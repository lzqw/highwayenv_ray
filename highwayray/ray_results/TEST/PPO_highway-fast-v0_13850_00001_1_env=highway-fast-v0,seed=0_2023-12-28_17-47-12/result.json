{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.4862597031063505, "policy_loss": -0.04069419922100173, "vf_loss": 6.521056719885932, "vf_explained_var": 0.0012226487530602348, "kl": 0.029485893761002798, "entropy": 1.5804663234286838, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 2000}, "sampler_results": {"episode_reward_max": 25.45293220589944, "episode_reward_min": 1.0515669732067, "episode_reward_mean": 8.928646030987952, "episode_len_mean": 11.826347305389222, "episode_media": {}, "episodes_this_iter": 167, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.477886123188993, 4.6449503170965825, 3.0686598658664943, 2.782441700960219, 21.15054881995625, 5.346027197995538, 10.332358559623128, 7.778198595921625, 17.66550125600749, 22.384394641727873, 3.9801748744098235, 18.83417951181514, 9.23470775941038, 7.532710627705605, 2.8478619837706, 1.9801294969714418, 9.718327923191296, 4.486258262049443, 1.765378591649179, 6.648758502420434, 6.779778844850785, 13.030949302732413, 21.24457510169915, 6.582703968849137, 6.716522094577086, 2.113158342536706, 7.553508324129963, 22.54760325100386, 8.917258079323231, 25.45293220589944, 21.052453395579448, 2.9461738810591918, 2.7530974449830916, 6.311911342048979, 6.764286092488565, 8.917905487468982, 6.199748872573543, 7.5996810101998555, 1.1182336398733663, 20.51063723283475, 5.181803372141482, 3.851661043952661, 8.331393635861117, 1.9801294969714418, 5.751291488865768, 1.0515669732067, 15.884418266524305, 4.66670676382131, 2.335058074823598, 11.897333576638738, 9.644430563608681, 3.78426506286109, 6.945249955666051, 8.06353199367483, 6.832450024339047, 9.018404840137283, 11.178376801311602, 13.479667366683705, 1.8310211293445555, 18.720215087982975, 2.5643544626778887, 22.56347649608543, 23.34484870981927, 10.912955902865487, 23.91738936985781, 8.234527082948961, 1.9130006968016178, 6.511400029347958, 5.733251402077789, 10.034758594497715, 5.046446298431657, 8.296398094108302, 2.6327113850086175, 1.833448065613905, 3.466362178898597, 8.63471947092739, 22.43160530263536, 3.546334030134951, 6.31755829903978, 21.031778813712954, 4.313000696801617, 7.4159541875574675, 7.915424370114533, 8.815821093222533, 17.377589114087943, 8.415615779908794, 9.168243490958387, 6.9969282880226995, 8.33363851665652, 12.919415635496094, 10.779158768749802, 1.8801294969714422, 6.6131122697523175, 15.384132071700847, 2.046796163638108, 9.612687519952217, 6.168663164340996, 2.532710609458528, 12.744011309831134, 20.11364307073806, 3.533333333333333, 7.115044010343308, 5.80137185507663, 9.11311297874462, 13.313112269748142, 8.16568292781032, 8.58598816218162, 4.478740045252978, 5.6326637366395085, 21.520177620228065, 1.8467961636381087, 23.03333871878797, 2.3169355743565796, 2.013000696801617, 18.2794282058151, 4.866352945088611, 13.181213940761163, 21.396193936817152, 5.645146135325421, 14.911283958736599, 23.445567155937518, 16.718393551231735, 2.8801294969714415, 13.55095916932586, 2.5321312971847516, 5.046446298431657, 10.111448222783103, 13.912270043701504, 2.4653777680197444, 5.165422597127395, 7.779821661922382, 22.485668045000644, 2.3023122039887776, 3.317728004269611, 5.478074422613265, 3.6635388674447036, 2.8134628303047755, 2.566044718341951, 15.660712940604641, 13.177892971749404, 4.713118245382063, 2.013462830304775, 2.483601479139982, 8.543945518703461, 20.845597929733785, 1.8467961636381087, 4.0655003997555585, 5.766977233691044, 2.782441700960219, 7.71216939265733, 20.484590634149086, 11.1124895458772, 18.382163561767534, 4.579667363468284, 8.096411337952693, 1.848486085051929, 5.649644806338591, 5.897687100665215, 3.4818189775443633, 22.685016398405846, 22.596989166468465, 3.012211550430047, 4.115456032436908, 3.913118245382062, 3.452263374485597, 11.699015678189609, 1.765378591649179], "episode_lengths": [13, 6, 5, 4, 29, 7, 12, 11, 24, 30, 6, 28, 13, 10, 4, 3, 11, 7, 3, 8, 8, 18, 25, 9, 9, 3, 12, 30, 11, 30, 27, 4, 4, 8, 10, 10, 8, 10, 2, 26, 7, 5, 12, 3, 8, 2, 22, 7, 4, 16, 11, 6, 9, 10, 10, 13, 13, 18, 3, 25, 4, 30, 29, 15, 30, 12, 3, 8, 7, 14, 6, 10, 4, 3, 5, 13, 28, 5, 9, 30, 6, 10, 9, 11, 20, 10, 12, 10, 11, 17, 14, 3, 8, 21, 3, 11, 9, 4, 16, 28, 5, 10, 8, 11, 16, 10, 13, 6, 7, 30, 3, 30, 4, 3, 25, 7, 18, 28, 8, 19, 29, 24, 4, 17, 4, 6, 12, 18, 4, 7, 11, 30, 4, 5, 7, 5, 4, 4, 19, 15, 6, 3, 4, 10, 28, 3, 6, 9, 4, 9, 27, 13, 23, 6, 11, 3, 8, 8, 5, 30, 30, 4, 6, 5, 5, 16, 3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1719203722113556, "mean_inference_ms": 1.2308163144837494, "mean_action_processing_ms": 0.10480134860090705, "mean_env_wait_ms": 29.64141153204984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007164835216042525, "StateBufferConnector_ms": 0.006602338688102311, "ViewRequirementAgentConnector_ms": 0.11499099388807833}}, "episode_reward_max": 25.45293220589944, "episode_reward_min": 1.0515669732067, "episode_reward_mean": 8.928646030987952, "episode_len_mean": 11.826347305389222, "episodes_this_iter": 167, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.477886123188993, 4.6449503170965825, 3.0686598658664943, 2.782441700960219, 21.15054881995625, 5.346027197995538, 10.332358559623128, 7.778198595921625, 17.66550125600749, 22.384394641727873, 3.9801748744098235, 18.83417951181514, 9.23470775941038, 7.532710627705605, 2.8478619837706, 1.9801294969714418, 9.718327923191296, 4.486258262049443, 1.765378591649179, 6.648758502420434, 6.779778844850785, 13.030949302732413, 21.24457510169915, 6.582703968849137, 6.716522094577086, 2.113158342536706, 7.553508324129963, 22.54760325100386, 8.917258079323231, 25.45293220589944, 21.052453395579448, 2.9461738810591918, 2.7530974449830916, 6.311911342048979, 6.764286092488565, 8.917905487468982, 6.199748872573543, 7.5996810101998555, 1.1182336398733663, 20.51063723283475, 5.181803372141482, 3.851661043952661, 8.331393635861117, 1.9801294969714418, 5.751291488865768, 1.0515669732067, 15.884418266524305, 4.66670676382131, 2.335058074823598, 11.897333576638738, 9.644430563608681, 3.78426506286109, 6.945249955666051, 8.06353199367483, 6.832450024339047, 9.018404840137283, 11.178376801311602, 13.479667366683705, 1.8310211293445555, 18.720215087982975, 2.5643544626778887, 22.56347649608543, 23.34484870981927, 10.912955902865487, 23.91738936985781, 8.234527082948961, 1.9130006968016178, 6.511400029347958, 5.733251402077789, 10.034758594497715, 5.046446298431657, 8.296398094108302, 2.6327113850086175, 1.833448065613905, 3.466362178898597, 8.63471947092739, 22.43160530263536, 3.546334030134951, 6.31755829903978, 21.031778813712954, 4.313000696801617, 7.4159541875574675, 7.915424370114533, 8.815821093222533, 17.377589114087943, 8.415615779908794, 9.168243490958387, 6.9969282880226995, 8.33363851665652, 12.919415635496094, 10.779158768749802, 1.8801294969714422, 6.6131122697523175, 15.384132071700847, 2.046796163638108, 9.612687519952217, 6.168663164340996, 2.532710609458528, 12.744011309831134, 20.11364307073806, 3.533333333333333, 7.115044010343308, 5.80137185507663, 9.11311297874462, 13.313112269748142, 8.16568292781032, 8.58598816218162, 4.478740045252978, 5.6326637366395085, 21.520177620228065, 1.8467961636381087, 23.03333871878797, 2.3169355743565796, 2.013000696801617, 18.2794282058151, 4.866352945088611, 13.181213940761163, 21.396193936817152, 5.645146135325421, 14.911283958736599, 23.445567155937518, 16.718393551231735, 2.8801294969714415, 13.55095916932586, 2.5321312971847516, 5.046446298431657, 10.111448222783103, 13.912270043701504, 2.4653777680197444, 5.165422597127395, 7.779821661922382, 22.485668045000644, 2.3023122039887776, 3.317728004269611, 5.478074422613265, 3.6635388674447036, 2.8134628303047755, 2.566044718341951, 15.660712940604641, 13.177892971749404, 4.713118245382063, 2.013462830304775, 2.483601479139982, 8.543945518703461, 20.845597929733785, 1.8467961636381087, 4.0655003997555585, 5.766977233691044, 2.782441700960219, 7.71216939265733, 20.484590634149086, 11.1124895458772, 18.382163561767534, 4.579667363468284, 8.096411337952693, 1.848486085051929, 5.649644806338591, 5.897687100665215, 3.4818189775443633, 22.685016398405846, 22.596989166468465, 3.012211550430047, 4.115456032436908, 3.913118245382062, 3.452263374485597, 11.699015678189609, 1.765378591649179], "episode_lengths": [13, 6, 5, 4, 29, 7, 12, 11, 24, 30, 6, 28, 13, 10, 4, 3, 11, 7, 3, 8, 8, 18, 25, 9, 9, 3, 12, 30, 11, 30, 27, 4, 4, 8, 10, 10, 8, 10, 2, 26, 7, 5, 12, 3, 8, 2, 22, 7, 4, 16, 11, 6, 9, 10, 10, 13, 13, 18, 3, 25, 4, 30, 29, 15, 30, 12, 3, 8, 7, 14, 6, 10, 4, 3, 5, 13, 28, 5, 9, 30, 6, 10, 9, 11, 20, 10, 12, 10, 11, 17, 14, 3, 8, 21, 3, 11, 9, 4, 16, 28, 5, 10, 8, 11, 16, 10, 13, 6, 7, 30, 3, 30, 4, 3, 25, 7, 18, 28, 8, 19, 29, 24, 4, 17, 4, 6, 12, 18, 4, 7, 11, 30, 4, 5, 7, 5, 4, 4, 19, 15, 6, 3, 4, 10, 28, 3, 6, 9, 4, 9, 27, 13, 23, 6, 11, 3, 8, 8, 5, 30, 30, 4, 6, 5, 5, 16, 3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1719203722113556, "mean_inference_ms": 1.2308163144837494, "mean_action_processing_ms": 0.10480134860090705, "mean_env_wait_ms": 29.64141153204984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007164835216042525, "StateBufferConnector_ms": 0.006602338688102311, "ViewRequirementAgentConnector_ms": 0.11499099388807833}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 2000, "num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.563014162205416, "num_env_steps_trained_throughput_per_sec": 29.563014162205416, "timesteps_total": 2000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 2000, "timers": {"training_iteration_time_ms": 67652.059, "sample_time_ms": 64384.106, "load_time_ms": 5.245, "load_throughput": 381317.696, "learn_time_ms": 3259.476, "learn_throughput": 613.596, "synch_weights_time_ms": 2.624}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 2000}, "done": false, "episodes_total": 167, "training_iteration": 1, "trial_id": "13850_00001", "date": "2023-12-28_17-48-37", "timestamp": 1703756917, "time_this_iter_s": 67.66085481643677, "time_total_s": 67.66085481643677, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 67.66085481643677, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 55.628865979381445, "ram_util_percent": 91.09381443298972}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.8689654244316944, "policy_loss": -0.021652758580942948, "vf_loss": 6.884579362869263, "vf_explained_var": 0.005672498279147678, "kl": 0.020129435858365873, "entropy": 1.5331122014257643, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 675.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 25.34364189757877, "episode_reward_min": 1.0491083676268862, "episode_reward_mean": 10.800891617678458, "episode_len_mean": 14.691176470588236, "episode_media": {}, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.684593324306004, 6.9859704770168864, 22.48409539310964, 6.278840597496103, 6.297826213482986, 3.7847496881800398, 2.3131583425367053, 17.229772556136176, 4.612024130629389, 19.46604793728728, 1.9463340301349508, 4.266671946950406, 3.6306765444218434, 3.878856429045265, 15.667480932942173, 13.385587646316973, 14.864260996562994, 2.3131583425367053, 3.901689479302434, 21.998179144206834, 17.279825114658692, 5.346486395586299, 4.379825009203373, 7.916357973593251, 18.612650807653946, 10.213508988730082, 25.34364189757877, 10.365105121523634, 16.401353824356203, 9.178262206258845, 10.099740090659642, 4.579044639634937, 16.363840007458112, 16.899816487194556, 4.5529256965952305, 5.782162793325908, 4.578700309425004, 21.450529078601406, 3.4993772761251947, 5.764894060468059, 22.319022519742013, 12.047900370413048, 4.153111909041576, 17.944200023800278, 18.664176681327646, 18.882342031066806, 20.81928972869088, 6.898117738906494, 17.232973800493838, 8.032759146483265, 21.144966456897453, 20.59748112601352, 13.4644411251814, 3.650547047450401, 4.485611393518955, 5.065471902291169, 7.751527535688643, 14.332715911142225, 7.684591250289381, 2.4653777680197444, 6.529723574707208, 5.917559098012349, 11.117506822797012, 2.466359768800248, 22.765160417809994, 9.697800271585141, 19.318669972198965, 3.4654233711720366, 18.285606414732545, 9.099411645280892, 1.8467961636381087, 1.748486085051929, 3.746796163638108, 22.764212583924497, 10.645828841444132, 5.885990587493427, 4.279317392702511, 6.74675009085372, 21.716077529257273, 8.632746119292541, 4.931465163732556, 6.3999546346199825, 23.479902856159395, 19.585665494227605, 8.281625784695587, 22.18387468030368, 9.950619565115197, 3.046491675870039, 9.286445275987463, 2.8131583425367057, 20.58618522231692, 8.848835495771183, 5.745973659068123, 3.2793226729862606, 9.200000000240752, 10.214175617889456, 13.433065492162262, 21.81924561959718, 4.584746093733852, 1.180129496971442, 11.0115961036633, 21.68058626387577, 6.052038450719391, 4.517909432251434, 23.252442734061894, 6.5131531538211656, 22.478685526963165, 1.0491083676268862, 7.832683232098666, 14.16927632724174, 5.251995764016134, 2.046796163638108, 13.184545777782922, 22.7190355723467, 18.186887034901673, 2.9307166415764856, 4.232044434686411, 20.617908766566167, 21.56866497356523, 2.6484856442110303, 10.467460630573582, 2.8635875579904004, 18.13466841676223, 8.052053273270184, 5.698544334137234, 9.085790132690452, 3.533333333333333, 13.278224132133152, 13.044123733096798, 1.7987986913137053, 21.818012572403912, 3.6535484212846043, 13.128389341406411, 14.946491689757147, 16.64765078572226, 12.064269436710493], "episode_lengths": [30, 8, 30, 8, 9, 6, 3, 23, 6, 27, 3, 6, 5, 5, 22, 19, 20, 3, 6, 30, 22, 7, 6, 11, 25, 14, 30, 14, 21, 11, 14, 6, 22, 23, 7, 8, 6, 30, 5, 8, 30, 16, 5, 23, 25, 27, 30, 9, 24, 11, 29, 27, 18, 5, 6, 7, 10, 19, 11, 4, 8, 9, 16, 4, 30, 13, 28, 5, 24, 12, 3, 3, 5, 30, 12, 9, 5, 8, 30, 13, 7, 8, 30, 29, 12, 30, 15, 4, 11, 4, 30, 11, 7, 4, 13, 14, 19, 30, 7, 2, 14, 30, 9, 6, 30, 8, 30, 2, 11, 20, 8, 3, 19, 30, 27, 4, 6, 29, 30, 4, 15, 4, 25, 12, 7, 12, 5, 18, 16, 3, 30, 6, 17, 19, 24, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0862145475136342, "mean_inference_ms": 1.2180553141667587, "mean_action_processing_ms": 0.10410370572868867, "mean_env_wait_ms": 29.479623704932685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006969360744251925, "StateBufferConnector_ms": 0.0060637207592234895, "ViewRequirementAgentConnector_ms": 0.11473263011259191}}, "episode_reward_max": 25.34364189757877, "episode_reward_min": 1.0491083676268862, "episode_reward_mean": 10.800891617678458, "episode_len_mean": 14.691176470588236, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.684593324306004, 6.9859704770168864, 22.48409539310964, 6.278840597496103, 6.297826213482986, 3.7847496881800398, 2.3131583425367053, 17.229772556136176, 4.612024130629389, 19.46604793728728, 1.9463340301349508, 4.266671946950406, 3.6306765444218434, 3.878856429045265, 15.667480932942173, 13.385587646316973, 14.864260996562994, 2.3131583425367053, 3.901689479302434, 21.998179144206834, 17.279825114658692, 5.346486395586299, 4.379825009203373, 7.916357973593251, 18.612650807653946, 10.213508988730082, 25.34364189757877, 10.365105121523634, 16.401353824356203, 9.178262206258845, 10.099740090659642, 4.579044639634937, 16.363840007458112, 16.899816487194556, 4.5529256965952305, 5.782162793325908, 4.578700309425004, 21.450529078601406, 3.4993772761251947, 5.764894060468059, 22.319022519742013, 12.047900370413048, 4.153111909041576, 17.944200023800278, 18.664176681327646, 18.882342031066806, 20.81928972869088, 6.898117738906494, 17.232973800493838, 8.032759146483265, 21.144966456897453, 20.59748112601352, 13.4644411251814, 3.650547047450401, 4.485611393518955, 5.065471902291169, 7.751527535688643, 14.332715911142225, 7.684591250289381, 2.4653777680197444, 6.529723574707208, 5.917559098012349, 11.117506822797012, 2.466359768800248, 22.765160417809994, 9.697800271585141, 19.318669972198965, 3.4654233711720366, 18.285606414732545, 9.099411645280892, 1.8467961636381087, 1.748486085051929, 3.746796163638108, 22.764212583924497, 10.645828841444132, 5.885990587493427, 4.279317392702511, 6.74675009085372, 21.716077529257273, 8.632746119292541, 4.931465163732556, 6.3999546346199825, 23.479902856159395, 19.585665494227605, 8.281625784695587, 22.18387468030368, 9.950619565115197, 3.046491675870039, 9.286445275987463, 2.8131583425367057, 20.58618522231692, 8.848835495771183, 5.745973659068123, 3.2793226729862606, 9.200000000240752, 10.214175617889456, 13.433065492162262, 21.81924561959718, 4.584746093733852, 1.180129496971442, 11.0115961036633, 21.68058626387577, 6.052038450719391, 4.517909432251434, 23.252442734061894, 6.5131531538211656, 22.478685526963165, 1.0491083676268862, 7.832683232098666, 14.16927632724174, 5.251995764016134, 2.046796163638108, 13.184545777782922, 22.7190355723467, 18.186887034901673, 2.9307166415764856, 4.232044434686411, 20.617908766566167, 21.56866497356523, 2.6484856442110303, 10.467460630573582, 2.8635875579904004, 18.13466841676223, 8.052053273270184, 5.698544334137234, 9.085790132690452, 3.533333333333333, 13.278224132133152, 13.044123733096798, 1.7987986913137053, 21.818012572403912, 3.6535484212846043, 13.128389341406411, 14.946491689757147, 16.64765078572226, 12.064269436710493], "episode_lengths": [30, 8, 30, 8, 9, 6, 3, 23, 6, 27, 3, 6, 5, 5, 22, 19, 20, 3, 6, 30, 22, 7, 6, 11, 25, 14, 30, 14, 21, 11, 14, 6, 22, 23, 7, 8, 6, 30, 5, 8, 30, 16, 5, 23, 25, 27, 30, 9, 24, 11, 29, 27, 18, 5, 6, 7, 10, 19, 11, 4, 8, 9, 16, 4, 30, 13, 28, 5, 24, 12, 3, 3, 5, 30, 12, 9, 5, 8, 30, 13, 7, 8, 30, 29, 12, 30, 15, 4, 11, 4, 30, 11, 7, 4, 13, 14, 19, 30, 7, 2, 14, 30, 9, 6, 30, 8, 30, 2, 11, 20, 8, 3, 19, 30, 27, 4, 6, 29, 30, 4, 15, 4, 25, 12, 7, 12, 5, 18, 16, 3, 30, 6, 17, 19, 24, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0862145475136342, "mean_inference_ms": 1.2180553141667587, "mean_action_processing_ms": 0.10410370572868867, "mean_env_wait_ms": 29.479623704932685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006969360744251925, "StateBufferConnector_ms": 0.0060637207592234895, "ViewRequirementAgentConnector_ms": 0.11473263011259191}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.087757093991858, "num_env_steps_trained_throughput_per_sec": 30.087757093991858, "timesteps_total": 4000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 67062.128, "sample_time_ms": 63844.932, "load_time_ms": 10.964, "load_throughput": 182414.578, "learn_time_ms": 3203.297, "learn_throughput": 624.357, "synch_weights_time_ms": 2.422}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 303, "training_iteration": 2, "trial_id": "13850_00001", "date": "2023-12-28_17-49-43", "timestamp": 1703756983, "time_this_iter_s": 66.47833728790283, "time_total_s": 134.1391921043396, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 134.1391921043396, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 56.02659574468084, "ram_util_percent": 92.22978723404252}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.479537400139702, "policy_loss": -0.03312240731385019, "vf_loss": 7.503605193032159, "vf_explained_var": 0.009889065159691705, "kl": 0.020121370361263703, "entropy": 1.4425438139173719, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1125.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 6000}, "sampler_results": {"episode_reward_max": 24.82022116903217, "episode_reward_min": 1.5999999999999999, "episode_reward_mean": 12.763110426779132, "episode_len_mean": 17.608695652173914, "episode_media": {}, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.28437439320479, 7.751897888270587, 16.533736643648083, 1.6327106102381586, 4.569329431207903, 22.020136724789914, 22.551067394489596, 2.279362770141792, 23.21821683683828, 9.149659515421396, 6.8683590886015375, 3.396399366180768, 21.286881756387857, 6.885598103769517, 14.418635776735938, 17.265164942352065, 5.786540198089096, 6.932142796527457, 21.732404053470123, 12.419275377967644, 16.48355015620084, 2.432044434686411, 11.351117449331229, 1.6836014791399825, 14.478926723443859, 1.8675007371641619, 14.628094796308678, 24.82022116903217, 21.352043706400185, 6.720220366647077, 20.516414318131158, 21.552660259933845, 23.11617947893982, 6.5658145614583185, 1.5999999999999999, 7.669026077629737, 22.151126098541447, 3.266043943571492, 12.2459514282572, 5.21932140525432, 11.268124916876321, 11.39649977267236, 20.919327486254943, 3.819551498228223, 10.885321928915166, 10.678826099694824, 4.614847823109603, 20.61991498229146, 22.35261815508851, 22.45222103998291, 3.0519865608863372, 18.26631678940175, 11.584495492583965, 10.534701848886192, 14.463636394689932, 4.745868952454182, 2.8793542947697803, 5.651292815001398, 6.335373373185197, 9.415160419432425, 14.198176239411975, 22.88303454120204, 4.05355439691435, 21.5523559464406, 23.044365254590655, 2.6517119596450094, 7.116363031448241, 8.599698134003658, 16.28534671874875, 22.184427561786613, 7.811461924617281, 21.19969414760165, 2.4192470104833284, 7.052931763793176, 1.665465357980372, 21.984761056761297, 22.384191254840616, 2.383601479139982, 2.6333333333333333, 20.753548513380235, 8.164394665256138, 2.046796163638108, 20.320215090075116, 22.785650824057672, 22.48626995203415, 22.519504106097436, 21.05354145142744, 22.352011540735155, 2.782441700960219, 11.752239533395993, 23.243609367890073, 22.11994725256589, 12.16604737992315, 5.7353220213905605, 21.96581356146809, 7.735994426944683, 21.38444494707058, 22.252622080143905, 2.1530974449830915, 18.950776635214932, 1.7824417009602196, 22.181515456156554, 15.400418495906454, 16.732381199246824, 16.402656880975407, 7.032485828582539, 22.118637046894793, 1.9973833082431531, 22.1193019484779, 2.699378051675284, 5.132395874350522, 15.632180239480794, 1.764354462677889, 12.845550300735582, 21.451415611030896], "episode_lengths": [30, 11, 21, 3, 7, 30, 30, 3, 30, 13, 10, 5, 30, 10, 21, 25, 9, 10, 30, 18, 24, 4, 16, 3, 19, 3, 19, 30, 30, 10, 30, 30, 30, 10, 3, 11, 30, 5, 17, 8, 16, 16, 30, 6, 15, 13, 6, 30, 30, 30, 5, 26, 17, 15, 19, 6, 4, 8, 9, 13, 19, 30, 7, 30, 30, 4, 10, 12, 23, 30, 10, 29, 4, 11, 3, 30, 30, 4, 4, 30, 11, 3, 30, 30, 30, 30, 30, 30, 4, 17, 29, 30, 16, 8, 30, 12, 30, 30, 3, 26, 3, 30, 20, 22, 24, 10, 30, 3, 30, 4, 7, 20, 3, 18, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.026929646526808, "mean_inference_ms": 1.2166272837049745, "mean_action_processing_ms": 0.10424422296041888, "mean_env_wait_ms": 29.569478377444103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007056567979895551, "StateBufferConnector_ms": 0.005687008733334748, "ViewRequirementAgentConnector_ms": 0.11483150979746944}}, "episode_reward_max": 24.82022116903217, "episode_reward_min": 1.5999999999999999, "episode_reward_mean": 12.763110426779132, "episode_len_mean": 17.608695652173914, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.28437439320479, 7.751897888270587, 16.533736643648083, 1.6327106102381586, 4.569329431207903, 22.020136724789914, 22.551067394489596, 2.279362770141792, 23.21821683683828, 9.149659515421396, 6.8683590886015375, 3.396399366180768, 21.286881756387857, 6.885598103769517, 14.418635776735938, 17.265164942352065, 5.786540198089096, 6.932142796527457, 21.732404053470123, 12.419275377967644, 16.48355015620084, 2.432044434686411, 11.351117449331229, 1.6836014791399825, 14.478926723443859, 1.8675007371641619, 14.628094796308678, 24.82022116903217, 21.352043706400185, 6.720220366647077, 20.516414318131158, 21.552660259933845, 23.11617947893982, 6.5658145614583185, 1.5999999999999999, 7.669026077629737, 22.151126098541447, 3.266043943571492, 12.2459514282572, 5.21932140525432, 11.268124916876321, 11.39649977267236, 20.919327486254943, 3.819551498228223, 10.885321928915166, 10.678826099694824, 4.614847823109603, 20.61991498229146, 22.35261815508851, 22.45222103998291, 3.0519865608863372, 18.26631678940175, 11.584495492583965, 10.534701848886192, 14.463636394689932, 4.745868952454182, 2.8793542947697803, 5.651292815001398, 6.335373373185197, 9.415160419432425, 14.198176239411975, 22.88303454120204, 4.05355439691435, 21.5523559464406, 23.044365254590655, 2.6517119596450094, 7.116363031448241, 8.599698134003658, 16.28534671874875, 22.184427561786613, 7.811461924617281, 21.19969414760165, 2.4192470104833284, 7.052931763793176, 1.665465357980372, 21.984761056761297, 22.384191254840616, 2.383601479139982, 2.6333333333333333, 20.753548513380235, 8.164394665256138, 2.046796163638108, 20.320215090075116, 22.785650824057672, 22.48626995203415, 22.519504106097436, 21.05354145142744, 22.352011540735155, 2.782441700960219, 11.752239533395993, 23.243609367890073, 22.11994725256589, 12.16604737992315, 5.7353220213905605, 21.96581356146809, 7.735994426944683, 21.38444494707058, 22.252622080143905, 2.1530974449830915, 18.950776635214932, 1.7824417009602196, 22.181515456156554, 15.400418495906454, 16.732381199246824, 16.402656880975407, 7.032485828582539, 22.118637046894793, 1.9973833082431531, 22.1193019484779, 2.699378051675284, 5.132395874350522, 15.632180239480794, 1.764354462677889, 12.845550300735582, 21.451415611030896], "episode_lengths": [30, 11, 21, 3, 7, 30, 30, 3, 30, 13, 10, 5, 30, 10, 21, 25, 9, 10, 30, 18, 24, 4, 16, 3, 19, 3, 19, 30, 30, 10, 30, 30, 30, 10, 3, 11, 30, 5, 17, 8, 16, 16, 30, 6, 15, 13, 6, 30, 30, 30, 5, 26, 17, 15, 19, 6, 4, 8, 9, 13, 19, 30, 7, 30, 30, 4, 10, 12, 23, 30, 10, 29, 4, 11, 3, 30, 30, 4, 4, 30, 11, 3, 30, 30, 30, 30, 30, 30, 4, 17, 29, 30, 16, 8, 30, 12, 30, 30, 3, 26, 3, 30, 20, 22, 24, 10, 30, 3, 30, 4, 7, 20, 3, 18, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.026929646526808, "mean_inference_ms": 1.2166272837049745, "mean_action_processing_ms": 0.10424422296041888, "mean_env_wait_ms": 29.569478377444103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007056567979895551, "StateBufferConnector_ms": 0.005687008733334748, "ViewRequirementAgentConnector_ms": 0.11483150979746944}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 6000, "num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.75868115111248, "num_env_steps_trained_throughput_per_sec": 29.75868115111248, "timesteps_total": 6000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 6000, "timers": {"training_iteration_time_ms": 67110.505, "sample_time_ms": 63898.052, "load_time_ms": 11.093, "load_throughput": 180287.735, "learn_time_ms": 3198.509, "learn_throughput": 625.291, "synch_weights_time_ms": 2.361}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 6000}, "done": false, "episodes_total": 418, "training_iteration": 3, "trial_id": "13850_00001", "date": "2023-12-28_17-50-50", "timestamp": 1703757050, "time_this_iter_s": 67.21294236183167, "time_total_s": 201.35213446617126, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 201.35213446617126, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 55.93854166666667, "ram_util_percent": 92.18645833333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.675, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.8182485824161105, "policy_loss": -0.007117112742529975, "vf_loss": 7.822010125054254, "vf_explained_var": 0.0021030292246076794, "kl": 0.00497126702552715, "entropy": 1.3903172482384576, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 23.584350532189244, "episode_reward_min": 1.5189803374294353, "episode_reward_mean": 15.233085509985635, "episode_len_mean": 21.17, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.9973833082431531, 22.1193019484779, 2.699378051675284, 5.132395874350522, 15.632180239480794, 1.764354462677889, 12.845550300735582, 21.451415611030896, 20.886887723559802, 17.185375262038622, 22.816536817903568, 22.517443316465062, 20.785967729727496, 12.133335175359152, 13.198816441526532, 14.884569628867048, 2.946491675870039, 21.91932066814751, 4.5310211293445555, 6.49817912820799, 10.579778950305553, 21.286881844885006, 1.5689788706554444, 21.62022036823502, 2.697383308243153, 23.018814171823458, 22.21843202872351, 3.966123544495447, 17.502662869995998, 8.232736573214188, 3.232710609458528, 21.15266081779124, 6.450932516441963, 20.65351611652106, 21.286887835698824, 4.429732699514101, 21.185950577129997, 21.352320034104416, 11.298792765164757, 21.153208200441725, 15.00265502657458, 23.584350532189244, 11.019019246541346, 22.283585667870142, 22.585693399915787, 19.585382672401426, 14.766749392137454, 22.11959767646785, 22.018700017577306, 8.018818521036122, 21.4198667112275, 21.619940296780833, 21.286887835462192, 21.36578420115986, 22.08562411821737, 21.386887035084214, 8.469323547669608, 3.0131583425367054, 21.202619321165397, 2.482746188728289, 22.486887835462724, 9.450618668949215, 20.786838880797447, 12.3654796132366, 22.03005403918133, 22.18381155687181, 4.681620825336344, 5.9189702512596005, 8.035996189442768, 21.25205459699486, 2.2189803374294357, 21.51959767622703, 21.253554502128843, 21.886579886797037, 21.586574001985152, 22.80234789595425, 21.76932074399625, 13.186881730578898, 1.5189803374294353, 10.120221169000995, 13.919018043197074, 22.248750977396828, 21.31790288245261, 22.51755412878365, 5.1967204876726525, 9.748497810168386, 20.886539424476233, 1.766043943571492, 17.486844207126055, 15.434012080265713, 21.25119873569507, 21.486537261463287, 5.046661217264056, 21.084786956941407, 10.419873440084508, 10.817375399513441, 21.41954561299669, 20.88569013962202, 17.91499901691938, 21.252609546617098], "episode_lengths": [3, 30, 4, 7, 20, 3, 18, 30, 30, 25, 30, 30, 30, 18, 19, 21, 4, 30, 6, 9, 13, 30, 3, 30, 4, 30, 30, 6, 25, 11, 5, 30, 9, 30, 30, 6, 30, 30, 15, 30, 22, 30, 16, 30, 30, 28, 21, 30, 30, 11, 30, 30, 30, 30, 30, 30, 13, 4, 30, 4, 30, 12, 30, 17, 30, 30, 6, 9, 12, 30, 4, 30, 30, 30, 30, 30, 30, 17, 3, 14, 19, 30, 30, 30, 7, 14, 30, 3, 24, 21, 30, 30, 7, 30, 16, 15, 30, 30, 24, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9717731353019139, "mean_inference_ms": 1.2169632683784977, "mean_action_processing_ms": 0.10435325338084382, "mean_env_wait_ms": 29.583052500319308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007055044174194336, "StateBufferConnector_ms": 0.005409717559814453, "ViewRequirementAgentConnector_ms": 0.11562800407409668}}, "episode_reward_max": 23.584350532189244, "episode_reward_min": 1.5189803374294353, "episode_reward_mean": 15.233085509985635, "episode_len_mean": 21.17, "episodes_this_iter": 92, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.9973833082431531, 22.1193019484779, 2.699378051675284, 5.132395874350522, 15.632180239480794, 1.764354462677889, 12.845550300735582, 21.451415611030896, 20.886887723559802, 17.185375262038622, 22.816536817903568, 22.517443316465062, 20.785967729727496, 12.133335175359152, 13.198816441526532, 14.884569628867048, 2.946491675870039, 21.91932066814751, 4.5310211293445555, 6.49817912820799, 10.579778950305553, 21.286881844885006, 1.5689788706554444, 21.62022036823502, 2.697383308243153, 23.018814171823458, 22.21843202872351, 3.966123544495447, 17.502662869995998, 8.232736573214188, 3.232710609458528, 21.15266081779124, 6.450932516441963, 20.65351611652106, 21.286887835698824, 4.429732699514101, 21.185950577129997, 21.352320034104416, 11.298792765164757, 21.153208200441725, 15.00265502657458, 23.584350532189244, 11.019019246541346, 22.283585667870142, 22.585693399915787, 19.585382672401426, 14.766749392137454, 22.11959767646785, 22.018700017577306, 8.018818521036122, 21.4198667112275, 21.619940296780833, 21.286887835462192, 21.36578420115986, 22.08562411821737, 21.386887035084214, 8.469323547669608, 3.0131583425367054, 21.202619321165397, 2.482746188728289, 22.486887835462724, 9.450618668949215, 20.786838880797447, 12.3654796132366, 22.03005403918133, 22.18381155687181, 4.681620825336344, 5.9189702512596005, 8.035996189442768, 21.25205459699486, 2.2189803374294357, 21.51959767622703, 21.253554502128843, 21.886579886797037, 21.586574001985152, 22.80234789595425, 21.76932074399625, 13.186881730578898, 1.5189803374294353, 10.120221169000995, 13.919018043197074, 22.248750977396828, 21.31790288245261, 22.51755412878365, 5.1967204876726525, 9.748497810168386, 20.886539424476233, 1.766043943571492, 17.486844207126055, 15.434012080265713, 21.25119873569507, 21.486537261463287, 5.046661217264056, 21.084786956941407, 10.419873440084508, 10.817375399513441, 21.41954561299669, 20.88569013962202, 17.91499901691938, 21.252609546617098], "episode_lengths": [3, 30, 4, 7, 20, 3, 18, 30, 30, 25, 30, 30, 30, 18, 19, 21, 4, 30, 6, 9, 13, 30, 3, 30, 4, 30, 30, 6, 25, 11, 5, 30, 9, 30, 30, 6, 30, 30, 15, 30, 22, 30, 16, 30, 30, 28, 21, 30, 30, 11, 30, 30, 30, 30, 30, 30, 13, 4, 30, 4, 30, 12, 30, 17, 30, 30, 6, 9, 12, 30, 4, 30, 30, 30, 30, 30, 30, 17, 3, 14, 19, 30, 30, 30, 7, 14, 30, 3, 24, 21, 30, 30, 7, 30, 16, 15, 30, 30, 24, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9717731353019139, "mean_inference_ms": 1.2169632683784977, "mean_action_processing_ms": 0.10435325338084382, "mean_env_wait_ms": 29.583052500319308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007055044174194336, "StateBufferConnector_ms": 0.005409717559814453, "ViewRequirementAgentConnector_ms": 0.11562800407409668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.98579881414833, "num_env_steps_trained_throughput_per_sec": 29.98579881414833, "timesteps_total": 8000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 67007.433, "sample_time_ms": 63805.687, "load_time_ms": 9.616, "load_throughput": 207986.314, "learn_time_ms": 3189.361, "learn_throughput": 627.085, "synch_weights_time_ms": 2.29}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 510, "training_iteration": 4, "trial_id": "13850_00001", "date": "2023-12-28_17-51-57", "timestamp": 1703757117, "time_this_iter_s": 66.70335030555725, "time_total_s": 268.0554847717285, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 268.0554847717285, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 56.08210526315791, "ram_util_percent": 92.23789473684205}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.956821241378784, "policy_loss": -0.041223387370506924, "vf_loss": 7.993069583045112, "vf_explained_var": 0.0020041880342695447, "kl": 0.014740934550072221, "entropy": 1.2714262586169773, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2025.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 10000}, "sampler_results": {"episode_reward_max": 23.81812472070825, "episode_reward_min": 1.6842249657064474, "episode_reward_mean": 16.305232531363107, "episode_len_mean": 22.8, "episode_media": {}, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.486844207126055, 15.434012080265713, 21.25119873569507, 21.486537261463287, 5.046661217264056, 21.084786956941407, 10.419873440084508, 10.817375399513441, 21.41954561299669, 20.88569013962202, 17.91499901691938, 21.252609546617098, 1.6842249657064474, 4.6856789972889334, 21.98657468654662, 20.919598444346484, 15.18637993719455, 20.720177620228053, 20.986887835702937, 15.866052063760886, 11.735950895960322, 21.119285456895568, 8.44910719194912, 21.152620186000977, 3.4868817546179374, 19.651051065280267, 2.046796163638108, 5.320221063581016, 19.953206773232935, 12.30004608667151, 21.06520785158812, 2.9154705465254835, 8.316123138022318, 14.45293177848938, 3.785929559081799, 21.686306755633765, 3.364757288214094, 21.751463992458408, 5.317908951160438, 22.767016545947175, 18.38688773046227, 21.753554502369667, 21.453510064039477, 21.71895994433569, 21.1526404901996, 3.4327106102381584, 23.81812472070825, 22.186843500012237, 19.31995331011804, 21.28688183288213, 19.768410469758965, 20.886851265469534, 21.48657724307948, 10.849459032046722, 5.886887730247684, 4.885024426400016, 4.286887730247683, 20.500307117231205, 21.552925020807578, 9.585993457603239, 7.116065531640753, 21.184445742259822, 22.618819906514528, 21.852659934369314, 22.185690596818315, 22.01960793341553, 22.668718284349207, 22.186887730247687, 22.29918748495667, 1.8643544626778887, 22.986276539977382, 21.318391273307686, 21.785555386584157, 21.886579193283122, 22.569289432733033, 21.086843499488758, 21.49919327668203, 21.685683375161382, 4.586887034901676, 21.58599171736786, 2.2511961201411834, 21.852655539095448, 16.764271038617306, 21.02021516621151, 20.95351016769145, 21.085957163896776, 8.18626434313033, 21.520177542074837, 21.853554502369608, 7.566626674726518, 21.719327486254958, 22.385306866654666, 12.485994152953314, 17.386887835703003, 20.816123950222373, 22.119609829180636, 20.98688782181589, 12.76871238946414, 6.620175084247655, 11.819289716632516], "episode_lengths": [24, 21, 30, 30, 7, 30, 16, 15, 30, 30, 24, 30, 3, 7, 30, 30, 21, 30, 30, 22, 17, 30, 12, 30, 6, 28, 3, 8, 30, 17, 30, 4, 12, 19, 6, 30, 5, 30, 8, 30, 28, 30, 30, 30, 30, 5, 30, 30, 27, 30, 27, 30, 30, 15, 9, 7, 7, 30, 30, 14, 10, 29, 30, 30, 30, 30, 30, 30, 30, 3, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 4, 30, 23, 30, 30, 30, 13, 30, 30, 10, 30, 30, 18, 23, 30, 30, 30, 18, 10, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9313109387147424, "mean_inference_ms": 1.216322383906043, "mean_action_processing_ms": 0.1044054455745456, "mean_env_wait_ms": 29.59493882374108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038593292236328, "StateBufferConnector_ms": 0.005257844924926758, "ViewRequirementAgentConnector_ms": 0.11511898040771484}}, "episode_reward_max": 23.81812472070825, "episode_reward_min": 1.6842249657064474, "episode_reward_mean": 16.305232531363107, "episode_len_mean": 22.8, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.486844207126055, 15.434012080265713, 21.25119873569507, 21.486537261463287, 5.046661217264056, 21.084786956941407, 10.419873440084508, 10.817375399513441, 21.41954561299669, 20.88569013962202, 17.91499901691938, 21.252609546617098, 1.6842249657064474, 4.6856789972889334, 21.98657468654662, 20.919598444346484, 15.18637993719455, 20.720177620228053, 20.986887835702937, 15.866052063760886, 11.735950895960322, 21.119285456895568, 8.44910719194912, 21.152620186000977, 3.4868817546179374, 19.651051065280267, 2.046796163638108, 5.320221063581016, 19.953206773232935, 12.30004608667151, 21.06520785158812, 2.9154705465254835, 8.316123138022318, 14.45293177848938, 3.785929559081799, 21.686306755633765, 3.364757288214094, 21.751463992458408, 5.317908951160438, 22.767016545947175, 18.38688773046227, 21.753554502369667, 21.453510064039477, 21.71895994433569, 21.1526404901996, 3.4327106102381584, 23.81812472070825, 22.186843500012237, 19.31995331011804, 21.28688183288213, 19.768410469758965, 20.886851265469534, 21.48657724307948, 10.849459032046722, 5.886887730247684, 4.885024426400016, 4.286887730247683, 20.500307117231205, 21.552925020807578, 9.585993457603239, 7.116065531640753, 21.184445742259822, 22.618819906514528, 21.852659934369314, 22.185690596818315, 22.01960793341553, 22.668718284349207, 22.186887730247687, 22.29918748495667, 1.8643544626778887, 22.986276539977382, 21.318391273307686, 21.785555386584157, 21.886579193283122, 22.569289432733033, 21.086843499488758, 21.49919327668203, 21.685683375161382, 4.586887034901676, 21.58599171736786, 2.2511961201411834, 21.852655539095448, 16.764271038617306, 21.02021516621151, 20.95351016769145, 21.085957163896776, 8.18626434313033, 21.520177542074837, 21.853554502369608, 7.566626674726518, 21.719327486254958, 22.385306866654666, 12.485994152953314, 17.386887835703003, 20.816123950222373, 22.119609829180636, 20.98688782181589, 12.76871238946414, 6.620175084247655, 11.819289716632516], "episode_lengths": [24, 21, 30, 30, 7, 30, 16, 15, 30, 30, 24, 30, 3, 7, 30, 30, 21, 30, 30, 22, 17, 30, 12, 30, 6, 28, 3, 8, 30, 17, 30, 4, 12, 19, 6, 30, 5, 30, 8, 30, 28, 30, 30, 30, 30, 5, 30, 30, 27, 30, 27, 30, 30, 15, 9, 7, 7, 30, 30, 14, 10, 29, 30, 30, 30, 30, 30, 30, 30, 3, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 4, 30, 23, 30, 30, 30, 13, 30, 30, 10, 30, 30, 18, 23, 30, 30, 30, 18, 10, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9313109387147424, "mean_inference_ms": 1.216322383906043, "mean_action_processing_ms": 0.1044054455745456, "mean_env_wait_ms": 29.59493882374108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038593292236328, "StateBufferConnector_ms": 0.005257844924926758, "ViewRequirementAgentConnector_ms": 0.11511898040771484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 10000, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.980900748402426, "num_env_steps_trained_throughput_per_sec": 29.980900748402426, "timesteps_total": 10000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 10000, "timers": {"training_iteration_time_ms": 66947.77, "sample_time_ms": 63745.778, "load_time_ms": 8.74, "load_throughput": 228834.306, "learn_time_ms": 3190.506, "learn_throughput": 626.86, "synch_weights_time_ms": 2.278}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 10000}, "done": false, "episodes_total": 598, "training_iteration": 5, "trial_id": "13850_00001", "date": "2023-12-28_17-53-04", "timestamp": 1703757184, "time_this_iter_s": 66.71411371231079, "time_total_s": 334.7695984840393, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 334.7695984840393, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 55.910526315789475, "ram_util_percent": 92.17578947368422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.960044033262465, "policy_loss": -0.031704190166460144, "vf_loss": 7.988559274673462, "vf_explained_var": 0.0006260408295525445, "kl": 0.009448673365459596, "entropy": 1.1844887394375272, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2475.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 23.08625767038761, "episode_reward_min": 2.2511961201411834, "episode_reward_mean": 18.079552657310376, "episode_len_mean": 25.3, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.685683375161382, 4.586887034901676, 21.58599171736786, 2.2511961201411834, 21.852655539095448, 16.764271038617306, 21.02021516621151, 20.95351016769145, 21.085957163896776, 8.18626434313033, 21.520177542074837, 21.853554502369608, 7.566626674726518, 21.719327486254958, 22.385306866654666, 12.485994152953314, 17.386887835703003, 20.816123950222373, 22.119609829180636, 20.98688782181589, 12.76871238946414, 6.620175084247655, 11.819289716632516, 22.019553419111723, 22.61836798137688, 2.830716641576486, 21.953157125292428, 17.219315430158442, 21.45231435700952, 21.553553701572326, 21.520215874868914, 21.765775059028236, 22.086233708879863, 21.1175949464357, 21.286887034901962, 15.286887835702995, 21.853553703341216, 21.48661989516799, 14.88565384915285, 7.653554500540912, 13.186619893942417, 13.335688249459666, 8.652930886584262, 22.618704925177315, 21.28569013779362, 23.08625767038761, 22.120221169036345, 21.35169764807234, 22.286844181471064, 21.45231142907699, 21.252660020595915, 21.553548501322112, 13.986887835703003, 22.153554486681898, 21.669019840250204, 21.020221168823046, 12.752662548330944, 22.120169012168354, 21.885982883722267, 20.920221169036267, 22.053554502369604, 21.88536604329549, 21.41307548351991, 22.019329229805646, 12.117902896025024, 21.25355448848653, 21.818708490105763, 21.420220357949034, 22.152925020780014, 5.652660817791233, 20.98572102875015, 22.21924732511675, 21.053554397103454, 21.586579874738668, 22.053205921559062, 7.06700958158002, 15.719913221722456, 21.620220369980952, 20.099419821532482, 21.686078067977878, 20.353554502128855, 8.685685064486876, 20.986887835671286, 2.7868416574632944, 21.820221063585013, 5.819597643545636, 4.9663621788985965, 22.020221061949236, 21.919907154462646, 20.38658334793075, 21.786887833874253, 13.769329536637033, 22.153244710956944, 20.68688783387458, 21.085982649528322, 22.666350874939404, 21.55355439691471, 16.05203388190713, 21.753510953588936, 3.5202203682350097], "episode_lengths": [30, 7, 30, 4, 30, 23, 30, 30, 30, 13, 30, 30, 10, 30, 30, 18, 23, 30, 30, 30, 18, 10, 18, 30, 30, 4, 30, 24, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 21, 11, 19, 20, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 30, 9, 30, 30, 30, 30, 30, 11, 24, 30, 29, 30, 30, 13, 30, 5, 30, 9, 7, 30, 30, 30, 30, 21, 30, 30, 30, 30, 30, 24, 30, 6]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8997164443100659, "mean_inference_ms": 1.217670322563984, "mean_action_processing_ms": 0.10458189210994412, "mean_env_wait_ms": 29.625631680231034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071332454681396484, "StateBufferConnector_ms": 0.005007505416870117, "ViewRequirementAgentConnector_ms": 0.1168360710144043}}, "episode_reward_max": 23.08625767038761, "episode_reward_min": 2.2511961201411834, "episode_reward_mean": 18.079552657310376, "episode_len_mean": 25.3, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.685683375161382, 4.586887034901676, 21.58599171736786, 2.2511961201411834, 21.852655539095448, 16.764271038617306, 21.02021516621151, 20.95351016769145, 21.085957163896776, 8.18626434313033, 21.520177542074837, 21.853554502369608, 7.566626674726518, 21.719327486254958, 22.385306866654666, 12.485994152953314, 17.386887835703003, 20.816123950222373, 22.119609829180636, 20.98688782181589, 12.76871238946414, 6.620175084247655, 11.819289716632516, 22.019553419111723, 22.61836798137688, 2.830716641576486, 21.953157125292428, 17.219315430158442, 21.45231435700952, 21.553553701572326, 21.520215874868914, 21.765775059028236, 22.086233708879863, 21.1175949464357, 21.286887034901962, 15.286887835702995, 21.853553703341216, 21.48661989516799, 14.88565384915285, 7.653554500540912, 13.186619893942417, 13.335688249459666, 8.652930886584262, 22.618704925177315, 21.28569013779362, 23.08625767038761, 22.120221169036345, 21.35169764807234, 22.286844181471064, 21.45231142907699, 21.252660020595915, 21.553548501322112, 13.986887835703003, 22.153554486681898, 21.669019840250204, 21.020221168823046, 12.752662548330944, 22.120169012168354, 21.885982883722267, 20.920221169036267, 22.053554502369604, 21.88536604329549, 21.41307548351991, 22.019329229805646, 12.117902896025024, 21.25355448848653, 21.818708490105763, 21.420220357949034, 22.152925020780014, 5.652660817791233, 20.98572102875015, 22.21924732511675, 21.053554397103454, 21.586579874738668, 22.053205921559062, 7.06700958158002, 15.719913221722456, 21.620220369980952, 20.099419821532482, 21.686078067977878, 20.353554502128855, 8.685685064486876, 20.986887835671286, 2.7868416574632944, 21.820221063585013, 5.819597643545636, 4.9663621788985965, 22.020221061949236, 21.919907154462646, 20.38658334793075, 21.786887833874253, 13.769329536637033, 22.153244710956944, 20.68688783387458, 21.085982649528322, 22.666350874939404, 21.55355439691471, 16.05203388190713, 21.753510953588936, 3.5202203682350097], "episode_lengths": [30, 7, 30, 4, 30, 23, 30, 30, 30, 13, 30, 30, 10, 30, 30, 18, 23, 30, 30, 30, 18, 10, 18, 30, 30, 4, 30, 24, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 21, 11, 19, 20, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 30, 9, 30, 30, 30, 30, 30, 11, 24, 30, 29, 30, 30, 13, 30, 5, 30, 9, 7, 30, 30, 30, 30, 21, 30, 30, 30, 30, 30, 24, 30, 6]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8997164443100659, "mean_inference_ms": 1.217670322563984, "mean_action_processing_ms": 0.10458189210994412, "mean_env_wait_ms": 29.625631680231034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071332454681396484, "StateBufferConnector_ms": 0.005007505416870117, "ViewRequirementAgentConnector_ms": 0.1168360710144043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.835257049259187, "num_env_steps_trained_throughput_per_sec": 29.835257049259187, "timesteps_total": 12000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 66962.268, "sample_time_ms": 63755.474, "load_time_ms": 9.332, "load_throughput": 214326.798, "learn_time_ms": 3194.736, "learn_throughput": 626.03, "synch_weights_time_ms": 2.265}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 675, "training_iteration": 6, "trial_id": "13850_00001", "date": "2023-12-28_17-54-11", "timestamp": 1703757251, "time_this_iter_s": 67.03965997695923, "time_total_s": 401.80925846099854, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 401.80925846099854, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 55.94375, "ram_util_percent": 92.02187500000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.9791506576538085, "policy_loss": 0.003935893786450227, "vf_loss": 7.97327176200019, "vf_explained_var": 0.0006368048985799154, "kl": 0.005757039169479204, "entropy": 1.149509205288357, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2925.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000}, "sampler_results": {"episode_reward_max": 22.88492983118476, "episode_reward_min": 1.8467961636381087, "episode_reward_mean": 17.913704350348972, "episode_len_mean": 25.02, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.686078067977878, 20.353554502128855, 8.685685064486876, 20.986887835671286, 2.7868416574632944, 21.820221063585013, 5.819597643545636, 4.9663621788985965, 22.020221061949236, 21.919907154462646, 20.38658334793075, 21.786887833874253, 13.769329536637033, 22.153244710956944, 20.68688783387458, 21.085982649528322, 22.666350874939404, 21.55355439691471, 16.05203388190713, 21.753510953588936, 3.5202203682350097, 21.985912768013474, 21.88688783549383, 8.08457483268586, 22.152931009801186, 22.420221065409777, 20.95355448848256, 21.78598592662711, 2.6839204779383774, 22.452264784295767, 17.55173703880332, 16.28569013962209, 21.48657988679703, 20.119610451845983, 20.18658334793494, 22.88492983118476, 3.018357759733349, 21.78657988838496, 21.720221154913926, 21.22022115514923, 21.553246555260735, 22.02022116903634, 18.752943241036046, 16.586887835703003, 21.95172513324715, 21.885366058770163, 21.61928397756676, 22.62021439465098, 21.15266081961999, 22.152900388963555, 21.619327472403523, 11.098213139452733, 7.519597676227016, 21.620215283669367, 22.386583346105706, 21.72022116903634, 21.8859506444724, 21.785292060735387, 22.084795852867025, 21.985689279773933, 22.252941611449835, 21.353554397071953, 21.653554502337954, 6.718817467373585, 21.619913220130705, 22.619585187650024, 22.284446518776015, 18.453246555291962, 22.551744667342366, 21.08657908788027, 21.4868878218159, 21.752937139796106, 3.51675129667567, 21.952930995918038, 2.846334030134951, 20.98684174782977, 21.619289193721247, 22.05265483068973, 20.752322051593342, 1.8467961636381087, 21.386887036646996, 11.053554502369666, 20.92017762025561, 20.81928972830787, 21.984575631714225, 22.386841854777543, 21.98653926856406, 21.45261716536226, 3.1192470104833285, 2.8859479883334056, 22.286887823644644, 20.52017762025977, 20.920221168795507, 1.9796673634682842, 11.786887835703, 8.419283977805728, 2.4654646305180847, 21.0862642378683, 22.020221169036347, 21.353510953593112], "episode_lengths": [30, 30, 13, 30, 5, 30, 9, 7, 30, 30, 30, 30, 21, 30, 30, 30, 30, 30, 24, 30, 6, 30, 30, 12, 30, 30, 30, 30, 4, 30, 26, 24, 30, 29, 29, 30, 5, 30, 30, 30, 30, 30, 27, 23, 30, 30, 30, 30, 30, 30, 30, 16, 11, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30, 30, 26, 30, 30, 30, 30, 5, 30, 4, 30, 30, 30, 30, 3, 30, 16, 30, 30, 30, 30, 30, 30, 5, 5, 30, 30, 30, 3, 17, 13, 4, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8723071477554711, "mean_inference_ms": 1.2170806914685697, "mean_action_processing_ms": 0.10462287502095372, "mean_env_wait_ms": 29.62410433994239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007139682769775391, "StateBufferConnector_ms": 0.0052411556243896484, "ViewRequirementAgentConnector_ms": 0.11550021171569824}}, "episode_reward_max": 22.88492983118476, "episode_reward_min": 1.8467961636381087, "episode_reward_mean": 17.913704350348972, "episode_len_mean": 25.02, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.686078067977878, 20.353554502128855, 8.685685064486876, 20.986887835671286, 2.7868416574632944, 21.820221063585013, 5.819597643545636, 4.9663621788985965, 22.020221061949236, 21.919907154462646, 20.38658334793075, 21.786887833874253, 13.769329536637033, 22.153244710956944, 20.68688783387458, 21.085982649528322, 22.666350874939404, 21.55355439691471, 16.05203388190713, 21.753510953588936, 3.5202203682350097, 21.985912768013474, 21.88688783549383, 8.08457483268586, 22.152931009801186, 22.420221065409777, 20.95355448848256, 21.78598592662711, 2.6839204779383774, 22.452264784295767, 17.55173703880332, 16.28569013962209, 21.48657988679703, 20.119610451845983, 20.18658334793494, 22.88492983118476, 3.018357759733349, 21.78657988838496, 21.720221154913926, 21.22022115514923, 21.553246555260735, 22.02022116903634, 18.752943241036046, 16.586887835703003, 21.95172513324715, 21.885366058770163, 21.61928397756676, 22.62021439465098, 21.15266081961999, 22.152900388963555, 21.619327472403523, 11.098213139452733, 7.519597676227016, 21.620215283669367, 22.386583346105706, 21.72022116903634, 21.8859506444724, 21.785292060735387, 22.084795852867025, 21.985689279773933, 22.252941611449835, 21.353554397071953, 21.653554502337954, 6.718817467373585, 21.619913220130705, 22.619585187650024, 22.284446518776015, 18.453246555291962, 22.551744667342366, 21.08657908788027, 21.4868878218159, 21.752937139796106, 3.51675129667567, 21.952930995918038, 2.846334030134951, 20.98684174782977, 21.619289193721247, 22.05265483068973, 20.752322051593342, 1.8467961636381087, 21.386887036646996, 11.053554502369666, 20.92017762025561, 20.81928972830787, 21.984575631714225, 22.386841854777543, 21.98653926856406, 21.45261716536226, 3.1192470104833285, 2.8859479883334056, 22.286887823644644, 20.52017762025977, 20.920221168795507, 1.9796673634682842, 11.786887835703, 8.419283977805728, 2.4654646305180847, 21.0862642378683, 22.020221169036347, 21.353510953593112], "episode_lengths": [30, 30, 13, 30, 5, 30, 9, 7, 30, 30, 30, 30, 21, 30, 30, 30, 30, 30, 24, 30, 6, 30, 30, 12, 30, 30, 30, 30, 4, 30, 26, 24, 30, 29, 29, 30, 5, 30, 30, 30, 30, 30, 27, 23, 30, 30, 30, 30, 30, 30, 30, 16, 11, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30, 30, 26, 30, 30, 30, 30, 5, 30, 4, 30, 30, 30, 30, 3, 30, 16, 30, 30, 30, 30, 30, 30, 5, 5, 30, 30, 30, 3, 17, 13, 4, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8723071477554711, "mean_inference_ms": 1.2170806914685697, "mean_action_processing_ms": 0.10462287502095372, "mean_env_wait_ms": 29.62410433994239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007139682769775391, "StateBufferConnector_ms": 0.0052411556243896484, "ViewRequirementAgentConnector_ms": 0.11550021171569824}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000, "num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.13171039161513, "num_env_steps_trained_throughput_per_sec": 30.13171039161513, "timesteps_total": 14000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 14000, "timers": {"training_iteration_time_ms": 66878.407, "sample_time_ms": 63676.767, "load_time_ms": 8.758, "load_throughput": 228357.312, "learn_time_ms": 3190.179, "learn_throughput": 626.924, "synch_weights_time_ms": 2.242}, "counters": {"num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000}, "done": false, "episodes_total": 754, "training_iteration": 7, "trial_id": "13850_00001", "date": "2023-12-28_17-55-17", "timestamp": 1703757317, "time_this_iter_s": 66.38016152381897, "time_total_s": 468.1894199848175, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 468.1894199848175, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 56.12872340425531, "ram_util_percent": 92.18829787234048}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.707107203801473, "policy_loss": -0.02829167733589808, "vf_loss": 7.733625138600667, "vf_explained_var": 0.00013351466920640733, "kl": 0.005255491666301048, "entropy": 1.0842132835918004, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3375.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 22.82022116879558, "episode_reward_min": 1.6836014791399823, "episode_reward_mean": 17.897503608409036, "episode_len_mean": 24.86, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.752322051593342, 1.8467961636381087, 21.386887036646996, 11.053554502369666, 20.92017762025561, 20.81928972830787, 21.984575631714225, 22.386841854777543, 21.98653926856406, 21.45261716536226, 3.1192470104833285, 2.8859479883334056, 22.286887823644644, 20.52017762025977, 20.920221168795507, 1.9796673634682842, 11.786887835703, 8.419283977805728, 2.4654646305180847, 21.0862642378683, 22.020221169036347, 21.353510953593112, 22.42022116903633, 22.82022116879558, 3.652035847672696, 21.720177620018966, 21.685994152952773, 21.452351639774463, 13.466089423283062, 21.252897053890827, 22.052577200098426, 22.402622760783558, 22.185955499874783, 22.41959844515997, 22.119554895568204, 21.886887835703007, 5.198753173966275, 21.752617257683585, 21.95262079848998, 22.220175082691437, 20.885638993826213, 21.920177620259782, 8.43510172155558, 22.353553610222978, 2.516355547342015, 11.053553701763628, 22.02022116903634, 3.7859555942251437, 21.720221063581022, 22.08569486092894, 21.852900427380675, 20.986887730436795, 21.65355370175089, 22.05351265180163, 21.35355448848255, 22.086259122024202, 22.284271143946164, 22.051996369180475, 21.985994152953335, 6.118704803709476, 21.88657988862578, 21.620219674428846, 22.020221169008803, 4.2202210635810165, 21.953554502369677, 21.302655131912157, 16.920221155153186, 21.986887730251695, 22.220221077406666, 21.852882258990686, 21.419953317102873, 22.019325839135234, 7.119913221718281, 22.020221169036347, 5.920215166211498, 7.319290484196725, 22.115099631899668, 13.253246555292437, 21.95355439691471, 22.686887835703008, 22.18657382538788, 21.553553691286478, 21.41995253317561, 21.820215180046905, 21.518396970147233, 9.753508326158403, 21.5526165235985, 4.519591595382776, 11.319327486286655, 21.285956397186244, 22.286887835703002, 21.253513682725544, 22.18626511077282, 21.519916681236566, 21.986887835703005, 1.6836014791399823, 21.286887036647013, 21.886887835703, 19.599386074049484, 22.020221169036347], "episode_lengths": [30, 3, 30, 16, 30, 30, 30, 30, 30, 30, 5, 5, 30, 30, 30, 3, 17, 13, 4, 30, 30, 30, 30, 30, 6, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 13, 30, 4, 16, 30, 6, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 9, 30, 30, 30, 7, 30, 30, 24, 30, 30, 30, 30, 30, 11, 30, 9, 11, 30, 19, 30, 30, 30, 30, 30, 30, 30, 15, 30, 7, 17, 30, 30, 30, 30, 30, 30, 3, 30, 30, 28, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8533708439740246, "mean_inference_ms": 1.2173006219323166, "mean_action_processing_ms": 0.10463834018995785, "mean_env_wait_ms": 29.629451474672436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007257699966430664, "StateBufferConnector_ms": 0.005298137664794922, "ViewRequirementAgentConnector_ms": 0.11726641654968262}}, "episode_reward_max": 22.82022116879558, "episode_reward_min": 1.6836014791399823, "episode_reward_mean": 17.897503608409036, "episode_len_mean": 24.86, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.752322051593342, 1.8467961636381087, 21.386887036646996, 11.053554502369666, 20.92017762025561, 20.81928972830787, 21.984575631714225, 22.386841854777543, 21.98653926856406, 21.45261716536226, 3.1192470104833285, 2.8859479883334056, 22.286887823644644, 20.52017762025977, 20.920221168795507, 1.9796673634682842, 11.786887835703, 8.419283977805728, 2.4654646305180847, 21.0862642378683, 22.020221169036347, 21.353510953593112, 22.42022116903633, 22.82022116879558, 3.652035847672696, 21.720177620018966, 21.685994152952773, 21.452351639774463, 13.466089423283062, 21.252897053890827, 22.052577200098426, 22.402622760783558, 22.185955499874783, 22.41959844515997, 22.119554895568204, 21.886887835703007, 5.198753173966275, 21.752617257683585, 21.95262079848998, 22.220175082691437, 20.885638993826213, 21.920177620259782, 8.43510172155558, 22.353553610222978, 2.516355547342015, 11.053553701763628, 22.02022116903634, 3.7859555942251437, 21.720221063581022, 22.08569486092894, 21.852900427380675, 20.986887730436795, 21.65355370175089, 22.05351265180163, 21.35355448848255, 22.086259122024202, 22.284271143946164, 22.051996369180475, 21.985994152953335, 6.118704803709476, 21.88657988862578, 21.620219674428846, 22.020221169008803, 4.2202210635810165, 21.953554502369677, 21.302655131912157, 16.920221155153186, 21.986887730251695, 22.220221077406666, 21.852882258990686, 21.419953317102873, 22.019325839135234, 7.119913221718281, 22.020221169036347, 5.920215166211498, 7.319290484196725, 22.115099631899668, 13.253246555292437, 21.95355439691471, 22.686887835703008, 22.18657382538788, 21.553553691286478, 21.41995253317561, 21.820215180046905, 21.518396970147233, 9.753508326158403, 21.5526165235985, 4.519591595382776, 11.319327486286655, 21.285956397186244, 22.286887835703002, 21.253513682725544, 22.18626511077282, 21.519916681236566, 21.986887835703005, 1.6836014791399823, 21.286887036647013, 21.886887835703, 19.599386074049484, 22.020221169036347], "episode_lengths": [30, 3, 30, 16, 30, 30, 30, 30, 30, 30, 5, 5, 30, 30, 30, 3, 17, 13, 4, 30, 30, 30, 30, 30, 6, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 13, 30, 4, 16, 30, 6, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 9, 30, 30, 30, 7, 30, 30, 24, 30, 30, 30, 30, 30, 11, 30, 9, 11, 30, 19, 30, 30, 30, 30, 30, 30, 30, 15, 30, 7, 17, 30, 30, 30, 30, 30, 30, 3, 30, 30, 28, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8533708439740246, "mean_inference_ms": 1.2173006219323166, "mean_action_processing_ms": 0.10463834018995785, "mean_env_wait_ms": 29.629451474672436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007257699966430664, "StateBufferConnector_ms": 0.005298137664794922, "ViewRequirementAgentConnector_ms": 0.11726641654968262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.96826655614127, "num_env_steps_trained_throughput_per_sec": 29.96826655614127, "timesteps_total": 16000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 66860.761, "sample_time_ms": 63662.831, "load_time_ms": 8.316, "load_throughput": 240511.149, "learn_time_ms": 3186.944, "learn_throughput": 627.56, "synch_weights_time_ms": 2.214}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 832, "training_iteration": 8, "trial_id": "13850_00001", "date": "2023-12-28_17-56-24", "timestamp": 1703757384, "time_this_iter_s": 66.74205613136292, "time_total_s": 534.9314761161804, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 534.9314761161804, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 55.97578947368423, "ram_util_percent": 92.20421052631582}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.694925391938951, "policy_loss": 0.006396683454513549, "vf_loss": 7.686529507107205, "vf_explained_var": 0.00011157049073113336, "kl": 0.005923609355391414, "entropy": 0.9874806612067752, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3825.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "sampler_results": {"episode_reward_max": 22.819865328200144, "episode_reward_min": 1.6836014791399823, "episode_reward_mean": 18.53357077403824, "episode_len_mean": 25.72, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.95355439691471, 22.686887835703008, 22.18657382538788, 21.553553691286478, 21.41995253317561, 21.820215180046905, 21.518396970147233, 9.753508326158403, 21.5526165235985, 4.519591595382776, 11.319327486286655, 21.285956397186244, 22.286887835703002, 21.253513682725544, 22.18626511077282, 21.519916681236566, 21.986887835703005, 1.6836014791399823, 21.286887036647013, 21.886887835703, 19.599386074049484, 22.020221169036347, 21.952931009801112, 5.986887730247683, 21.953554502369677, 21.486844286926434, 22.169285292540653, 21.886881846713575, 22.252652561651683, 22.15355450236968, 21.719327486254958, 21.919321497356396, 21.720177620259772, 22.15355450236968, 2.5993780516752842, 22.020221169036347, 21.81959767646784, 21.286887036678163, 21.92017751504533, 21.65355450233797, 9.719597676467291, 6.319913221718281, 21.952660819588292, 22.08688782364048, 11.901769187246874, 20.920220368235366, 22.152931009801186, 13.620215089721727, 22.252887447309668, 21.853553703345394, 20.619907246465758, 8.26932953666267, 16.552358304633596, 21.72021508972175, 13.486275858280962, 21.353206878638535, 22.819865328200144, 21.320220368386064, 5.11646488649888, 21.953554488482574, 7.252660817791233, 21.886844286926447, 21.22021516621549, 21.82021596692946, 21.420215166215474, 1.765378591649179, 3.65292492871611, 22.353554397124764, 21.720221168795536, 22.253548513402084, 22.252352770577474, 21.252660714164673, 4.352660018818868, 21.752617243796685, 21.653554397103466, 22.552931778494106, 1.7327113850086178, 21.420221063581035, 7.519554893743848, 17.319597676479294, 22.18394959981391, 22.020221169036347, 22.020221169036347, 14.886887835703003, 21.38657391130416, 22.020221169036347, 20.120177620259774, 21.88568847922639, 22.020221169036347, 19.186265111009458, 21.365383029705374, 21.386887833874262, 22.253548526798443, 22.120175785635315, 2.2526146550000723, 21.6202211690358, 21.82022106376959, 20.420221167207927, 21.452662549046497, 21.852660819615824], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 15, 30, 7, 17, 30, 30, 30, 30, 30, 30, 3, 30, 30, 28, 30, 30, 9, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 4, 30, 30, 30, 30, 30, 14, 10, 30, 30, 17, 30, 30, 20, 30, 30, 30, 12, 23, 30, 20, 30, 30, 30, 7, 30, 11, 30, 30, 30, 30, 3, 6, 30, 30, 30, 30, 30, 7, 30, 30, 30, 3, 30, 11, 24, 30, 30, 30, 21, 30, 30, 30, 30, 30, 27, 29, 30, 30, 30, 4, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8376656875062216, "mean_inference_ms": 1.2164543405463664, "mean_action_processing_ms": 0.10457639389416366, "mean_env_wait_ms": 29.619056382413337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007028102874755859, "StateBufferConnector_ms": 0.0050373077392578125, "ViewRequirementAgentConnector_ms": 0.11485719680786133}}, "episode_reward_max": 22.819865328200144, "episode_reward_min": 1.6836014791399823, "episode_reward_mean": 18.53357077403824, "episode_len_mean": 25.72, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.95355439691471, 22.686887835703008, 22.18657382538788, 21.553553691286478, 21.41995253317561, 21.820215180046905, 21.518396970147233, 9.753508326158403, 21.5526165235985, 4.519591595382776, 11.319327486286655, 21.285956397186244, 22.286887835703002, 21.253513682725544, 22.18626511077282, 21.519916681236566, 21.986887835703005, 1.6836014791399823, 21.286887036647013, 21.886887835703, 19.599386074049484, 22.020221169036347, 21.952931009801112, 5.986887730247683, 21.953554502369677, 21.486844286926434, 22.169285292540653, 21.886881846713575, 22.252652561651683, 22.15355450236968, 21.719327486254958, 21.919321497356396, 21.720177620259772, 22.15355450236968, 2.5993780516752842, 22.020221169036347, 21.81959767646784, 21.286887036678163, 21.92017751504533, 21.65355450233797, 9.719597676467291, 6.319913221718281, 21.952660819588292, 22.08688782364048, 11.901769187246874, 20.920220368235366, 22.152931009801186, 13.620215089721727, 22.252887447309668, 21.853553703345394, 20.619907246465758, 8.26932953666267, 16.552358304633596, 21.72021508972175, 13.486275858280962, 21.353206878638535, 22.819865328200144, 21.320220368386064, 5.11646488649888, 21.953554488482574, 7.252660817791233, 21.886844286926447, 21.22021516621549, 21.82021596692946, 21.420215166215474, 1.765378591649179, 3.65292492871611, 22.353554397124764, 21.720221168795536, 22.253548513402084, 22.252352770577474, 21.252660714164673, 4.352660018818868, 21.752617243796685, 21.653554397103466, 22.552931778494106, 1.7327113850086178, 21.420221063581035, 7.519554893743848, 17.319597676479294, 22.18394959981391, 22.020221169036347, 22.020221169036347, 14.886887835703003, 21.38657391130416, 22.020221169036347, 20.120177620259774, 21.88568847922639, 22.020221169036347, 19.186265111009458, 21.365383029705374, 21.386887833874262, 22.253548526798443, 22.120175785635315, 2.2526146550000723, 21.6202211690358, 21.82022106376959, 20.420221167207927, 21.452662549046497, 21.852660819615824], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 15, 30, 7, 17, 30, 30, 30, 30, 30, 30, 3, 30, 30, 28, 30, 30, 9, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 4, 30, 30, 30, 30, 30, 14, 10, 30, 30, 17, 30, 30, 20, 30, 30, 30, 12, 23, 30, 20, 30, 30, 30, 7, 30, 11, 30, 30, 30, 30, 3, 6, 30, 30, 30, 30, 30, 7, 30, 30, 30, 3, 30, 11, 24, 30, 30, 30, 21, 30, 30, 30, 30, 30, 27, 29, 30, 30, 30, 4, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8376656875062216, "mean_inference_ms": 1.2164543405463664, "mean_action_processing_ms": 0.10457639389416366, "mean_env_wait_ms": 29.619056382413337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007028102874755859, "StateBufferConnector_ms": 0.0050373077392578125, "ViewRequirementAgentConnector_ms": 0.11485719680786133}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.176928306613817, "num_env_steps_trained_throughput_per_sec": 30.176928306613817, "timesteps_total": 18000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 66795.762, "sample_time_ms": 63596.815, "load_time_ms": 9.505, "load_throughput": 210411.897, "learn_time_ms": 3186.77, "learn_throughput": 627.595, "synch_weights_time_ms": 2.217}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "done": false, "episodes_total": 910, "training_iteration": 9, "trial_id": "13850_00001", "date": "2023-12-28_17-57-30", "timestamp": 1703757450, "time_this_iter_s": 66.28122234344482, "time_total_s": 601.2126984596252, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 601.2126984596252, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 56.08297872340426, "ram_util_percent": 92.2436170212766}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.249238431718615, "policy_loss": -0.02953924665848414, "vf_loss": 7.2760178322262234, "vf_explained_var": -1.5614695019192165e-05, "kl": 0.008177345639572498, "entropy": 0.8792404891384973, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 4275.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 22.620220263024976, "episode_reward_min": 1.7327113850086178, "episode_reward_mean": 19.656246708967718, "episode_len_mean": 27.21, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.352660018818868, 21.752617243796685, 21.653554397103466, 22.552931778494106, 1.7327113850086178, 21.420221063581035, 7.519554893743848, 17.319597676479294, 22.18394959981391, 22.020221169036347, 22.020221169036347, 14.886887835703003, 21.38657391130416, 22.020221169036347, 20.120177620259774, 21.88568847922639, 22.020221169036347, 19.186265111009458, 21.365383029705374, 21.386887833874262, 22.253548526798443, 22.120175785635315, 2.2526146550000723, 21.6202211690358, 21.82022106376959, 20.420221167207927, 21.452662549046497, 21.852660819615824, 22.08506363342509, 21.78688184671357, 8.552931778252471, 22.08559811765657, 22.020221169036347, 21.88657988862578, 21.886881846713575, 20.98688783546218, 22.020221169036347, 10.486887835702992, 21.919597674639093, 21.886264329251375, 21.885993353929255, 22.218699398845658, 3.7528848315615564, 22.01932921499762, 10.152887459127482, 21.85354842305507, 21.720221168795536, 21.752661847061823, 21.81932748628666, 7.55293100976946, 21.45355450236549, 22.15351084837866, 21.753510939710175, 21.52022106377012, 22.020221169036347, 21.686579886797375, 21.653554502369676, 13.12022037001205, 15.286881846713564, 21.32021517980608, 22.15355450236968, 21.553548513139432, 22.05324655529245, 22.620220263024976, 22.085988495156677, 21.919022613107266, 21.286881846713573, 20.986881756741845, 8.520215888511771, 21.75266081961999, 20.98688783546219, 21.753554502369667, 21.453554502369677, 21.886881846713575, 19.420220277194755, 21.4535543970993, 21.886844286926447, 21.720221063581032, 22.019597676467832, 21.65354849954882, 21.453554396914345, 21.78688782181987, 21.819907336595804, 22.15355450236968, 22.01955412762264, 21.986887835671304, 21.985994152953335, 21.920221169036342, 22.286887140357003, 22.085994152953333, 21.853554502369672, 21.818706403930356, 2.4660439435714916, 22.053245074468602, 21.71991311650401, 21.819327486254952, 20.953510953593106, 21.820221063770134, 15.253554488486529, 20.32022116903633], "episode_lengths": [7, 30, 30, 30, 3, 30, 11, 24, 30, 30, 30, 21, 30, 30, 30, 30, 30, 27, 29, 30, 30, 30, 4, 30, 30, 30, 30, 30, 30, 30, 12, 30, 30, 30, 30, 30, 30, 15, 30, 30, 30, 30, 6, 30, 15, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 30, 29, 19, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 27, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 4, 30, 30, 30, 30, 30, 22, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8238710290943433, "mean_inference_ms": 1.2161367685664632, "mean_action_processing_ms": 0.10453818054064173, "mean_env_wait_ms": 29.598710677982535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007052183151245117, "StateBufferConnector_ms": 0.0048635005950927734, "ViewRequirementAgentConnector_ms": 0.11471295356750488}}, "episode_reward_max": 22.620220263024976, "episode_reward_min": 1.7327113850086178, "episode_reward_mean": 19.656246708967718, "episode_len_mean": 27.21, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.352660018818868, 21.752617243796685, 21.653554397103466, 22.552931778494106, 1.7327113850086178, 21.420221063581035, 7.519554893743848, 17.319597676479294, 22.18394959981391, 22.020221169036347, 22.020221169036347, 14.886887835703003, 21.38657391130416, 22.020221169036347, 20.120177620259774, 21.88568847922639, 22.020221169036347, 19.186265111009458, 21.365383029705374, 21.386887833874262, 22.253548526798443, 22.120175785635315, 2.2526146550000723, 21.6202211690358, 21.82022106376959, 20.420221167207927, 21.452662549046497, 21.852660819615824, 22.08506363342509, 21.78688184671357, 8.552931778252471, 22.08559811765657, 22.020221169036347, 21.88657988862578, 21.886881846713575, 20.98688783546218, 22.020221169036347, 10.486887835702992, 21.919597674639093, 21.886264329251375, 21.885993353929255, 22.218699398845658, 3.7528848315615564, 22.01932921499762, 10.152887459127482, 21.85354842305507, 21.720221168795536, 21.752661847061823, 21.81932748628666, 7.55293100976946, 21.45355450236549, 22.15351084837866, 21.753510939710175, 21.52022106377012, 22.020221169036347, 21.686579886797375, 21.653554502369676, 13.12022037001205, 15.286881846713564, 21.32021517980608, 22.15355450236968, 21.553548513139432, 22.05324655529245, 22.620220263024976, 22.085988495156677, 21.919022613107266, 21.286881846713573, 20.986881756741845, 8.520215888511771, 21.75266081961999, 20.98688783546219, 21.753554502369667, 21.453554502369677, 21.886881846713575, 19.420220277194755, 21.4535543970993, 21.886844286926447, 21.720221063581032, 22.019597676467832, 21.65354849954882, 21.453554396914345, 21.78688782181987, 21.819907336595804, 22.15355450236968, 22.01955412762264, 21.986887835671304, 21.985994152953335, 21.920221169036342, 22.286887140357003, 22.085994152953333, 21.853554502369672, 21.818706403930356, 2.4660439435714916, 22.053245074468602, 21.71991311650401, 21.819327486254952, 20.953510953593106, 21.820221063770134, 15.253554488486529, 20.32022116903633], "episode_lengths": [7, 30, 30, 30, 3, 30, 11, 24, 30, 30, 30, 21, 30, 30, 30, 30, 30, 27, 29, 30, 30, 30, 4, 30, 30, 30, 30, 30, 30, 30, 12, 30, 30, 30, 30, 30, 30, 15, 30, 30, 30, 30, 6, 30, 15, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 30, 29, 19, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 27, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 4, 30, 30, 30, 30, 30, 22, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8238710290943433, "mean_inference_ms": 1.2161367685664632, "mean_action_processing_ms": 0.10453818054064173, "mean_env_wait_ms": 29.598710677982535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007052183151245117, "StateBufferConnector_ms": 0.0048635005950927734, "ViewRequirementAgentConnector_ms": 0.11471295356750488}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.26378132840982, "num_env_steps_trained_throughput_per_sec": 30.26378132840982, "timesteps_total": 20000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 66724.743, "sample_time_ms": 63520.523, "load_time_ms": 9.482, "load_throughput": 210925.915, "learn_time_ms": 3192.05, "learn_throughput": 626.557, "synch_weights_time_ms": 2.234}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 982, "training_iteration": 10, "trial_id": "13850_00001", "date": "2023-12-28_17-58-36", "timestamp": 1703757516, "time_this_iter_s": 66.09066152572632, "time_total_s": 667.3033599853516, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 667.3033599853516, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 55.703191489361686, "ram_util_percent": 92.48404255319154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.036972351074219, "policy_loss": 0.0013659614986843533, "vf_loss": 7.032651969061957, "vf_explained_var": -0.0001054076353708903, "kl": 0.0087537097004588, "entropy": 0.7802147132820553, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 22000, "num_env_steps_trained": 22000, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 22000}, "sampler_results": {"episode_reward_max": 22.41790896481091, "episode_reward_min": 2.4660439435714916, "episode_reward_mean": 20.801385668373687, "episode_len_mean": 28.88, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.98688783546219, 21.753554502369667, 21.453554502369677, 21.886881846713575, 19.420220277194755, 21.4535543970993, 21.886844286926447, 21.720221063581032, 22.019597676467832, 21.65354849954882, 21.453554396914345, 21.78688782181987, 21.819907336595804, 22.15355450236968, 22.01955412762264, 21.986887835671304, 21.985994152953335, 21.920221169036342, 22.286887140357003, 22.085994152953333, 21.853554502369672, 21.818706403930356, 2.4660439435714916, 22.053245074468602, 21.71991311650401, 21.819327486254952, 20.953510953593106, 21.820221063770134, 15.253554488486529, 20.32022116903633, 21.720220370012054, 21.686887730405214, 22.15355450236968, 21.852654830676855, 21.686573820938385, 21.220177515013816, 21.6202211690358, 21.985994152953335, 20.953510848378656, 21.220221155149538, 21.653554502369616, 21.386887730248034, 20.086887835703003, 21.986887835703012, 22.28626511101364, 22.020221169036347, 21.15351095359303, 20.2202151782187, 22.30000262946315, 22.286887835703006, 20.08688773040529, 21.752660817791593, 21.602662856112765, 21.68684428692643, 21.920177620259782, 21.819907246260573, 22.36898788857621, 21.720221063770136, 21.153510953593106, 10.719557579312644, 21.286887835703002, 21.753554500541274, 21.986886931275468, 22.020221169036347, 21.653510953593095, 20.820182220250057, 21.586887835702942, 20.985994152953314, 17.80266286999656, 21.75266080573686, 22.020221169036347, 21.48688783567128, 20.75203271154972, 21.45351095359311, 22.252264784323316, 20.45355450236966, 21.920177620259782, 22.020221169036347, 21.153553703345384, 21.58684956736387, 11.319326685489514, 21.853554502369672, 20.78688783570301, 22.020221169036347, 21.85354842305506, 21.786887835703002, 21.120221077624926, 21.785949858677736, 21.585994152949144, 15.320220370012052, 5.020221063581016, 21.553554408972722, 13.986887835703003, 22.020221169036347, 21.386264343133956, 22.41790896481091, 21.820221063770134, 21.753554500541274, 21.920177620259782, 21.952660020596007], "episode_lengths": [30, 30, 30, 30, 27, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 4, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 22, 8, 30, 20, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8108210233672009, "mean_inference_ms": 1.216782545616746, "mean_action_processing_ms": 0.10459004179528072, "mean_env_wait_ms": 29.60240476745087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007024049758911133, "StateBufferConnector_ms": 0.004890918731689453, "ViewRequirementAgentConnector_ms": 0.11567091941833496}}, "episode_reward_max": 22.41790896481091, "episode_reward_min": 2.4660439435714916, "episode_reward_mean": 20.801385668373687, "episode_len_mean": 28.88, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.98688783546219, 21.753554502369667, 21.453554502369677, 21.886881846713575, 19.420220277194755, 21.4535543970993, 21.886844286926447, 21.720221063581032, 22.019597676467832, 21.65354849954882, 21.453554396914345, 21.78688782181987, 21.819907336595804, 22.15355450236968, 22.01955412762264, 21.986887835671304, 21.985994152953335, 21.920221169036342, 22.286887140357003, 22.085994152953333, 21.853554502369672, 21.818706403930356, 2.4660439435714916, 22.053245074468602, 21.71991311650401, 21.819327486254952, 20.953510953593106, 21.820221063770134, 15.253554488486529, 20.32022116903633, 21.720220370012054, 21.686887730405214, 22.15355450236968, 21.852654830676855, 21.686573820938385, 21.220177515013816, 21.6202211690358, 21.985994152953335, 20.953510848378656, 21.220221155149538, 21.653554502369616, 21.386887730248034, 20.086887835703003, 21.986887835703012, 22.28626511101364, 22.020221169036347, 21.15351095359303, 20.2202151782187, 22.30000262946315, 22.286887835703006, 20.08688773040529, 21.752660817791593, 21.602662856112765, 21.68684428692643, 21.920177620259782, 21.819907246260573, 22.36898788857621, 21.720221063770136, 21.153510953593106, 10.719557579312644, 21.286887835703002, 21.753554500541274, 21.986886931275468, 22.020221169036347, 21.653510953593095, 20.820182220250057, 21.586887835702942, 20.985994152953314, 17.80266286999656, 21.75266080573686, 22.020221169036347, 21.48688783567128, 20.75203271154972, 21.45351095359311, 22.252264784323316, 20.45355450236966, 21.920177620259782, 22.020221169036347, 21.153553703345384, 21.58684956736387, 11.319326685489514, 21.853554502369672, 20.78688783570301, 22.020221169036347, 21.85354842305506, 21.786887835703002, 21.120221077624926, 21.785949858677736, 21.585994152949144, 15.320220370012052, 5.020221063581016, 21.553554408972722, 13.986887835703003, 22.020221169036347, 21.386264343133956, 22.41790896481091, 21.820221063770134, 21.753554500541274, 21.920177620259782, 21.952660020596007], "episode_lengths": [30, 30, 30, 30, 27, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 4, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 22, 8, 30, 20, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8108210233672009, "mean_inference_ms": 1.216782545616746, "mean_action_processing_ms": 0.10459004179528072, "mean_env_wait_ms": 29.60240476745087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007024049758911133, "StateBufferConnector_ms": 0.004890918731689453, "ViewRequirementAgentConnector_ms": 0.11567091941833496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 22000, "num_env_steps_sampled": 22000, "num_env_steps_trained": 22000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.94910762983404, "num_env_steps_trained_throughput_per_sec": 29.94910762983404, "timesteps_total": 22000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 22000, "timers": {"training_iteration_time_ms": 66637.53, "sample_time_ms": 63439.986, "load_time_ms": 9.485, "load_throughput": 210856.461, "learn_time_ms": 3185.434, "learn_throughput": 627.858, "synch_weights_time_ms": 2.191}, "counters": {"num_env_steps_sampled": 22000, "num_env_steps_trained": 22000, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 22000}, "done": false, "episodes_total": 1052, "training_iteration": 11, "trial_id": "13850_00001", "date": "2023-12-28_17-59-43", "timestamp": 1703757583, "time_this_iter_s": 66.78441977500916, "time_total_s": 734.0877797603607, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 734.0877797603607, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 55.88958333333333, "ram_util_percent": 92.68541666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.567392199834188, "policy_loss": -0.029617257598373626, "vf_loss": 6.595689798990885, "vf_explained_var": -8.446627193027073e-05, "kl": 0.003910103079144089, "entropy": 0.7020144731468625, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 5175.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 22.41790896481091, "episode_reward_min": 3.183601479139982, "episode_reward_mean": 19.945451340700057, "episode_len_mean": 27.89, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.75203271154972, 21.45351095359311, 22.252264784323316, 20.45355450236966, 21.920177620259782, 22.020221169036347, 21.153553703345384, 21.58684956736387, 11.319326685489514, 21.853554502369672, 20.78688783570301, 22.020221169036347, 21.85354842305506, 21.786887835703002, 21.120221077624926, 21.785949858677736, 21.585994152949144, 15.320220370012052, 5.020221063581016, 21.553554408972722, 13.986887835703003, 22.020221169036347, 21.386264343133956, 22.41790896481091, 21.820221063770134, 21.753554500541274, 21.920177620259782, 21.952660020596007, 3.9868416574632946, 21.28626511101362, 22.02022116903634, 20.68688783567128, 21.985994152953328, 20.820221063770113, 21.820176834595372, 20.95355450236911, 21.520221169036347, 21.353554502337943, 20.720221169036336, 20.35355450236966, 21.020221169035793, 21.519913221954923, 18.520221168795526, 21.719329320820332, 21.853554488485994, 21.35355450236912, 20.820221169036326, 21.853554502128855, 22.020221169036347, 7.119913116661579, 21.920221169036342, 22.020221169036347, 21.95324655529245, 21.820221169036337, 22.15355450236968, 3.183601479139982, 21.753246450026435, 21.153554502369666, 21.286844286926446, 21.920221169036342, 20.953554502369602, 21.78688782181987, 20.986887821819785, 21.020221168795523, 21.886881846713575, 21.95355450212886, 21.985994152953335, 21.186887730432602, 21.120221169036338, 21.985994152953335, 15.820221169036273, 21.486887835703012, 22.153554410801476, 21.086887730436786, 12.902662869996552, 22.120221167207603, 22.020221169036347, 21.020221169036326, 21.753554500541274, 21.720221168795536, 21.686887835702453, 21.953509563058148, 21.119022777609416, 12.920221169036322, 13.920221169036324, 22.020221169036347, 21.720221168795536, 22.319597582377483, 20.82017508266024, 21.320175070650865, 6.520221167207579, 21.820221169036337, 21.520177620259776, 21.850320477060205, 21.45266080552774, 21.82022116903634, 9.952660819619915, 21.086844286894724, 10.65355370156869, 21.78626434310281], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 22, 8, 30, 20, 30, 30, 30, 30, 30, 30, 30, 6, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 27, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 24, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 20, 20, 30, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 15, 30, 16, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7998525241083795, "mean_inference_ms": 1.2177115919128652, "mean_action_processing_ms": 0.10465569976876839, "mean_env_wait_ms": 29.6189225204289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070340633392333984, "StateBufferConnector_ms": 0.004912137985229492, "ViewRequirementAgentConnector_ms": 0.1157681941986084}}, "episode_reward_max": 22.41790896481091, "episode_reward_min": 3.183601479139982, "episode_reward_mean": 19.945451340700057, "episode_len_mean": 27.89, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.75203271154972, 21.45351095359311, 22.252264784323316, 20.45355450236966, 21.920177620259782, 22.020221169036347, 21.153553703345384, 21.58684956736387, 11.319326685489514, 21.853554502369672, 20.78688783570301, 22.020221169036347, 21.85354842305506, 21.786887835703002, 21.120221077624926, 21.785949858677736, 21.585994152949144, 15.320220370012052, 5.020221063581016, 21.553554408972722, 13.986887835703003, 22.020221169036347, 21.386264343133956, 22.41790896481091, 21.820221063770134, 21.753554500541274, 21.920177620259782, 21.952660020596007, 3.9868416574632946, 21.28626511101362, 22.02022116903634, 20.68688783567128, 21.985994152953328, 20.820221063770113, 21.820176834595372, 20.95355450236911, 21.520221169036347, 21.353554502337943, 20.720221169036336, 20.35355450236966, 21.020221169035793, 21.519913221954923, 18.520221168795526, 21.719329320820332, 21.853554488485994, 21.35355450236912, 20.820221169036326, 21.853554502128855, 22.020221169036347, 7.119913116661579, 21.920221169036342, 22.020221169036347, 21.95324655529245, 21.820221169036337, 22.15355450236968, 3.183601479139982, 21.753246450026435, 21.153554502369666, 21.286844286926446, 21.920221169036342, 20.953554502369602, 21.78688782181987, 20.986887821819785, 21.020221168795523, 21.886881846713575, 21.95355450212886, 21.985994152953335, 21.186887730432602, 21.120221169036338, 21.985994152953335, 15.820221169036273, 21.486887835703012, 22.153554410801476, 21.086887730436786, 12.902662869996552, 22.120221167207603, 22.020221169036347, 21.020221169036326, 21.753554500541274, 21.720221168795536, 21.686887835702453, 21.953509563058148, 21.119022777609416, 12.920221169036322, 13.920221169036324, 22.020221169036347, 21.720221168795536, 22.319597582377483, 20.82017508266024, 21.320175070650865, 6.520221167207579, 21.820221169036337, 21.520177620259776, 21.850320477060205, 21.45266080552774, 21.82022116903634, 9.952660819619915, 21.086844286894724, 10.65355370156869, 21.78626434310281], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 22, 8, 30, 20, 30, 30, 30, 30, 30, 30, 30, 6, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 27, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 24, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 20, 20, 30, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 15, 30, 16, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7998525241083795, "mean_inference_ms": 1.2177115919128652, "mean_action_processing_ms": 0.10465569976876839, "mean_env_wait_ms": 29.6189225204289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070340633392333984, "StateBufferConnector_ms": 0.004912137985229492, "ViewRequirementAgentConnector_ms": 0.1157681941986084}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.896614145565607, "num_env_steps_trained_throughput_per_sec": 29.896614145565607, "timesteps_total": 24000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 66680.029, "sample_time_ms": 63480.574, "load_time_ms": 8.735, "load_throughput": 228973.597, "learn_time_ms": 3188.107, "learn_throughput": 627.332, "synch_weights_time_ms": 2.179}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 1124, "training_iteration": 12, "trial_id": "13850_00001", "date": "2023-12-28_18-00-50", "timestamp": 1703757650, "time_this_iter_s": 66.90203881263733, "time_total_s": 800.989818572998, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 800.989818572998, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 56.0, "ram_util_percent": 92.7515789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.89184232711792, "policy_loss": -0.019321363187498518, "vf_loss": 5.910570060941908, "vf_explained_var": -2.333521842956543e-05, "kl": 0.0035176234114763874, "entropy": 0.6298878513442145, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 5625.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 26000, "num_env_steps_trained": 26000, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 26000}, "sampler_results": {"episode_reward_max": 22.319597582377483, "episode_reward_min": 5.119597571012521, "episode_reward_mean": 19.84620778517012, "episode_len_mean": 27.81, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.486887835703012, 22.153554410801476, 21.086887730436786, 12.902662869996552, 22.120221167207603, 22.020221169036347, 21.020221169036326, 21.753554500541274, 21.720221168795536, 21.686887835702453, 21.953509563058148, 21.119022777609416, 12.920221169036322, 13.920221169036324, 22.020221169036347, 21.720221168795536, 22.319597582377483, 20.82017508266024, 21.320175070650865, 6.520221167207579, 21.820221169036337, 21.520177620259776, 21.850320477060205, 21.45266080552774, 21.82022116903634, 9.952660819619915, 21.086844286894724, 10.65355370156869, 21.78626434310281, 22.020221169036347, 20.953246555292427, 21.920221167207597, 21.752931009797013, 21.45351095359311, 22.020221169036347, 21.520221155149553, 16.886887835702996, 6.053554502128845, 21.55293100980117, 22.152931009801186, 20.785931990238705, 21.886887833874603, 21.05355450236966, 14.353554502369125, 21.786881846686025, 22.253507630561, 21.220221169004635, 20.553554502369604, 22.020221169036347, 22.020221169036347, 22.020221169036347, 14.253553703345379, 22.020221169036347, 20.153554410801462, 20.320221169035776, 21.152931009801165, 21.053554397103458, 20.55355450233795, 21.720221169036332, 21.020221169036326, 22.15355450236968, 21.18688782181987, 20.486887835702994, 21.920215881973817, 21.48626434313451, 21.120221168795528, 6.8535544884825494, 20.286887835703, 22.020221169036347, 20.985994152953314, 21.553553703104782, 22.020221169036347, 21.986887835703012, 6.686887835671289, 21.920221169036342, 7.419913221958554, 21.620221169036327, 21.020221169035793, 21.186887835703, 21.5868878356713, 21.985994152953335, 21.420221169036342, 21.153554502128863, 21.68684428692638, 22.15355450236968, 22.020221169036347, 21.95324655529245, 21.720221168795536, 22.020221169036347, 5.119597571012521, 21.61991322195911, 22.086887140357, 20.953554502369666, 21.020221155153195, 20.319597676467843, 22.153250014601607, 21.9862583541451, 21.986887835703012, 21.853554500541204, 8.886887835702451], "episode_lengths": [30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 20, 20, 30, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 15, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 25, 10, 30, 30, 30, 30, 30, 21, 30, 30, 30, 30, 30, 30, 30, 21, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 30, 11, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7916161440375831, "mean_inference_ms": 1.2188555901041505, "mean_action_processing_ms": 0.10472971240235417, "mean_env_wait_ms": 29.64359006844661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007068157196044922, "StateBufferConnector_ms": 0.00477910041809082, "ViewRequirementAgentConnector_ms": 0.11771798133850098}}, "episode_reward_max": 22.319597582377483, "episode_reward_min": 5.119597571012521, "episode_reward_mean": 19.84620778517012, "episode_len_mean": 27.81, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.486887835703012, 22.153554410801476, 21.086887730436786, 12.902662869996552, 22.120221167207603, 22.020221169036347, 21.020221169036326, 21.753554500541274, 21.720221168795536, 21.686887835702453, 21.953509563058148, 21.119022777609416, 12.920221169036322, 13.920221169036324, 22.020221169036347, 21.720221168795536, 22.319597582377483, 20.82017508266024, 21.320175070650865, 6.520221167207579, 21.820221169036337, 21.520177620259776, 21.850320477060205, 21.45266080552774, 21.82022116903634, 9.952660819619915, 21.086844286894724, 10.65355370156869, 21.78626434310281, 22.020221169036347, 20.953246555292427, 21.920221167207597, 21.752931009797013, 21.45351095359311, 22.020221169036347, 21.520221155149553, 16.886887835702996, 6.053554502128845, 21.55293100980117, 22.152931009801186, 20.785931990238705, 21.886887833874603, 21.05355450236966, 14.353554502369125, 21.786881846686025, 22.253507630561, 21.220221169004635, 20.553554502369604, 22.020221169036347, 22.020221169036347, 22.020221169036347, 14.253553703345379, 22.020221169036347, 20.153554410801462, 20.320221169035776, 21.152931009801165, 21.053554397103458, 20.55355450233795, 21.720221169036332, 21.020221169036326, 22.15355450236968, 21.18688782181987, 20.486887835702994, 21.920215881973817, 21.48626434313451, 21.120221168795528, 6.8535544884825494, 20.286887835703, 22.020221169036347, 20.985994152953314, 21.553553703104782, 22.020221169036347, 21.986887835703012, 6.686887835671289, 21.920221169036342, 7.419913221958554, 21.620221169036327, 21.020221169035793, 21.186887835703, 21.5868878356713, 21.985994152953335, 21.420221169036342, 21.153554502128863, 21.68684428692638, 22.15355450236968, 22.020221169036347, 21.95324655529245, 21.720221168795536, 22.020221169036347, 5.119597571012521, 21.61991322195911, 22.086887140357, 20.953554502369666, 21.020221155153195, 20.319597676467843, 22.153250014601607, 21.9862583541451, 21.986887835703012, 21.853554500541204, 8.886887835702451], "episode_lengths": [30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 20, 20, 30, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 15, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 25, 10, 30, 30, 30, 30, 30, 21, 30, 30, 30, 30, 30, 30, 30, 21, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 30, 11, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7916161440375831, "mean_inference_ms": 1.2188555901041505, "mean_action_processing_ms": 0.10472971240235417, "mean_env_wait_ms": 29.64359006844661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007068157196044922, "StateBufferConnector_ms": 0.00477910041809082, "ViewRequirementAgentConnector_ms": 0.11771798133850098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 26000, "num_env_steps_sampled": 26000, "num_env_steps_trained": 26000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.725226007673427, "num_env_steps_trained_throughput_per_sec": 29.725226007673427, "timesteps_total": 26000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 26000, "timers": {"training_iteration_time_ms": 66687.593, "sample_time_ms": 63490.456, "load_time_ms": 9.32, "load_throughput": 214597.837, "learn_time_ms": 3185.196, "learn_throughput": 627.905, "synch_weights_time_ms": 2.187}, "counters": {"num_env_steps_sampled": 26000, "num_env_steps_trained": 26000, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 26000}, "done": false, "episodes_total": 1195, "training_iteration": 13, "trial_id": "13850_00001", "date": "2023-12-28_18-01-57", "timestamp": 1703757717, "time_this_iter_s": 67.28795671463013, "time_total_s": 868.2777752876282, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 868.2777752876282, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 55.91041666666666, "ram_util_percent": 92.91145833333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.613238762749566, "policy_loss": -0.0720414402253098, "vf_loss": 4.684664994345771, "vf_explained_var": -3.8429896036783854e-05, "kl": 0.007291273556822441, "entropy": 0.5207620184951358, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6075.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 22.55355450236967, "episode_reward_min": 4.753548421284604, "episode_reward_mean": 20.68026448700865, "episode_len_mean": 28.89, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.020221169036347, 20.985994152953314, 21.553553703104782, 22.020221169036347, 21.986887835703012, 6.686887835671289, 21.920221169036342, 7.419913221958554, 21.620221169036327, 21.020221169035793, 21.186887835703, 21.5868878356713, 21.985994152953335, 21.420221169036342, 21.153554502128863, 21.68684428692638, 22.15355450236968, 22.020221169036347, 21.95324655529245, 21.720221168795536, 22.020221169036347, 5.119597571012521, 21.61991322195911, 22.086887140357, 20.953554502369666, 21.020221155153195, 20.319597676467843, 22.153250014601607, 21.9862583541451, 21.986887835703012, 21.853554500541204, 8.886887835702451, 21.120221167207937, 20.886887835703007, 21.886881846713575, 20.786887835703002, 21.65355450236551, 22.020221169036347, 20.68688783567128, 22.020221169036347, 22.020221169036347, 21.65355450236551, 20.02022116903634, 20.420221169036328, 22.020221169036347, 20.486887835702927, 22.020221169036347, 21.01932748628665, 21.553554397103454, 21.55355450236967, 21.219327486283028, 20.586887835702917, 21.086579888625767, 22.020221169036347, 21.886881846713575, 20.25355450236966, 22.26932953666322, 20.986887036678713, 21.653554502369662, 20.986887835703012, 21.985994152953335, 20.02022116903634, 21.020221169036326, 22.020221169036347, 20.75355450236967, 22.55355450236967, 22.020221169036347, 4.753548421284604, 20.986881832878154, 21.0202150884787, 22.120221156977976, 22.020221169036347, 20.02022116903634, 22.020221169036347, 21.120220370012053, 21.65354849954882, 20.51991668126826, 22.020221169036347, 21.686573911304226, 21.786543250780298, 20.153554502369673, 21.986258354145065, 21.719327486254958, 22.053548499548743, 22.253554502369674, 21.985994152953335, 22.020221169036347, 22.153548513143583, 20.886887835703007, 21.853554488485994, 22.020221169036347, 21.820221063770134, 22.020221169036347, 20.720221169036254, 22.15355450236968, 21.25351095359311, 21.48688783570301, 21.920177620259782, 12.553554502369668, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 11, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7831106348453365, "mean_inference_ms": 1.2184027346812663, "mean_action_processing_ms": 0.10469282124488723, "mean_env_wait_ms": 29.634308644036143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069735050201416016, "StateBufferConnector_ms": 0.004758358001708984, "ViewRequirementAgentConnector_ms": 0.11690640449523926}}, "episode_reward_max": 22.55355450236967, "episode_reward_min": 4.753548421284604, "episode_reward_mean": 20.68026448700865, "episode_len_mean": 28.89, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.020221169036347, 20.985994152953314, 21.553553703104782, 22.020221169036347, 21.986887835703012, 6.686887835671289, 21.920221169036342, 7.419913221958554, 21.620221169036327, 21.020221169035793, 21.186887835703, 21.5868878356713, 21.985994152953335, 21.420221169036342, 21.153554502128863, 21.68684428692638, 22.15355450236968, 22.020221169036347, 21.95324655529245, 21.720221168795536, 22.020221169036347, 5.119597571012521, 21.61991322195911, 22.086887140357, 20.953554502369666, 21.020221155153195, 20.319597676467843, 22.153250014601607, 21.9862583541451, 21.986887835703012, 21.853554500541204, 8.886887835702451, 21.120221167207937, 20.886887835703007, 21.886881846713575, 20.786887835703002, 21.65355450236551, 22.020221169036347, 20.68688783567128, 22.020221169036347, 22.020221169036347, 21.65355450236551, 20.02022116903634, 20.420221169036328, 22.020221169036347, 20.486887835702927, 22.020221169036347, 21.01932748628665, 21.553554397103454, 21.55355450236967, 21.219327486283028, 20.586887835702917, 21.086579888625767, 22.020221169036347, 21.886881846713575, 20.25355450236966, 22.26932953666322, 20.986887036678713, 21.653554502369662, 20.986887835703012, 21.985994152953335, 20.02022116903634, 21.020221169036326, 22.020221169036347, 20.75355450236967, 22.55355450236967, 22.020221169036347, 4.753548421284604, 20.986881832878154, 21.0202150884787, 22.120221156977976, 22.020221169036347, 20.02022116903634, 22.020221169036347, 21.120220370012053, 21.65354849954882, 20.51991668126826, 22.020221169036347, 21.686573911304226, 21.786543250780298, 20.153554502369673, 21.986258354145065, 21.719327486254958, 22.053548499548743, 22.253554502369674, 21.985994152953335, 22.020221169036347, 22.153548513143583, 20.886887835703007, 21.853554488485994, 22.020221169036347, 21.820221063770134, 22.020221169036347, 20.720221169036254, 22.15355450236968, 21.25351095359311, 21.48688783570301, 21.920177620259782, 12.553554502369668, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 11, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7831106348453365, "mean_inference_ms": 1.2184027346812663, "mean_action_processing_ms": 0.10469282124488723, "mean_env_wait_ms": 29.634308644036143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069735050201416016, "StateBufferConnector_ms": 0.004758358001708984, "ViewRequirementAgentConnector_ms": 0.11690640449523926}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.417085226320925, "num_env_steps_trained_throughput_per_sec": 30.417085226320925, "timesteps_total": 28000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 66593.021, "sample_time_ms": 63394.517, "load_time_ms": 10.025, "load_throughput": 199509.302, "learn_time_ms": 3185.843, "learn_throughput": 627.777, "synch_weights_time_ms": 2.194}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 1263, "training_iteration": 14, "trial_id": "13850_00001", "date": "2023-12-28_18-03-03", "timestamp": 1703757783, "time_this_iter_s": 65.75720691680908, "time_total_s": 934.0349822044373, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 934.0349822044373, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 55.890322580645154, "ram_util_percent": 92.841935483871}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8570638953314886, "policy_loss": -0.029547980493969388, "vf_loss": 3.8860655498504637, "vf_explained_var": -1.9994179407755533e-05, "kl": 0.0064752383782419026, "entropy": 0.4142449763086107, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6525.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000}, "sampler_results": {"episode_reward_max": 22.286259062850778, "episode_reward_min": 3.620215087951271, "episode_reward_mean": 20.74480162809311, "episode_len_mean": 29.08, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0202150884787, 22.120221156977976, 22.020221169036347, 20.02022116903634, 22.020221169036347, 21.120220370012053, 21.65354849954882, 20.51991668126826, 22.020221169036347, 21.686573911304226, 21.786543250780298, 20.153554502369673, 21.986258354145065, 21.719327486254958, 22.053548499548743, 22.253554502369674, 21.985994152953335, 22.020221169036347, 22.153548513143583, 20.886887835703007, 21.853554488485994, 22.020221169036347, 21.820221063770134, 22.020221169036347, 20.720221169036254, 22.15355450236968, 21.25351095359311, 21.48688783570301, 21.920177620259782, 12.553554502369668, 22.020221169036347, 20.620221168767976, 22.020221169036347, 20.486887835702994, 21.52013934644446, 22.020221169036347, 20.28688773043679, 20.15293100980118, 22.020221169036347, 20.85355450236968, 20.985994152953314, 21.386887833874262, 21.353554502369672, 22.020221169036347, 22.15355450236919, 21.020221169036326, 21.320221169036333, 21.286887833874584, 22.020221169036347, 21.520221169036322, 20.02022116903634, 22.05324655529245, 5.920221167207578, 21.78688782181987, 21.020221169036326, 21.920221169036342, 21.985994152953335, 21.78688782181987, 20.286887835702995, 21.653554502369662, 22.286259062850778, 20.153554502369666, 22.020221169036347, 21.686887835702997, 21.920177620259782, 20.653510953593106, 21.386887835703007, 22.020221169036347, 20.786887835703006, 22.020221169036347, 9.020220370011977, 21.152931009801165, 21.020221169036336, 21.986887835703012, 21.65355450236551, 20.02022116903634, 20.153554502369666, 21.520177620259236, 21.053554502128858, 22.020221169036347, 22.020221169036347, 20.620221169036338, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.45355450236966, 22.15355450236968, 20.886844286926355, 3.620215087951271, 20.253554397103386, 20.920221169036346, 21.55355450236967, 21.453554502369677, 20.820221063770113, 22.020221169036347, 22.020221169036347, 21.519327486286667, 22.020221169036347, 20.853553703345373, 7.186887821815882], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 9, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 6, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7758702333608082, "mean_inference_ms": 1.2189539803445435, "mean_action_processing_ms": 0.1047520673807221, "mean_env_wait_ms": 29.641835666635345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069921016693115234, "StateBufferConnector_ms": 0.004820346832275391, "ViewRequirementAgentConnector_ms": 0.11687755584716797}}, "episode_reward_max": 22.286259062850778, "episode_reward_min": 3.620215087951271, "episode_reward_mean": 20.74480162809311, "episode_len_mean": 29.08, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.0202150884787, 22.120221156977976, 22.020221169036347, 20.02022116903634, 22.020221169036347, 21.120220370012053, 21.65354849954882, 20.51991668126826, 22.020221169036347, 21.686573911304226, 21.786543250780298, 20.153554502369673, 21.986258354145065, 21.719327486254958, 22.053548499548743, 22.253554502369674, 21.985994152953335, 22.020221169036347, 22.153548513143583, 20.886887835703007, 21.853554488485994, 22.020221169036347, 21.820221063770134, 22.020221169036347, 20.720221169036254, 22.15355450236968, 21.25351095359311, 21.48688783570301, 21.920177620259782, 12.553554502369668, 22.020221169036347, 20.620221168767976, 22.020221169036347, 20.486887835702994, 21.52013934644446, 22.020221169036347, 20.28688773043679, 20.15293100980118, 22.020221169036347, 20.85355450236968, 20.985994152953314, 21.386887833874262, 21.353554502369672, 22.020221169036347, 22.15355450236919, 21.020221169036326, 21.320221169036333, 21.286887833874584, 22.020221169036347, 21.520221169036322, 20.02022116903634, 22.05324655529245, 5.920221167207578, 21.78688782181987, 21.020221169036326, 21.920221169036342, 21.985994152953335, 21.78688782181987, 20.286887835702995, 21.653554502369662, 22.286259062850778, 20.153554502369666, 22.020221169036347, 21.686887835702997, 21.920177620259782, 20.653510953593106, 21.386887835703007, 22.020221169036347, 20.786887835703006, 22.020221169036347, 9.020220370011977, 21.152931009801165, 21.020221169036336, 21.986887835703012, 21.65355450236551, 20.02022116903634, 20.153554502369666, 21.520177620259236, 21.053554502128858, 22.020221169036347, 22.020221169036347, 20.620221169036338, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.45355450236966, 22.15355450236968, 20.886844286926355, 3.620215087951271, 20.253554397103386, 20.920221169036346, 21.55355450236967, 21.453554502369677, 20.820221063770113, 22.020221169036347, 22.020221169036347, 21.519327486286667, 22.020221169036347, 20.853553703345373, 7.186887821815882], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 9, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 6, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7758702333608082, "mean_inference_ms": 1.2189539803445435, "mean_action_processing_ms": 0.1047520673807221, "mean_env_wait_ms": 29.641835666635345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069921016693115234, "StateBufferConnector_ms": 0.004820346832275391, "ViewRequirementAgentConnector_ms": 0.11687755584716797}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000, "num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.74756875401424, "num_env_steps_trained_throughput_per_sec": 29.74756875401424, "timesteps_total": 30000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 30000, "timers": {"training_iteration_time_ms": 66645.344, "sample_time_ms": 63449.645, "load_time_ms": 10.449, "load_throughput": 191399.686, "learn_time_ms": 3182.607, "learn_throughput": 628.416, "synch_weights_time_ms": 2.194}, "counters": {"num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000}, "done": false, "episodes_total": 1332, "training_iteration": 15, "trial_id": "13850_00001", "date": "2023-12-28_18-04-10", "timestamp": 1703757850, "time_this_iter_s": 67.23986506462097, "time_total_s": 1001.2748472690582, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1001.2748472690582, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 56.265625, "ram_util_percent": 92.6729166666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.218834102948507, "policy_loss": 0.006076349715391795, "vf_loss": 3.212668614917331, "vf_explained_var": -2.393417888217502e-05, "kl": 0.0010562736337046531, "entropy": 0.4001603830522961, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 22.286842458264626, "episode_reward_min": 3.620215087951271, "episode_reward_mean": 20.591614110623983, "episode_len_mean": 28.92, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.786887835703006, 22.020221169036347, 9.020220370011977, 21.152931009801165, 21.020221169036336, 21.986887835703012, 21.65355450236551, 20.02022116903634, 20.153554502369666, 21.520177620259236, 21.053554502128858, 22.020221169036347, 22.020221169036347, 20.620221169036338, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.45355450236966, 22.15355450236968, 20.886844286926355, 3.620215087951271, 20.253554397103386, 20.920221169036346, 21.55355450236967, 21.453554502369677, 20.820221063770113, 22.020221169036347, 22.020221169036347, 21.519327486286667, 22.020221169036347, 20.853553703345373, 7.186887821815882, 22.020221169036347, 22.020221169036347, 21.72022116721308, 21.020221169036326, 22.020221169036347, 5.386887833874246, 21.520221169036347, 21.020221169036326, 20.78661998691773, 22.020221169036347, 21.220215180046903, 22.020221169036347, 20.486887036678713, 21.020221169036326, 22.020221169036347, 21.153554488486535, 21.386887835699383, 21.586887835702942, 20.153554502369666, 21.520221169032652, 21.820221167444775, 22.15355450236967, 20.02022116903634, 21.784575631710062, 20.420215888752118, 15.72022116903634, 22.020221169036347, 21.920177620259782, 21.386264343134506, 22.020221169036347, 22.286264343134516, 20.120221169036334, 21.653554384856005, 22.020221169036347, 20.8868878338746, 21.886887835703, 21.020221169004625, 18.502039377428055, 21.985994152953335, 21.78688773043673, 22.020221169036347, 7.786887835698825, 21.35262305981285, 21.086887835702996, 20.02022116903634, 21.453554488482567, 21.020221169036326, 21.95324655529245, 22.020221169036347, 21.986887833874537, 21.985994152953335, 22.15355450236968, 22.1535545023696, 20.02022116903634, 21.286887835703002, 21.986887835703012, 22.286842458264626, 21.519597676467846, 20.55355450236967, 21.020221169036326, 21.520221169036322, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.486887835702994, 22.020221169036347], "episode_lengths": [30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 6, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 9, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 27, 30, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.769191017069608, "mean_inference_ms": 1.2187923450664366, "mean_action_processing_ms": 0.10474135974776382, "mean_env_wait_ms": 29.63399254903934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070149898529052734, "StateBufferConnector_ms": 0.004790782928466797, "ViewRequirementAgentConnector_ms": 0.1162722110748291}}, "episode_reward_max": 22.286842458264626, "episode_reward_min": 3.620215087951271, "episode_reward_mean": 20.591614110623983, "episode_len_mean": 28.92, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.786887835703006, 22.020221169036347, 9.020220370011977, 21.152931009801165, 21.020221169036336, 21.986887835703012, 21.65355450236551, 20.02022116903634, 20.153554502369666, 21.520177620259236, 21.053554502128858, 22.020221169036347, 22.020221169036347, 20.620221169036338, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.45355450236966, 22.15355450236968, 20.886844286926355, 3.620215087951271, 20.253554397103386, 20.920221169036346, 21.55355450236967, 21.453554502369677, 20.820221063770113, 22.020221169036347, 22.020221169036347, 21.519327486286667, 22.020221169036347, 20.853553703345373, 7.186887821815882, 22.020221169036347, 22.020221169036347, 21.72022116721308, 21.020221169036326, 22.020221169036347, 5.386887833874246, 21.520221169036347, 21.020221169036326, 20.78661998691773, 22.020221169036347, 21.220215180046903, 22.020221169036347, 20.486887036678713, 21.020221169036326, 22.020221169036347, 21.153554488486535, 21.386887835699383, 21.586887835702942, 20.153554502369666, 21.520221169032652, 21.820221167444775, 22.15355450236967, 20.02022116903634, 21.784575631710062, 20.420215888752118, 15.72022116903634, 22.020221169036347, 21.920177620259782, 21.386264343134506, 22.020221169036347, 22.286264343134516, 20.120221169036334, 21.653554384856005, 22.020221169036347, 20.8868878338746, 21.886887835703, 21.020221169004625, 18.502039377428055, 21.985994152953335, 21.78688773043673, 22.020221169036347, 7.786887835698825, 21.35262305981285, 21.086887835702996, 20.02022116903634, 21.453554488482567, 21.020221169036326, 21.95324655529245, 22.020221169036347, 21.986887833874537, 21.985994152953335, 22.15355450236968, 22.1535545023696, 20.02022116903634, 21.286887835703002, 21.986887835703012, 22.286842458264626, 21.519597676467846, 20.55355450236967, 21.020221169036326, 21.520221169036322, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.486887835702994, 22.020221169036347], "episode_lengths": [30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 6, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 9, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 27, 30, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.769191017069608, "mean_inference_ms": 1.2187923450664366, "mean_action_processing_ms": 0.10474135974776382, "mean_env_wait_ms": 29.63399254903934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070149898529052734, "StateBufferConnector_ms": 0.004790782928466797, "ViewRequirementAgentConnector_ms": 0.1162722110748291}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.40908518168389, "num_env_steps_trained_throughput_per_sec": 30.40908518168389, "timesteps_total": 32000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 66518.848, "sample_time_ms": 63328.106, "load_time_ms": 9.759, "load_throughput": 204947.106, "learn_time_ms": 3178.355, "learn_throughput": 629.256, "synch_weights_time_ms": 2.178}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 1400, "training_iteration": 16, "trial_id": "13850_00001", "date": "2023-12-28_18-05-16", "timestamp": 1703757916, "time_this_iter_s": 65.77463746070862, "time_total_s": 1067.0494847297668, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1067.0494847297668, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 55.80645161290322, "ram_util_percent": 92.63655913978495}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0421875, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.577600595686171, "policy_loss": -0.027653233723507985, "vf_loss": 2.6051724825965032, "vf_explained_var": 1.3837814331054687e-05, "kl": 0.0019282728584977427, "entropy": 0.4409462563196818, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 7425.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 34000, "num_env_steps_trained": 34000, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 34000}, "sampler_results": {"episode_reward_max": 22.286842458264626, "episode_reward_min": 3.620215087951271, "episode_reward_mean": 20.17697732465333, "episode_len_mean": 28.56, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.78688773043673, 22.020221169036347, 7.786887835698825, 21.35262305981285, 21.086887835702996, 20.02022116903634, 21.453554488482567, 21.020221169036326, 21.95324655529245, 22.020221169036347, 21.986887833874537, 21.985994152953335, 22.15355450236968, 22.1535545023696, 20.02022116903634, 21.286887835703002, 21.986887835703012, 22.286842458264626, 21.519597676467846, 20.55355450236967, 21.020221169036326, 21.520221169036322, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.486887835702994, 22.020221169036347, 22.020221169036347, 20.853554502369658, 22.020221169036347, 20.286887835702995, 20.35355450236967, 22.15355450236968, 21.586887835702942, 20.85355439709927, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.25355450236967, 22.020221169036347, 12.020221169036335, 20.02022116903634, 20.820221169036316, 22.020221169036347, 22.020221169036347, 11.086887835703, 21.15355380702366, 21.020221169036326, 22.152931009801186, 21.753554502369667, 20.22022116903633, 20.02022116903634, 22.152931009801186, 20.02022116903634, 21.753554397103464, 20.88688782181985, 21.05266081961998, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.82022116879551, 10.020221169036335, 21.620221169036345, 20.02022116903634, 21.753554490314194, 22.020221169036347, 11.820221169036333, 20.02022116903634, 22.020221169036347, 20.153554502369676, 21.820221063770134, 21.020221169036326, 20.985994152953314, 21.82022037001206, 20.053554500540926, 21.853553703345394, 21.420221169036342, 21.320221063581364, 22.02022116903634, 22.020221169036347, 22.020221169036347, 21.686887835671303, 21.28688783570245, 9.35355450236966, 20.153554502369673, 22.020221169036347, 20.85355448848652, 21.486844286926445, 22.020221169036347, 4.252660714164672, 20.720221167207594, 21.453554502369585, 20.02022116903634, 3.620215087951271, 20.02022116903634, 20.153554502369673, 12.102662869996553, 20.58684428692644], "episode_lengths": [30, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 19, 30, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 15, 30, 30, 30, 30, 30, 7, 30, 30, 30, 6, 30, 30, 18, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7637605245827747, "mean_inference_ms": 1.2190383412685202, "mean_action_processing_ms": 0.10477885362721395, "mean_env_wait_ms": 29.639419993541942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007070779800415039, "StateBufferConnector_ms": 0.004798173904418945, "ViewRequirementAgentConnector_ms": 0.11698794364929199}}, "episode_reward_max": 22.286842458264626, "episode_reward_min": 3.620215087951271, "episode_reward_mean": 20.17697732465333, "episode_len_mean": 28.56, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.78688773043673, 22.020221169036347, 7.786887835698825, 21.35262305981285, 21.086887835702996, 20.02022116903634, 21.453554488482567, 21.020221169036326, 21.95324655529245, 22.020221169036347, 21.986887833874537, 21.985994152953335, 22.15355450236968, 22.1535545023696, 20.02022116903634, 21.286887835703002, 21.986887835703012, 22.286842458264626, 21.519597676467846, 20.55355450236967, 21.020221169036326, 21.520221169036322, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.486887835702994, 22.020221169036347, 22.020221169036347, 20.853554502369658, 22.020221169036347, 20.286887835702995, 20.35355450236967, 22.15355450236968, 21.586887835702942, 20.85355439709927, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.25355450236967, 22.020221169036347, 12.020221169036335, 20.02022116903634, 20.820221169036316, 22.020221169036347, 22.020221169036347, 11.086887835703, 21.15355380702366, 21.020221169036326, 22.152931009801186, 21.753554502369667, 20.22022116903633, 20.02022116903634, 22.152931009801186, 20.02022116903634, 21.753554397103464, 20.88688782181985, 21.05266081961998, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.82022116879551, 10.020221169036335, 21.620221169036345, 20.02022116903634, 21.753554490314194, 22.020221169036347, 11.820221169036333, 20.02022116903634, 22.020221169036347, 20.153554502369676, 21.820221063770134, 21.020221169036326, 20.985994152953314, 21.82022037001206, 20.053554500540926, 21.853553703345394, 21.420221169036342, 21.320221063581364, 22.02022116903634, 22.020221169036347, 22.020221169036347, 21.686887835671303, 21.28688783570245, 9.35355450236966, 20.153554502369673, 22.020221169036347, 20.85355448848652, 21.486844286926445, 22.020221169036347, 4.252660714164672, 20.720221167207594, 21.453554502369585, 20.02022116903634, 3.620215087951271, 20.02022116903634, 20.153554502369673, 12.102662869996553, 20.58684428692644], "episode_lengths": [30, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 19, 30, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 15, 30, 30, 30, 30, 30, 7, 30, 30, 30, 6, 30, 30, 18, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7637605245827747, "mean_inference_ms": 1.2190383412685202, "mean_action_processing_ms": 0.10477885362721395, "mean_env_wait_ms": 29.639419993541942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007070779800415039, "StateBufferConnector_ms": 0.004798173904418945, "ViewRequirementAgentConnector_ms": 0.11698794364929199}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 34000, "num_env_steps_sampled": 34000, "num_env_steps_trained": 34000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.77812904682794, "num_env_steps_trained_throughput_per_sec": 29.77812904682794, "timesteps_total": 34000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 34000, "timers": {"training_iteration_time_ms": 66597.661, "sample_time_ms": 63403.256, "load_time_ms": 9.88, "load_throughput": 202435.127, "learn_time_ms": 3181.898, "learn_throughput": 628.556, "synch_weights_time_ms": 2.175}, "counters": {"num_env_steps_sampled": 34000, "num_env_steps_trained": 34000, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 34000}, "done": false, "episodes_total": 1471, "training_iteration": 17, "trial_id": "13850_00001", "date": "2023-12-28_18-06-23", "timestamp": 1703757983, "time_this_iter_s": 67.16797065734863, "time_total_s": 1134.2174553871155, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1134.2174553871155, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 56.08541666666667, "ram_util_percent": 92.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.02109375, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3281003801027933, "policy_loss": 0.01006452245844735, "vf_loss": 2.3179895729488798, "vf_explained_var": 2.777311537000868e-06, "kl": 0.0021940096514369463, "entropy": 0.40342998259597357, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 7875.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 22.286264343134512, "episode_reward_min": 3.620215087951271, "episode_reward_mean": 19.8906514164379, "episode_len_mean": 28.26, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.020221169036347, 20.153554502369676, 21.820221063770134, 21.020221169036326, 20.985994152953314, 21.82022037001206, 20.053554500540926, 21.853553703345394, 21.420221169036342, 21.320221063581364, 22.02022116903634, 22.020221169036347, 22.020221169036347, 21.686887835671303, 21.28688783570245, 9.35355450236966, 20.153554502369673, 22.020221169036347, 20.85355448848652, 21.486844286926445, 22.020221169036347, 4.252660714164672, 20.720221167207594, 21.453554502369585, 20.02022116903634, 3.620215087951271, 20.02022116903634, 20.153554502369673, 12.102662869996553, 20.58684428692644, 20.02022116903634, 21.986887821816268, 21.652931009801176, 21.486882633596128, 20.153554502369193, 21.020177620259766, 21.153554502369666, 21.320221169036337, 10.486887835702928, 18.120221169036338, 21.1862643431345, 21.586844286894742, 21.48688783570298, 8.520221169032158, 21.020221169036326, 22.286264343134512, 21.520221169036347, 20.886887835703, 18.420221169036342, 6.320221168795511, 21.886887835703007, 20.02022116903634, 20.753554500541252, 21.820221063770134, 20.986887835702994, 16.686887833874593, 21.020221169036326, 20.22022116903633, 22.15355450236968, 21.020221169036326, 7.086887835671288, 20.353554502337957, 20.686887835703004, 20.02022116903634, 20.02022116903634, 21.05355450236605, 21.15351440521502, 21.98599598383877, 21.153554502365505, 21.020221169036326, 22.020221169036347, 21.686887835703008, 10.386887835698824, 21.153554502369666, 20.02022116903634, 22.020221169036347, 21.820221063770134, 21.020221169036326, 20.02022116903634, 21.786887835702995, 22.020221169036347, 20.886887821819855, 20.186887835702997, 21.453554502369677, 20.486887835702994, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.8862547858585, 20.420221167448396, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.886887835703007, 18.38688783570301, 21.486887835703012, 20.786259062850753, 21.153554490311304, 21.753510167932085, 22.15355449031131], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 15, 30, 30, 30, 30, 30, 7, 30, 30, 30, 6, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 15, 28, 30, 30, 30, 13, 30, 30, 30, 30, 26, 10, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 26, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7592377637533702, "mean_inference_ms": 1.2193426780964536, "mean_action_processing_ms": 0.10483938519705031, "mean_env_wait_ms": 29.653229171544826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007098674774169922, "StateBufferConnector_ms": 0.004808664321899414, "ViewRequirementAgentConnector_ms": 0.11606526374816895}}, "episode_reward_max": 22.286264343134512, "episode_reward_min": 3.620215087951271, "episode_reward_mean": 19.8906514164379, "episode_len_mean": 28.26, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.020221169036347, 20.153554502369676, 21.820221063770134, 21.020221169036326, 20.985994152953314, 21.82022037001206, 20.053554500540926, 21.853553703345394, 21.420221169036342, 21.320221063581364, 22.02022116903634, 22.020221169036347, 22.020221169036347, 21.686887835671303, 21.28688783570245, 9.35355450236966, 20.153554502369673, 22.020221169036347, 20.85355448848652, 21.486844286926445, 22.020221169036347, 4.252660714164672, 20.720221167207594, 21.453554502369585, 20.02022116903634, 3.620215087951271, 20.02022116903634, 20.153554502369673, 12.102662869996553, 20.58684428692644, 20.02022116903634, 21.986887821816268, 21.652931009801176, 21.486882633596128, 20.153554502369193, 21.020177620259766, 21.153554502369666, 21.320221169036337, 10.486887835702928, 18.120221169036338, 21.1862643431345, 21.586844286894742, 21.48688783570298, 8.520221169032158, 21.020221169036326, 22.286264343134512, 21.520221169036347, 20.886887835703, 18.420221169036342, 6.320221168795511, 21.886887835703007, 20.02022116903634, 20.753554500541252, 21.820221063770134, 20.986887835702994, 16.686887833874593, 21.020221169036326, 20.22022116903633, 22.15355450236968, 21.020221169036326, 7.086887835671288, 20.353554502337957, 20.686887835703004, 20.02022116903634, 20.02022116903634, 21.05355450236605, 21.15351440521502, 21.98599598383877, 21.153554502365505, 21.020221169036326, 22.020221169036347, 21.686887835703008, 10.386887835698824, 21.153554502369666, 20.02022116903634, 22.020221169036347, 21.820221063770134, 21.020221169036326, 20.02022116903634, 21.786887835702995, 22.020221169036347, 20.886887821819855, 20.186887835702997, 21.453554502369677, 20.486887835702994, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.8862547858585, 20.420221167448396, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.886887835703007, 18.38688783570301, 21.486887835703012, 20.786259062850753, 21.153554490311304, 21.753510167932085, 22.15355449031131], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 15, 30, 30, 30, 30, 30, 7, 30, 30, 30, 6, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 15, 28, 30, 30, 30, 13, 30, 30, 30, 30, 26, 10, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 26, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7592377637533702, "mean_inference_ms": 1.2193426780964536, "mean_action_processing_ms": 0.10483938519705031, "mean_env_wait_ms": 29.653229171544826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007098674774169922, "StateBufferConnector_ms": 0.004808664321899414, "ViewRequirementAgentConnector_ms": 0.11606526374816895}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.861708837452987, "num_env_steps_trained_throughput_per_sec": 29.861708837452987, "timesteps_total": 36000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 66621.475, "sample_time_ms": 63426.865, "load_time_ms": 11.032, "load_throughput": 181284.372, "learn_time_ms": 3180.944, "learn_throughput": 628.744, "synch_weights_time_ms": 2.18}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 1541, "training_iteration": 18, "trial_id": "13850_00001", "date": "2023-12-28_18-07-30", "timestamp": 1703758050, "time_this_iter_s": 66.98012948036194, "time_total_s": 1201.1975848674774, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1201.1975848674774, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 56.20315789473685, "ram_util_percent": 92.6673684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2705267879698012, "policy_loss": -0.013553009637527995, "vf_loss": 1.2840201797750261, "vf_explained_var": 9.210374620225695e-05, "kl": 0.005652542665286897, "entropy": 0.34159327420923447, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 8325.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 38000, "num_env_steps_trained": 38000, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 38000}, "sampler_results": {"episode_reward_max": 22.153554502342136, "episode_reward_min": 1.7327113850086178, "episode_reward_mean": 20.94165341870285, "episode_len_mean": 29.55, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.153554502365505, 21.020221169036326, 22.020221169036347, 21.686887835703008, 10.386887835698824, 21.153554502369666, 20.02022116903634, 22.020221169036347, 21.820221063770134, 21.020221169036326, 20.02022116903634, 21.786887835702995, 22.020221169036347, 20.886887821819855, 20.186887835702997, 21.453554502369677, 20.486887835702994, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.8862547858585, 20.420221167448396, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.886887835703007, 18.38688783570301, 21.486887835703012, 20.786259062850753, 21.153554490311304, 21.753510167932085, 22.15355449031131, 20.153554502369673, 21.15355450236919, 21.186887835703, 21.153554502369662, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.253554502365485, 21.086887835702996, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.153554502342136, 21.286887835703002, 20.153554502369676, 20.02022116903634, 21.486887835703, 22.01955412762264, 21.020221169036326, 21.486887835703012, 22.020221169036347, 21.020221169036326, 21.586887626784023, 22.020221169036347, 22.020221169036347, 20.98688783569883, 21.820220368211448, 1.7327113850086178, 20.820221063770113, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.753554500541252, 20.02022116903634, 21.586887835702942, 22.053554502369675, 21.486265111013623, 22.020221169036347, 20.153554502369673, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.420220466911545, 21.953554502369677, 20.153554502369676, 20.02022116903634, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.85355450216056, 20.02022116903634, 22.053553807023665, 21.05355450236966, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.153554502369666, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326], "episode_lengths": [30, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 26, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 3, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.754495562165758, "mean_inference_ms": 1.2192372562043328, "mean_action_processing_ms": 0.10482492334305224, "mean_env_wait_ms": 29.648435645030222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007077932357788086, "StateBufferConnector_ms": 0.0047910213470458984, "ViewRequirementAgentConnector_ms": 0.11677145957946777}}, "episode_reward_max": 22.153554502342136, "episode_reward_min": 1.7327113850086178, "episode_reward_mean": 20.94165341870285, "episode_len_mean": 29.55, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.153554502365505, 21.020221169036326, 22.020221169036347, 21.686887835703008, 10.386887835698824, 21.153554502369666, 20.02022116903634, 22.020221169036347, 21.820221063770134, 21.020221169036326, 20.02022116903634, 21.786887835702995, 22.020221169036347, 20.886887821819855, 20.186887835702997, 21.453554502369677, 20.486887835702994, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.8862547858585, 20.420221167448396, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.886887835703007, 18.38688783570301, 21.486887835703012, 20.786259062850753, 21.153554490311304, 21.753510167932085, 22.15355449031131, 20.153554502369673, 21.15355450236919, 21.186887835703, 21.153554502369662, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.253554502365485, 21.086887835702996, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.153554502342136, 21.286887835703002, 20.153554502369676, 20.02022116903634, 21.486887835703, 22.01955412762264, 21.020221169036326, 21.486887835703012, 22.020221169036347, 21.020221169036326, 21.586887626784023, 22.020221169036347, 22.020221169036347, 20.98688783569883, 21.820220368211448, 1.7327113850086178, 20.820221063770113, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.753554500541252, 20.02022116903634, 21.586887835702942, 22.053554502369675, 21.486265111013623, 22.020221169036347, 20.153554502369673, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.420220466911545, 21.953554502369677, 20.153554502369676, 20.02022116903634, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.85355450216056, 20.02022116903634, 22.053553807023665, 21.05355450236966, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.153554502369666, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326], "episode_lengths": [30, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 26, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 3, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.754495562165758, "mean_inference_ms": 1.2192372562043328, "mean_action_processing_ms": 0.10482492334305224, "mean_env_wait_ms": 29.648435645030222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007077932357788086, "StateBufferConnector_ms": 0.0047910213470458984, "ViewRequirementAgentConnector_ms": 0.11677145957946777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 38000, "num_env_steps_sampled": 38000, "num_env_steps_trained": 38000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.293183138570193, "num_env_steps_trained_throughput_per_sec": 30.293183138570193, "timesteps_total": 38000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 38000, "timers": {"training_iteration_time_ms": 66596.041, "sample_time_ms": 63405.247, "load_time_ms": 10.203, "load_throughput": 196012.917, "learn_time_ms": 3177.975, "learn_throughput": 629.332, "synch_weights_time_ms": 2.16}, "counters": {"num_env_steps_sampled": 38000, "num_env_steps_trained": 38000, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 38000}, "done": false, "episodes_total": 1609, "training_iteration": 19, "trial_id": "13850_00001", "date": "2023-12-28_18-08-36", "timestamp": 1703758116, "time_this_iter_s": 66.02641010284424, "time_total_s": 1267.2239949703217, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1267.2239949703217, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 55.92553191489362, "ram_util_percent": 92.72765957446813}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.138854271305932, "policy_loss": 0.004075882302390204, "vf_loss": 1.1347426382700603, "vf_explained_var": 5.3638882107204864e-05, "kl": 0.003389530899516511, "entropy": 0.30014025774266984, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 8775.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 22.419598444346963, "episode_reward_min": 4.42022036823501, "episode_reward_mean": 20.85685543904913, "episode_len_mean": 29.51, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.486265111013623, 22.020221169036347, 20.153554502369673, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.420220466911545, 21.953554502369677, 20.153554502369676, 20.02022116903634, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.85355450216056, 20.02022116903634, 22.053553807023665, 21.05355450236966, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.153554502369666, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.120221167207582, 4.42022036823501, 20.586887835702917, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.920221169035788, 22.020221169036347, 21.95324655529245, 20.02022116903634, 21.586844286894742, 21.15355450236966, 21.153554502369662, 22.419598444346963, 22.020221169036347, 22.020221169036347, 21.086887835703003, 22.020221169036347, 16.58688783387459, 22.020221169036347, 20.820221168795516, 20.02022116903634, 20.086579888625774, 21.15355450236966, 22.020221169036347, 22.020221169036347, 20.45355450236966, 22.15354922208594, 21.153554500781738, 22.020221169036347, 21.020221169036326, 21.586887835702942, 21.920177620259782, 21.020221169036326, 22.020221169036347, 20.02022116903634, 20.820221063770113, 20.25355450236966, 22.020221169036347, 22.020221169036347, 21.95324655529245, 20.02022116903634, 21.186887835703, 21.586887835702942, 21.020221169036326, 22.020221169036347, 21.253554502369653, 21.286887140356985, 21.28688783549389, 22.020221169036347, 21.55355450236967, 20.92017762025976, 21.420221169036342, 21.220221169032175, 22.020221169036347, 22.020221169036347, 20.086579888625774, 21.020221169036326, 5.953554500540911, 20.586887835702917, 20.02022116903634, 20.02022116903634, 21.152931009801165, 21.686887833843087, 22.020221169036347, 21.65355450236551, 22.15355450236968, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 9, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7497030313677757, "mean_inference_ms": 1.2186670815301115, "mean_action_processing_ms": 0.10478739942725418, "mean_env_wait_ms": 29.632231401351238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007097959518432617, "StateBufferConnector_ms": 0.004756450653076172, "ViewRequirementAgentConnector_ms": 0.11603927612304688}}, "episode_reward_max": 22.419598444346963, "episode_reward_min": 4.42022036823501, "episode_reward_mean": 20.85685543904913, "episode_len_mean": 29.51, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.486265111013623, 22.020221169036347, 20.153554502369673, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.420220466911545, 21.953554502369677, 20.153554502369676, 20.02022116903634, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.85355450216056, 20.02022116903634, 22.053553807023665, 21.05355450236966, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.153554502369666, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.120221167207582, 4.42022036823501, 20.586887835702917, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.920221169035788, 22.020221169036347, 21.95324655529245, 20.02022116903634, 21.586844286894742, 21.15355450236966, 21.153554502369662, 22.419598444346963, 22.020221169036347, 22.020221169036347, 21.086887835703003, 22.020221169036347, 16.58688783387459, 22.020221169036347, 20.820221168795516, 20.02022116903634, 20.086579888625774, 21.15355450236966, 22.020221169036347, 22.020221169036347, 20.45355450236966, 22.15354922208594, 21.153554500781738, 22.020221169036347, 21.020221169036326, 21.586887835702942, 21.920177620259782, 21.020221169036326, 22.020221169036347, 20.02022116903634, 20.820221063770113, 20.25355450236966, 22.020221169036347, 22.020221169036347, 21.95324655529245, 20.02022116903634, 21.186887835703, 21.586887835702942, 21.020221169036326, 22.020221169036347, 21.253554502369653, 21.286887140356985, 21.28688783549389, 22.020221169036347, 21.55355450236967, 20.92017762025976, 21.420221169036342, 21.220221169032175, 22.020221169036347, 22.020221169036347, 20.086579888625774, 21.020221169036326, 5.953554500540911, 20.586887835702917, 20.02022116903634, 20.02022116903634, 21.152931009801165, 21.686887833843087, 22.020221169036347, 21.65355450236551, 22.15355450236968, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 9, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7497030313677757, "mean_inference_ms": 1.2186670815301115, "mean_action_processing_ms": 0.10478739942725418, "mean_env_wait_ms": 29.632231401351238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007097959518432617, "StateBufferConnector_ms": 0.004756450653076172, "ViewRequirementAgentConnector_ms": 0.11603927612304688}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.416315846528292, "num_env_steps_trained_throughput_per_sec": 30.416315846528292, "timesteps_total": 40000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 66562.9, "sample_time_ms": 63377.369, "load_time_ms": 10.233, "load_throughput": 195454.361, "learn_time_ms": 3172.711, "learn_throughput": 630.376, "synch_weights_time_ms": 2.133}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 1677, "training_iteration": 20, "trial_id": "13850_00001", "date": "2023-12-28_18-09-42", "timestamp": 1703758182, "time_this_iter_s": 65.75883960723877, "time_total_s": 1332.9828345775604, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1332.9828345775604, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 55.99255319148936, "ram_util_percent": 92.65531914893621}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0052734375, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0381041551298564, "policy_loss": 0.004955810358126958, "vf_loss": 1.0331334056456885, "vf_explained_var": 0.008641286691029867, "kl": 0.002833261870225585, "entropy": 0.2836500270499123, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 9225.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "sampler_results": {"episode_reward_max": 22.286887835702515, "episode_reward_min": 4.720221155149216, "episode_reward_mean": 20.66782874985281, "episode_len_mean": 29.28, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.820221063770113, 20.25355450236966, 22.020221169036347, 22.020221169036347, 21.95324655529245, 20.02022116903634, 21.186887835703, 21.586887835702942, 21.020221169036326, 22.020221169036347, 21.253554502369653, 21.286887140356985, 21.28688783549389, 22.020221169036347, 21.55355450236967, 20.92017762025976, 21.420221169036342, 21.220221169032175, 22.020221169036347, 22.020221169036347, 20.086579888625774, 21.020221169036326, 5.953554500540911, 20.586887835702917, 20.02022116903634, 20.02022116903634, 21.152931009801165, 21.686887833843087, 22.020221169036347, 21.65355450236551, 22.15355450236968, 22.020221169036347, 21.420221169035774, 20.22022116903634, 22.286887835702515, 21.58688263362785, 20.02022116903634, 21.853286653402726, 21.08684773854781, 21.219913221958628, 21.8535543970993, 21.520221169036322, 21.020221169036326, 22.020221169036347, 20.619913221959084, 12.553554502369668, 8.68688783570293, 21.152931009801165, 20.920221169036267, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.15293100980118, 21.720221169036332, 21.153554502369662, 21.720221169036332, 22.153554502369676, 20.02022116903634, 21.153554502366042, 20.286887835702995, 21.55325183569409, 21.020177620259762, 22.020221169036347, 20.02022116903634, 4.720221155149216, 21.48688783570298, 21.48688783570298, 22.020221169036347, 20.02022116903634, 20.320221169036326, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.486881846713572, 22.020221169036347, 21.186887835703, 21.153554502369666, 22.020221169036347, 21.06902158958598, 20.02022116903634, 20.153554502369673, 22.020221169036347, 22.020221169036347, 21.153554502369662, 21.153554502369666, 21.15355450236966, 20.286887833905958, 21.753554502365496, 20.22022116903633, 20.02022116903634, 22.153554502369655, 22.15354922208594, 20.135996203329892, 20.486887835702994, 20.02022116903634, 21.853554502369672, 21.55355450236959], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 9, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7453112548173947, "mean_inference_ms": 1.218166069176504, "mean_action_processing_ms": 0.10474793166155719, "mean_env_wait_ms": 29.615981429384775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069599151611328125, "StateBufferConnector_ms": 0.004788875579833984, "ViewRequirementAgentConnector_ms": 0.11453700065612793}}, "episode_reward_max": 22.286887835702515, "episode_reward_min": 4.720221155149216, "episode_reward_mean": 20.66782874985281, "episode_len_mean": 29.28, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.820221063770113, 20.25355450236966, 22.020221169036347, 22.020221169036347, 21.95324655529245, 20.02022116903634, 21.186887835703, 21.586887835702942, 21.020221169036326, 22.020221169036347, 21.253554502369653, 21.286887140356985, 21.28688783549389, 22.020221169036347, 21.55355450236967, 20.92017762025976, 21.420221169036342, 21.220221169032175, 22.020221169036347, 22.020221169036347, 20.086579888625774, 21.020221169036326, 5.953554500540911, 20.586887835702917, 20.02022116903634, 20.02022116903634, 21.152931009801165, 21.686887833843087, 22.020221169036347, 21.65355450236551, 22.15355450236968, 22.020221169036347, 21.420221169035774, 20.22022116903634, 22.286887835702515, 21.58688263362785, 20.02022116903634, 21.853286653402726, 21.08684773854781, 21.219913221958628, 21.8535543970993, 21.520221169036322, 21.020221169036326, 22.020221169036347, 20.619913221959084, 12.553554502369668, 8.68688783570293, 21.152931009801165, 20.920221169036267, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.15293100980118, 21.720221169036332, 21.153554502369662, 21.720221169036332, 22.153554502369676, 20.02022116903634, 21.153554502366042, 20.286887835702995, 21.55325183569409, 21.020177620259762, 22.020221169036347, 20.02022116903634, 4.720221155149216, 21.48688783570298, 21.48688783570298, 22.020221169036347, 20.02022116903634, 20.320221169036326, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.486881846713572, 22.020221169036347, 21.186887835703, 21.153554502369666, 22.020221169036347, 21.06902158958598, 20.02022116903634, 20.153554502369673, 22.020221169036347, 22.020221169036347, 21.153554502369662, 21.153554502369666, 21.15355450236966, 20.286887833905958, 21.753554502365496, 20.22022116903633, 20.02022116903634, 22.153554502369655, 22.15354922208594, 20.135996203329892, 20.486887835702994, 20.02022116903634, 21.853554502369672, 21.55355450236959], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 9, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7453112548173947, "mean_inference_ms": 1.218166069176504, "mean_action_processing_ms": 0.10474793166155719, "mean_env_wait_ms": 29.615981429384775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069599151611328125, "StateBufferConnector_ms": 0.004788875579833984, "ViewRequirementAgentConnector_ms": 0.11453700065612793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.423347259020996, "num_env_steps_trained_throughput_per_sec": 30.423347259020996, "timesteps_total": 42000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 42000, "timers": {"training_iteration_time_ms": 66458.803, "sample_time_ms": 63279.312, "load_time_ms": 10.25, "load_throughput": 195119.755, "learn_time_ms": 3166.674, "learn_throughput": 631.577, "synch_weights_time_ms": 2.111}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "done": false, "episodes_total": 1745, "training_iteration": 21, "trial_id": "13850_00001", "date": "2023-12-28_18-10-48", "timestamp": 1703758248, "time_this_iter_s": 65.74353432655334, "time_total_s": 1398.7263689041138, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1398.7263689041138, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 55.99574468085107, "ram_util_percent": 92.72659574468086}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00263671875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8081636405156718, "policy_loss": 0.0008236444327566359, "vf_loss": 0.8073343154125744, "vf_explained_var": 0.17442282689942254, "kl": 0.002153474455940693, "entropy": 0.27258219487137264, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 9675.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 22.153554502369676, "episode_reward_min": 7.820221168767974, "episode_reward_mean": 20.572813381947423, "episode_len_mean": 29.45, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.48688783570298, 22.020221169036347, 20.02022116903634, 20.320221169036326, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.486881846713572, 22.020221169036347, 21.186887835703, 21.153554502369666, 22.020221169036347, 21.06902158958598, 20.02022116903634, 20.153554502369673, 22.020221169036347, 22.020221169036347, 21.153554502369662, 21.153554502369666, 21.15355450236966, 20.286887833905958, 21.753554502365496, 20.22022116903633, 20.02022116903634, 22.153554502369655, 22.15354922208594, 20.135996203329892, 20.486887835702994, 20.02022116903634, 21.853554502369672, 21.55355450236959, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.153554502369673, 20.720221169035774, 20.153554502369666, 10.12022115515319, 22.020221169036347, 20.153554502369673, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.553554502369654, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.72022116879551, 20.02022116903634, 20.153554502369673, 20.02022116903634, 22.153554502342136, 20.02022116903634, 20.186887835702997, 13.502662869996552, 20.02022116903634, 20.820221063770113, 20.02022116903634, 22.020221169036347, 20.153554502369666, 20.72022116903633, 21.753554500541274, 22.020221169036347, 21.720221168795536, 20.986264343134508, 22.020221169036347, 20.28658325636673, 20.153554502369676, 20.02022116903634, 20.92022115515329, 20.02022116903634, 20.151242298380893, 22.020221169036347, 21.586887835702942, 21.153548513380223, 20.02022116903634, 21.95324655529245, 21.153554502369662, 21.653554502369662, 22.153554502342136, 22.020221169036347, 22.153554502369676, 20.153554502369673, 22.153554502366045, 20.02022116903634, 7.820221168767974, 22.020221169036347, 20.02022116903634, 22.020221169036347, 14.135996203329888, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.153554502369676, 20.153549222085925, 22.020221169036347, 20.820221169036337, 20.02022116903634, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7416748916495078, "mean_inference_ms": 1.2178752005991578, "mean_action_processing_ms": 0.10473436202004315, "mean_env_wait_ms": 29.61232924178811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006958484649658203, "StateBufferConnector_ms": 0.004669904708862305, "ViewRequirementAgentConnector_ms": 0.11451101303100586}}, "episode_reward_max": 22.153554502369676, "episode_reward_min": 7.820221168767974, "episode_reward_mean": 20.572813381947423, "episode_len_mean": 29.45, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.48688783570298, 22.020221169036347, 20.02022116903634, 20.320221169036326, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.486881846713572, 22.020221169036347, 21.186887835703, 21.153554502369666, 22.020221169036347, 21.06902158958598, 20.02022116903634, 20.153554502369673, 22.020221169036347, 22.020221169036347, 21.153554502369662, 21.153554502369666, 21.15355450236966, 20.286887833905958, 21.753554502365496, 20.22022116903633, 20.02022116903634, 22.153554502369655, 22.15354922208594, 20.135996203329892, 20.486887835702994, 20.02022116903634, 21.853554502369672, 21.55355450236959, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.153554502369673, 20.720221169035774, 20.153554502369666, 10.12022115515319, 22.020221169036347, 20.153554502369673, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.553554502369654, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.72022116879551, 20.02022116903634, 20.153554502369673, 20.02022116903634, 22.153554502342136, 20.02022116903634, 20.186887835702997, 13.502662869996552, 20.02022116903634, 20.820221063770113, 20.02022116903634, 22.020221169036347, 20.153554502369666, 20.72022116903633, 21.753554500541274, 22.020221169036347, 21.720221168795536, 20.986264343134508, 22.020221169036347, 20.28658325636673, 20.153554502369676, 20.02022116903634, 20.92022115515329, 20.02022116903634, 20.151242298380893, 22.020221169036347, 21.586887835702942, 21.153548513380223, 20.02022116903634, 21.95324655529245, 21.153554502369662, 21.653554502369662, 22.153554502342136, 22.020221169036347, 22.153554502369676, 20.153554502369673, 22.153554502366045, 20.02022116903634, 7.820221168767974, 22.020221169036347, 20.02022116903634, 22.020221169036347, 14.135996203329888, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.153554502369676, 20.153549222085925, 22.020221169036347, 20.820221169036337, 20.02022116903634, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7416748916495078, "mean_inference_ms": 1.2178752005991578, "mean_action_processing_ms": 0.10473436202004315, "mean_env_wait_ms": 29.61232924178811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006958484649658203, "StateBufferConnector_ms": 0.004669904708862305, "ViewRequirementAgentConnector_ms": 0.11451101303100586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.0631684675014, "num_env_steps_trained_throughput_per_sec": 30.0631684675014, "timesteps_total": 44000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 66421.741, "sample_time_ms": 63241.129, "load_time_ms": 9.849, "load_throughput": 203072.201, "learn_time_ms": 3168.206, "learn_throughput": 631.272, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 1814, "training_iteration": 22, "trial_id": "13850_00001", "date": "2023-12-28_18-11-55", "timestamp": 1703758315, "time_this_iter_s": 66.531569480896, "time_total_s": 1465.2579383850098, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1465.2579383850098, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 55.81489361702128, "ram_util_percent": 92.73191489361699}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.001318359375, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7066029458694094, "policy_loss": 0.003305368191666073, "vf_loss": 0.7032938276727995, "vf_explained_var": 0.2893650970194075, "kl": 0.0028413701361192168, "entropy": 0.23609535853068034, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 10125.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 46000, "num_env_steps_trained": 46000, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 46000}, "sampler_results": {"episode_reward_max": 22.28688782364416, "episode_reward_min": 2.819551498228223, "episode_reward_mean": 20.419637360593764, "episode_len_mean": 29.11, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.153554502369676, 20.02022116903634, 20.92022115515329, 20.02022116903634, 20.151242298380893, 22.020221169036347, 21.586887835702942, 21.153548513380223, 20.02022116903634, 21.95324655529245, 21.153554502369662, 21.653554502369662, 22.153554502342136, 22.020221169036347, 22.153554502369676, 20.153554502369673, 22.153554502366045, 20.02022116903634, 7.820221168767974, 22.020221169036347, 20.02022116903634, 22.020221169036347, 14.135996203329888, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.153554502369676, 20.153549222085925, 22.020221169036347, 20.820221169036337, 20.02022116903634, 20.02022116903634, 20.753554502128846, 21.153554502369666, 21.020221169036326, 22.15355450236967, 21.586887835702992, 21.88657978335977, 20.120221169036334, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.786887835703002, 22.020221169036347, 22.15355450236968, 20.819916681268264, 2.819551498228223, 21.020221169036326, 21.220221169036336, 21.220221169036336, 22.020221169036347, 21.38688783569881, 22.15355380702367, 16.020221169036333, 21.020221169036326, 22.020221169036347, 21.586887835702992, 21.020221169036326, 21.853554502369672, 21.020221169036326, 22.020221169036347, 20.720221155153187, 20.02022116903634, 21.28688596558365, 21.386887835703007, 20.02022116903634, 22.020221169036347, 21.186887036678705, 21.020221169036326, 21.020221169036326, 21.62022116225748, 20.386887835698825, 20.353553703345387, 20.02022116903634, 20.286264343130885, 20.02022116903634, 21.820221169036337, 20.753554500541252, 21.020221169036326, 20.02022116903634, 21.020221169036326, 4.319591595382777, 20.02022116903634, 22.28688782364416, 20.086887835703003, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.02022116903634, 21.020221169036326, 21.38688783569881, 22.020221169036347, 22.020221169036347, 20.35124219311468, 20.420221167207924, 15.620215180046895, 20.75355450236967, 22.020221169036347, 20.886887833874596], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7382226125842304, "mean_inference_ms": 1.21748183226388, "mean_action_processing_ms": 0.10471333373625895, "mean_env_wait_ms": 29.604679248286374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006963014602661133, "StateBufferConnector_ms": 0.004755735397338867, "ViewRequirementAgentConnector_ms": 0.11429882049560547}}, "episode_reward_max": 22.28688782364416, "episode_reward_min": 2.819551498228223, "episode_reward_mean": 20.419637360593764, "episode_len_mean": 29.11, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.153554502369676, 20.02022116903634, 20.92022115515329, 20.02022116903634, 20.151242298380893, 22.020221169036347, 21.586887835702942, 21.153548513380223, 20.02022116903634, 21.95324655529245, 21.153554502369662, 21.653554502369662, 22.153554502342136, 22.020221169036347, 22.153554502369676, 20.153554502369673, 22.153554502366045, 20.02022116903634, 7.820221168767974, 22.020221169036347, 20.02022116903634, 22.020221169036347, 14.135996203329888, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.153554502369676, 20.153549222085925, 22.020221169036347, 20.820221169036337, 20.02022116903634, 20.02022116903634, 20.753554502128846, 21.153554502369666, 21.020221169036326, 22.15355450236967, 21.586887835702992, 21.88657978335977, 20.120221169036334, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.786887835703002, 22.020221169036347, 22.15355450236968, 20.819916681268264, 2.819551498228223, 21.020221169036326, 21.220221169036336, 21.220221169036336, 22.020221169036347, 21.38688783569881, 22.15355380702367, 16.020221169036333, 21.020221169036326, 22.020221169036347, 21.586887835702992, 21.020221169036326, 21.853554502369672, 21.020221169036326, 22.020221169036347, 20.720221155153187, 20.02022116903634, 21.28688596558365, 21.386887835703007, 20.02022116903634, 22.020221169036347, 21.186887036678705, 21.020221169036326, 21.020221169036326, 21.62022116225748, 20.386887835698825, 20.353553703345387, 20.02022116903634, 20.286264343130885, 20.02022116903634, 21.820221169036337, 20.753554500541252, 21.020221169036326, 20.02022116903634, 21.020221169036326, 4.319591595382777, 20.02022116903634, 22.28688782364416, 20.086887835703003, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.02022116903634, 21.020221169036326, 21.38688783569881, 22.020221169036347, 22.020221169036347, 20.35124219311468, 20.420221167207924, 15.620215180046895, 20.75355450236967, 22.020221169036347, 20.886887833874596], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7382226125842304, "mean_inference_ms": 1.21748183226388, "mean_action_processing_ms": 0.10471333373625895, "mean_env_wait_ms": 29.604679248286374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006963014602661133, "StateBufferConnector_ms": 0.004755735397338867, "ViewRequirementAgentConnector_ms": 0.11429882049560547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 46000, "num_env_steps_sampled": 46000, "num_env_steps_trained": 46000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.37603453309261, "num_env_steps_trained_throughput_per_sec": 30.37603453309261, "timesteps_total": 46000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 46000, "timers": {"training_iteration_time_ms": 66277.587, "sample_time_ms": 63096.624, "load_time_ms": 9.132, "load_throughput": 219003.694, "learn_time_ms": 3169.307, "learn_throughput": 631.053, "synch_weights_time_ms": 2.068}, "counters": {"num_env_steps_sampled": 46000, "num_env_steps_trained": 46000, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 46000}, "done": false, "episodes_total": 1882, "training_iteration": 23, "trial_id": "13850_00001", "date": "2023-12-28_18-13-00", "timestamp": 1703758380, "time_this_iter_s": 65.84614658355713, "time_total_s": 1531.104084968567, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1531.104084968567, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 55.97446808510638, "ram_util_percent": 92.81808510638292}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0006591796875, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0207079972110094, "policy_loss": 0.007782502654525969, "vf_loss": 1.0129244629542034, "vf_explained_var": 0.20600750592019823, "kl": 0.0015665567550003326, "entropy": 0.1843657527698411, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 10575.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 22.286887835703, "episode_reward_min": 4.319591595382777, "episode_reward_mean": 20.142473853638556, "episode_len_mean": 28.61, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.386887835698825, 20.353553703345387, 20.02022116903634, 20.286264343130885, 20.02022116903634, 21.820221169036337, 20.753554500541252, 21.020221169036326, 20.02022116903634, 21.020221169036326, 4.319591595382777, 20.02022116903634, 22.28688782364416, 20.086887835703003, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.02022116903634, 21.020221169036326, 21.38688783569881, 22.020221169036347, 22.020221169036347, 20.35124219311468, 20.420221167207924, 15.620215180046895, 20.75355450236967, 22.020221169036347, 20.886887833874596, 20.153554502369673, 22.28688783569938, 22.15355450236968, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.1512422983809, 21.752662640823353, 21.353553808556253, 17.4868877441348, 20.286887835703002, 22.286887835703, 20.02022116903634, 22.15355450236919, 13.420221169036331, 21.520221169036347, 21.953554502369677, 22.020221169036347, 20.153554502369676, 22.020221169036347, 22.020221169036347, 20.02022116903634, 15.120221167238812, 21.15355450236966, 22.020221169036347, 20.78688782181985, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 8.020221169035786, 7.620215180042722, 20.153514405215024, 21.020221169036326, 21.020221169036326, 22.15355449031131, 20.55355450236967, 7.420221169004621, 20.02022116903634, 22.020221169036347, 21.020221169036326, 21.08657988862576, 21.31932748628666, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.153554502369676, 21.020221169036326, 21.020221169036326, 21.020221169036326, 8.886887835702451, 21.020221169036326, 21.420221169035774, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.153554502369673, 21.020221169036326, 20.02022116903634, 22.020221169036347, 21.15355450236967, 21.020221169036326, 9.186887835702928, 22.15355450236967, 20.153514405215024, 22.15355450236968, 20.320221168795523, 22.020221169036347, 22.28688783570253], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 27, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 21, 30, 30, 30, 30, 30, 30, 30, 30, 13, 12, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7354105784574912, "mean_inference_ms": 1.2171023791360989, "mean_action_processing_ms": 0.10470020121449104, "mean_env_wait_ms": 29.599132181256874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007086515426635742, "StateBufferConnector_ms": 0.004838466644287109, "ViewRequirementAgentConnector_ms": 0.11469602584838867}}, "episode_reward_max": 22.286887835703, "episode_reward_min": 4.319591595382777, "episode_reward_mean": 20.142473853638556, "episode_len_mean": 28.61, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.386887835698825, 20.353553703345387, 20.02022116903634, 20.286264343130885, 20.02022116903634, 21.820221169036337, 20.753554500541252, 21.020221169036326, 20.02022116903634, 21.020221169036326, 4.319591595382777, 20.02022116903634, 22.28688782364416, 20.086887835703003, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.02022116903634, 21.020221169036326, 21.38688783569881, 22.020221169036347, 22.020221169036347, 20.35124219311468, 20.420221167207924, 15.620215180046895, 20.75355450236967, 22.020221169036347, 20.886887833874596, 20.153554502369673, 22.28688783569938, 22.15355450236968, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.1512422983809, 21.752662640823353, 21.353553808556253, 17.4868877441348, 20.286887835703002, 22.286887835703, 20.02022116903634, 22.15355450236919, 13.420221169036331, 21.520221169036347, 21.953554502369677, 22.020221169036347, 20.153554502369676, 22.020221169036347, 22.020221169036347, 20.02022116903634, 15.120221167238812, 21.15355450236966, 22.020221169036347, 20.78688782181985, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 8.020221169035786, 7.620215180042722, 20.153514405215024, 21.020221169036326, 21.020221169036326, 22.15355449031131, 20.55355450236967, 7.420221169004621, 20.02022116903634, 22.020221169036347, 21.020221169036326, 21.08657988862576, 21.31932748628666, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.153554502369676, 21.020221169036326, 21.020221169036326, 21.020221169036326, 8.886887835702451, 21.020221169036326, 21.420221169035774, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.153554502369673, 21.020221169036326, 20.02022116903634, 22.020221169036347, 21.15355450236967, 21.020221169036326, 9.186887835702928, 22.15355450236967, 20.153514405215024, 22.15355450236968, 20.320221168795523, 22.020221169036347, 22.28688783570253], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 27, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 21, 30, 30, 30, 30, 30, 30, 30, 30, 13, 12, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7354105784574912, "mean_inference_ms": 1.2171023791360989, "mean_action_processing_ms": 0.10470020121449104, "mean_env_wait_ms": 29.599132181256874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007086515426635742, "StateBufferConnector_ms": 0.004838466644287109, "ViewRequirementAgentConnector_ms": 0.11469602584838867}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.15301564286392, "num_env_steps_trained_throughput_per_sec": 30.15301564286392, "timesteps_total": 48000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 66335.17, "sample_time_ms": 63152.339, "load_time_ms": 8.437, "load_throughput": 237048.022, "learn_time_ms": 3171.887, "learn_throughput": 630.54, "synch_weights_time_ms": 2.059}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 1953, "training_iteration": 24, "trial_id": "13850_00001", "date": "2023-12-28_18-14-07", "timestamp": 1703758447, "time_this_iter_s": 66.33301997184753, "time_total_s": 1597.4371049404144, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1597.4371049404144, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 56.096808510638304, "ram_util_percent": 92.85425531914893}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00032958984375, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7054286802960107, "policy_loss": 0.005197572708129883, "vf_loss": 0.7002305531667339, "vf_explained_var": 0.5180550972620647, "kl": 0.001664265036339619, "entropy": 0.16268124994304445, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11025.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 50000}, "sampler_results": {"episode_reward_max": 22.28688783570253, "episode_reward_min": 8.020221169035786, "episode_reward_mean": 20.50919635684171, "episode_len_mean": 29.28, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.02022116903634, 22.020221169036347, 21.020221169036326, 21.08657988862576, 21.31932748628666, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.153554502369676, 21.020221169036326, 21.020221169036326, 21.020221169036326, 8.886887835702451, 21.020221169036326, 21.420221169035774, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.153554502369673, 21.020221169036326, 20.02022116903634, 22.020221169036347, 21.15355450236967, 21.020221169036326, 9.186887835702928, 22.15355450236967, 20.153514405215024, 22.15355450236968, 20.320221168795523, 22.020221169036347, 22.28688783570253, 21.020221169036326, 21.41959767646784, 21.986887835703012, 21.020221169036326, 22.020221169036347, 20.953246555292427, 20.02022116903634, 21.020221169036326, 22.020221169036347, 8.020221169035786, 22.020221169036347, 21.6202211690358, 21.020221169036326, 21.186887835703004, 20.02022116903634, 21.020221169036326, 19.386887835703007, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.620221169036327, 20.02022116903634, 21.15355450236919, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.153554410801462, 20.02022116903634, 21.586887835702942, 20.153554502369605, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.02022116903634, 22.020221169036347, 21.020221169036326, 14.020221169036336, 21.020221169036326, 20.02022116903634, 21.153554502369662, 21.020221169036326, 21.153554502369662, 22.153554502366045, 21.286887835703006, 22.020221169036347, 20.02022116903634, 21.1535545023696, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.08657988862576, 20.420221169036328, 20.78688782181985, 22.153554502342136, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326, 11.986887835703, 20.02022116903634, 20.353554502337957, 20.02022116903634, 21.286887835703, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.733185919569467, "mean_inference_ms": 1.2172336107832964, "mean_action_processing_ms": 0.10472531363970478, "mean_env_wait_ms": 29.602813131223883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007049560546875, "StateBufferConnector_ms": 0.004875898361206055, "ViewRequirementAgentConnector_ms": 0.1157691478729248}}, "episode_reward_max": 22.28688783570253, "episode_reward_min": 8.020221169035786, "episode_reward_mean": 20.50919635684171, "episode_len_mean": 29.28, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.02022116903634, 22.020221169036347, 21.020221169036326, 21.08657988862576, 21.31932748628666, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.153554502369676, 21.020221169036326, 21.020221169036326, 21.020221169036326, 8.886887835702451, 21.020221169036326, 21.420221169035774, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.153554502369673, 21.020221169036326, 20.02022116903634, 22.020221169036347, 21.15355450236967, 21.020221169036326, 9.186887835702928, 22.15355450236967, 20.153514405215024, 22.15355450236968, 20.320221168795523, 22.020221169036347, 22.28688783570253, 21.020221169036326, 21.41959767646784, 21.986887835703012, 21.020221169036326, 22.020221169036347, 20.953246555292427, 20.02022116903634, 21.020221169036326, 22.020221169036347, 8.020221169035786, 22.020221169036347, 21.6202211690358, 21.020221169036326, 21.186887835703004, 20.02022116903634, 21.020221169036326, 19.386887835703007, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.620221169036327, 20.02022116903634, 21.15355450236919, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.153554410801462, 20.02022116903634, 21.586887835702942, 20.153554502369605, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.02022116903634, 22.020221169036347, 21.020221169036326, 14.020221169036336, 21.020221169036326, 20.02022116903634, 21.153554502369662, 21.020221169036326, 21.153554502369662, 22.153554502366045, 21.286887835703006, 22.020221169036347, 20.02022116903634, 21.1535545023696, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.08657988862576, 20.420221169036328, 20.78688782181985, 22.153554502342136, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326, 11.986887835703, 20.02022116903634, 20.353554502337957, 20.02022116903634, 21.286887835703, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.733185919569467, "mean_inference_ms": 1.2172336107832964, "mean_action_processing_ms": 0.10472531363970478, "mean_env_wait_ms": 29.602813131223883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007049560546875, "StateBufferConnector_ms": 0.004875898361206055, "ViewRequirementAgentConnector_ms": 0.1157691478729248}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 50000, "num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.94137704832557, "num_env_steps_trained_throughput_per_sec": 29.94137704832557, "timesteps_total": 50000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 50000, "timers": {"training_iteration_time_ms": 66291.653, "sample_time_ms": 63105.214, "load_time_ms": 9.084, "load_throughput": 220165.926, "learn_time_ms": 3174.83, "learn_throughput": 629.955, "synch_weights_time_ms": 2.073}, "counters": {"num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 50000}, "done": false, "episodes_total": 2021, "training_iteration": 25, "trial_id": "13850_00001", "date": "2023-12-28_18-15-14", "timestamp": 1703758514, "time_this_iter_s": 66.80222940444946, "time_total_s": 1664.239334344864, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1664.239334344864, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 55.86666666666667, "ram_util_percent": 92.83124999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.000164794921875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.17626248569848638, "policy_loss": -0.019089548273219004, "vf_loss": 0.19535182706183857, "vf_explained_var": 0.8212983082400428, "kl": 0.0012674712116949225, "entropy": 0.15871801445881525, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11475.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 22.420221169036346, "episode_reward_min": 11.986887835703, "episode_reward_mean": 20.849878159935287, "episode_len_mean": 29.78, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.020221169036326, 20.02022116903634, 22.020221169036347, 21.020221169036326, 14.020221169036336, 21.020221169036326, 20.02022116903634, 21.153554502369662, 21.020221169036326, 21.153554502369662, 22.153554502366045, 21.286887835703006, 22.020221169036347, 20.02022116903634, 21.1535545023696, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.08657988862576, 20.420221169036328, 20.78688782181985, 22.153554502342136, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326, 11.986887835703, 20.02022116903634, 20.353554502337957, 20.02022116903634, 21.286887835703, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.15355450236967, 21.32022037001204, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.15355380702366, 21.020221169036326, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.420221169036346, 20.02022116903634, 21.020221169036326, 22.153514405215034, 21.020221169036326, 20.02022116903634, 21.020221169036326, 21.153554502369662, 20.28688783411459, 22.020221169036347, 22.15355380702367, 20.02022116903634, 20.153549222085925, 22.15355450236967, 21.020221169036326, 21.020221169036326, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.153554502369666, 21.420221169036342, 20.02022116903634, 21.686887835702997, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.153554502369662, 20.02022116903634, 21.020221169036326, 21.686276575639415, 20.02022116903634, 21.15355380702366, 21.020221169036326, 20.02022116903634, 20.686887835703004, 21.15355450234213, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.15355450236967, 21.153554502369662, 20.153554410801462], "episode_lengths": [30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7306669912592486, "mean_inference_ms": 1.2176111826585672, "mean_action_processing_ms": 0.10476624281599566, "mean_env_wait_ms": 29.610325194481494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00702214241027832, "StateBufferConnector_ms": 0.004766702651977539, "ViewRequirementAgentConnector_ms": 0.11653280258178711}}, "episode_reward_max": 22.420221169036346, "episode_reward_min": 11.986887835703, "episode_reward_mean": 20.849878159935287, "episode_len_mean": 29.78, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.020221169036326, 20.02022116903634, 22.020221169036347, 21.020221169036326, 14.020221169036336, 21.020221169036326, 20.02022116903634, 21.153554502369662, 21.020221169036326, 21.153554502369662, 22.153554502366045, 21.286887835703006, 22.020221169036347, 20.02022116903634, 21.1535545023696, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.08657988862576, 20.420221169036328, 20.78688782181985, 22.153554502342136, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326, 11.986887835703, 20.02022116903634, 20.353554502337957, 20.02022116903634, 21.286887835703, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.15355450236967, 21.32022037001204, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.15355380702366, 21.020221169036326, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.420221169036346, 20.02022116903634, 21.020221169036326, 22.153514405215034, 21.020221169036326, 20.02022116903634, 21.020221169036326, 21.153554502369662, 20.28688783411459, 22.020221169036347, 22.15355380702367, 20.02022116903634, 20.153549222085925, 22.15355450236967, 21.020221169036326, 21.020221169036326, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.153554502369666, 21.420221169036342, 20.02022116903634, 21.686887835702997, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.153554502369662, 20.02022116903634, 21.020221169036326, 21.686276575639415, 20.02022116903634, 21.15355380702366, 21.020221169036326, 20.02022116903634, 20.686887835703004, 21.15355450234213, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.15355450236967, 21.153554502369662, 20.153554410801462], "episode_lengths": [30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7306669912592486, "mean_inference_ms": 1.2176111826585672, "mean_action_processing_ms": 0.10476624281599566, "mean_env_wait_ms": 29.610325194481494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00702214241027832, "StateBufferConnector_ms": 0.004766702651977539, "ViewRequirementAgentConnector_ms": 0.11653280258178711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.912122037604565, "num_env_steps_trained_throughput_per_sec": 29.912122037604565, "timesteps_total": 52000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 66400.923, "sample_time_ms": 63214.367, "load_time_ms": 10.066, "load_throughput": 198696.957, "learn_time_ms": 3173.952, "learn_throughput": 630.129, "synch_weights_time_ms": 2.088}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 2087, "training_iteration": 26, "trial_id": "13850_00001", "date": "2023-12-28_18-16-20", "timestamp": 1703758580, "time_this_iter_s": 66.86715078353882, "time_total_s": 1731.1064851284027, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1731.1064851284027, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 55.996842105263156, "ram_util_percent": 92.85368421052627}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.23974609375e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4794522584976059, "policy_loss": 0.005234911077552372, "vf_loss": 0.4742172696855333, "vf_explained_var": 0.6556331763002607, "kl": 0.0010681366088811887, "entropy": 0.16625741634103988, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11925.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "sampler_results": {"episode_reward_max": 22.15355450236968, "episode_reward_min": 6.020221169004622, "episode_reward_mean": 20.44836890209626, "episode_len_mean": 29.29, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.020221169036326, 21.020221169036326, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.153554502369666, 21.420221169036342, 20.02022116903634, 21.686887835702997, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.153554502369662, 20.02022116903634, 21.020221169036326, 21.686276575639415, 20.02022116903634, 21.15355380702366, 21.020221169036326, 20.02022116903634, 20.686887835703004, 21.15355450234213, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.15355450236967, 21.153554502369662, 20.153554410801462, 20.02022116903634, 22.020221169036347, 20.353554502337957, 21.153554502160556, 22.15355450236967, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.02022116903634, 20.153554502369676, 22.020221169036347, 22.020221169036347, 20.153554502160556, 22.020221169036347, 22.020221169036347, 22.020221169036347, 11.353554502369668, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.753554500541274, 20.02022116903634, 21.020221169036326, 21.286847043202343, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.12022106358103, 20.686887140356983, 20.153554502369676, 20.153554502366045, 22.153554502369676, 22.15355449031131, 21.95324655529245, 22.020221169036347, 21.135996203329878, 20.02022116903634, 20.15355450078173, 22.020221169036347, 21.15355450236919, 22.020221169036347, 6.020221169004622, 7.420221169004621, 20.153514405215024, 20.02022116903634, 22.020221169036347, 22.020221169036347, 6.686887835462177, 20.25355448848653, 21.020221169036326, 20.153554502369673, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.153554502369662, 21.020221169036326, 21.153554490311304, 20.02022116903634, 22.15355450236968, 20.02022116903634, 20.586887835702917, 20.02022116903634, 20.15355450078173, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 11, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7281840642894489, "mean_inference_ms": 1.217497322173397, "mean_action_processing_ms": 0.10475524266927667, "mean_env_wait_ms": 29.608458926033254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006930828094482422, "StateBufferConnector_ms": 0.004715681076049805, "ViewRequirementAgentConnector_ms": 0.11481523513793945}}, "episode_reward_max": 22.15355450236968, "episode_reward_min": 6.020221169004622, "episode_reward_mean": 20.44836890209626, "episode_len_mean": 29.29, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.020221169036326, 21.020221169036326, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.153554502369666, 21.420221169036342, 20.02022116903634, 21.686887835702997, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.153554502369662, 20.02022116903634, 21.020221169036326, 21.686276575639415, 20.02022116903634, 21.15355380702366, 21.020221169036326, 20.02022116903634, 20.686887835703004, 21.15355450234213, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.15355450236967, 21.153554502369662, 20.153554410801462, 20.02022116903634, 22.020221169036347, 20.353554502337957, 21.153554502160556, 22.15355450236967, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.02022116903634, 20.153554502369676, 22.020221169036347, 22.020221169036347, 20.153554502160556, 22.020221169036347, 22.020221169036347, 22.020221169036347, 11.353554502369668, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.753554500541274, 20.02022116903634, 21.020221169036326, 21.286847043202343, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.12022106358103, 20.686887140356983, 20.153554502369676, 20.153554502366045, 22.153554502369676, 22.15355449031131, 21.95324655529245, 22.020221169036347, 21.135996203329878, 20.02022116903634, 20.15355450078173, 22.020221169036347, 21.15355450236919, 22.020221169036347, 6.020221169004622, 7.420221169004621, 20.153514405215024, 20.02022116903634, 22.020221169036347, 22.020221169036347, 6.686887835462177, 20.25355448848653, 21.020221169036326, 20.153554502369673, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.153554502369662, 21.020221169036326, 21.153554490311304, 20.02022116903634, 22.15355450236968, 20.02022116903634, 20.586887835702917, 20.02022116903634, 20.15355450078173, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 11, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7281840642894489, "mean_inference_ms": 1.217497322173397, "mean_action_processing_ms": 0.10475524266927667, "mean_env_wait_ms": 29.608458926033254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006930828094482422, "StateBufferConnector_ms": 0.004715681076049805, "ViewRequirementAgentConnector_ms": 0.11481523513793945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.25618832977953, "num_env_steps_trained_throughput_per_sec": 30.25618832977953, "timesteps_total": 54000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 66294.802, "sample_time_ms": 63105.681, "load_time_ms": 9.944, "load_throughput": 201129.003, "learn_time_ms": 3176.65, "learn_throughput": 629.594, "synch_weights_time_ms": 2.08}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "done": false, "episodes_total": 2156, "training_iteration": 27, "trial_id": "13850_00001", "date": "2023-12-28_18-17-27", "timestamp": 1703758647, "time_this_iter_s": 66.10698080062866, "time_total_s": 1797.2134659290314, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1797.2134659290314, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 56.18723404255319, "ram_util_percent": 92.74042553191488}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.119873046875e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5361632864007131, "policy_loss": 0.0029204681515693663, "vf_loss": 0.5332427585952811, "vf_explained_var": 0.6350498218006558, "kl": 0.0015069553608134968, "entropy": 0.1967232291566001, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 12375.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 22.286887835703002, "episode_reward_min": 4.486887730247683, "episode_reward_mean": 20.347503941142044, "episode_len_mean": 29.13, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.15355449031131, 21.95324655529245, 22.020221169036347, 21.135996203329878, 20.02022116903634, 20.15355450078173, 22.020221169036347, 21.15355450236919, 22.020221169036347, 6.020221169004622, 7.420221169004621, 20.153514405215024, 20.02022116903634, 22.020221169036347, 22.020221169036347, 6.686887835462177, 20.25355448848653, 21.020221169036326, 20.153554502369673, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.153554502369662, 21.020221169036326, 21.153554490311304, 20.02022116903634, 22.15355450236968, 20.02022116903634, 20.586887835702917, 20.02022116903634, 20.15355450078173, 22.020221169036347, 20.02022116903634, 21.020221169036326, 16.886887835702996, 21.953554502369677, 22.020221169036347, 21.15355450236967, 20.02022116903634, 21.15355450236967, 20.02022116903634, 20.78688782181985, 20.02022116903634, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.02022116903634, 20.520221169036326, 20.02022116903634, 21.153554502369662, 20.286887833905958, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 21.020221169036326, 4.486887730247683, 20.25355450236966, 20.41760447725195, 20.02022116903634, 21.020221169036326, 20.153554502369676, 22.286887835703002, 20.28688783570301, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.1359962033299, 22.020221169036347, 20.02022116903634, 21.15355450236966, 22.020221169036347, 21.65355450236551, 20.153554502369673, 20.02022116903634, 21.020221169036326, 22.153554502369666, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.653554502369673, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.15355450236966, 21.020221169036326, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.186887835699377, 20.02022116903634, 21.08657988862576, 20.72022116879551, 22.020221169036347, 22.020221169036347, 20.28688782364464], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 11, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7258450335848439, "mean_inference_ms": 1.2171428355976848, "mean_action_processing_ms": 0.10472800063809869, "mean_env_wait_ms": 29.60277532237681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00729060173034668, "StateBufferConnector_ms": 0.004698753356933594, "ViewRequirementAgentConnector_ms": 0.11437273025512695}}, "episode_reward_max": 22.286887835703002, "episode_reward_min": 4.486887730247683, "episode_reward_mean": 20.347503941142044, "episode_len_mean": 29.13, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.15355449031131, 21.95324655529245, 22.020221169036347, 21.135996203329878, 20.02022116903634, 20.15355450078173, 22.020221169036347, 21.15355450236919, 22.020221169036347, 6.020221169004622, 7.420221169004621, 20.153514405215024, 20.02022116903634, 22.020221169036347, 22.020221169036347, 6.686887835462177, 20.25355448848653, 21.020221169036326, 20.153554502369673, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.153554502369662, 21.020221169036326, 21.153554490311304, 20.02022116903634, 22.15355450236968, 20.02022116903634, 20.586887835702917, 20.02022116903634, 20.15355450078173, 22.020221169036347, 20.02022116903634, 21.020221169036326, 16.886887835702996, 21.953554502369677, 22.020221169036347, 21.15355450236967, 20.02022116903634, 21.15355450236967, 20.02022116903634, 20.78688782181985, 20.02022116903634, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.02022116903634, 20.520221169036326, 20.02022116903634, 21.153554502369662, 20.286887833905958, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 21.020221169036326, 4.486887730247683, 20.25355450236966, 20.41760447725195, 20.02022116903634, 21.020221169036326, 20.153554502369676, 22.286887835703002, 20.28688783570301, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.1359962033299, 22.020221169036347, 20.02022116903634, 21.15355450236966, 22.020221169036347, 21.65355450236551, 20.153554502369673, 20.02022116903634, 21.020221169036326, 22.153554502369666, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.653554502369673, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.15355450236966, 21.020221169036326, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.186887835699377, 20.02022116903634, 21.08657988862576, 20.72022116879551, 22.020221169036347, 22.020221169036347, 20.28688782364464], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 11, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7258450335848439, "mean_inference_ms": 1.2171428355976848, "mean_action_processing_ms": 0.10472800063809869, "mean_env_wait_ms": 29.60277532237681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00729060173034668, "StateBufferConnector_ms": 0.004698753356933594, "ViewRequirementAgentConnector_ms": 0.11437273025512695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.250638522408565, "num_env_steps_trained_throughput_per_sec": 30.250638522408565, "timesteps_total": 56000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 66208.692, "sample_time_ms": 63016.319, "load_time_ms": 9.009, "load_throughput": 221991.32, "learn_time_ms": 3180.814, "learn_throughput": 628.77, "synch_weights_time_ms": 2.096}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 2224, "training_iteration": 28, "trial_id": "13850_00001", "date": "2023-12-28_18-18-33", "timestamp": 1703758713, "time_this_iter_s": 66.1189923286438, "time_total_s": 1863.3324582576752, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1863.3324582576752, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 56.15212765957448, "ram_util_percent": 92.48510638297873}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0599365234375e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9362591867911396, "policy_loss": -0.04179937627580431, "vf_loss": 0.9780585409452518, "vf_explained_var": 0.5308935770723555, "kl": 0.0016885358102275679, "entropy": 0.17332373099194634, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 12825.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 58000, "num_env_steps_trained": 58000, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 58000}, "sampler_results": {"episode_reward_max": 22.28688783570253, "episode_reward_min": 11.353554502369668, "episode_reward_mean": 20.733506621249088, "episode_len_mean": 29.56, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.02022116903634, 22.020221169036347, 22.1359962033299, 22.020221169036347, 20.02022116903634, 21.15355450236966, 22.020221169036347, 21.65355450236551, 20.153554502369673, 20.02022116903634, 21.020221169036326, 22.153554502369666, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.653554502369673, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.15355450236966, 21.020221169036326, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.186887835699377, 20.02022116903634, 21.08657988862576, 20.72022116879551, 22.020221169036347, 22.020221169036347, 20.28688782364464, 21.22022116903634, 21.020221169036326, 16.953554502369673, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.420221169036328, 16.3535545023696, 21.15355450236966, 20.153554502369673, 20.386887835702993, 20.92022116903633, 21.686887835671303, 22.020221169036347, 20.02022116903634, 21.686887835702997, 20.02022116903634, 22.020221169036347, 21.286847738547877, 20.269329536663218, 11.353554502369668, 22.020221169036347, 21.020221169036326, 20.02022116903634, 22.020221169036347, 14.153514405215022, 21.020221169036326, 20.586887835702996, 22.15355450078174, 18.420221169036342, 22.1512422983809, 20.55355450236967, 22.020221169036347, 21.05355450236966, 20.02022116903634, 20.02022116903634, 20.386887835702993, 20.02022116903634, 22.020221169036347, 21.6202211690358, 20.1532500146016, 21.020221169036326, 20.153554502369673, 21.020221169036326, 21.55355450236967, 22.020221169036347, 22.28688783570253, 21.153554502369662, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.153554502369676, 21.020221169036326, 21.15355450234213, 20.15355450236967, 20.286887835703006, 20.02022116903634, 20.02022116903634, 21.153554502366042, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.153554502369676, 20.02022116903634, 21.28688783570299, 21.453554502369677, 21.15355450236966, 17.786887835493893], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 24, 30, 30, 30, 30, 23, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 20, 30, 30, 30, 26, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7238486351385276, "mean_inference_ms": 1.2174053847112563, "mean_action_processing_ms": 0.10474961959631882, "mean_env_wait_ms": 29.60751576571032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007086992263793945, "StateBufferConnector_ms": 0.004716396331787109, "ViewRequirementAgentConnector_ms": 0.11588335037231445}}, "episode_reward_max": 22.28688783570253, "episode_reward_min": 11.353554502369668, "episode_reward_mean": 20.733506621249088, "episode_len_mean": 29.56, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.02022116903634, 22.020221169036347, 22.1359962033299, 22.020221169036347, 20.02022116903634, 21.15355450236966, 22.020221169036347, 21.65355450236551, 20.153554502369673, 20.02022116903634, 21.020221169036326, 22.153554502369666, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.653554502369673, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.15355450236966, 21.020221169036326, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.186887835699377, 20.02022116903634, 21.08657988862576, 20.72022116879551, 22.020221169036347, 22.020221169036347, 20.28688782364464, 21.22022116903634, 21.020221169036326, 16.953554502369673, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.420221169036328, 16.3535545023696, 21.15355450236966, 20.153554502369673, 20.386887835702993, 20.92022116903633, 21.686887835671303, 22.020221169036347, 20.02022116903634, 21.686887835702997, 20.02022116903634, 22.020221169036347, 21.286847738547877, 20.269329536663218, 11.353554502369668, 22.020221169036347, 21.020221169036326, 20.02022116903634, 22.020221169036347, 14.153514405215022, 21.020221169036326, 20.586887835702996, 22.15355450078174, 18.420221169036342, 22.1512422983809, 20.55355450236967, 22.020221169036347, 21.05355450236966, 20.02022116903634, 20.02022116903634, 20.386887835702993, 20.02022116903634, 22.020221169036347, 21.6202211690358, 20.1532500146016, 21.020221169036326, 20.153554502369673, 21.020221169036326, 21.55355450236967, 22.020221169036347, 22.28688783570253, 21.153554502369662, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.153554502369676, 21.020221169036326, 21.15355450234213, 20.15355450236967, 20.286887835703006, 20.02022116903634, 20.02022116903634, 21.153554502366042, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.153554502369676, 20.02022116903634, 21.28688783570299, 21.453554502369677, 21.15355450236966, 17.786887835493893], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 24, 30, 30, 30, 30, 23, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 20, 30, 30, 30, 26, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7238486351385276, "mean_inference_ms": 1.2174053847112563, "mean_action_processing_ms": 0.10474961959631882, "mean_env_wait_ms": 29.60751576571032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007086992263793945, "StateBufferConnector_ms": 0.004716396331787109, "ViewRequirementAgentConnector_ms": 0.11588335037231445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 58000, "num_env_steps_sampled": 58000, "num_env_steps_trained": 58000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.840918310821934, "num_env_steps_trained_throughput_per_sec": 29.840918310821934, "timesteps_total": 58000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 58000, "timers": {"training_iteration_time_ms": 66308.753, "sample_time_ms": 63113.349, "load_time_ms": 8.464, "load_throughput": 236291.495, "learn_time_ms": 3184.362, "learn_throughput": 628.069, "synch_weights_time_ms": 2.127}, "counters": {"num_env_steps_sampled": 58000, "num_env_steps_trained": 58000, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 58000}, "done": false, "episodes_total": 2292, "training_iteration": 29, "trial_id": "13850_00001", "date": "2023-12-28_18-19-40", "timestamp": 1703758780, "time_this_iter_s": 67.0271463394165, "time_total_s": 1930.3596045970917, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1930.3596045970917, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 55.89368421052631, "ram_util_percent": 92.44631578947369}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.02996826171875e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4521028693744706, "policy_loss": 0.0028956717583868237, "vf_loss": 0.44920718383457925, "vf_explained_var": 0.6596392440795898, "kl": 0.00164312587193312, "entropy": 0.17205099095900853, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 13275.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 22.28688783570299, "episode_reward_min": 3.353553701568343, "episode_reward_mean": 20.45600418326982, "episode_len_mean": 29.24, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.02022116903634, 22.020221169036347, 21.6202211690358, 20.1532500146016, 21.020221169036326, 20.153554502369673, 21.020221169036326, 21.55355450236967, 22.020221169036347, 22.28688783570253, 21.153554502369662, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.153554502369676, 21.020221169036326, 21.15355450234213, 20.15355450236967, 20.286887835703006, 20.02022116903634, 20.02022116903634, 21.153554502366042, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.153554502369676, 20.02022116903634, 21.28688783570299, 21.453554502369677, 21.15355450236966, 17.786887835493893, 20.320221168795523, 20.35355450236966, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.020221169036326, 4.486887730247683, 20.02022116903634, 22.28688783570299, 22.020221169036347, 21.020221169036326, 20.153554502369605, 22.020221169036347, 21.020221169036326, 3.353553701568343, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.15355450236966, 21.020221169036326, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.151242298380893, 22.020221169036347, 22.020221169036347, 20.153554502369676, 21.453554502128842, 20.153549222085925, 22.020221169036347, 18.935996203302356, 20.02022116903634, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.120221155149217, 20.752660819379166, 4.286887730247683, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.15355450236968, 20.02022116903634, 21.020221169036326, 20.82022116900461, 22.15355450236967, 20.153554502369193, 21.15355450236966, 21.65355450236551, 21.153554490311304, 21.020221169036326, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.153554410801462, 22.152931009801186, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.820221169036337, 20.28688783570301, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 6, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7221948247945648, "mean_inference_ms": 1.217764990637684, "mean_action_processing_ms": 0.10478738016362868, "mean_env_wait_ms": 29.61461754664555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007030487060546875, "StateBufferConnector_ms": 0.004826784133911133, "ViewRequirementAgentConnector_ms": 0.11636686325073242}}, "episode_reward_max": 22.28688783570299, "episode_reward_min": 3.353553701568343, "episode_reward_mean": 20.45600418326982, "episode_len_mean": 29.24, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.02022116903634, 22.020221169036347, 21.6202211690358, 20.1532500146016, 21.020221169036326, 20.153554502369673, 21.020221169036326, 21.55355450236967, 22.020221169036347, 22.28688783570253, 21.153554502369662, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.153554502369676, 21.020221169036326, 21.15355450234213, 20.15355450236967, 20.286887835703006, 20.02022116903634, 20.02022116903634, 21.153554502366042, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.153554502369676, 20.02022116903634, 21.28688783570299, 21.453554502369677, 21.15355450236966, 17.786887835493893, 20.320221168795523, 20.35355450236966, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.020221169036326, 4.486887730247683, 20.02022116903634, 22.28688783570299, 22.020221169036347, 21.020221169036326, 20.153554502369605, 22.020221169036347, 21.020221169036326, 3.353553701568343, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.15355450236966, 21.020221169036326, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.151242298380893, 22.020221169036347, 22.020221169036347, 20.153554502369676, 21.453554502128842, 20.153549222085925, 22.020221169036347, 18.935996203302356, 20.02022116903634, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.120221155149217, 20.752660819379166, 4.286887730247683, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.15355450236968, 20.02022116903634, 21.020221169036326, 20.82022116900461, 22.15355450236967, 20.153554502369193, 21.15355450236966, 21.65355450236551, 21.153554490311304, 21.020221169036326, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.153554410801462, 22.152931009801186, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.820221169036337, 20.28688783570301, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 6, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7221948247945648, "mean_inference_ms": 1.217764990637684, "mean_action_processing_ms": 0.10478738016362868, "mean_env_wait_ms": 29.61461754664555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007030487060546875, "StateBufferConnector_ms": 0.004826784133911133, "ViewRequirementAgentConnector_ms": 0.11636686325073242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.92245986056331, "num_env_steps_trained_throughput_per_sec": 29.92245986056331, "timesteps_total": 60000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 66417.277, "sample_time_ms": 63221.691, "load_time_ms": 8.486, "load_throughput": 235680.736, "learn_time_ms": 3184.52, "learn_throughput": 628.038, "synch_weights_time_ms": 2.126}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 2361, "training_iteration": 30, "trial_id": "13850_00001", "date": "2023-12-28_18-20-47", "timestamp": 1703758847, "time_this_iter_s": 66.84421610832214, "time_total_s": 1997.2038207054138, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1997.2038207054138, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 56.07395833333334, "ram_util_percent": 92.43541666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.14984130859375e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4215297633908793, "policy_loss": 0.0030513551086187364, "vf_loss": 0.41847840524382063, "vf_explained_var": 0.7023903302351634, "kl": 0.0016793739605443629, "entropy": 0.13980545898278554, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 13725.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 62000, "num_env_steps_trained": 62000, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 62000}, "sampler_results": {"episode_reward_max": 22.15355450236968, "episode_reward_min": 4.286887730247683, "episode_reward_mean": 20.658348104355447, "episode_len_mean": 29.39, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.120221155149217, 20.752660819379166, 4.286887730247683, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.15355450236968, 20.02022116903634, 21.020221169036326, 20.82022116900461, 22.15355450236967, 20.153554502369193, 21.15355450236966, 21.65355450236551, 21.153554490311304, 21.020221169036326, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.153554410801462, 22.152931009801186, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.820221169036337, 20.28688783570301, 20.02022116903634, 21.020221169036326, 21.52022106377012, 22.020221169036347, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.153554502366045, 21.020221169036326, 22.020221169036347, 22.15355450078174, 20.153554502369673, 21.153548513380223, 21.020221169036326, 21.020221169036326, 20.320221168795523, 21.020221169036326, 20.15293100980118, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.72022116903634, 20.02022116903634, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.135996203329892, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.052660819619994, 6.4202211535612825, 22.020221169036347, 21.62022116903634, 21.986887835703012, 20.286887835703006, 20.02022116903634, 22.020221169036347, 22.020221169036347, 7.486887835671289, 22.15355449031131, 21.15355450236967, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 21.753554502369667, 21.020221169036326, 20.886887835703, 22.020221169036347, 21.020221169036326, 21.15355450236966, 21.88688714006864, 21.020221169036326, 21.15351440521502, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.15355449031131, 20.153554502369666], "episode_lengths": [30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7205086379266803, "mean_inference_ms": 1.2177142012820328, "mean_action_processing_ms": 0.10479954994712795, "mean_env_wait_ms": 29.614286326998823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007067203521728516, "StateBufferConnector_ms": 0.004851341247558594, "ViewRequirementAgentConnector_ms": 0.11606192588806152}}, "episode_reward_max": 22.15355450236968, "episode_reward_min": 4.286887730247683, "episode_reward_mean": 20.658348104355447, "episode_len_mean": 29.39, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.120221155149217, 20.752660819379166, 4.286887730247683, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.15355450236968, 20.02022116903634, 21.020221169036326, 20.82022116900461, 22.15355450236967, 20.153554502369193, 21.15355450236966, 21.65355450236551, 21.153554490311304, 21.020221169036326, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.153554410801462, 22.152931009801186, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.820221169036337, 20.28688783570301, 20.02022116903634, 21.020221169036326, 21.52022106377012, 22.020221169036347, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.153554502366045, 21.020221169036326, 22.020221169036347, 22.15355450078174, 20.153554502369673, 21.153548513380223, 21.020221169036326, 21.020221169036326, 20.320221168795523, 21.020221169036326, 20.15293100980118, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.72022116903634, 20.02022116903634, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.135996203329892, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.052660819619994, 6.4202211535612825, 22.020221169036347, 21.62022116903634, 21.986887835703012, 20.286887835703006, 20.02022116903634, 22.020221169036347, 22.020221169036347, 7.486887835671289, 22.15355449031131, 21.15355450236967, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 21.753554502369667, 21.020221169036326, 20.886887835703, 22.020221169036347, 21.020221169036326, 21.15355450236966, 21.88688714006864, 21.020221169036326, 21.15351440521502, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.15355449031131, 20.153554502369666], "episode_lengths": [30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7205086379266803, "mean_inference_ms": 1.2177142012820328, "mean_action_processing_ms": 0.10479954994712795, "mean_env_wait_ms": 29.614286326998823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007067203521728516, "StateBufferConnector_ms": 0.004851341247558594, "ViewRequirementAgentConnector_ms": 0.11606192588806152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 62000, "num_env_steps_sampled": 62000, "num_env_steps_trained": 62000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.217387067072252, "num_env_steps_trained_throughput_per_sec": 30.217387067072252, "timesteps_total": 62000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 62000, "timers": {"training_iteration_time_ms": 66462.084, "sample_time_ms": 63266.93, "load_time_ms": 8.529, "load_throughput": 234493.547, "learn_time_ms": 3184.038, "learn_throughput": 628.133, "synch_weights_time_ms": 2.133}, "counters": {"num_env_steps_sampled": 62000, "num_env_steps_trained": 62000, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 62000}, "done": false, "episodes_total": 2429, "training_iteration": 31, "trial_id": "13850_00001", "date": "2023-12-28_18-21-53", "timestamp": 1703758913, "time_this_iter_s": 66.19251799583435, "time_total_s": 2063.396338701248, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2063.396338701248, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 55.88936170212765, "ram_util_percent": 92.38510638297868}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.574920654296875e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.43847684608565435, "policy_loss": -0.04884392980072234, "vf_loss": 0.48732076480156844, "vf_explained_var": 0.5937644342581431, "kl": 0.0013413409028821851, "entropy": 0.16507192376587126, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 22.15355449031131, "episode_reward_min": 7.486887835671289, "episode_reward_mean": 20.645205175799024, "episode_len_mean": 29.42, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.62022116903634, 21.986887835703012, 20.286887835703006, 20.02022116903634, 22.020221169036347, 22.020221169036347, 7.486887835671289, 22.15355449031131, 21.15355450236967, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 21.753554502369667, 21.020221169036326, 20.886887835703, 22.020221169036347, 21.020221169036326, 21.15355450236966, 21.88688714006864, 21.020221169036326, 21.15351440521502, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.15355449031131, 20.153554502369666, 22.020221169036347, 20.15355450078173, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.25355448848653, 21.586887835702942, 21.020221169036326, 20.420221063770125, 22.020221169036347, 22.152931009801186, 21.8866199853572, 21.020221169036326, 20.986887835702994, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.15355450078173, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.02022116903634, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.153554502369673, 20.55355450236967, 20.02022116903634, 20.153554502369673, 21.020221169036326, 20.02022116903634, 20.02022116903634, 9.353554502369668, 22.020221169036347, 20.55355450236965, 20.02022116903634, 22.020221169036347, 20.02022116903634, 20.752931009801177, 12.15355450236967, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.153554502160556, 20.02022116903634, 22.020221169036347, 20.75355450236967, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.120177620259774, 22.020221169036347, 21.020221169036326, 22.020221169036347, 10.020221169036335], "episode_lengths": [30, 30, 30, 30, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 15, 30, 30, 30, 30, 30, 30, 19, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7187223840100815, "mean_inference_ms": 1.2174123577932725, "mean_action_processing_ms": 0.10478422948613292, "mean_env_wait_ms": 29.608558703358348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069124698638916016, "StateBufferConnector_ms": 0.004884004592895508, "ViewRequirementAgentConnector_ms": 0.11529541015625}}, "episode_reward_max": 22.15355449031131, "episode_reward_min": 7.486887835671289, "episode_reward_mean": 20.645205175799024, "episode_len_mean": 29.42, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.62022116903634, 21.986887835703012, 20.286887835703006, 20.02022116903634, 22.020221169036347, 22.020221169036347, 7.486887835671289, 22.15355449031131, 21.15355450236967, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 21.753554502369667, 21.020221169036326, 20.886887835703, 22.020221169036347, 21.020221169036326, 21.15355450236966, 21.88688714006864, 21.020221169036326, 21.15351440521502, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.15355449031131, 20.153554502369666, 22.020221169036347, 20.15355450078173, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.25355448848653, 21.586887835702942, 21.020221169036326, 20.420221063770125, 22.020221169036347, 22.152931009801186, 21.8866199853572, 21.020221169036326, 20.986887835702994, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.15355450078173, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.02022116903634, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.153554502369673, 20.55355450236967, 20.02022116903634, 20.153554502369673, 21.020221169036326, 20.02022116903634, 20.02022116903634, 9.353554502369668, 22.020221169036347, 20.55355450236965, 20.02022116903634, 22.020221169036347, 20.02022116903634, 20.752931009801177, 12.15355450236967, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.153554502160556, 20.02022116903634, 22.020221169036347, 20.75355450236967, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.120177620259774, 22.020221169036347, 21.020221169036326, 22.020221169036347, 10.020221169036335], "episode_lengths": [30, 30, 30, 30, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 15, 30, 30, 30, 30, 30, 30, 19, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7187223840100815, "mean_inference_ms": 1.2174123577932725, "mean_action_processing_ms": 0.10478422948613292, "mean_env_wait_ms": 29.608558703358348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069124698638916016, "StateBufferConnector_ms": 0.004884004592895508, "ViewRequirementAgentConnector_ms": 0.11529541015625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.323586987658985, "num_env_steps_trained_throughput_per_sec": 30.323586987658985, "timesteps_total": 64000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 66404.952, "sample_time_ms": 63211.652, "load_time_ms": 9.898, "load_throughput": 202052.851, "learn_time_ms": 3180.816, "learn_throughput": 628.769, "synch_weights_time_ms": 2.132}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 2497, "training_iteration": 32, "trial_id": "13850_00001", "date": "2023-12-28_18-22-59", "timestamp": 1703758979, "time_this_iter_s": 65.96007966995239, "time_total_s": 2129.3564183712006, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2129.3564183712006, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 55.98617021276596, "ram_util_percent": 92.21808510638294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2874603271484376e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9453591712398661, "policy_loss": 0.010662071340613895, "vf_loss": 0.9346970996757349, "vf_explained_var": 0.5506051766872406, "kl": 0.0015163184516718145, "entropy": 0.14391090404656198, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 14625.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 66000, "num_env_steps_trained": 66000, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 66000}, "sampler_results": {"episode_reward_max": 22.15355380702367, "episode_reward_min": 9.353554502369668, "episode_reward_mean": 20.400012700002918, "episode_len_mean": 29.26, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.020221169036326, 20.02022116903634, 20.02022116903634, 9.353554502369668, 22.020221169036347, 20.55355450236965, 20.02022116903634, 22.020221169036347, 20.02022116903634, 20.752931009801177, 12.15355450236967, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.153554502160556, 20.02022116903634, 22.020221169036347, 20.75355450236967, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.120177620259774, 22.020221169036347, 21.020221169036326, 22.020221169036347, 10.020221169036335, 20.02022116903634, 21.020221169036326, 20.02022116903634, 20.02022116903634, 22.020221169036347, 21.486887835703012, 22.020221169036347, 21.6202211690358, 22.020221169036347, 20.02022116903634, 17.586887835702996, 21.253554488486518, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.15355450234213, 20.25355450236966, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.320221169008793, 21.020221169036326, 14.020221169036333, 22.15355380702367, 21.420220466911537, 21.020221169036326, 21.020221169036326, 21.153554502369666, 21.020221169036326, 20.75355450236967, 17.35355450236967, 22.020221169036347, 20.953246555292427, 20.02022116903634, 20.68688783567128, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.020221169036326, 16.020221169036333, 21.286887835702995, 20.02022116903634, 21.720221168795536, 10.267017332674442, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.220221169036336, 22.020221169036347], "episode_lengths": [30, 30, 30, 15, 30, 30, 30, 30, 30, 30, 19, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 26, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 27, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7170844916081314, "mean_inference_ms": 1.21718822289711, "mean_action_processing_ms": 0.10476876505683894, "mean_env_wait_ms": 29.604912785240657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007075309753417969, "StateBufferConnector_ms": 0.004700422286987305, "ViewRequirementAgentConnector_ms": 0.11531496047973633}}, "episode_reward_max": 22.15355380702367, "episode_reward_min": 9.353554502369668, "episode_reward_mean": 20.400012700002918, "episode_len_mean": 29.26, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.020221169036326, 20.02022116903634, 20.02022116903634, 9.353554502369668, 22.020221169036347, 20.55355450236965, 20.02022116903634, 22.020221169036347, 20.02022116903634, 20.752931009801177, 12.15355450236967, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.153554502160556, 20.02022116903634, 22.020221169036347, 20.75355450236967, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.120177620259774, 22.020221169036347, 21.020221169036326, 22.020221169036347, 10.020221169036335, 20.02022116903634, 21.020221169036326, 20.02022116903634, 20.02022116903634, 22.020221169036347, 21.486887835703012, 22.020221169036347, 21.6202211690358, 22.020221169036347, 20.02022116903634, 17.586887835702996, 21.253554488486518, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.15355450234213, 20.25355450236966, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.320221169008793, 21.020221169036326, 14.020221169036333, 22.15355380702367, 21.420220466911537, 21.020221169036326, 21.020221169036326, 21.153554502369666, 21.020221169036326, 20.75355450236967, 17.35355450236967, 22.020221169036347, 20.953246555292427, 20.02022116903634, 20.68688783567128, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.020221169036326, 16.020221169036333, 21.286887835702995, 20.02022116903634, 21.720221168795536, 10.267017332674442, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.220221169036336, 22.020221169036347], "episode_lengths": [30, 30, 30, 15, 30, 30, 30, 30, 30, 30, 19, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 26, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 27, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7170844916081314, "mean_inference_ms": 1.21718822289711, "mean_action_processing_ms": 0.10476876505683894, "mean_env_wait_ms": 29.604912785240657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007075309753417969, "StateBufferConnector_ms": 0.004700422286987305, "ViewRequirementAgentConnector_ms": 0.11531496047973633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 66000, "num_env_steps_sampled": 66000, "num_env_steps_trained": 66000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.19785958123882, "num_env_steps_trained_throughput_per_sec": 30.19785958123882, "timesteps_total": 66000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 66000, "timers": {"training_iteration_time_ms": 66443.8, "sample_time_ms": 63254.513, "load_time_ms": 9.453, "load_throughput": 211582.415, "learn_time_ms": 3177.235, "learn_throughput": 629.478, "synch_weights_time_ms": 2.138}, "counters": {"num_env_steps_sampled": 66000, "num_env_steps_trained": 66000, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 66000}, "done": false, "episodes_total": 2565, "training_iteration": 33, "trial_id": "13850_00001", "date": "2023-12-28_18-24-05", "timestamp": 1703759045, "time_this_iter_s": 66.23460292816162, "time_total_s": 2195.591021299362, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2195.591021299362, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 55.8191489361702, "ram_util_percent": 92.3053191489361}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.437301635742188e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.15399983507788015, "policy_loss": -0.0016628074521819751, "vf_loss": 0.15566263978473013, "vf_explained_var": 0.8694043405850729, "kl": 0.001150281131033718, "entropy": 0.15181511604123646, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15075.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 22.15355380702367, "episode_reward_min": 4.2202210635810165, "episode_reward_mean": 20.69401579465486, "episode_len_mean": 29.55, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.15355380702367, 21.420220466911537, 21.020221169036326, 21.020221169036326, 21.153554502369666, 21.020221169036326, 20.75355450236967, 17.35355450236967, 22.020221169036347, 20.953246555292427, 20.02022116903634, 20.68688783567128, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.020221169036326, 16.020221169036333, 21.286887835702995, 20.02022116903634, 21.720221168795536, 10.267017332674442, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.220221169036336, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.153554502369662, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.153554502369605, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.153554502369676, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.02022116903634, 20.02022116903634, 4.2202210635810165, 21.15355450236966, 21.153548513380223, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.920177620259782, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.153554502369666, 22.020221169036347, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.820221169036337, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.953246555292427, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 27, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7156928593301279, "mean_inference_ms": 1.2173226673052389, "mean_action_processing_ms": 0.10479559173046496, "mean_env_wait_ms": 29.611739127328498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007046222686767578, "StateBufferConnector_ms": 0.00475621223449707, "ViewRequirementAgentConnector_ms": 0.11556267738342285}}, "episode_reward_max": 22.15355380702367, "episode_reward_min": 4.2202210635810165, "episode_reward_mean": 20.69401579465486, "episode_len_mean": 29.55, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.15355380702367, 21.420220466911537, 21.020221169036326, 21.020221169036326, 21.153554502369666, 21.020221169036326, 20.75355450236967, 17.35355450236967, 22.020221169036347, 20.953246555292427, 20.02022116903634, 20.68688783567128, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.020221169036326, 16.020221169036333, 21.286887835702995, 20.02022116903634, 21.720221168795536, 10.267017332674442, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.220221169036336, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.153554502369662, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.153554502369605, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.153554502369676, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.02022116903634, 20.02022116903634, 4.2202210635810165, 21.15355450236966, 21.153548513380223, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.920177620259782, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.153554502369666, 22.020221169036347, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.820221169036337, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.953246555292427, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 27, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7156928593301279, "mean_inference_ms": 1.2173226673052389, "mean_action_processing_ms": 0.10479559173046496, "mean_env_wait_ms": 29.611739127328498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007046222686767578, "StateBufferConnector_ms": 0.00475621223449707, "ViewRequirementAgentConnector_ms": 0.11556267738342285}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.76302300344266, "num_env_steps_trained_throughput_per_sec": 29.76302300344266, "timesteps_total": 68000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 66530.712, "sample_time_ms": 63344.595, "load_time_ms": 9.492, "load_throughput": 210708.691, "learn_time_ms": 3174.024, "learn_throughput": 630.115, "synch_weights_time_ms": 2.144}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 2632, "training_iteration": 34, "trial_id": "13850_00001", "date": "2023-12-28_18-25-12", "timestamp": 1703759112, "time_this_iter_s": 67.20262837409973, "time_total_s": 2262.793649673462, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2262.793649673462, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 56.02708333333334, "ram_util_percent": 92.36354166666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.218650817871094e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.53379755556948, "policy_loss": -0.00015635440333022012, "vf_loss": 0.533953907986482, "vf_explained_var": 0.6605189167128669, "kl": 0.0014163004222602993, "entropy": 0.18206399159299003, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15525.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000}, "sampler_results": {"episode_reward_max": 22.15355450236968, "episode_reward_min": 2.4198304058739155, "episode_reward_mean": 20.67287100020962, "episode_len_mean": 29.49, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.020221169036347, 22.020221169036347, 22.020221169036347, 21.920177620259782, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.153554502369666, 22.020221169036347, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.820221169036337, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.953246555292427, 20.02022116903634, 20.02022116903634, 22.153554410801476, 20.15355450236966, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.153549222085925, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.02022116903634, 21.020221169036326, 21.353554502337943, 20.02022116903634, 20.553554502369668, 20.78688783567128, 22.020221169036347, 22.020221169036347, 20.186887835702997, 20.720221155153183, 20.45355450236966, 20.02022116903634, 21.020221169036326, 21.886881846713575, 20.02022116903634, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.02022116903634, 3.0202150879512706, 20.02022116903634, 21.020221169036326, 22.020221169036347, 20.02022116903634, 20.286887835702995, 20.02022116903634, 21.020221169036326, 22.15355450236968, 21.020221169036326, 2.4198304058739155, 20.02022116903634, 20.320221168795523, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.95324655529245, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.753554500541274, 21.020221169036326, 22.020221169036347, 21.586619986945102, 22.020221169036347, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.153250014601607, 21.020221169036326, 21.020221169036326, 21.153554502369666, 22.020221169036347, 20.02022116903634, 21.486844286926445, 20.02022116903634, 20.120221169036334, 22.15355450236967, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 4, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7143455764573204, "mean_inference_ms": 1.2172539826626767, "mean_action_processing_ms": 0.10478611110120628, "mean_env_wait_ms": 29.609284841170584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007022857666015625, "StateBufferConnector_ms": 0.0049364566802978516, "ViewRequirementAgentConnector_ms": 0.11544132232666016}}, "episode_reward_max": 22.15355450236968, "episode_reward_min": 2.4198304058739155, "episode_reward_mean": 20.67287100020962, "episode_len_mean": 29.49, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.020221169036347, 22.020221169036347, 22.020221169036347, 21.920177620259782, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.153554502369666, 22.020221169036347, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.820221169036337, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.953246555292427, 20.02022116903634, 20.02022116903634, 22.153554410801476, 20.15355450236966, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.153549222085925, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.02022116903634, 21.020221169036326, 21.353554502337943, 20.02022116903634, 20.553554502369668, 20.78688783567128, 22.020221169036347, 22.020221169036347, 20.186887835702997, 20.720221155153183, 20.45355450236966, 20.02022116903634, 21.020221169036326, 21.886881846713575, 20.02022116903634, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.02022116903634, 3.0202150879512706, 20.02022116903634, 21.020221169036326, 22.020221169036347, 20.02022116903634, 20.286887835702995, 20.02022116903634, 21.020221169036326, 22.15355450236968, 21.020221169036326, 2.4198304058739155, 20.02022116903634, 20.320221168795523, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.95324655529245, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.753554500541274, 21.020221169036326, 22.020221169036347, 21.586619986945102, 22.020221169036347, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.153250014601607, 21.020221169036326, 21.020221169036326, 21.153554502369666, 22.020221169036347, 20.02022116903634, 21.486844286926445, 20.02022116903634, 20.120221169036334, 22.15355450236967, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 4, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7143455764573204, "mean_inference_ms": 1.2172539826626767, "mean_action_processing_ms": 0.10478611110120628, "mean_env_wait_ms": 29.609284841170584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007022857666015625, "StateBufferConnector_ms": 0.0049364566802978516, "ViewRequirementAgentConnector_ms": 0.11544132232666016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000, "num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.38069385851705, "num_env_steps_trained_throughput_per_sec": 30.38069385851705, "timesteps_total": 70000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 70000, "timers": {"training_iteration_time_ms": 66434.12, "sample_time_ms": 63248.034, "load_time_ms": 8.799, "load_throughput": 227308.91, "learn_time_ms": 3174.703, "learn_throughput": 629.98, "synch_weights_time_ms": 2.134}, "counters": {"num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000}, "done": false, "episodes_total": 2701, "training_iteration": 35, "trial_id": "13850_00001", "date": "2023-12-28_18-26-18", "timestamp": 1703759178, "time_this_iter_s": 65.83595967292786, "time_total_s": 2328.6296093463898, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2328.6296093463898, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 55.988172043010756, "ram_util_percent": 92.32150537634402}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.609325408935547e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9096821293814314, "policy_loss": 0.008976916041639115, "vf_loss": 0.9007052129424281, "vf_explained_var": 0.549498408238093, "kl": 0.0011770949691066294, "entropy": 0.21761012530989118, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15975.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 22.15355450236968, "episode_reward_min": 2.4198304058739155, "episode_reward_mean": 20.5948422298666, "episode_len_mean": 29.42, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.020221169036326, 22.15355450236968, 21.020221169036326, 2.4198304058739155, 20.02022116903634, 20.320221168795523, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.95324655529245, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.753554500541274, 21.020221169036326, 22.020221169036347, 21.586619986945102, 22.020221169036347, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.153250014601607, 21.020221169036326, 21.020221169036326, 21.153554502369666, 22.020221169036347, 20.02022116903634, 21.486844286926445, 20.02022116903634, 20.120221169036334, 22.15355450236967, 20.02022116903634, 21.420221169036328, 20.02022116903634, 21.020221169036326, 22.020221169036347, 14.020221169036333, 21.020221169036326, 20.02022116903634, 20.120221169036334, 20.68688783567128, 20.953554502369663, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.020221169036326, 21.020221169036326, 16.22022116903634, 20.02022116903634, 21.553554502369657, 22.020221169036347, 18.92022116903633, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.985994152953335, 20.02022116903634, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.02022116903634, 21.020221169036326, 21.020221169036326, 20.45355450236966, 20.02022116903634, 21.020221169036326, 20.02022116903634, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.986887835703012, 22.1512422983809, 20.02022116903634, 21.153554502369666, 20.02022116903634, 20.186887835702997, 22.153514405215034, 22.020221169036347, 9.620221169036261, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.753554500541252, 20.55355450236965, 22.020221169036347, 21.020221169036326, 21.020221169036326, 21.286887835703002, 21.720221168795536, 20.68688783567128, 20.02022116903634, 20.153554502366045, 20.153554502369673], "episode_lengths": [30, 30, 30, 4, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7129020538450115, "mean_inference_ms": 1.2169923246864152, "mean_action_processing_ms": 0.10475305354154031, "mean_env_wait_ms": 29.603329234812225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006983518600463867, "StateBufferConnector_ms": 0.004879951477050781, "ViewRequirementAgentConnector_ms": 0.11777114868164062}}, "episode_reward_max": 22.15355450236968, "episode_reward_min": 2.4198304058739155, "episode_reward_mean": 20.5948422298666, "episode_len_mean": 29.42, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.020221169036326, 22.15355450236968, 21.020221169036326, 2.4198304058739155, 20.02022116903634, 20.320221168795523, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.95324655529245, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.753554500541274, 21.020221169036326, 22.020221169036347, 21.586619986945102, 22.020221169036347, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.153250014601607, 21.020221169036326, 21.020221169036326, 21.153554502369666, 22.020221169036347, 20.02022116903634, 21.486844286926445, 20.02022116903634, 20.120221169036334, 22.15355450236967, 20.02022116903634, 21.420221169036328, 20.02022116903634, 21.020221169036326, 22.020221169036347, 14.020221169036333, 21.020221169036326, 20.02022116903634, 20.120221169036334, 20.68688783567128, 20.953554502369663, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.020221169036326, 21.020221169036326, 16.22022116903634, 20.02022116903634, 21.553554502369657, 22.020221169036347, 18.92022116903633, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.985994152953335, 20.02022116903634, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.02022116903634, 21.020221169036326, 21.020221169036326, 20.45355450236966, 20.02022116903634, 21.020221169036326, 20.02022116903634, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.986887835703012, 22.1512422983809, 20.02022116903634, 21.153554502369666, 20.02022116903634, 20.186887835702997, 22.153514405215034, 22.020221169036347, 9.620221169036261, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.753554500541252, 20.55355450236965, 22.020221169036347, 21.020221169036326, 21.020221169036326, 21.286887835703002, 21.720221168795536, 20.68688783567128, 20.02022116903634, 20.153554502366045, 20.153554502369673], "episode_lengths": [30, 30, 30, 4, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7129020538450115, "mean_inference_ms": 1.2169923246864152, "mean_action_processing_ms": 0.10475305354154031, "mean_env_wait_ms": 29.603329234812225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006983518600463867, "StateBufferConnector_ms": 0.004879951477050781, "ViewRequirementAgentConnector_ms": 0.11777114868164062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.277090844782183, "num_env_steps_trained_throughput_per_sec": 30.277090844782183, "timesteps_total": 72000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 66353.523, "sample_time_ms": 63165.634, "load_time_ms": 9.292, "load_throughput": 215233.794, "learn_time_ms": 3176.032, "learn_throughput": 629.717, "synch_weights_time_ms": 2.116}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 2768, "training_iteration": 36, "trial_id": "13850_00001", "date": "2023-12-28_18-27-24", "timestamp": 1703759244, "time_this_iter_s": 66.06164407730103, "time_total_s": 2394.691253423691, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2394.691253423691, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 56.19255319148935, "ram_util_percent": 92.34893617021272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.046627044677735e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.41605599709967567, "policy_loss": 0.004747402874959839, "vf_loss": 0.4113085909105009, "vf_explained_var": 0.8599244666099548, "kl": 0.0015378040071974209, "entropy": 0.21518585940202078, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 16425.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 74000, "num_env_steps_trained": 74000, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 74000}, "sampler_results": {"episode_reward_max": 22.15355450236968, "episode_reward_min": 9.620221169036261, "episode_reward_mean": 20.772188273688315, "episode_len_mean": 29.76, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.02022116903634, 21.020221169036326, 20.02022116903634, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.986887835703012, 22.1512422983809, 20.02022116903634, 21.153554502369666, 20.02022116903634, 20.186887835702997, 22.153514405215034, 22.020221169036347, 9.620221169036261, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.753554500541252, 20.55355450236965, 22.020221169036347, 21.020221169036326, 21.020221169036326, 21.286887835703002, 21.720221168795536, 20.68688783567128, 20.02022116903634, 20.153554502366045, 20.153554502369673, 21.586887835702942, 22.153554502342136, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.02022116903634, 20.02022116903634, 21.453554502369677, 20.15355450236967, 21.020221169036326, 20.92017762025976, 22.020221169036347, 21.153554502369662, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.15355450236968, 20.153554502369676, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 22.020221169036347, 21.12022116903633, 21.020221169036326, 20.02022116903634, 21.020221169036326, 21.220221169036336, 21.020221169036326, 21.020221169036326, 20.153554502369676, 22.020221169036347, 20.02022116903634, 22.15355450236968, 14.020221169036333, 22.020221169036347, 20.086887835703003, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.15355450236967, 20.02022116903634, 21.420221169036328, 20.052660819619994, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.886887835703, 22.020221169036347, 22.15355450236967, 20.153554502369676, 22.020221169036347, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7114862007569098, "mean_inference_ms": 1.2169758313319559, "mean_action_processing_ms": 0.10474454511907597, "mean_env_wait_ms": 29.601272785573318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007022380828857422, "StateBufferConnector_ms": 0.0047223567962646484, "ViewRequirementAgentConnector_ms": 0.11522960662841797}}, "episode_reward_max": 22.15355450236968, "episode_reward_min": 9.620221169036261, "episode_reward_mean": 20.772188273688315, "episode_len_mean": 29.76, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.02022116903634, 21.020221169036326, 20.02022116903634, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.986887835703012, 22.1512422983809, 20.02022116903634, 21.153554502369666, 20.02022116903634, 20.186887835702997, 22.153514405215034, 22.020221169036347, 9.620221169036261, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.753554500541252, 20.55355450236965, 22.020221169036347, 21.020221169036326, 21.020221169036326, 21.286887835703002, 21.720221168795536, 20.68688783567128, 20.02022116903634, 20.153554502366045, 20.153554502369673, 21.586887835702942, 22.153554502342136, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.02022116903634, 20.02022116903634, 21.453554502369677, 20.15355450236967, 21.020221169036326, 20.92017762025976, 22.020221169036347, 21.153554502369662, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.15355450236968, 20.153554502369676, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 22.020221169036347, 21.12022116903633, 21.020221169036326, 20.02022116903634, 21.020221169036326, 21.220221169036336, 21.020221169036326, 21.020221169036326, 20.153554502369676, 22.020221169036347, 20.02022116903634, 22.15355450236968, 14.020221169036333, 22.020221169036347, 20.086887835703003, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.15355450236967, 20.02022116903634, 21.420221169036328, 20.052660819619994, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.886887835703, 22.020221169036347, 22.15355450236967, 20.153554502369676, 22.020221169036347, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7114862007569098, "mean_inference_ms": 1.2169758313319559, "mean_action_processing_ms": 0.10474454511907597, "mean_env_wait_ms": 29.601272785573318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007022380828857422, "StateBufferConnector_ms": 0.0047223567962646484, "ViewRequirementAgentConnector_ms": 0.11522960662841797}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 74000, "num_env_steps_sampled": 74000, "num_env_steps_trained": 74000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.112332901498448, "num_env_steps_trained_throughput_per_sec": 30.112332901498448, "timesteps_total": 74000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 74000, "timers": {"training_iteration_time_ms": 66385.102, "sample_time_ms": 63196.437, "load_time_ms": 9.788, "load_throughput": 204324.606, "learn_time_ms": 3176.262, "learn_throughput": 629.671, "synch_weights_time_ms": 2.164}, "counters": {"num_env_steps_sampled": 74000, "num_env_steps_trained": 74000, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 74000}, "done": false, "episodes_total": 2835, "training_iteration": 37, "trial_id": "13850_00001", "date": "2023-12-28_18-28-31", "timestamp": 1703759311, "time_this_iter_s": 66.42271184921265, "time_total_s": 2461.1139652729034, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2461.1139652729034, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 55.81052631578948, "ram_util_percent": 92.358947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.0233135223388675e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.618089017280274, "policy_loss": 0.004234637270371119, "vf_loss": 0.6138543803037868, "vf_explained_var": 0.6100222461753422, "kl": 0.0024843155141403353, "entropy": 0.18637143592039743, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 16875.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 22.286583347934933, "episode_reward_min": 7.786887835698825, "episode_reward_mean": 20.62053865747432, "episode_len_mean": 29.42, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.020221169036333, 22.020221169036347, 20.086887835703003, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.15355450236967, 20.02022116903634, 21.420221169036328, 20.052660819619994, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.886887835703, 22.020221169036347, 22.15355450236967, 20.153554502369676, 22.020221169036347, 20.02022116903634, 20.386887835702993, 19.053554502369664, 21.020221169036326, 22.020221169036347, 21.15355450236966, 21.020221169036326, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.153250014601607, 22.020221169036347, 21.020221169036326, 20.15355450236967, 21.020221169036326, 22.153554502160564, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.153554502369676, 7.786887835698825, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.78688782181985, 20.786844286894713, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.686887835703004, 21.15355450236966, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.05355450236966, 20.02022116903634, 20.153554502369676, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.02022116903634, 8.053554502369119, 10.686887835703002, 21.65355450236551, 22.020221169036347, 20.75351623403006, 21.6202211690358, 22.286583347934933, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326], "episode_lengths": [22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 28, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7102167907167923, "mean_inference_ms": 1.216861755513569, "mean_action_processing_ms": 0.10473946637458109, "mean_env_wait_ms": 29.595331325407106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006958723068237305, "StateBufferConnector_ms": 0.004790306091308594, "ViewRequirementAgentConnector_ms": 0.11491107940673828}}, "episode_reward_max": 22.286583347934933, "episode_reward_min": 7.786887835698825, "episode_reward_mean": 20.62053865747432, "episode_len_mean": 29.42, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.020221169036333, 22.020221169036347, 20.086887835703003, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.15355450236967, 20.02022116903634, 21.420221169036328, 20.052660819619994, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.886887835703, 22.020221169036347, 22.15355450236967, 20.153554502369676, 22.020221169036347, 20.02022116903634, 20.386887835702993, 19.053554502369664, 21.020221169036326, 22.020221169036347, 21.15355450236966, 21.020221169036326, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.153250014601607, 22.020221169036347, 21.020221169036326, 20.15355450236967, 21.020221169036326, 22.153554502160564, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.153554502369676, 7.786887835698825, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.78688782181985, 20.786844286894713, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.686887835703004, 21.15355450236966, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.05355450236966, 20.02022116903634, 20.153554502369676, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.02022116903634, 8.053554502369119, 10.686887835703002, 21.65355450236551, 22.020221169036347, 20.75351623403006, 21.6202211690358, 22.286583347934933, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326], "episode_lengths": [22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 28, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7102167907167923, "mean_inference_ms": 1.216861755513569, "mean_action_processing_ms": 0.10473946637458109, "mean_env_wait_ms": 29.595331325407106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006958723068237305, "StateBufferConnector_ms": 0.004790306091308594, "ViewRequirementAgentConnector_ms": 0.11491107940673828}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.423619464663982, "num_env_steps_trained_throughput_per_sec": 30.423619464663982, "timesteps_total": 76000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 66347.51, "sample_time_ms": 63163.535, "load_time_ms": 9.592, "load_throughput": 208510.012, "learn_time_ms": 3171.786, "learn_throughput": 630.559, "synch_weights_time_ms": 2.146}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 2904, "training_iteration": 38, "trial_id": "13850_00001", "date": "2023-12-28_18-29-36", "timestamp": 1703759376, "time_this_iter_s": 65.7431230545044, "time_total_s": 2526.857088327408, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2526.857088327408, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 55.91505376344087, "ram_util_percent": 92.405376344086}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0116567611694337e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5700753553999433, "policy_loss": 0.0012243035187323888, "vf_loss": 0.5688510547412766, "vf_explained_var": 0.7374806298149956, "kl": 0.002001739230890879, "entropy": 0.19351173420747123, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 17325.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 78000, "num_env_steps_trained": 78000, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 78000}, "sampler_results": {"episode_reward_max": 22.286583347934933, "episode_reward_min": 4.6201810579945715, "episode_reward_mean": 20.490166235240732, "episode_len_mean": 29.34, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.05355450236966, 20.02022116903634, 20.153554502369676, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.02022116903634, 8.053554502369119, 10.686887835703002, 21.65355450236551, 22.020221169036347, 20.75351623403006, 21.6202211690358, 22.286583347934933, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.1535545023696, 22.020221169036347, 4.6201810579945715, 22.020221169036347, 20.219913221959104, 20.02022116903634, 20.153554502369605, 21.653554502369662, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.286887744134795, 11.12022037001205, 20.786887835703006, 20.02022116903634, 20.25355448848653, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.153554502369673, 20.02022116903634, 21.020221169036326, 20.1532500146016, 21.020221169036326, 20.18599415295343, 20.02022116903634, 21.15355450236919, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.820221169036337, 22.020221169036347, 22.020221169036347, 21.086887835702996, 21.020221169036326, 20.85355450236967, 21.15351440521502, 22.020221169036347, 20.420220382122135, 20.153554502160556, 21.020221169036326, 20.02022116903634, 20.28684245826462, 20.85355450236967, 20.02022116903634, 22.020221169036347, 21.05266081961998, 20.42022116903634, 20.02022116903634, 20.35355450236966, 20.02022116903634, 20.553547739825714, 22.020221169036347, 20.1532500146016, 20.02022116903634, 20.153554410801462, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.120221169036334, 20.02022116903634, 22.020221169036347, 20.151242298380893], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7092708589794777, "mean_inference_ms": 1.217058943736083, "mean_action_processing_ms": 0.10475793973092382, "mean_env_wait_ms": 29.598235625150142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007158517837524414, "StateBufferConnector_ms": 0.0049190521240234375, "ViewRequirementAgentConnector_ms": 0.11648774147033691}}, "episode_reward_max": 22.286583347934933, "episode_reward_min": 4.6201810579945715, "episode_reward_mean": 20.490166235240732, "episode_len_mean": 29.34, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.05355450236966, 20.02022116903634, 20.153554502369676, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.02022116903634, 8.053554502369119, 10.686887835703002, 21.65355450236551, 22.020221169036347, 20.75351623403006, 21.6202211690358, 22.286583347934933, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.1535545023696, 22.020221169036347, 4.6201810579945715, 22.020221169036347, 20.219913221959104, 20.02022116903634, 20.153554502369605, 21.653554502369662, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.286887744134795, 11.12022037001205, 20.786887835703006, 20.02022116903634, 20.25355448848653, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.153554502369673, 20.02022116903634, 21.020221169036326, 20.1532500146016, 21.020221169036326, 20.18599415295343, 20.02022116903634, 21.15355450236919, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.820221169036337, 22.020221169036347, 22.020221169036347, 21.086887835702996, 21.020221169036326, 20.85355450236967, 21.15351440521502, 22.020221169036347, 20.420220382122135, 20.153554502160556, 21.020221169036326, 20.02022116903634, 20.28684245826462, 20.85355450236967, 20.02022116903634, 22.020221169036347, 21.05266081961998, 20.42022116903634, 20.02022116903634, 20.35355450236966, 20.02022116903634, 20.553547739825714, 22.020221169036347, 20.1532500146016, 20.02022116903634, 20.153554410801462, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.120221169036334, 20.02022116903634, 22.020221169036347, 20.151242298380893], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7092708589794777, "mean_inference_ms": 1.217058943736083, "mean_action_processing_ms": 0.10475793973092382, "mean_env_wait_ms": 29.598235625150142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007158517837524414, "StateBufferConnector_ms": 0.0049190521240234375, "ViewRequirementAgentConnector_ms": 0.11648774147033691}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 78000, "num_env_steps_sampled": 78000, "num_env_steps_trained": 78000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.82365118305632, "num_env_steps_trained_throughput_per_sec": 29.82365118305632, "timesteps_total": 78000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 78000, "timers": {"training_iteration_time_ms": 66351.391, "sample_time_ms": 63170.263, "load_time_ms": 9.622, "load_throughput": 207864.17, "learn_time_ms": 3168.929, "learn_throughput": 631.128, "synch_weights_time_ms": 2.127}, "counters": {"num_env_steps_sampled": 78000, "num_env_steps_trained": 78000, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 78000}, "done": false, "episodes_total": 2972, "training_iteration": 39, "trial_id": "13850_00001", "date": "2023-12-28_18-30-43", "timestamp": 1703759443, "time_this_iter_s": 67.06540822982788, "time_total_s": 2593.9224965572357, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2593.9224965572357, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 55.800000000000004, "ram_util_percent": 92.38437499999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0058283805847169e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8018276701702012, "policy_loss": 0.007018378625313441, "vf_loss": 0.7948092972321643, "vf_explained_var": 0.5618268456723955, "kl": 0.0019367292813934375, "entropy": 0.15298182752397324, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 17775.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 22.15355450236967, "episode_reward_min": 1.9310211293445556, "episode_reward_mean": 20.33292997366484, "episode_len_mean": 29.19, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.086887835702996, 21.020221169036326, 20.85355450236967, 21.15351440521502, 22.020221169036347, 20.420220382122135, 20.153554502160556, 21.020221169036326, 20.02022116903634, 20.28684245826462, 20.85355450236967, 20.02022116903634, 22.020221169036347, 21.05266081961998, 20.42022116903634, 20.02022116903634, 20.35355450236966, 20.02022116903634, 20.553547739825714, 22.020221169036347, 20.1532500146016, 20.02022116903634, 20.153554410801462, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.120221169036334, 20.02022116903634, 22.020221169036347, 20.151242298380893, 20.153554502369673, 20.02022116903634, 22.15355449031131, 20.02022116903634, 21.286887835703002, 8.68688783570293, 15.486887835703005, 20.320220369802936, 20.02022116903634, 21.020221169036326, 20.586887835703003, 20.02022116903634, 22.020221169036347, 20.15355450236967, 22.020221169036347, 20.02022116903634, 20.620221169036316, 22.020221169036347, 20.153554502369673, 21.153554502369662, 21.020221169036326, 20.45355450236966, 21.020221169036326, 22.020221169036347, 20.153554410801462, 21.152931009801165, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 1.9310211293445556, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.020221169036326, 21.020221169036326, 20.153553807023656, 21.020221169036326, 9.820221169036325, 21.020221169036326, 21.886887835703007, 21.153554502369662, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.02022116903634, 21.153554500781738, 22.15355450236967, 21.020221169036326, 14.020221169036336, 21.020221169036326, 20.153554502369676, 20.02022116903634, 20.153554502369676, 16.82022116903633, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.153514405215034, 20.02022116903634, 20.02022116903634, 21.020221169036326, 22.15354922208594, 20.151242298380893, 21.020221169036326, 22.020221169036347, 21.020221169036326], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 3, 30, 30, 30, 30, 30, 30, 30, 30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.708381152444473, "mean_inference_ms": 1.217331324702482, "mean_action_processing_ms": 0.10479090726109536, "mean_env_wait_ms": 29.60277406934376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007336854934692383, "StateBufferConnector_ms": 0.004787921905517578, "ViewRequirementAgentConnector_ms": 0.11669802665710449}}, "episode_reward_max": 22.15355450236967, "episode_reward_min": 1.9310211293445556, "episode_reward_mean": 20.33292997366484, "episode_len_mean": 29.19, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.086887835702996, 21.020221169036326, 20.85355450236967, 21.15351440521502, 22.020221169036347, 20.420220382122135, 20.153554502160556, 21.020221169036326, 20.02022116903634, 20.28684245826462, 20.85355450236967, 20.02022116903634, 22.020221169036347, 21.05266081961998, 20.42022116903634, 20.02022116903634, 20.35355450236966, 20.02022116903634, 20.553547739825714, 22.020221169036347, 20.1532500146016, 20.02022116903634, 20.153554410801462, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.120221169036334, 20.02022116903634, 22.020221169036347, 20.151242298380893, 20.153554502369673, 20.02022116903634, 22.15355449031131, 20.02022116903634, 21.286887835703002, 8.68688783570293, 15.486887835703005, 20.320220369802936, 20.02022116903634, 21.020221169036326, 20.586887835703003, 20.02022116903634, 22.020221169036347, 20.15355450236967, 22.020221169036347, 20.02022116903634, 20.620221169036316, 22.020221169036347, 20.153554502369673, 21.153554502369662, 21.020221169036326, 20.45355450236966, 21.020221169036326, 22.020221169036347, 20.153554410801462, 21.152931009801165, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 1.9310211293445556, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.020221169036326, 21.020221169036326, 20.153553807023656, 21.020221169036326, 9.820221169036325, 21.020221169036326, 21.886887835703007, 21.153554502369662, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.02022116903634, 21.153554500781738, 22.15355450236967, 21.020221169036326, 14.020221169036336, 21.020221169036326, 20.153554502369676, 20.02022116903634, 20.153554502369676, 16.82022116903633, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.153514405215034, 20.02022116903634, 20.02022116903634, 21.020221169036326, 22.15354922208594, 20.151242298380893, 21.020221169036326, 22.020221169036347, 21.020221169036326], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 3, 30, 30, 30, 30, 30, 30, 30, 30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.708381152444473, "mean_inference_ms": 1.217331324702482, "mean_action_processing_ms": 0.10479090726109536, "mean_env_wait_ms": 29.60277406934376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007336854934692383, "StateBufferConnector_ms": 0.004787921905517578, "ViewRequirementAgentConnector_ms": 0.11669802665710449}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.99516214674934, "num_env_steps_trained_throughput_per_sec": 29.99516214674934, "timesteps_total": 80000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 66335.191, "sample_time_ms": 63155.121, "load_time_ms": 10.343, "load_throughput": 193359.857, "learn_time_ms": 3167.158, "learn_throughput": 631.481, "synch_weights_time_ms": 2.122}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 3041, "training_iteration": 40, "trial_id": "13850_00001", "date": "2023-12-28_18-31-50", "timestamp": 1703759510, "time_this_iter_s": 66.68313026428223, "time_total_s": 2660.605626821518, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2660.605626821518, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 55.91263157894738, "ram_util_percent": 92.45157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.029141902923584e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7257368121381539, "policy_loss": 0.004647182027498881, "vf_loss": 0.7210896310086051, "vf_explained_var": 0.6433217329449124, "kl": 0.012751259769171004, "entropy": 0.24929068744182586, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 18225.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 82000, "num_env_steps_trained": 82000, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 82000}, "sampler_results": {"episode_reward_max": 22.553554502369675, "episode_reward_min": 6.686887835671289, "episode_reward_mean": 20.46665610738338, "episode_len_mean": 29.37, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.153553807023656, 21.020221169036326, 9.820221169036325, 21.020221169036326, 21.886887835703007, 21.153554502369662, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.02022116903634, 21.153554500781738, 22.15355450236967, 21.020221169036326, 14.020221169036336, 21.020221169036326, 20.153554502369676, 20.02022116903634, 20.153554502369676, 16.82022116903633, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.153514405215034, 20.02022116903634, 20.02022116903634, 21.020221169036326, 22.15354922208594, 20.151242298380893, 21.020221169036326, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.28688783567547, 20.02022116903634, 20.985994152953314, 20.386887835702993, 11.986887835703, 21.153548513380223, 20.02022116903634, 22.020221169036347, 20.135996203329892, 20.02022116903634, 21.020221169036326, 21.920177620259782, 22.020221169036347, 21.020221169036326, 20.02022116903634, 18.05355450236967, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.553554502369675, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.153553807023656, 22.020221169036347, 21.020221169036326, 21.38688783570253, 22.020221169036347, 19.353554502369672, 21.020221169036326, 20.151242298380893, 20.286887823644633, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.25355450236967, 20.02022116903634, 20.02022116903634, 22.020221169036347, 21.753554500541274, 20.02022116903634, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.020221169036326, 6.686887835671289, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.153554502342132, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.78688782181985, 21.820221063770134, 20.15355450078173, 21.020221169036326, 20.02022116903634, 22.020221169036347], "episode_lengths": [30, 30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 28, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7075676635594393, "mean_inference_ms": 1.2175842849925635, "mean_action_processing_ms": 0.10482576208679077, "mean_env_wait_ms": 29.607750904147366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007024526596069336, "StateBufferConnector_ms": 0.004873752593994141, "ViewRequirementAgentConnector_ms": 0.11665511131286621}}, "episode_reward_max": 22.553554502369675, "episode_reward_min": 6.686887835671289, "episode_reward_mean": 20.46665610738338, "episode_len_mean": 29.37, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.153553807023656, 21.020221169036326, 9.820221169036325, 21.020221169036326, 21.886887835703007, 21.153554502369662, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.02022116903634, 21.153554500781738, 22.15355450236967, 21.020221169036326, 14.020221169036336, 21.020221169036326, 20.153554502369676, 20.02022116903634, 20.153554502369676, 16.82022116903633, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.153514405215034, 20.02022116903634, 20.02022116903634, 21.020221169036326, 22.15354922208594, 20.151242298380893, 21.020221169036326, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.28688783567547, 20.02022116903634, 20.985994152953314, 20.386887835702993, 11.986887835703, 21.153548513380223, 20.02022116903634, 22.020221169036347, 20.135996203329892, 20.02022116903634, 21.020221169036326, 21.920177620259782, 22.020221169036347, 21.020221169036326, 20.02022116903634, 18.05355450236967, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.553554502369675, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.153553807023656, 22.020221169036347, 21.020221169036326, 21.38688783570253, 22.020221169036347, 19.353554502369672, 21.020221169036326, 20.151242298380893, 20.286887823644633, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.25355450236967, 20.02022116903634, 20.02022116903634, 22.020221169036347, 21.753554500541274, 20.02022116903634, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.020221169036326, 6.686887835671289, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.153554502342132, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.78688782181985, 21.820221063770134, 20.15355450078173, 21.020221169036326, 20.02022116903634, 22.020221169036347], "episode_lengths": [30, 30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 28, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7075676635594393, "mean_inference_ms": 1.2175842849925635, "mean_action_processing_ms": 0.10482576208679077, "mean_env_wait_ms": 29.607750904147366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007024526596069336, "StateBufferConnector_ms": 0.004873752593994141, "ViewRequirementAgentConnector_ms": 0.11665511131286621}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 82000, "num_env_steps_sampled": 82000, "num_env_steps_trained": 82000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.88421972418038, "num_env_steps_trained_throughput_per_sec": 29.88421972418038, "timesteps_total": 82000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 82000, "timers": {"training_iteration_time_ms": 66408.98, "sample_time_ms": 63227.068, "load_time_ms": 10.284, "load_throughput": 194472.449, "learn_time_ms": 3169.055, "learn_throughput": 631.103, "synch_weights_time_ms": 2.127}, "counters": {"num_env_steps_sampled": 82000, "num_env_steps_trained": 82000, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 82000}, "done": false, "episodes_total": 3109, "training_iteration": 41, "trial_id": "13850_00001", "date": "2023-12-28_18-32-57", "timestamp": 1703759577, "time_this_iter_s": 66.93039345741272, "time_total_s": 2727.5360202789307, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2727.5360202789307, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 56.01157894736843, "ram_util_percent": 92.44842105263156}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.029141902923584e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6124516941938135, "policy_loss": 0.004269081188572777, "vf_loss": 0.6081826083362103, "vf_explained_var": 0.8156061646673415, "kl": 0.0027814033284651145, "entropy": 0.3869623792171478, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 18675.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 22.28688783570301, "episode_reward_min": 6.135996203089065, "episode_reward_mean": 20.591817686216825, "episode_len_mean": 29.41, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.020221169036326, 20.151242298380893, 20.286887823644633, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.25355450236967, 20.02022116903634, 20.02022116903634, 22.020221169036347, 21.753554500541274, 20.02022116903634, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.020221169036326, 6.686887835671289, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.153554502342132, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.78688782181985, 21.820221063770134, 20.15355450078173, 21.020221169036326, 20.02022116903634, 22.020221169036347, 21.520182900697193, 21.020221169036326, 22.020221169036347, 20.669329536663202, 22.020221169036347, 20.153554502369673, 21.020221169036326, 22.28688783570301, 20.153554502366045, 20.42022116903634, 22.020221169036347, 22.15355449031131, 22.020221169036347, 20.53599620152922, 20.02022116903634, 6.135996203089065, 21.386887835703007, 20.02022116903634, 22.020221169036347, 20.420221169036346, 20.02022116903634, 20.02022116903634, 21.020221169036326, 22.020221169036347, 20.15355450236967, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.553554502369607, 20.02022116903634, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.28684773833924, 22.020221169036347, 21.020221169036326, 21.153554502366042, 20.153554502369673, 20.286887140357003, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.15355450078173, 21.020221169036326, 22.020221169036347, 21.120177620259764, 22.020221169036347, 20.1532500146016, 21.020221169036326, 21.020221169036326, 22.152931009801186, 21.020221169036326, 21.48688783570299, 10.15354922208593, 15.73595610617162, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.153554502369676, 21.020221169036326, 20.02022116903634, 22.153514405215034, 22.020221169036347, 22.15355450236968, 20.02022116903634, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 24, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7064770134582976, "mean_inference_ms": 1.2173768047231173, "mean_action_processing_ms": 0.1048139070670341, "mean_env_wait_ms": 29.602394364492067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007047176361083984, "StateBufferConnector_ms": 0.004907369613647461, "ViewRequirementAgentConnector_ms": 0.11445784568786621}}, "episode_reward_max": 22.28688783570301, "episode_reward_min": 6.135996203089065, "episode_reward_mean": 20.591817686216825, "episode_len_mean": 29.41, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.020221169036326, 20.151242298380893, 20.286887823644633, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.25355450236967, 20.02022116903634, 20.02022116903634, 22.020221169036347, 21.753554500541274, 20.02022116903634, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.020221169036326, 6.686887835671289, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.153554502342132, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.78688782181985, 21.820221063770134, 20.15355450078173, 21.020221169036326, 20.02022116903634, 22.020221169036347, 21.520182900697193, 21.020221169036326, 22.020221169036347, 20.669329536663202, 22.020221169036347, 20.153554502369673, 21.020221169036326, 22.28688783570301, 20.153554502366045, 20.42022116903634, 22.020221169036347, 22.15355449031131, 22.020221169036347, 20.53599620152922, 20.02022116903634, 6.135996203089065, 21.386887835703007, 20.02022116903634, 22.020221169036347, 20.420221169036346, 20.02022116903634, 20.02022116903634, 21.020221169036326, 22.020221169036347, 20.15355450236967, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.553554502369607, 20.02022116903634, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.28684773833924, 22.020221169036347, 21.020221169036326, 21.153554502366042, 20.153554502369673, 20.286887140357003, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.15355450078173, 21.020221169036326, 22.020221169036347, 21.120177620259764, 22.020221169036347, 20.1532500146016, 21.020221169036326, 21.020221169036326, 22.152931009801186, 21.020221169036326, 21.48688783570299, 10.15354922208593, 15.73595610617162, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.153554502369676, 21.020221169036326, 20.02022116903634, 22.153514405215034, 22.020221169036347, 22.15355450236968, 20.02022116903634, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 24, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7064770134582976, "mean_inference_ms": 1.2173768047231173, "mean_action_processing_ms": 0.1048139070670341, "mean_env_wait_ms": 29.602394364492067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007047176361083984, "StateBufferConnector_ms": 0.004907369613647461, "ViewRequirementAgentConnector_ms": 0.11445784568786621}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.553148999697644, "num_env_steps_trained_throughput_per_sec": 30.553148999697644, "timesteps_total": 84000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 66359.424, "sample_time_ms": 63177.749, "load_time_ms": 10.149, "load_throughput": 197062.784, "learn_time_ms": 3168.933, "learn_throughput": 631.127, "synch_weights_time_ms": 2.146}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 3177, "training_iteration": 42, "trial_id": "13850_00001", "date": "2023-12-28_18-34-03", "timestamp": 1703759643, "time_this_iter_s": 65.46489119529724, "time_total_s": 2793.000911474228, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2793.000911474228, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 55.77096774193548, "ram_util_percent": 92.3892473118279}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.514570951461792e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6081641960889101, "policy_loss": 0.0005478332771195306, "vf_loss": 0.6076163634119762, "vf_explained_var": 0.6506001243326399, "kl": 0.0038846710612695863, "entropy": 0.3941529353459676, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19125.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 86000, "num_env_steps_trained": 86000, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 86000}, "sampler_results": {"episode_reward_max": 22.420221169036346, "episode_reward_min": 1.8310211293445555, "episode_reward_mean": 20.68690520420863, "episode_len_mean": 29.31, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.153554502366042, 20.153554502369673, 20.286887140357003, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.15355450078173, 21.020221169036326, 22.020221169036347, 21.120177620259764, 22.020221169036347, 20.1532500146016, 21.020221169036326, 21.020221169036326, 22.152931009801186, 21.020221169036326, 21.48688783570299, 10.15354922208593, 15.73595610617162, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.153554502369676, 21.020221169036326, 20.02022116903634, 22.153514405215034, 22.020221169036347, 22.15355450236968, 20.02022116903634, 22.020221169036347, 20.153554502369673, 20.28457563150511, 21.920177620259782, 20.02022116903634, 21.820221169036337, 21.020221169036326, 21.020221169036326, 22.153554502369666, 21.453553703341743, 21.286887835703, 21.020221169036326, 21.153554502369666, 20.2868877441348, 20.35355450236966, 22.020221169036347, 21.153250014601593, 22.020221169036347, 21.186887835703, 1.8310211293445555, 20.153548513380233, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.02022116903634, 22.153554502369655, 20.55355371545546, 20.153554502369673, 20.286887835703006, 20.153554502160556, 21.586887835699294, 21.020221169036326, 22.152931009801186, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.020221169036326, 22.153250014601607, 20.153554502369676, 21.053549222085863, 22.286887835702988, 20.286887835493886, 21.95324655529245, 20.15355450236967, 22.020221169036347, 22.28688783567547, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.153554502369673, 21.020221169036326, 20.15355450236967, 22.020221169036347, 21.402662869996547, 5.351242284493771, 22.420221169036346, 22.020221169036347, 22.020221169036347, 22.15355450236968, 21.286887835699375, 20.75355450236967, 21.32022037001205, 22.15355449031131, 21.020221169036326], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 24, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 3, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7056434863702665, "mean_inference_ms": 1.2175298695320156, "mean_action_processing_ms": 0.10489732929122596, "mean_env_wait_ms": 29.60470485722867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038116455078125, "StateBufferConnector_ms": 0.005003213882446289, "ViewRequirementAgentConnector_ms": 0.11533761024475098}}, "episode_reward_max": 22.420221169036346, "episode_reward_min": 1.8310211293445555, "episode_reward_mean": 20.68690520420863, "episode_len_mean": 29.31, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.153554502366042, 20.153554502369673, 20.286887140357003, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.15355450078173, 21.020221169036326, 22.020221169036347, 21.120177620259764, 22.020221169036347, 20.1532500146016, 21.020221169036326, 21.020221169036326, 22.152931009801186, 21.020221169036326, 21.48688783570299, 10.15354922208593, 15.73595610617162, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.153554502369676, 21.020221169036326, 20.02022116903634, 22.153514405215034, 22.020221169036347, 22.15355450236968, 20.02022116903634, 22.020221169036347, 20.153554502369673, 20.28457563150511, 21.920177620259782, 20.02022116903634, 21.820221169036337, 21.020221169036326, 21.020221169036326, 22.153554502369666, 21.453553703341743, 21.286887835703, 21.020221169036326, 21.153554502369666, 20.2868877441348, 20.35355450236966, 22.020221169036347, 21.153250014601593, 22.020221169036347, 21.186887835703, 1.8310211293445555, 20.153548513380233, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.02022116903634, 22.153554502369655, 20.55355371545546, 20.153554502369673, 20.286887835703006, 20.153554502160556, 21.586887835699294, 21.020221169036326, 22.152931009801186, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.020221169036326, 22.153250014601607, 20.153554502369676, 21.053549222085863, 22.286887835702988, 20.286887835493886, 21.95324655529245, 20.15355450236967, 22.020221169036347, 22.28688783567547, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.153554502369673, 21.020221169036326, 20.15355450236967, 22.020221169036347, 21.402662869996547, 5.351242284493771, 22.420221169036346, 22.020221169036347, 22.020221169036347, 22.15355450236968, 21.286887835699375, 20.75355450236967, 21.32022037001205, 22.15355449031131, 21.020221169036326], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 24, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 3, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7056434863702665, "mean_inference_ms": 1.2175298695320156, "mean_action_processing_ms": 0.10489732929122596, "mean_env_wait_ms": 29.60470485722867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038116455078125, "StateBufferConnector_ms": 0.005003213882446289, "ViewRequirementAgentConnector_ms": 0.11533761024475098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 86000, "num_env_steps_sampled": 86000, "num_env_steps_trained": 86000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.762871045726982, "num_env_steps_trained_throughput_per_sec": 29.762871045726982, "timesteps_total": 86000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 86000, "timers": {"training_iteration_time_ms": 66456.22, "sample_time_ms": 63271.318, "load_time_ms": 11.375, "load_throughput": 175828.259, "learn_time_ms": 3170.944, "learn_throughput": 630.727, "synch_weights_time_ms": 2.142}, "counters": {"num_env_steps_sampled": 86000, "num_env_steps_trained": 86000, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 86000}, "done": false, "episodes_total": 3245, "training_iteration": 43, "trial_id": "13850_00001", "date": "2023-12-28_18-35-10", "timestamp": 1703759710, "time_this_iter_s": 67.20230150222778, "time_total_s": 2860.2032129764557, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2860.2032129764557, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 55.92395833333333, "ram_util_percent": 92.37708333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.257285475730896e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3205491350508399, "policy_loss": 0.0026005711240900888, "vf_loss": 0.317948562208977, "vf_explained_var": 0.6142177911599477, "kl": 0.005344890152667613, "entropy": 0.3690470655096902, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19575.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 22.420221169036346, "episode_reward_min": 5.351242284493771, "episode_reward_mean": 20.723659657858416, "episode_len_mean": 29.48, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.020221169036326, 22.020221169036347, 21.020221169036326, 22.153250014601607, 20.153554502369676, 21.053549222085863, 22.286887835702988, 20.286887835493886, 21.95324655529245, 20.15355450236967, 22.020221169036347, 22.28688783567547, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.153554502369673, 21.020221169036326, 20.15355450236967, 22.020221169036347, 21.402662869996547, 5.351242284493771, 22.420221169036346, 22.020221169036347, 22.020221169036347, 22.15355450236968, 21.286887835699375, 20.75355450236967, 21.32022037001205, 22.15355449031131, 21.020221169036326, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.653554502369673, 20.02022116903634, 20.286887835702526, 20.153554502369673, 21.020221169036326, 22.020221169036347, 9.586887835702928, 22.020221169036347, 20.820221169000995, 20.15355450236967, 20.153554502369676, 20.02022116903634, 22.020221169036347, 21.153549222085925, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.02022116903634, 22.1512422983809, 22.020221169036347, 20.02022116903634, 20.286881860073255, 20.15355450236967, 20.02022116903634, 20.02022116903634, 20.153554502369673, 20.02022116903634, 20.02022116903634, 20.02022116903634, 11.086887835703, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.45355450212879, 21.020221169036326, 21.020221169036326, 21.020221169036326, 21.153554502160556, 21.020221169036326, 22.15354922208594, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.15355450236968, 21.020221169036326, 21.286887835703002, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.286887835702995, 21.15355450236966, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.153554502160556, 21.020221169036326, 20.286887835493893, 22.020221169036347, 22.15355450236968, 21.153554502369133, 20.55355450236967], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7047665593258045, "mean_inference_ms": 1.2175395356804815, "mean_action_processing_ms": 0.10493598966288324, "mean_env_wait_ms": 29.603052891933768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00706934928894043, "StateBufferConnector_ms": 0.004889249801635742, "ViewRequirementAgentConnector_ms": 0.11539840698242188}}, "episode_reward_max": 22.420221169036346, "episode_reward_min": 5.351242284493771, "episode_reward_mean": 20.723659657858416, "episode_len_mean": 29.48, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.020221169036326, 22.020221169036347, 21.020221169036326, 22.153250014601607, 20.153554502369676, 21.053549222085863, 22.286887835702988, 20.286887835493886, 21.95324655529245, 20.15355450236967, 22.020221169036347, 22.28688783567547, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.153554502369673, 21.020221169036326, 20.15355450236967, 22.020221169036347, 21.402662869996547, 5.351242284493771, 22.420221169036346, 22.020221169036347, 22.020221169036347, 22.15355450236968, 21.286887835699375, 20.75355450236967, 21.32022037001205, 22.15355449031131, 21.020221169036326, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.653554502369673, 20.02022116903634, 20.286887835702526, 20.153554502369673, 21.020221169036326, 22.020221169036347, 9.586887835702928, 22.020221169036347, 20.820221169000995, 20.15355450236967, 20.153554502369676, 20.02022116903634, 22.020221169036347, 21.153549222085925, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.02022116903634, 22.1512422983809, 22.020221169036347, 20.02022116903634, 20.286881860073255, 20.15355450236967, 20.02022116903634, 20.02022116903634, 20.153554502369673, 20.02022116903634, 20.02022116903634, 20.02022116903634, 11.086887835703, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.45355450212879, 21.020221169036326, 21.020221169036326, 21.020221169036326, 21.153554502160556, 21.020221169036326, 22.15354922208594, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.15355450236968, 21.020221169036326, 21.286887835703002, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.286887835702995, 21.15355450236966, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.153554502160556, 21.020221169036326, 20.286887835493893, 22.020221169036347, 22.15355450236968, 21.153554502369133, 20.55355450236967], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7047665593258045, "mean_inference_ms": 1.2175395356804815, "mean_action_processing_ms": 0.10493598966288324, "mean_env_wait_ms": 29.603052891933768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00706934928894043, "StateBufferConnector_ms": 0.004889249801635742, "ViewRequirementAgentConnector_ms": 0.11539840698242188}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.37522477277363, "num_env_steps_trained_throughput_per_sec": 30.37522477277363, "timesteps_total": 88000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 66320.786, "sample_time_ms": 63133.779, "load_time_ms": 11.838, "load_throughput": 168948.379, "learn_time_ms": 3172.598, "learn_throughput": 630.398, "synch_weights_time_ms": 2.13}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 3313, "training_iteration": 44, "trial_id": "13850_00001", "date": "2023-12-28_18-36-16", "timestamp": 1703759776, "time_this_iter_s": 65.84816455841064, "time_total_s": 2926.0513775348663, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2926.0513775348663, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 55.979787234042576, "ram_util_percent": 92.381914893617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.257285475730896e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9928075910690758, "policy_loss": -0.012547598116927676, "vf_loss": 1.0053551846494277, "vf_explained_var": 0.4235829774538676, "kl": 0.0021851833973805454, "entropy": 0.3068805361456341, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20025.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "sampler_results": {"episode_reward_max": 22.286887835703, "episode_reward_min": 3.753553701568343, "episode_reward_mean": 20.38453923439087, "episode_len_mean": 29.03, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.020221169036326, 21.020221169036326, 21.153554502160556, 21.020221169036326, 22.15354922208594, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.15355450236968, 21.020221169036326, 21.286887835703002, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.286887835702995, 21.15355450236966, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.153554502160556, 21.020221169036326, 20.286887835493893, 22.020221169036347, 22.15355450236968, 21.153554502369133, 20.55355450236967, 15.486887835703005, 20.02022116903634, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.02022116903634, 17.8202158887526, 20.485995988036684, 22.020221169036347, 21.186887835703, 22.020221169036347, 22.020221169036347, 21.152931009801165, 22.020221169036347, 20.02022116903634, 21.6202211690358, 3.753553701568343, 18.686887835703004, 21.153554502160556, 20.02022116903634, 22.020221169036347, 21.15355450236966, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.753554500541274, 21.020221169036326, 21.153554502369666, 21.020221169036326, 20.15355450236967, 22.153554502369666, 8.82022107746813, 21.020221169036326, 22.15355450078174, 20.153554502369673, 20.153554502369666, 20.153554502369676, 20.02022116903634, 20.02022116903634, 22.286887835703, 10.753554502369054, 22.020221169036347, 22.153554502160564, 21.15355450236966, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.153554502369673, 21.020221169036326, 20.02022116903634, 14.020221169036333, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.220221169036336, 6.686887835462177, 21.153554502366042, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 6, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7042371715538934, "mean_inference_ms": 1.2178135725477415, "mean_action_processing_ms": 0.10495478737973628, "mean_env_wait_ms": 29.611595038038885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007212638854980469, "StateBufferConnector_ms": 0.004929304122924805, "ViewRequirementAgentConnector_ms": 0.11722993850708008}}, "episode_reward_max": 22.286887835703, "episode_reward_min": 3.753553701568343, "episode_reward_mean": 20.38453923439087, "episode_len_mean": 29.03, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.020221169036326, 21.020221169036326, 21.153554502160556, 21.020221169036326, 22.15354922208594, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.15355450236968, 21.020221169036326, 21.286887835703002, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.286887835702995, 21.15355450236966, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.153554502160556, 21.020221169036326, 20.286887835493893, 22.020221169036347, 22.15355450236968, 21.153554502369133, 20.55355450236967, 15.486887835703005, 20.02022116903634, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.02022116903634, 17.8202158887526, 20.485995988036684, 22.020221169036347, 21.186887835703, 22.020221169036347, 22.020221169036347, 21.152931009801165, 22.020221169036347, 20.02022116903634, 21.6202211690358, 3.753553701568343, 18.686887835703004, 21.153554502160556, 20.02022116903634, 22.020221169036347, 21.15355450236966, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.753554500541274, 21.020221169036326, 21.153554502369666, 21.020221169036326, 20.15355450236967, 22.153554502369666, 8.82022107746813, 21.020221169036326, 22.15355450078174, 20.153554502369673, 20.153554502369666, 20.153554502369676, 20.02022116903634, 20.02022116903634, 22.286887835703, 10.753554502369054, 22.020221169036347, 22.153554502160564, 21.15355450236966, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.153554502369673, 21.020221169036326, 20.02022116903634, 14.020221169036333, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.220221169036336, 6.686887835462177, 21.153554502366042, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 6, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7042371715538934, "mean_inference_ms": 1.2178135725477415, "mean_action_processing_ms": 0.10495478737973628, "mean_env_wait_ms": 29.611595038038885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007212638854980469, "StateBufferConnector_ms": 0.004929304122924805, "ViewRequirementAgentConnector_ms": 0.11722993850708008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.476912091646845, "num_env_steps_trained_throughput_per_sec": 29.476912091646845, "timesteps_total": 90000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 66522.629, "sample_time_ms": 63340.168, "load_time_ms": 11.994, "load_throughput": 166754.623, "learn_time_ms": 3167.913, "learn_throughput": 631.33, "synch_weights_time_ms": 2.119}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "episodes_total": 3383, "training_iteration": 45, "trial_id": "13850_00001", "date": "2023-12-28_18-37-24", "timestamp": 1703759844, "time_this_iter_s": 67.8543131351471, "time_total_s": 2993.9056906700134, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2993.9056906700134, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 56.225, "ram_util_percent": 92.35416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.28642737865448e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6434353068491651, "policy_loss": 0.004744501031107373, "vf_loss": 0.6386908040133615, "vf_explained_var": 0.4484737189610799, "kl": 0.004049993037964567, "entropy": 0.25094471828805076, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20475.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 22.286887835703, "episode_reward_min": 2.6868817546179375, "episode_reward_mean": 20.066880807275076, "episode_len_mean": 28.45, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.286887835703, 10.753554502369054, 22.020221169036347, 22.153554502160564, 21.15355450236966, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.153554502369673, 21.020221169036326, 20.02022116903634, 14.020221169036333, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.220221169036336, 6.686887835462177, 21.153554502366042, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.153554502369662, 20.02022116903634, 21.82022116903633, 21.12022116903633, 21.020221169036326, 22.020221169036347, 21.15355450236966, 20.02022116903634, 20.02022116903634, 22.020221169036347, 3.7532038363618914, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.15355450078173, 22.020221169036347, 21.420221169036342, 22.020221169036347, 21.15355450236966, 22.020221169036347, 21.153554502369662, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.15355450236967, 20.520221169036326, 21.153554502366042, 21.520220475226544, 21.020221169036326, 21.586887835702942, 21.020221169036326, 12.020221169036335, 22.020221169036347, 5.220221167207579, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.853553703345394, 20.42022116903634, 2.6868817546179375, 20.1532500146016, 20.586887835702917, 20.02022116903634, 20.02022116903634, 21.153554502160556, 11.353554502369668, 20.286887835703002, 20.15355450236967, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.420221167239294, 21.286887835702995, 20.55355450236967, 7.486847738544184, 22.020221169036347, 22.286887823644637, 22.020221169036347, 21.020221169036326, 21.020221169036326, 22.15355450236968, 21.020221169036326], "episode_lengths": [30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 6, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 19, 30, 8, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7036274745061797, "mean_inference_ms": 1.2177411147659187, "mean_action_processing_ms": 0.1049451815209499, "mean_env_wait_ms": 29.610733110705706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006911277770996094, "StateBufferConnector_ms": 0.00473332405090332, "ViewRequirementAgentConnector_ms": 0.11498093605041504}}, "episode_reward_max": 22.286887835703, "episode_reward_min": 2.6868817546179375, "episode_reward_mean": 20.066880807275076, "episode_len_mean": 28.45, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.286887835703, 10.753554502369054, 22.020221169036347, 22.153554502160564, 21.15355450236966, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.153554502369673, 21.020221169036326, 20.02022116903634, 14.020221169036333, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.220221169036336, 6.686887835462177, 21.153554502366042, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.153554502369662, 20.02022116903634, 21.82022116903633, 21.12022116903633, 21.020221169036326, 22.020221169036347, 21.15355450236966, 20.02022116903634, 20.02022116903634, 22.020221169036347, 3.7532038363618914, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.15355450078173, 22.020221169036347, 21.420221169036342, 22.020221169036347, 21.15355450236966, 22.020221169036347, 21.153554502369662, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.15355450236967, 20.520221169036326, 21.153554502366042, 21.520220475226544, 21.020221169036326, 21.586887835702942, 21.020221169036326, 12.020221169036335, 22.020221169036347, 5.220221167207579, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.853553703345394, 20.42022116903634, 2.6868817546179375, 20.1532500146016, 20.586887835702917, 20.02022116903634, 20.02022116903634, 21.153554502160556, 11.353554502369668, 20.286887835703002, 20.15355450236967, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.420221167239294, 21.286887835702995, 20.55355450236967, 7.486847738544184, 22.020221169036347, 22.286887823644637, 22.020221169036347, 21.020221169036326, 21.020221169036326, 22.15355450236968, 21.020221169036326], "episode_lengths": [30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 6, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 19, 30, 8, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7036274745061797, "mean_inference_ms": 1.2177411147659187, "mean_action_processing_ms": 0.1049451815209499, "mean_env_wait_ms": 29.610733110705706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006911277770996094, "StateBufferConnector_ms": 0.00473332405090332, "ViewRequirementAgentConnector_ms": 0.11498093605041504}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.439668783509696, "num_env_steps_trained_throughput_per_sec": 30.439668783509696, "timesteps_total": 92000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 66487.348, "sample_time_ms": 63306.947, "load_time_ms": 11.884, "load_throughput": 168299.949, "learn_time_ms": 3165.927, "learn_throughput": 631.726, "synch_weights_time_ms": 2.15}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 3453, "training_iteration": 46, "trial_id": "13850_00001", "date": "2023-12-28_18-38-29", "timestamp": 1703759909, "time_this_iter_s": 65.70819401741028, "time_total_s": 3059.6138846874237, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3059.6138846874237, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 55.996808510638296, "ram_util_percent": 92.3234042553191}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.14321368932724e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9838461422340737, "policy_loss": 0.004974997341632843, "vf_loss": 0.9788711488909192, "vf_explained_var": 0.6186440132723914, "kl": 0.003816655552644034, "entropy": 0.23677228639523187, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 94000, "num_env_steps_trained": 94000, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 94000}, "sampler_results": {"episode_reward_max": 22.286887823644637, "episode_reward_min": 2.6868817546179375, "episode_reward_mean": 20.162185204727184, "episode_len_mean": 28.83, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.220221167207579, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.853553703345394, 20.42022116903634, 2.6868817546179375, 20.1532500146016, 20.586887835702917, 20.02022116903634, 20.02022116903634, 21.153554502160556, 11.353554502369668, 20.286887835703002, 20.15355450236967, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.420221167239294, 21.286887835702995, 20.55355450236967, 7.486847738544184, 22.020221169036347, 22.286887823644637, 22.020221169036347, 21.020221169036326, 21.020221169036326, 22.15355450236968, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.153554502369666, 20.286887835702995, 20.02022116903634, 22.020221169036347, 21.020221169036326, 21.15355450236966, 20.02022116903634, 20.153554502369673, 20.153554502369673, 20.953553703345374, 22.15355450236968, 20.620221168982557, 21.720221168795536, 20.286887835702995, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.284575631714215, 20.02022116903634, 20.02022116903634, 22.020221169036347, 21.020221169036326, 18.586887835703006, 20.02022116903634, 20.15355450236966, 12.686887835702999, 20.02022116903634, 21.520221169036347, 20.72022116903634, 20.02022116903634, 21.2868878338746, 10.686887835703002, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.353554502369672, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 21.020221169036326, 21.586887835702942, 10.020221169036336, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.153554502369666, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.15355450236966, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.153554502369673, 22.020221169036347, 20.02022116903634, 21.51932932137316, 21.153554502369662, 20.153514405215024, 20.55355450236965, 21.686887835671303], "episode_lengths": [8, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 28, 30, 30, 19, 30, 30, 30, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.702811721389571, "mean_inference_ms": 1.217587592617443, "mean_action_processing_ms": 0.10493185849980195, "mean_env_wait_ms": 29.606584428740724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00690007209777832, "StateBufferConnector_ms": 0.004717111587524414, "ViewRequirementAgentConnector_ms": 0.11496353149414062}}, "episode_reward_max": 22.286887823644637, "episode_reward_min": 2.6868817546179375, "episode_reward_mean": 20.162185204727184, "episode_len_mean": 28.83, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.220221167207579, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.853553703345394, 20.42022116903634, 2.6868817546179375, 20.1532500146016, 20.586887835702917, 20.02022116903634, 20.02022116903634, 21.153554502160556, 11.353554502369668, 20.286887835703002, 20.15355450236967, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.420221167239294, 21.286887835702995, 20.55355450236967, 7.486847738544184, 22.020221169036347, 22.286887823644637, 22.020221169036347, 21.020221169036326, 21.020221169036326, 22.15355450236968, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.153554502369666, 20.286887835702995, 20.02022116903634, 22.020221169036347, 21.020221169036326, 21.15355450236966, 20.02022116903634, 20.153554502369673, 20.153554502369673, 20.953553703345374, 22.15355450236968, 20.620221168982557, 21.720221168795536, 20.286887835702995, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.284575631714215, 20.02022116903634, 20.02022116903634, 22.020221169036347, 21.020221169036326, 18.586887835703006, 20.02022116903634, 20.15355450236966, 12.686887835702999, 20.02022116903634, 21.520221169036347, 20.72022116903634, 20.02022116903634, 21.2868878338746, 10.686887835703002, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.353554502369672, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 21.020221169036326, 21.586887835702942, 10.020221169036336, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.153554502369666, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.15355450236966, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.153554502369673, 22.020221169036347, 20.02022116903634, 21.51932932137316, 21.153554502369662, 20.153514405215024, 20.55355450236965, 21.686887835671303], "episode_lengths": [8, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 28, 30, 30, 19, 30, 30, 30, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.702811721389571, "mean_inference_ms": 1.217587592617443, "mean_action_processing_ms": 0.10493185849980195, "mean_env_wait_ms": 29.606584428740724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00690007209777832, "StateBufferConnector_ms": 0.004717111587524414, "ViewRequirementAgentConnector_ms": 0.11496353149414062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 94000, "num_env_steps_sampled": 94000, "num_env_steps_trained": 94000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.22064776902043, "num_env_steps_trained_throughput_per_sec": 30.22064776902043, "timesteps_total": 94000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 94000, "timers": {"training_iteration_time_ms": 66463.543, "sample_time_ms": 63286.403, "load_time_ms": 11.931, "load_throughput": 167631.015, "learn_time_ms": 3162.644, "learn_throughput": 632.382, "synch_weights_time_ms": 2.126}, "counters": {"num_env_steps_sampled": 94000, "num_env_steps_trained": 94000, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 94000}, "done": false, "episodes_total": 3521, "training_iteration": 47, "trial_id": "13850_00001", "date": "2023-12-28_18-39-35", "timestamp": 1703759975, "time_this_iter_s": 66.1845314502716, "time_total_s": 3125.7984161376953, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3125.7984161376953, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 56.03510638297873, "ram_util_percent": 92.38829787234039}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.57160684466362e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4566972888095511, "policy_loss": -0.044815903115603656, "vf_loss": 0.501513191430519, "vf_explained_var": 0.5604139931996663, "kl": 0.0017194668032685793, "entropy": 0.2548706434501542, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 21375.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 22.15355450236968, "episode_reward_min": 7.353554502365493, "episode_reward_mean": 20.685679758299802, "episode_len_mean": 29.39, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.020221169036326, 21.020221169036326, 20.02022116903634, 21.353554502369672, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 21.020221169036326, 21.586887835702942, 10.020221169036336, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.153554502369666, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.15355450236966, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.153554502369673, 22.020221169036347, 20.02022116903634, 21.51932932137316, 21.153554502369662, 20.153514405215024, 20.55355450236965, 21.686887835671303, 22.020221169036347, 22.020221169036347, 22.1359962033299, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.55355450236966, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.153549222085925, 22.15355450236968, 21.020221169036326, 22.153554502366045, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.02022116903634, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.020221169036326, 7.353554502365493, 21.020221169036326, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.15355450236967, 20.68688783567128, 20.286887835703006, 22.15355450236919, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.020221169036326, 13.386887835702998, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.02022116903634, 22.15355449031131, 21.15355450234213, 22.15355450236967, 15.486887835703005, 22.15355450236967, 20.02022116903634, 21.420221169036342, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.15355450236919, 20.151242298380893, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.35355450236966, 20.02022116903634, 22.020221169036347, 21.353554502337943, 20.02022116903634, 12.020221169036335, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 19, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7018686147695307, "mean_inference_ms": 1.2173100762195863, "mean_action_processing_ms": 0.10490637895124884, "mean_env_wait_ms": 29.598905893874534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006850719451904297, "StateBufferConnector_ms": 0.004630565643310547, "ViewRequirementAgentConnector_ms": 0.11385917663574219}}, "episode_reward_max": 22.15355450236968, "episode_reward_min": 7.353554502365493, "episode_reward_mean": 20.685679758299802, "episode_len_mean": 29.39, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.020221169036326, 21.020221169036326, 20.02022116903634, 21.353554502369672, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 21.020221169036326, 21.586887835702942, 10.020221169036336, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.153554502369666, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.15355450236966, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.153554502369673, 22.020221169036347, 20.02022116903634, 21.51932932137316, 21.153554502369662, 20.153514405215024, 20.55355450236965, 21.686887835671303, 22.020221169036347, 22.020221169036347, 22.1359962033299, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.55355450236966, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.153549222085925, 22.15355450236968, 21.020221169036326, 22.153554502366045, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.02022116903634, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.020221169036326, 7.353554502365493, 21.020221169036326, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.15355450236967, 20.68688783567128, 20.286887835703006, 22.15355450236919, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.020221169036326, 13.386887835702998, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.02022116903634, 22.15355449031131, 21.15355450234213, 22.15355450236967, 15.486887835703005, 22.15355450236967, 20.02022116903634, 21.420221169036342, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.15355450236919, 20.151242298380893, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.35355450236966, 20.02022116903634, 22.020221169036347, 21.353554502337943, 20.02022116903634, 12.020221169036335, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 19, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7018686147695307, "mean_inference_ms": 1.2173100762195863, "mean_action_processing_ms": 0.10490637895124884, "mean_env_wait_ms": 29.598905893874534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006850719451904297, "StateBufferConnector_ms": 0.004630565643310547, "ViewRequirementAgentConnector_ms": 0.11385917663574219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.59471940446363, "num_env_steps_trained_throughput_per_sec": 30.59471940446363, "timesteps_total": 96000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 66426.78, "sample_time_ms": 63249.909, "load_time_ms": 11.981, "load_throughput": 166930.496, "learn_time_ms": 3162.319, "learn_throughput": 632.447, "synch_weights_time_ms": 2.141}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 3589, "training_iteration": 48, "trial_id": "13850_00001", "date": "2023-12-28_18-40-41", "timestamp": 1703760041, "time_this_iter_s": 65.37542796134949, "time_total_s": 3191.173844099045, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3191.173844099045, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 55.89677419354838, "ram_util_percent": 92.42043010752687}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.8580342233181e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.24971926934810149, "policy_loss": 0.00014368334578143227, "vf_loss": 0.24957558509686756, "vf_explained_var": 0.8402219865057203, "kl": 0.017182414870824027, "entropy": 0.392525706688563, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 21825.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 98000, "num_env_steps_trained": 98000, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 98000}, "sampler_results": {"episode_reward_max": 22.286887834115067, "episode_reward_min": 3.586887034901676, "episode_reward_mean": 20.610837589230044, "episode_len_mean": 29.31, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.020221169036326, 22.020221169036347, 21.020221169036326, 13.386887835702998, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.02022116903634, 22.15355449031131, 21.15355450234213, 22.15355450236967, 15.486887835703005, 22.15355450236967, 20.02022116903634, 21.420221169036342, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.15355450236919, 20.151242298380893, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.35355450236966, 20.02022116903634, 22.020221169036347, 21.353554502337943, 20.02022116903634, 12.020221169036335, 22.020221169036347, 20.78688782181985, 22.153554502160564, 20.153554502369676, 22.020221169036347, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.28688783570301, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.28688783570301, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.95324655529245, 21.020221169036326, 20.42018107188169, 21.020221169036326, 3.586887034901676, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.353554502337957, 22.020221169036347, 20.15355450236967, 20.28688783570301, 20.02022116903634, 21.020221169036326, 20.153549222085925, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.1512422983809, 21.020221169036326, 21.020221169036326, 22.153554502342136, 22.020221169036347, 20.153554502369676, 22.020221169036347, 22.020221169036347, 22.020221169036347, 8.68688783570293, 22.286887834115067, 22.020221169036347, 20.420181071881625, 21.320221169036337, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 20.15355450236967, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.886881846713575], "episode_lengths": [30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 19, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 6, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7011194514943091, "mean_inference_ms": 1.2172538285163343, "mean_action_processing_ms": 0.10489895225904274, "mean_env_wait_ms": 29.596188256205735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006929159164428711, "StateBufferConnector_ms": 0.004734039306640625, "ViewRequirementAgentConnector_ms": 0.11514902114868164}}, "episode_reward_max": 22.286887834115067, "episode_reward_min": 3.586887034901676, "episode_reward_mean": 20.610837589230044, "episode_len_mean": 29.31, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.020221169036326, 22.020221169036347, 21.020221169036326, 13.386887835702998, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.02022116903634, 22.15355449031131, 21.15355450234213, 22.15355450236967, 15.486887835703005, 22.15355450236967, 20.02022116903634, 21.420221169036342, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.15355450236919, 20.151242298380893, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.35355450236966, 20.02022116903634, 22.020221169036347, 21.353554502337943, 20.02022116903634, 12.020221169036335, 22.020221169036347, 20.78688782181985, 22.153554502160564, 20.153554502369676, 22.020221169036347, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.28688783570301, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.28688783570301, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.95324655529245, 21.020221169036326, 20.42018107188169, 21.020221169036326, 3.586887034901676, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.353554502337957, 22.020221169036347, 20.15355450236967, 20.28688783570301, 20.02022116903634, 21.020221169036326, 20.153549222085925, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.1512422983809, 21.020221169036326, 21.020221169036326, 22.153554502342136, 22.020221169036347, 20.153554502369676, 22.020221169036347, 22.020221169036347, 22.020221169036347, 8.68688783570293, 22.286887834115067, 22.020221169036347, 20.420181071881625, 21.320221169036337, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 20.15355450236967, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.886881846713575], "episode_lengths": [30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 19, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 6, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7011194514943091, "mean_inference_ms": 1.2172538285163343, "mean_action_processing_ms": 0.10489895225904274, "mean_env_wait_ms": 29.596188256205735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006929159164428711, "StateBufferConnector_ms": 0.004734039306640625, "ViewRequirementAgentConnector_ms": 0.11514902114868164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 98000, "num_env_steps_sampled": 98000, "num_env_steps_trained": 98000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.08588463532882, "num_env_steps_trained_throughput_per_sec": 30.08588463532882, "timesteps_total": 98000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 98000, "timers": {"training_iteration_time_ms": 66368.328, "sample_time_ms": 63191.26, "load_time_ms": 12.912, "load_throughput": 154893.68, "learn_time_ms": 3161.592, "learn_throughput": 632.593, "synch_weights_time_ms": 2.129}, "counters": {"num_env_steps_sampled": 98000, "num_env_steps_trained": 98000, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 98000}, "done": false, "episodes_total": 3657, "training_iteration": 49, "trial_id": "13850_00001", "date": "2023-12-28_18-41-47", "timestamp": 1703760107, "time_this_iter_s": 66.48084425926208, "time_total_s": 3257.654688358307, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3257.654688358307, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 56.12526315789472, "ram_util_percent": 92.40631578947365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.8580342233181e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5164217025372717, "policy_loss": -0.057144431869188946, "vf_loss": 0.5735661385084192, "vf_explained_var": 0.7489663945304023, "kl": 0.007986426191140998, "entropy": 0.6857589252789815, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 22275.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 22.553554502369668, "episode_reward_min": 8.68688783570293, "episode_reward_mean": 20.91647641282954, "episode_len_mean": 29.63, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.020221169036347, 21.020221169036326, 22.1512422983809, 21.020221169036326, 21.020221169036326, 22.153554502342136, 22.020221169036347, 20.153554502369676, 22.020221169036347, 22.020221169036347, 22.020221169036347, 8.68688783570293, 22.286887834115067, 22.020221169036347, 20.420181071881625, 21.320221169036337, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 20.15355450236967, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.886881846713575, 20.286882555419258, 16.516125700301327, 22.15355449031131, 20.42018107188163, 21.020221169036326, 20.419916681268266, 21.020221169036326, 20.286583347934453, 20.551242298380338, 20.4865798886513, 21.286887835699382, 15.486887823644638, 22.020221169036347, 21.453553781034323, 20.553554502365557, 21.620221051763412, 21.286887835703, 22.020221169036347, 20.28688783569937, 22.553554502369668, 21.15355441080147, 21.5202194162421, 21.15355450236966, 20.42021588874897, 20.686887835703004, 21.020221169036326, 21.26667627467653, 20.553554502369675, 21.15355450236966, 21.986847640201375, 22.020221169036347, 22.020221169036347, 20.42022116903634, 20.153554502342132, 20.432790316590957, 22.553554502341647, 21.08688783570299, 21.686887835703004, 21.020221169036326, 21.020221169036326, 21.686887823644156, 20.420221169036324, 20.653554502342026, 21.886881846713575, 22.28688714035693, 21.153554502369662, 21.386583334051785, 22.15354922208594, 22.153554502342136, 20.153554502369676, 22.020221169036347, 20.553553793377358, 21.153554500781738, 20.55324991097504, 21.667017332646907, 22.417599196995752, 20.553554502365504, 20.02022116903634, 21.15355441080147, 20.153554502369676, 21.020221169036326, 20.41991668124072, 22.153554502160564, 22.419916577641708, 20.42022116903271, 22.15355450236968, 21.520221169036322, 13.620221169036268], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 24, 30, 30, 30, 30, 30, 30, 30, 30, 30, 24, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7003272598034695, "mean_inference_ms": 1.2171339085199258, "mean_action_processing_ms": 0.1048852177513343, "mean_env_wait_ms": 29.59319610665867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007029294967651367, "StateBufferConnector_ms": 0.004711627960205078, "ViewRequirementAgentConnector_ms": 0.11454510688781738}}, "episode_reward_max": 22.553554502369668, "episode_reward_min": 8.68688783570293, "episode_reward_mean": 20.91647641282954, "episode_len_mean": 29.63, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.020221169036347, 21.020221169036326, 22.1512422983809, 21.020221169036326, 21.020221169036326, 22.153554502342136, 22.020221169036347, 20.153554502369676, 22.020221169036347, 22.020221169036347, 22.020221169036347, 8.68688783570293, 22.286887834115067, 22.020221169036347, 20.420181071881625, 21.320221169036337, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 20.15355450236967, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.886881846713575, 20.286882555419258, 16.516125700301327, 22.15355449031131, 20.42018107188163, 21.020221169036326, 20.419916681268266, 21.020221169036326, 20.286583347934453, 20.551242298380338, 20.4865798886513, 21.286887835699382, 15.486887823644638, 22.020221169036347, 21.453553781034323, 20.553554502365557, 21.620221051763412, 21.286887835703, 22.020221169036347, 20.28688783569937, 22.553554502369668, 21.15355441080147, 21.5202194162421, 21.15355450236966, 20.42021588874897, 20.686887835703004, 21.020221169036326, 21.26667627467653, 20.553554502369675, 21.15355450236966, 21.986847640201375, 22.020221169036347, 22.020221169036347, 20.42022116903634, 20.153554502342132, 20.432790316590957, 22.553554502341647, 21.08688783570299, 21.686887835703004, 21.020221169036326, 21.020221169036326, 21.686887823644156, 20.420221169036324, 20.653554502342026, 21.886881846713575, 22.28688714035693, 21.153554502369662, 21.386583334051785, 22.15354922208594, 22.153554502342136, 20.153554502369676, 22.020221169036347, 20.553553793377358, 21.153554500781738, 20.55324991097504, 21.667017332646907, 22.417599196995752, 20.553554502365504, 20.02022116903634, 21.15355441080147, 20.153554502369676, 21.020221169036326, 20.41991668124072, 22.153554502160564, 22.419916577641708, 20.42022116903271, 22.15355450236968, 21.520221169036322, 13.620221169036268], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 24, 30, 30, 30, 30, 30, 30, 30, 30, 30, 24, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7003272598034695, "mean_inference_ms": 1.2171339085199258, "mean_action_processing_ms": 0.1048852177513343, "mean_env_wait_ms": 29.59319610665867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007029294967651367, "StateBufferConnector_ms": 0.004711627960205078, "ViewRequirementAgentConnector_ms": 0.11454510688781738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.356092921907184, "num_env_steps_trained_throughput_per_sec": 30.356092921907184, "timesteps_total": 100000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 66289.049, "sample_time_ms": 63112.778, "load_time_ms": 11.744, "load_throughput": 170305.281, "learn_time_ms": 3161.938, "learn_throughput": 632.523, "synch_weights_time_ms": 2.141}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 3725, "training_iteration": 50, "trial_id": "13850_00001", "date": "2023-12-28_18-42-53", "timestamp": 1703760173, "time_this_iter_s": 65.89083099365234, "time_total_s": 3323.5455193519592, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3323.5455193519592, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 55.96702127659572, "ram_util_percent": 92.46170212765956}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.8580342233181e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.832759062912729, "policy_loss": 0.0003020947840478685, "vf_loss": 0.8324569683315025, "vf_explained_var": 0.5303317467371623, "kl": 0.007953700747743642, "entropy": 0.6928449385695987, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 22725.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 102000, "num_env_steps_trained": 102000, "num_agent_steps_sampled": 102000, "num_agent_steps_trained": 102000}, "sampler_results": {"episode_reward_max": 22.686887835703004, "episode_reward_min": 1.9973833082431531, "episode_reward_mean": 20.128239053232686, "episode_len_mean": 28.46, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.020221169036326, 21.686887823644156, 20.420221169036324, 20.653554502342026, 21.886881846713575, 22.28688714035693, 21.153554502369662, 21.386583334051785, 22.15354922208594, 22.153554502342136, 20.153554502369676, 22.020221169036347, 20.553553793377358, 21.153554500781738, 20.55324991097504, 21.667017332646907, 22.417599196995752, 20.553554502365504, 20.02022116903634, 21.15355441080147, 20.153554502369676, 21.020221169036326, 20.41991668124072, 22.153554502160564, 22.419916577641708, 20.42022116903271, 22.15355450236968, 21.520221169036322, 13.620221169036268, 21.297693877096282, 21.286887835703, 22.020221169036347, 20.286583347934936, 20.153554502342132, 1.9973833082431531, 22.42022038212213, 21.286887744134805, 9.202662869756209, 20.284575619655854, 11.635996201501479, 21.15355450236966, 22.020221169036347, 21.286887835702935, 21.020221169036326, 22.220221156974343, 22.28688255541564, 22.153554502369655, 22.153554502369666, 20.95354842287671, 22.15355449031131, 22.15355380702367, 22.686887835703004, 21.652931778494093, 21.15355450236967, 20.55355450236966, 22.286264343134558, 20.286887835703006, 20.420221169036342, 20.55355371545547, 21.15355450236966, 22.020221169036347, 22.15355450236968, 20.686847738339246, 9.20035065190792, 21.020221169036326, 5.353554488482548, 20.28688774413432, 20.286887835703002, 20.820221077467657, 21.42022116882723, 8.134165465551794, 22.15355450236919, 20.486887835702994, 22.153554502160564, 21.40266286999655, 14.797343920318003, 10.535996203329878, 21.153554502369666, 22.119327484698726, 21.153554502366042, 20.02022116903634, 22.153554502369666, 21.351202091006137, 22.020221169036347, 21.153554490311304, 21.15355450236966, 20.42022116903271, 21.15355450234213, 21.06435984841694, 22.020221169036347, 21.286847738548364, 20.28658334793493, 20.420221169036335, 21.153554490311304, 13.620215876694234, 21.420175791597952, 22.020221169036347, 20.420221169036324, 20.153554502369673, 21.086887823640946], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 21, 30, 30, 30, 30, 30, 3, 30, 30, 14, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 8, 30, 30, 30, 30, 12, 30, 30, 30, 30, 21, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 21, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6997198899950392, "mean_inference_ms": 1.2169746562529085, "mean_action_processing_ms": 0.10487042483113412, "mean_env_wait_ms": 29.590563351878167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007111072540283203, "StateBufferConnector_ms": 0.004789590835571289, "ViewRequirementAgentConnector_ms": 0.11489653587341309}}, "episode_reward_max": 22.686887835703004, "episode_reward_min": 1.9973833082431531, "episode_reward_mean": 20.128239053232686, "episode_len_mean": 28.46, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.020221169036326, 21.686887823644156, 20.420221169036324, 20.653554502342026, 21.886881846713575, 22.28688714035693, 21.153554502369662, 21.386583334051785, 22.15354922208594, 22.153554502342136, 20.153554502369676, 22.020221169036347, 20.553553793377358, 21.153554500781738, 20.55324991097504, 21.667017332646907, 22.417599196995752, 20.553554502365504, 20.02022116903634, 21.15355441080147, 20.153554502369676, 21.020221169036326, 20.41991668124072, 22.153554502160564, 22.419916577641708, 20.42022116903271, 22.15355450236968, 21.520221169036322, 13.620221169036268, 21.297693877096282, 21.286887835703, 22.020221169036347, 20.286583347934936, 20.153554502342132, 1.9973833082431531, 22.42022038212213, 21.286887744134805, 9.202662869756209, 20.284575619655854, 11.635996201501479, 21.15355450236966, 22.020221169036347, 21.286887835702935, 21.020221169036326, 22.220221156974343, 22.28688255541564, 22.153554502369655, 22.153554502369666, 20.95354842287671, 22.15355449031131, 22.15355380702367, 22.686887835703004, 21.652931778494093, 21.15355450236967, 20.55355450236966, 22.286264343134558, 20.286887835703006, 20.420221169036342, 20.55355371545547, 21.15355450236966, 22.020221169036347, 22.15355450236968, 20.686847738339246, 9.20035065190792, 21.020221169036326, 5.353554488482548, 20.28688774413432, 20.286887835703002, 20.820221077467657, 21.42022116882723, 8.134165465551794, 22.15355450236919, 20.486887835702994, 22.153554502160564, 21.40266286999655, 14.797343920318003, 10.535996203329878, 21.153554502369666, 22.119327484698726, 21.153554502366042, 20.02022116903634, 22.153554502369666, 21.351202091006137, 22.020221169036347, 21.153554490311304, 21.15355450236966, 20.42022116903271, 21.15355450234213, 21.06435984841694, 22.020221169036347, 21.286847738548364, 20.28658334793493, 20.420221169036335, 21.153554490311304, 13.620215876694234, 21.420175791597952, 22.020221169036347, 20.420221169036324, 20.153554502369673, 21.086887823640946], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 21, 30, 30, 30, 30, 30, 3, 30, 30, 14, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 8, 30, 30, 30, 30, 12, 30, 30, 30, 30, 21, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 21, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6997198899950392, "mean_inference_ms": 1.2169746562529085, "mean_action_processing_ms": 0.10487042483113412, "mean_env_wait_ms": 29.590563351878167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007111072540283203, "StateBufferConnector_ms": 0.004789590835571289, "ViewRequirementAgentConnector_ms": 0.11489653587341309}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102000, "num_agent_steps_trained": 102000, "num_env_steps_sampled": 102000, "num_env_steps_trained": 102000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.193660657555867, "num_env_steps_trained_throughput_per_sec": 30.193660657555867, "timesteps_total": 102000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 102000, "timers": {"training_iteration_time_ms": 66220.461, "sample_time_ms": 63041.131, "load_time_ms": 11.81, "load_throughput": 169351.191, "learn_time_ms": 3164.912, "learn_throughput": 631.929, "synch_weights_time_ms": 2.154}, "counters": {"num_env_steps_sampled": 102000, "num_env_steps_trained": 102000, "num_agent_steps_sampled": 102000, "num_agent_steps_trained": 102000}, "done": false, "episodes_total": 3796, "training_iteration": 51, "trial_id": "13850_00001", "date": "2023-12-28_18-43-59", "timestamp": 1703760239, "time_this_iter_s": 66.24406838417053, "time_total_s": 3389.7895877361298, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3389.7895877361298, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 55.98723404255318, "ram_util_percent": 92.54468085106383}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.8580342233181e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5245225801732805, "policy_loss": 0.008759031105372642, "vf_loss": 1.5157635501606597, "vf_explained_var": 0.36291068024105494, "kl": 0.00903416965224746, "entropy": 0.6087899585564931, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 23175.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 22.55355450236968, "episode_reward_min": 1.8643544626778887, "episode_reward_mean": 19.92592758177823, "episode_len_mean": 28.22, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.486887835702994, 22.153554502160564, 21.40266286999655, 14.797343920318003, 10.535996203329878, 21.153554502369666, 22.119327484698726, 21.153554502366042, 20.02022116903634, 22.153554502369666, 21.351202091006137, 22.020221169036347, 21.153554490311304, 21.15355450236966, 20.42022116903271, 21.15355450234213, 21.06435984841694, 22.020221169036347, 21.286847738548364, 20.28658334793493, 20.420221169036335, 21.153554490311304, 13.620215876694234, 21.420175791597952, 22.020221169036347, 20.420221169036324, 20.153554502369673, 21.086887823640946, 18.553554502369675, 20.153554502369676, 20.28684245826462, 22.28688783390596, 20.286887835493896, 22.020221169036347, 20.420221155390042, 21.020221169036326, 20.153554410801462, 21.69773396219184, 21.15355450236966, 8.153554502365491, 12.686887835703002, 21.153554502369666, 20.61760101794279, 21.135996203329878, 21.151242298380883, 21.41960988349172, 20.28688115136755, 22.020221169036347, 15.620215888752593, 21.220182218714257, 21.020221169036326, 22.28688783570301, 22.153554502369666, 21.686887835702997, 20.153554502369676, 20.02022116903634, 20.886887835703, 20.286887835675465, 20.820221169036323, 22.153554502160564, 22.020221169036347, 4.050587144605044, 5.953554500540911, 21.153554502366042, 21.28688783570246, 16.553549116871437, 20.63599620332989, 20.1532500146016, 22.15355450236968, 22.020221169036347, 14.286887732076437, 22.15355450236967, 22.020221169036347, 22.153554502369676, 20.953554502369673, 21.020221169036326, 1.8643544626778887, 20.286887823644637, 22.55355450236968, 21.42022107746451, 22.1535545023696, 22.15355450236968, 22.284271143946164, 20.68684773854835, 20.420221169036335, 21.42021588875252, 22.020221169036347, 21.153554502369666, 22.020221169036347, 20.88661998535719, 21.820221063770134, 20.18688703667872, 21.553554410958867, 21.9868825417729, 8.020221169035786, 21.220221169036336, 21.020221169036326, 20.28688783569938, 21.300349865184398, 22.15355450236967], "episode_lengths": [30, 30, 30, 21, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 21, 30, 30, 30, 30, 30, 26, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 12, 18, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 6, 9, 30, 30, 25, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 3, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6994511366806858, "mean_inference_ms": 1.2170146597447336, "mean_action_processing_ms": 0.10487552867265441, "mean_env_wait_ms": 29.593908704910064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007311582565307617, "StateBufferConnector_ms": 0.004833698272705078, "ViewRequirementAgentConnector_ms": 0.11628246307373047}}, "episode_reward_max": 22.55355450236968, "episode_reward_min": 1.8643544626778887, "episode_reward_mean": 19.92592758177823, "episode_len_mean": 28.22, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.486887835702994, 22.153554502160564, 21.40266286999655, 14.797343920318003, 10.535996203329878, 21.153554502369666, 22.119327484698726, 21.153554502366042, 20.02022116903634, 22.153554502369666, 21.351202091006137, 22.020221169036347, 21.153554490311304, 21.15355450236966, 20.42022116903271, 21.15355450234213, 21.06435984841694, 22.020221169036347, 21.286847738548364, 20.28658334793493, 20.420221169036335, 21.153554490311304, 13.620215876694234, 21.420175791597952, 22.020221169036347, 20.420221169036324, 20.153554502369673, 21.086887823640946, 18.553554502369675, 20.153554502369676, 20.28684245826462, 22.28688783390596, 20.286887835493896, 22.020221169036347, 20.420221155390042, 21.020221169036326, 20.153554410801462, 21.69773396219184, 21.15355450236966, 8.153554502365491, 12.686887835703002, 21.153554502369666, 20.61760101794279, 21.135996203329878, 21.151242298380883, 21.41960988349172, 20.28688115136755, 22.020221169036347, 15.620215888752593, 21.220182218714257, 21.020221169036326, 22.28688783570301, 22.153554502369666, 21.686887835702997, 20.153554502369676, 20.02022116903634, 20.886887835703, 20.286887835675465, 20.820221169036323, 22.153554502160564, 22.020221169036347, 4.050587144605044, 5.953554500540911, 21.153554502366042, 21.28688783570246, 16.553549116871437, 20.63599620332989, 20.1532500146016, 22.15355450236968, 22.020221169036347, 14.286887732076437, 22.15355450236967, 22.020221169036347, 22.153554502369676, 20.953554502369673, 21.020221169036326, 1.8643544626778887, 20.286887823644637, 22.55355450236968, 21.42022107746451, 22.1535545023696, 22.15355450236968, 22.284271143946164, 20.68684773854835, 20.420221169036335, 21.42021588875252, 22.020221169036347, 21.153554502369666, 22.020221169036347, 20.88661998535719, 21.820221063770134, 20.18688703667872, 21.553554410958867, 21.9868825417729, 8.020221169035786, 21.220221169036336, 21.020221169036326, 20.28688783569938, 21.300349865184398, 22.15355450236967], "episode_lengths": [30, 30, 30, 21, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 21, 30, 30, 30, 30, 30, 26, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 12, 18, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 6, 9, 30, 30, 25, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 3, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6994511366806858, "mean_inference_ms": 1.2170146597447336, "mean_action_processing_ms": 0.10487552867265441, "mean_env_wait_ms": 29.593908704910064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007311582565307617, "StateBufferConnector_ms": 0.004833698272705078, "ViewRequirementAgentConnector_ms": 0.11628246307373047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.84646023599844, "num_env_steps_trained_throughput_per_sec": 29.84646023599844, "timesteps_total": 104000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 66375.453, "sample_time_ms": 63194.222, "load_time_ms": 11.761, "load_throughput": 170059.115, "learn_time_ms": 3166.875, "learn_throughput": 631.537, "synch_weights_time_ms": 2.141}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 3868, "training_iteration": 52, "trial_id": "13850_00001", "date": "2023-12-28_18-45-07", "timestamp": 1703760307, "time_this_iter_s": 67.0147614479065, "time_total_s": 3456.8043491840363, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3456.8043491840363, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 55.904210526315794, "ram_util_percent": 92.39999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.8580342233181e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9730383222467369, "policy_loss": 0.0017263471086819966, "vf_loss": 0.9713119755602545, "vf_explained_var": 0.6305327951908112, "kl": 0.007587198563646635, "entropy": 0.6240700315766864, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 106000, "num_env_steps_trained": 106000, "num_agent_steps_sampled": 106000, "num_agent_steps_trained": 106000}, "sampler_results": {"episode_reward_max": 22.55355450236968, "episode_reward_min": 1.0643544626778891, "episode_reward_mean": 20.44278611501245, "episode_len_mean": 28.83, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.15355450236968, 22.020221169036347, 14.286887732076437, 22.15355450236967, 22.020221169036347, 22.153554502369676, 20.953554502369673, 21.020221169036326, 1.8643544626778887, 20.286887823644637, 22.55355450236968, 21.42022107746451, 22.1535545023696, 22.15355450236968, 22.284271143946164, 20.68684773854835, 20.420221169036335, 21.42021588875252, 22.020221169036347, 21.153554502369666, 22.020221169036347, 20.88661998535719, 21.820221063770134, 20.18688703667872, 21.553554410958867, 21.9868825417729, 8.020221169035786, 21.220221169036336, 21.020221169036326, 20.28688783569938, 21.300349865184398, 22.15355450236967, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.286583347934936, 20.28684773854836, 22.153554502369676, 21.286887835703002, 21.284574936368212, 21.62022116225748, 22.020221169036347, 20.717908171361827, 20.53599620332989, 20.02022116903634, 22.020221169036347, 21.364056055994876, 20.153553807023656, 20.520221169036336, 20.686887835703004, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.153554502369676, 22.420221169036346, 20.420221169036335, 21.01932862602783, 22.15355450078174, 20.153554502369676, 21.020221169036326, 18.820221168827224, 20.286887835703013, 22.020221169036347, 21.153549222085925, 20.886887815044588, 20.286583347934933, 22.153554502369676, 22.020221169036347, 20.02022116903634, 21.153554502160556, 22.153554502366045, 22.15355450078174, 8.40266277842418, 20.684575631714225, 22.153554502369666, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.15355450078174, 19.41608215152476, 21.020221169036326, 22.020221169036347, 9.602662869996482, 20.219913209900735, 20.420221169005178, 21.88688783570293, 22.420221169036346, 22.15355450236968, 21.15355450236966, 21.135996203329878, 1.0643544626778891, 20.451242298354643, 22.05351265180163, 21.020221169036326, 21.453554502369677, 20.786543250780287, 22.020221169036347, 22.020221169036347, 21.319953308223564], "episode_lengths": [30, 30, 20, 30, 30, 30, 30, 30, 3, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 28, 30, 30, 15, 30, 30, 30, 30, 30, 30, 30, 2, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6990393786528888, "mean_inference_ms": 1.2172359340871792, "mean_action_processing_ms": 0.10488408319560062, "mean_env_wait_ms": 29.598902996820353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007182598114013672, "StateBufferConnector_ms": 0.004836082458496094, "ViewRequirementAgentConnector_ms": 0.11638808250427246}}, "episode_reward_max": 22.55355450236968, "episode_reward_min": 1.0643544626778891, "episode_reward_mean": 20.44278611501245, "episode_len_mean": 28.83, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.15355450236968, 22.020221169036347, 14.286887732076437, 22.15355450236967, 22.020221169036347, 22.153554502369676, 20.953554502369673, 21.020221169036326, 1.8643544626778887, 20.286887823644637, 22.55355450236968, 21.42022107746451, 22.1535545023696, 22.15355450236968, 22.284271143946164, 20.68684773854835, 20.420221169036335, 21.42021588875252, 22.020221169036347, 21.153554502369666, 22.020221169036347, 20.88661998535719, 21.820221063770134, 20.18688703667872, 21.553554410958867, 21.9868825417729, 8.020221169035786, 21.220221169036336, 21.020221169036326, 20.28688783569938, 21.300349865184398, 22.15355450236967, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.286583347934936, 20.28684773854836, 22.153554502369676, 21.286887835703002, 21.284574936368212, 21.62022116225748, 22.020221169036347, 20.717908171361827, 20.53599620332989, 20.02022116903634, 22.020221169036347, 21.364056055994876, 20.153553807023656, 20.520221169036336, 20.686887835703004, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.153554502369676, 22.420221169036346, 20.420221169036335, 21.01932862602783, 22.15355450078174, 20.153554502369676, 21.020221169036326, 18.820221168827224, 20.286887835703013, 22.020221169036347, 21.153549222085925, 20.886887815044588, 20.286583347934933, 22.153554502369676, 22.020221169036347, 20.02022116903634, 21.153554502160556, 22.153554502366045, 22.15355450078174, 8.40266277842418, 20.684575631714225, 22.153554502369666, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.15355450078174, 19.41608215152476, 21.020221169036326, 22.020221169036347, 9.602662869996482, 20.219913209900735, 20.420221169005178, 21.88688783570293, 22.420221169036346, 22.15355450236968, 21.15355450236966, 21.135996203329878, 1.0643544626778891, 20.451242298354643, 22.05351265180163, 21.020221169036326, 21.453554502369677, 20.786543250780287, 22.020221169036347, 22.020221169036347, 21.319953308223564], "episode_lengths": [30, 30, 20, 30, 30, 30, 30, 30, 3, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 28, 30, 30, 15, 30, 30, 30, 30, 30, 30, 30, 2, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6990393786528888, "mean_inference_ms": 1.2172359340871792, "mean_action_processing_ms": 0.10488408319560062, "mean_env_wait_ms": 29.598902996820353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007182598114013672, "StateBufferConnector_ms": 0.004836082458496094, "ViewRequirementAgentConnector_ms": 0.11638808250427246}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106000, "num_agent_steps_trained": 106000, "num_env_steps_sampled": 106000, "num_env_steps_trained": 106000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.856609468496124, "num_env_steps_trained_throughput_per_sec": 29.856609468496124, "timesteps_total": 106000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 106000, "timers": {"training_iteration_time_ms": 66354.355, "sample_time_ms": 63172.92, "load_time_ms": 11.338, "load_throughput": 176403.958, "learn_time_ms": 3167.497, "learn_throughput": 631.413, "synch_weights_time_ms": 2.146}, "counters": {"num_env_steps_sampled": 106000, "num_env_steps_trained": 106000, "num_agent_steps_sampled": 106000, "num_agent_steps_trained": 106000}, "done": false, "episodes_total": 3936, "training_iteration": 53, "trial_id": "13850_00001", "date": "2023-12-28_18-46-14", "timestamp": 1703760374, "time_this_iter_s": 66.99192595481873, "time_total_s": 3523.796275138855, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3523.796275138855, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 55.909375000000004, "ram_util_percent": 92.41145833333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.8580342233181e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5134081841591331, "policy_loss": -0.004118779115378857, "vf_loss": 0.5175269585909943, "vf_explained_var": 0.8170686711205376, "kl": 0.009406784042183267, "entropy": 0.544741363922755, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24075.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 22.420221169036346, "episode_reward_min": 1.0643544626778891, "episode_reward_mean": 20.67080072825166, "episode_len_mean": 29.19, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.020221169036347, 20.02022116903634, 21.153554502160556, 22.153554502366045, 22.15355450078174, 8.40266277842418, 20.684575631714225, 22.153554502369666, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.15355450078174, 19.41608215152476, 21.020221169036326, 22.020221169036347, 9.602662869996482, 20.219913209900735, 20.420221169005178, 21.88688783570293, 22.420221169036346, 22.15355450236968, 21.15355450236966, 21.135996203329878, 1.0643544626778891, 20.451242298354643, 22.05351265180163, 21.020221169036326, 21.453554502369677, 20.786543250780287, 22.020221169036347, 22.020221169036347, 21.319953308223564, 20.41790896504708, 20.02022116903634, 21.020221169036326, 20.02022116903634, 21.553554502337953, 21.020221169036326, 20.286887744134795, 21.420177620259775, 22.15355450236968, 22.15355450236967, 20.15355450236967, 20.65355450236548, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.15355450236966, 22.15355450236968, 22.020221169036347, 20.28688783569938, 20.02022116903634, 7.153554502128845, 21.135996203329878, 22.15355450236968, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.420221167211754, 21.286887835702995, 21.020221169036326, 20.02022116903634, 20.286882555419265, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.020221169036326, 22.286887835703013, 21.284574936368212, 21.020221169036326, 22.020221169036347, 20.1532500146016, 22.020221169036347, 20.153554502369676, 20.153554502369605, 20.820221063770113, 22.020221169036347, 21.020221169036326, 21.25355450236967, 20.219327486286662, 20.28688714035699, 22.053250007791647, 21.286887036678724, 22.153514405215034, 21.020221169036326, 22.020221169036347, 22.286887823644644, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.75355450236912, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.65355450236967, 21.020221169036326, 22.020221169036347, 22.15355450236968, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 28, 30, 30, 15, 30, 30, 30, 30, 30, 30, 30, 2, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6983642542710973, "mean_inference_ms": 1.2190440084495675, "mean_action_processing_ms": 0.10486917926759583, "mean_env_wait_ms": 29.5955910626209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007048130035400391, "StateBufferConnector_ms": 0.004761219024658203, "ViewRequirementAgentConnector_ms": 0.11519980430603027}}, "episode_reward_max": 22.420221169036346, "episode_reward_min": 1.0643544626778891, "episode_reward_mean": 20.67080072825166, "episode_len_mean": 29.19, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.020221169036347, 20.02022116903634, 21.153554502160556, 22.153554502366045, 22.15355450078174, 8.40266277842418, 20.684575631714225, 22.153554502369666, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.15355450078174, 19.41608215152476, 21.020221169036326, 22.020221169036347, 9.602662869996482, 20.219913209900735, 20.420221169005178, 21.88688783570293, 22.420221169036346, 22.15355450236968, 21.15355450236966, 21.135996203329878, 1.0643544626778891, 20.451242298354643, 22.05351265180163, 21.020221169036326, 21.453554502369677, 20.786543250780287, 22.020221169036347, 22.020221169036347, 21.319953308223564, 20.41790896504708, 20.02022116903634, 21.020221169036326, 20.02022116903634, 21.553554502337953, 21.020221169036326, 20.286887744134795, 21.420177620259775, 22.15355450236968, 22.15355450236967, 20.15355450236967, 20.65355450236548, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.15355450236966, 22.15355450236968, 22.020221169036347, 20.28688783569938, 20.02022116903634, 7.153554502128845, 21.135996203329878, 22.15355450236968, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.420221167211754, 21.286887835702995, 21.020221169036326, 20.02022116903634, 20.286882555419265, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.020221169036326, 22.286887835703013, 21.284574936368212, 21.020221169036326, 22.020221169036347, 20.1532500146016, 22.020221169036347, 20.153554502369676, 20.153554502369605, 20.820221063770113, 22.020221169036347, 21.020221169036326, 21.25355450236967, 20.219327486286662, 20.28688714035699, 22.053250007791647, 21.286887036678724, 22.153514405215034, 21.020221169036326, 22.020221169036347, 22.286887823644644, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.75355450236912, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.65355450236967, 21.020221169036326, 22.020221169036347, 22.15355450236968, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 28, 30, 30, 15, 30, 30, 30, 30, 30, 30, 30, 2, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6983642542710973, "mean_inference_ms": 1.2190440084495675, "mean_action_processing_ms": 0.10486917926759583, "mean_env_wait_ms": 29.5955910626209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007048130035400391, "StateBufferConnector_ms": 0.004761219024658203, "ViewRequirementAgentConnector_ms": 0.11519980430603027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.376883936887044, "num_env_steps_trained_throughput_per_sec": 30.376883936887044, "timesteps_total": 108000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 66353.995, "sample_time_ms": 63176.948, "load_time_ms": 10.82, "load_throughput": 184846.424, "learn_time_ms": 3163.615, "learn_throughput": 632.188, "synch_weights_time_ms": 2.157}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 4004, "training_iteration": 54, "trial_id": "13850_00001", "date": "2023-12-28_18-47-19", "timestamp": 1703760439, "time_this_iter_s": 65.84428548812866, "time_total_s": 3589.6405606269836, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3589.6405606269836, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 56.10645161290323, "ram_util_percent": 92.42903225806451}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.8580342233181e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.087439854376846, "policy_loss": 0.00128868554201391, "vf_loss": 1.0861511793153154, "vf_explained_var": 0.5226050636503432, "kl": 0.007967264096421631, "entropy": 0.4322047101126777, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24525.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_agent_steps_sampled": 110000, "num_agent_steps_trained": 110000}, "sampler_results": {"episode_reward_max": 22.286887823644644, "episode_reward_min": 3.0689788706554446, "episode_reward_mean": 20.735318488712586, "episode_len_mean": 29.22, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.284574936368212, 21.020221169036326, 22.020221169036347, 20.1532500146016, 22.020221169036347, 20.153554502369676, 20.153554502369605, 20.820221063770113, 22.020221169036347, 21.020221169036326, 21.25355450236967, 20.219327486286662, 20.28688714035699, 22.053250007791647, 21.286887036678724, 22.153514405215034, 21.020221169036326, 22.020221169036347, 22.286887823644644, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.75355450236912, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.65355450236967, 21.020221169036326, 22.020221169036347, 22.15355450236968, 20.02022116903634, 21.41959767646789, 20.32022116903633, 21.55355450236967, 21.020221169036326, 22.020221169036347, 20.486887835702934, 20.35355450236966, 21.020221169036326, 22.020221169036347, 20.520215966957494, 20.153554502342132, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.68688782364463, 20.78688782181985, 22.020221169036347, 5.019027604687673, 21.853553703345394, 22.15355450236968, 21.153554490311304, 20.32022116903634, 22.15355450236968, 21.020221169036326, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 7.086887835671288, 22.15355450078174, 22.153554502369676, 21.820221063770134, 22.020221169036347, 14.153554502369667, 21.986887835702994, 16.853554500781737, 21.153554490311304, 21.820221169036337, 21.25355450236967, 22.020221169036347, 20.886881846713557, 22.15355450236968, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.720221168795536, 21.020221169036326, 21.020221169036326, 20.886887835675473, 21.386887835703007, 22.020221169036347, 22.020221169036347, 21.15355450236967, 22.020221169036347, 22.020221169036347, 20.15355450236967, 20.953553794961195, 22.153554502369676, 3.0689788706554446, 21.020221169036326, 22.020221169036347, 20.1535544903113, 21.020221169036326, 21.286887835703002, 20.586882633627845, 22.020221169036347, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 22, 30, 26, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6976861164179808, "mean_inference_ms": 1.2197157654676178, "mean_action_processing_ms": 0.10484929931465015, "mean_env_wait_ms": 29.59005805901599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006970882415771484, "StateBufferConnector_ms": 0.004765748977661133, "ViewRequirementAgentConnector_ms": 0.11502718925476074}}, "episode_reward_max": 22.286887823644644, "episode_reward_min": 3.0689788706554446, "episode_reward_mean": 20.735318488712586, "episode_len_mean": 29.22, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.284574936368212, 21.020221169036326, 22.020221169036347, 20.1532500146016, 22.020221169036347, 20.153554502369676, 20.153554502369605, 20.820221063770113, 22.020221169036347, 21.020221169036326, 21.25355450236967, 20.219327486286662, 20.28688714035699, 22.053250007791647, 21.286887036678724, 22.153514405215034, 21.020221169036326, 22.020221169036347, 22.286887823644644, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.75355450236912, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.65355450236967, 21.020221169036326, 22.020221169036347, 22.15355450236968, 20.02022116903634, 21.41959767646789, 20.32022116903633, 21.55355450236967, 21.020221169036326, 22.020221169036347, 20.486887835702934, 20.35355450236966, 21.020221169036326, 22.020221169036347, 20.520215966957494, 20.153554502342132, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.68688782364463, 20.78688782181985, 22.020221169036347, 5.019027604687673, 21.853553703345394, 22.15355450236968, 21.153554490311304, 20.32022116903634, 22.15355450236968, 21.020221169036326, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 7.086887835671288, 22.15355450078174, 22.153554502369676, 21.820221063770134, 22.020221169036347, 14.153554502369667, 21.986887835702994, 16.853554500781737, 21.153554490311304, 21.820221169036337, 21.25355450236967, 22.020221169036347, 20.886881846713557, 22.15355450236968, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.720221168795536, 21.020221169036326, 21.020221169036326, 20.886887835675473, 21.386887835703007, 22.020221169036347, 22.020221169036347, 21.15355450236967, 22.020221169036347, 22.020221169036347, 20.15355450236967, 20.953553794961195, 22.153554502369676, 3.0689788706554446, 21.020221169036326, 22.020221169036347, 20.1535544903113, 21.020221169036326, 21.286887835703002, 20.586882633627845, 22.020221169036347, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 22, 30, 26, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6976861164179808, "mean_inference_ms": 1.2197157654676178, "mean_action_processing_ms": 0.10484929931465015, "mean_env_wait_ms": 29.59005805901599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006970882415771484, "StateBufferConnector_ms": 0.004765748977661133, "ViewRequirementAgentConnector_ms": 0.11502718925476074}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110000, "num_agent_steps_trained": 110000, "num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.37331691410291, "num_env_steps_trained_throughput_per_sec": 30.37331691410291, "timesteps_total": 110000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 110000, "timers": {"training_iteration_time_ms": 66153.751, "sample_time_ms": 62976.157, "load_time_ms": 10.919, "load_throughput": 183162.179, "learn_time_ms": 3164.073, "learn_throughput": 632.097, "synch_weights_time_ms": 2.144}, "counters": {"num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_agent_steps_sampled": 110000, "num_agent_steps_trained": 110000}, "done": false, "episodes_total": 4073, "training_iteration": 55, "trial_id": "13850_00001", "date": "2023-12-28_18-48-25", "timestamp": 1703760505, "time_this_iter_s": 65.85206413269043, "time_total_s": 3655.492624759674, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3655.492624759674, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 55.98085106382978, "ram_util_percent": 92.5031914893617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.8580342233181e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3450403208161394, "policy_loss": -0.02751996921168433, "vf_loss": 1.3725602937820884, "vf_explained_var": 0.4100070243411594, "kl": 0.007314346812880956, "entropy": 0.44455396036307016, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24975.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 22.15355450236968, "episode_reward_min": 3.0689788706554446, "episode_reward_mean": 20.33353793486942, "episode_len_mean": 28.87, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.820221169036337, 21.25355450236967, 22.020221169036347, 20.886881846713557, 22.15355450236968, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.720221168795536, 21.020221169036326, 21.020221169036326, 20.886887835675473, 21.386887835703007, 22.020221169036347, 22.020221169036347, 21.15355450236967, 22.020221169036347, 22.020221169036347, 20.15355450236967, 20.953553794961195, 22.153554502369676, 3.0689788706554446, 21.020221169036326, 22.020221169036347, 20.1535544903113, 21.020221169036326, 21.286887835703002, 20.586882633627845, 22.020221169036347, 22.020221169036347, 20.28688783569937, 20.452660818028424, 22.020221169036347, 22.020221169036347, 20.786887744134805, 5.269058019178027, 21.153554502369662, 20.420221169035784, 20.5862643431345, 20.620221169036338, 20.219327472403517, 20.45355274936995, 21.020221169036326, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 21.420221169035774, 22.1512422983809, 22.020221169036347, 22.020221169036347, 21.15355441080147, 21.15355450236967, 22.020221169036347, 21.986887835703012, 20.02022116903634, 21.020221169036326, 21.15355450236919, 20.286887835675465, 22.020221169036347, 21.286887835703, 20.353548421473317, 20.153549222085925, 21.020221169036326, 22.020221169036347, 21.753554500541274, 22.020221169036347, 21.920221169036342, 20.620221169036338, 9.35355450236966, 22.15355450236968, 11.766712844906374, 8.153554502369118, 21.020221169036326, 20.28688783567184, 20.88688782181623, 20.28658334793493, 20.786887835703006, 20.02022116903634, 21.020221169036326, 20.153549222085925, 21.05355450236966, 21.920221169036342, 20.452655539310005, 20.72022116903634, 17.686887835703008, 20.92022116903633, 20.320221168795523, 21.317902294567446, 17.88688783570301, 22.020221169036347, 20.25355450236966, 22.020221169036347, 20.5868495673634, 20.286887835703002, 22.15355450236968, 20.75355450236967, 22.020221169036347, 21.020221169036326, 12.182792366967995], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 15, 30, 18, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 26, 30, 30, 30, 30, 30, 30, 30, 30, 30, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6972832455368662, "mean_inference_ms": 1.2198118882990554, "mean_action_processing_ms": 0.10485510677853932, "mean_env_wait_ms": 29.593926746911198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006989240646362305, "StateBufferConnector_ms": 0.004809856414794922, "ViewRequirementAgentConnector_ms": 0.11638569831848145}}, "episode_reward_max": 22.15355450236968, "episode_reward_min": 3.0689788706554446, "episode_reward_mean": 20.33353793486942, "episode_len_mean": 28.87, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.820221169036337, 21.25355450236967, 22.020221169036347, 20.886881846713557, 22.15355450236968, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.720221168795536, 21.020221169036326, 21.020221169036326, 20.886887835675473, 21.386887835703007, 22.020221169036347, 22.020221169036347, 21.15355450236967, 22.020221169036347, 22.020221169036347, 20.15355450236967, 20.953553794961195, 22.153554502369676, 3.0689788706554446, 21.020221169036326, 22.020221169036347, 20.1535544903113, 21.020221169036326, 21.286887835703002, 20.586882633627845, 22.020221169036347, 22.020221169036347, 20.28688783569937, 20.452660818028424, 22.020221169036347, 22.020221169036347, 20.786887744134805, 5.269058019178027, 21.153554502369662, 20.420221169035784, 20.5862643431345, 20.620221169036338, 20.219327472403517, 20.45355274936995, 21.020221169036326, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 21.420221169035774, 22.1512422983809, 22.020221169036347, 22.020221169036347, 21.15355441080147, 21.15355450236967, 22.020221169036347, 21.986887835703012, 20.02022116903634, 21.020221169036326, 21.15355450236919, 20.286887835675465, 22.020221169036347, 21.286887835703, 20.353548421473317, 20.153549222085925, 21.020221169036326, 22.020221169036347, 21.753554500541274, 22.020221169036347, 21.920221169036342, 20.620221169036338, 9.35355450236966, 22.15355450236968, 11.766712844906374, 8.153554502369118, 21.020221169036326, 20.28688783567184, 20.88688782181623, 20.28658334793493, 20.786887835703006, 20.02022116903634, 21.020221169036326, 20.153549222085925, 21.05355450236966, 21.920221169036342, 20.452655539310005, 20.72022116903634, 17.686887835703008, 20.92022116903633, 20.320221168795523, 21.317902294567446, 17.88688783570301, 22.020221169036347, 20.25355450236966, 22.020221169036347, 20.5868495673634, 20.286887835703002, 22.15355450236968, 20.75355450236967, 22.020221169036347, 21.020221169036326, 12.182792366967995], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 15, 30, 18, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 26, 30, 30, 30, 30, 30, 30, 30, 30, 30, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6972832455368662, "mean_inference_ms": 1.2198118882990554, "mean_action_processing_ms": 0.10485510677853932, "mean_env_wait_ms": 29.593926746911198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006989240646362305, "StateBufferConnector_ms": 0.004809856414794922, "ViewRequirementAgentConnector_ms": 0.11638569831848145}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.701939238492873, "num_env_steps_trained_throughput_per_sec": 29.701939238492873, "timesteps_total": 112000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 66316.944, "sample_time_ms": 63134.995, "load_time_ms": 9.588, "load_throughput": 208587.783, "learn_time_ms": 3169.789, "learn_throughput": 630.957, "synch_weights_time_ms": 2.118}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 4143, "training_iteration": 56, "trial_id": "13850_00001", "date": "2023-12-28_18-49-33", "timestamp": 1703760573, "time_this_iter_s": 67.34073805809021, "time_total_s": 3722.8333628177643, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3722.8333628177643, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 55.802083333333336, "ram_util_percent": 92.52604166666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.8580342233181e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.475219466475149, "policy_loss": 0.0017760516703128814, "vf_loss": 0.4734434146247804, "vf_explained_var": 0.5118393101957109, "kl": 0.0038066894161094644, "entropy": 0.4289551865392261, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 25425.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 114000, "num_env_steps_trained": 114000, "num_agent_steps_sampled": 114000, "num_agent_steps_trained": 114000}, "sampler_results": {"episode_reward_max": 22.286887835703013, "episode_reward_min": 6.053554502128845, "episode_reward_mean": 20.269367316769753, "episode_len_mean": 29.03, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.920221169036342, 20.620221169036338, 9.35355450236966, 22.15355450236968, 11.766712844906374, 8.153554502369118, 21.020221169036326, 20.28688783567184, 20.88688782181623, 20.28658334793493, 20.786887835703006, 20.02022116903634, 21.020221169036326, 20.153549222085925, 21.05355450236966, 21.920221169036342, 20.452655539310005, 20.72022116903634, 17.686887835703008, 20.92022116903633, 20.320221168795523, 21.317902294567446, 17.88688783570301, 22.020221169036347, 20.25355450236966, 22.020221169036347, 20.5868495673634, 20.286887835703002, 22.15355450236968, 20.75355450236967, 22.020221169036347, 21.020221169036326, 12.182792366967995, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.152931009801165, 22.020221169036347, 21.020221169036336, 20.286887835703006, 21.15351440521502, 20.51932772732909, 22.020221169036347, 21.15355380702366, 21.020221169036326, 21.286264341546577, 20.02022116903634, 21.020221169036326, 21.38599529268733, 21.15355450236966, 21.135996203329878, 20.350326556374686, 20.35355450236966, 21.2202211674484, 20.353554502337957, 20.153554502369673, 20.153554502369673, 21.020215186627496, 20.02022116903634, 20.420221169036335, 20.02022116903634, 20.15355450236967, 20.086887835703006, 20.453554502369595, 21.020221169036326, 20.02022116903634, 12.820221169036333, 22.020221169036347, 6.053554502128845, 20.286887835703002, 20.820221063770113, 21.15355450236919, 21.15355450236966, 20.02022116903634, 20.42022116903634, 20.02022116903634, 20.153554502369666, 22.020221169036347, 22.020221169036347, 20.153553807023656, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.15355450236968, 22.020221169036347, 21.020221169036326, 20.153553807023656, 20.75355450236967, 20.820221156974334, 22.153514405215034, 21.020221169036326, 22.286887835703013, 21.020221169036326, 22.020221169036347, 22.153554502160564, 20.686887835703004, 22.020221169036347, 20.02022116903634, 22.020221169036347, 21.2199132219591], "episode_lengths": [30, 30, 15, 30, 18, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 26, 30, 30, 30, 30, 30, 30, 30, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 19, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6967337986191899, "mean_inference_ms": 1.2197739956359888, "mean_action_processing_ms": 0.10485192717478595, "mean_env_wait_ms": 29.594605456468663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006933927536010742, "StateBufferConnector_ms": 0.004698991775512695, "ViewRequirementAgentConnector_ms": 0.11527848243713379}}, "episode_reward_max": 22.286887835703013, "episode_reward_min": 6.053554502128845, "episode_reward_mean": 20.269367316769753, "episode_len_mean": 29.03, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.920221169036342, 20.620221169036338, 9.35355450236966, 22.15355450236968, 11.766712844906374, 8.153554502369118, 21.020221169036326, 20.28688783567184, 20.88688782181623, 20.28658334793493, 20.786887835703006, 20.02022116903634, 21.020221169036326, 20.153549222085925, 21.05355450236966, 21.920221169036342, 20.452655539310005, 20.72022116903634, 17.686887835703008, 20.92022116903633, 20.320221168795523, 21.317902294567446, 17.88688783570301, 22.020221169036347, 20.25355450236966, 22.020221169036347, 20.5868495673634, 20.286887835703002, 22.15355450236968, 20.75355450236967, 22.020221169036347, 21.020221169036326, 12.182792366967995, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.152931009801165, 22.020221169036347, 21.020221169036336, 20.286887835703006, 21.15351440521502, 20.51932772732909, 22.020221169036347, 21.15355380702366, 21.020221169036326, 21.286264341546577, 20.02022116903634, 21.020221169036326, 21.38599529268733, 21.15355450236966, 21.135996203329878, 20.350326556374686, 20.35355450236966, 21.2202211674484, 20.353554502337957, 20.153554502369673, 20.153554502369673, 21.020215186627496, 20.02022116903634, 20.420221169036335, 20.02022116903634, 20.15355450236967, 20.086887835703006, 20.453554502369595, 21.020221169036326, 20.02022116903634, 12.820221169036333, 22.020221169036347, 6.053554502128845, 20.286887835703002, 20.820221063770113, 21.15355450236919, 21.15355450236966, 20.02022116903634, 20.42022116903634, 20.02022116903634, 20.153554502369666, 22.020221169036347, 22.020221169036347, 20.153553807023656, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.15355450236968, 22.020221169036347, 21.020221169036326, 20.153553807023656, 20.75355450236967, 20.820221156974334, 22.153514405215034, 21.020221169036326, 22.286887835703013, 21.020221169036326, 22.020221169036347, 22.153554502160564, 20.686887835703004, 22.020221169036347, 20.02022116903634, 22.020221169036347, 21.2199132219591], "episode_lengths": [30, 30, 15, 30, 18, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 26, 30, 30, 30, 30, 30, 30, 30, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 19, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6967337986191899, "mean_inference_ms": 1.2197739956359888, "mean_action_processing_ms": 0.10485192717478595, "mean_env_wait_ms": 29.594605456468663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006933927536010742, "StateBufferConnector_ms": 0.004698991775512695, "ViewRequirementAgentConnector_ms": 0.11527848243713379}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114000, "num_agent_steps_trained": 114000, "num_env_steps_sampled": 114000, "num_env_steps_trained": 114000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.24002553071003, "num_env_steps_trained_throughput_per_sec": 30.24002553071003, "timesteps_total": 114000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 114000, "timers": {"training_iteration_time_ms": 66312.703, "sample_time_ms": 63129.303, "load_time_ms": 9.121, "load_throughput": 219264.154, "learn_time_ms": 3171.724, "learn_throughput": 630.572, "synch_weights_time_ms": 2.097}, "counters": {"num_env_steps_sampled": 114000, "num_env_steps_trained": 114000, "num_agent_steps_sampled": 114000, "num_agent_steps_trained": 114000}, "done": false, "episodes_total": 4210, "training_iteration": 57, "trial_id": "13850_00001", "date": "2023-12-28_18-50-39", "timestamp": 1703760639, "time_this_iter_s": 66.14236855506897, "time_total_s": 3788.9757313728333, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3788.9757313728333, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 56.099999999999994, "ram_util_percent": 92.47127659574465}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.92901711165905e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8417715542018414, "policy_loss": 0.005007174147499932, "vf_loss": 0.836764376875427, "vf_explained_var": 0.5433584951029884, "kl": 0.0050366776754492875, "entropy": 0.32321823206212785, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 25875.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 22.286887835703013, "episode_reward_min": 6.053554502128845, "episode_reward_mean": 20.77285113688028, "episode_len_mean": 29.62, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.053554502128845, 20.286887835703002, 20.820221063770113, 21.15355450236919, 21.15355450236966, 20.02022116903634, 20.42022116903634, 20.02022116903634, 20.153554502369666, 22.020221169036347, 22.020221169036347, 20.153553807023656, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.15355450236968, 22.020221169036347, 21.020221169036326, 20.153553807023656, 20.75355450236967, 20.820221156974334, 22.153514405215034, 21.020221169036326, 22.286887835703013, 21.020221169036326, 22.020221169036347, 22.153554502160564, 20.686887835703004, 22.020221169036347, 20.02022116903634, 22.020221169036347, 21.2199132219591, 21.020221169036326, 22.020221169036347, 15.220182900693581, 18.986887823644636, 22.020221169036347, 20.28688774413479, 22.020221169036347, 21.586887835702992, 21.020221169036326, 22.020221169036347, 21.020221169036326, 12.720221169036334, 20.02022116903634, 20.153554502369673, 22.020221169036347, 20.153554502369673, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.151242298380893, 20.15355450236967, 20.28688783570299, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.486887835703012, 20.753554502365482, 20.02022116903634, 20.55355450236967, 21.020221169036326, 20.02022116903634, 21.25355450234213, 21.020221169036326, 22.15355450236968, 22.020221169036347, 20.686887835703004, 20.420221155390042, 22.020221169036347, 20.353554502337957, 22.020221169036347, 20.153554502369673, 20.02022116903634, 20.02022116903634, 20.453554502369663, 20.42022116903634, 21.020221169036326, 21.086886071151362, 20.153548513380233, 21.253554488486518, 22.020221169036347, 20.386887821819858, 21.020221169036326, 21.286887835703006, 21.920221169036342, 20.98688703667881, 21.2535109535931, 20.653248257092844, 20.1535544903113, 22.020221169036347, 21.020221169036326, 20.2868877441348, 21.986887835703012, 22.020221169036347, 20.65294324047954, 22.020221169036347, 21.286887835702995, 22.020221169036347], "episode_lengths": [10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 29, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.696089666310165, "mean_inference_ms": 1.2195429362723282, "mean_action_processing_ms": 0.1048387084252012, "mean_env_wait_ms": 29.591092776761663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006868600845336914, "StateBufferConnector_ms": 0.0046710968017578125, "ViewRequirementAgentConnector_ms": 0.1145172119140625}}, "episode_reward_max": 22.286887835703013, "episode_reward_min": 6.053554502128845, "episode_reward_mean": 20.77285113688028, "episode_len_mean": 29.62, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.053554502128845, 20.286887835703002, 20.820221063770113, 21.15355450236919, 21.15355450236966, 20.02022116903634, 20.42022116903634, 20.02022116903634, 20.153554502369666, 22.020221169036347, 22.020221169036347, 20.153553807023656, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.15355450236968, 22.020221169036347, 21.020221169036326, 20.153553807023656, 20.75355450236967, 20.820221156974334, 22.153514405215034, 21.020221169036326, 22.286887835703013, 21.020221169036326, 22.020221169036347, 22.153554502160564, 20.686887835703004, 22.020221169036347, 20.02022116903634, 22.020221169036347, 21.2199132219591, 21.020221169036326, 22.020221169036347, 15.220182900693581, 18.986887823644636, 22.020221169036347, 20.28688774413479, 22.020221169036347, 21.586887835702992, 21.020221169036326, 22.020221169036347, 21.020221169036326, 12.720221169036334, 20.02022116903634, 20.153554502369673, 22.020221169036347, 20.153554502369673, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.151242298380893, 20.15355450236967, 20.28688783570299, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.486887835703012, 20.753554502365482, 20.02022116903634, 20.55355450236967, 21.020221169036326, 20.02022116903634, 21.25355450234213, 21.020221169036326, 22.15355450236968, 22.020221169036347, 20.686887835703004, 20.420221155390042, 22.020221169036347, 20.353554502337957, 22.020221169036347, 20.153554502369673, 20.02022116903634, 20.02022116903634, 20.453554502369663, 20.42022116903634, 21.020221169036326, 21.086886071151362, 20.153548513380233, 21.253554488486518, 22.020221169036347, 20.386887821819858, 21.020221169036326, 21.286887835703006, 21.920221169036342, 20.98688703667881, 21.2535109535931, 20.653248257092844, 20.1535544903113, 22.020221169036347, 21.020221169036326, 20.2868877441348, 21.986887835703012, 22.020221169036347, 20.65294324047954, 22.020221169036347, 21.286887835702995, 22.020221169036347], "episode_lengths": [10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 29, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.696089666310165, "mean_inference_ms": 1.2195429362723282, "mean_action_processing_ms": 0.1048387084252012, "mean_env_wait_ms": 29.591092776761663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006868600845336914, "StateBufferConnector_ms": 0.0046710968017578125, "ViewRequirementAgentConnector_ms": 0.1145172119140625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.35294010203276, "num_env_steps_trained_throughput_per_sec": 30.35294010203276, "timesteps_total": 116000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 66364.775, "sample_time_ms": 63178.908, "load_time_ms": 9.508, "load_throughput": 210338.855, "learn_time_ms": 3173.803, "learn_throughput": 630.159, "synch_weights_time_ms": 2.098}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 4278, "training_iteration": 58, "trial_id": "13850_00001", "date": "2023-12-28_18-51-45", "timestamp": 1703760705, "time_this_iter_s": 65.89626407623291, "time_total_s": 3854.871995449066, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3854.871995449066, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 55.958510638297874, "ram_util_percent": 92.48085106382979}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.92901711165905e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.700521818117963, "policy_loss": 0.00665930547648006, "vf_loss": 0.6938625161018637, "vf_explained_var": 0.6082981545395322, "kl": 0.0017563547720990207, "entropy": 0.30989539606703653, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 26325.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 118000, "num_env_steps_trained": 118000, "num_agent_steps_sampled": 118000, "num_agent_steps_trained": 118000}, "sampler_results": {"episode_reward_max": 22.153554502160564, "episode_reward_min": 5.720221155149215, "episode_reward_mean": 20.679543091678237, "episode_len_mean": 29.55, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.686887835703004, 20.420221155390042, 22.020221169036347, 20.353554502337957, 22.020221169036347, 20.153554502369673, 20.02022116903634, 20.02022116903634, 20.453554502369663, 20.42022116903634, 21.020221169036326, 21.086886071151362, 20.153548513380233, 21.253554488486518, 22.020221169036347, 20.386887821819858, 21.020221169036326, 21.286887835703006, 21.920221169036342, 20.98688703667881, 21.2535109535931, 20.653248257092844, 20.1535544903113, 22.020221169036347, 21.020221169036326, 20.2868877441348, 21.986887835703012, 22.020221169036347, 20.65294324047954, 22.020221169036347, 21.286887835702995, 22.020221169036347, 20.02022116903634, 20.153554502369666, 20.620221169035773, 20.753554500541252, 22.020221169036347, 21.186849475977485, 20.820221169008803, 20.15355450236966, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.15355380702366, 21.020221169036326, 20.153554502369676, 22.020221169036347, 20.02022116903634, 21.153554502369666, 21.15355450236966, 9.35355450236966, 20.02022116903634, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.28688783549389, 15.486887835703005, 20.153554410801462, 21.15355450236966, 21.153554502366042, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.153554502369673, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.453554490311305, 20.25351095359321, 19.253554502369667, 20.02022116903634, 21.153554502369666, 22.153554502160564, 20.42022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.253510953593103, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.786887140356985, 20.02022116903634, 21.686887835702997, 21.920177620259782, 21.153554502369662, 22.020221169036347, 20.42022116903627, 20.02022116903634, 21.286887835703002, 21.020221169036326, 5.720221155149215, 21.020221169036326, 20.02022116903634, 20.18688703667872], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 15, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 9, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6955723720943117, "mean_inference_ms": 1.2194754487658122, "mean_action_processing_ms": 0.10483747735346842, "mean_env_wait_ms": 29.59047358465539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00710296630859375, "StateBufferConnector_ms": 0.004738569259643555, "ViewRequirementAgentConnector_ms": 0.11537337303161621}}, "episode_reward_max": 22.153554502160564, "episode_reward_min": 5.720221155149215, "episode_reward_mean": 20.679543091678237, "episode_len_mean": 29.55, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.686887835703004, 20.420221155390042, 22.020221169036347, 20.353554502337957, 22.020221169036347, 20.153554502369673, 20.02022116903634, 20.02022116903634, 20.453554502369663, 20.42022116903634, 21.020221169036326, 21.086886071151362, 20.153548513380233, 21.253554488486518, 22.020221169036347, 20.386887821819858, 21.020221169036326, 21.286887835703006, 21.920221169036342, 20.98688703667881, 21.2535109535931, 20.653248257092844, 20.1535544903113, 22.020221169036347, 21.020221169036326, 20.2868877441348, 21.986887835703012, 22.020221169036347, 20.65294324047954, 22.020221169036347, 21.286887835702995, 22.020221169036347, 20.02022116903634, 20.153554502369666, 20.620221169035773, 20.753554500541252, 22.020221169036347, 21.186849475977485, 20.820221169008803, 20.15355450236966, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.15355380702366, 21.020221169036326, 20.153554502369676, 22.020221169036347, 20.02022116903634, 21.153554502369666, 21.15355450236966, 9.35355450236966, 20.02022116903634, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.28688783549389, 15.486887835703005, 20.153554410801462, 21.15355450236966, 21.153554502366042, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.153554502369673, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.453554490311305, 20.25351095359321, 19.253554502369667, 20.02022116903634, 21.153554502369666, 22.153554502160564, 20.42022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.253510953593103, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.786887140356985, 20.02022116903634, 21.686887835702997, 21.920177620259782, 21.153554502369662, 22.020221169036347, 20.42022116903627, 20.02022116903634, 21.286887835703002, 21.020221169036326, 5.720221155149215, 21.020221169036326, 20.02022116903634, 20.18688703667872], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 15, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 9, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6955723720943117, "mean_inference_ms": 1.2194754487658122, "mean_action_processing_ms": 0.10483747735346842, "mean_env_wait_ms": 29.59047358465539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00710296630859375, "StateBufferConnector_ms": 0.004738569259643555, "ViewRequirementAgentConnector_ms": 0.11537337303161621}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118000, "num_agent_steps_trained": 118000, "num_env_steps_sampled": 118000, "num_env_steps_trained": 118000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.073727526559516, "num_env_steps_trained_throughput_per_sec": 30.073727526559516, "timesteps_total": 118000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 118000, "timers": {"training_iteration_time_ms": 66367.462, "sample_time_ms": 63181.68, "load_time_ms": 9.019, "load_throughput": 221760.686, "learn_time_ms": 3174.208, "learn_throughput": 630.078, "synch_weights_time_ms": 2.102}, "counters": {"num_env_steps_sampled": 118000, "num_env_steps_trained": 118000, "num_agent_steps_sampled": 118000, "num_agent_steps_trained": 118000}, "done": false, "episodes_total": 4346, "training_iteration": 59, "trial_id": "13850_00001", "date": "2023-12-28_18-52-51", "timestamp": 1703760771, "time_this_iter_s": 66.508145570755, "time_total_s": 3921.380141019821, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3921.380141019821, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 55.894736842105274, "ram_util_percent": 92.47473684210524}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.964508555829525e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6584179047743479, "policy_loss": 0.005997452206081814, "vf_loss": 0.6524204560990134, "vf_explained_var": 0.6683052824603186, "kl": 0.00313724567420877, "entropy": 0.27394716660181684, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 26775.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 22.15355450236968, "episode_reward_min": 5.720221155149215, "episode_reward_mean": 20.71685967715439, "episode_len_mean": 29.54, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.453554490311305, 20.25351095359321, 19.253554502369667, 20.02022116903634, 21.153554502369666, 22.153554502160564, 20.42022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.253510953593103, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.786887140356985, 20.02022116903634, 21.686887835702997, 21.920177620259782, 21.153554502369662, 22.020221169036347, 20.42022116903627, 20.02022116903634, 21.286887835703002, 21.020221169036326, 5.720221155149215, 21.020221169036326, 20.02022116903634, 20.18688703667872, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.420221169036328, 21.020221169036326, 22.020221169036347, 21.15355450236966, 22.020221169036347, 22.020221169036347, 21.55355450236967, 20.35355450236966, 22.020221169036347, 20.02022116903634, 21.020221169036326, 14.153554502369667, 21.020221169036326, 20.75355450236967, 21.320221169036337, 20.686887835672582, 21.020221169036326, 20.02022116903634, 20.151242298380893, 21.020221169036326, 20.153514405215024, 20.02022116903634, 22.020221169036347, 20.286887835702466, 22.020221169036347, 21.020221169036326, 20.520221169036336, 20.286876566429818, 20.02022116903634, 20.8199533268699, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.15355450236967, 22.020221169036347, 22.15355450236968, 20.15355450078173, 22.020221169036347, 9.253554502160485, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.153554502369673, 22.020221169036347, 22.020221169036347, 20.65355450236548, 20.02022116903634, 20.02022116903634, 20.153548513380233, 22.020221169036347, 20.153548513380233, 22.153514405215034, 21.020221169036326, 21.553554502369195, 20.02022116903634, 22.020221169036347, 21.286887835703002, 20.02022116903634, 21.620221167413348, 22.020221169036347, 20.353554305535248, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 9, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6950779452323635, "mean_inference_ms": 1.219482165083436, "mean_action_processing_ms": 0.1048443783632014, "mean_env_wait_ms": 29.59102216243062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007068157196044922, "StateBufferConnector_ms": 0.004721403121948242, "ViewRequirementAgentConnector_ms": 0.11506080627441406}}, "episode_reward_max": 22.15355450236968, "episode_reward_min": 5.720221155149215, "episode_reward_mean": 20.71685967715439, "episode_len_mean": 29.54, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.453554490311305, 20.25351095359321, 19.253554502369667, 20.02022116903634, 21.153554502369666, 22.153554502160564, 20.42022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.253510953593103, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.786887140356985, 20.02022116903634, 21.686887835702997, 21.920177620259782, 21.153554502369662, 22.020221169036347, 20.42022116903627, 20.02022116903634, 21.286887835703002, 21.020221169036326, 5.720221155149215, 21.020221169036326, 20.02022116903634, 20.18688703667872, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.420221169036328, 21.020221169036326, 22.020221169036347, 21.15355450236966, 22.020221169036347, 22.020221169036347, 21.55355450236967, 20.35355450236966, 22.020221169036347, 20.02022116903634, 21.020221169036326, 14.153554502369667, 21.020221169036326, 20.75355450236967, 21.320221169036337, 20.686887835672582, 21.020221169036326, 20.02022116903634, 20.151242298380893, 21.020221169036326, 20.153514405215024, 20.02022116903634, 22.020221169036347, 20.286887835702466, 22.020221169036347, 21.020221169036326, 20.520221169036336, 20.286876566429818, 20.02022116903634, 20.8199533268699, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.15355450236967, 22.020221169036347, 22.15355450236968, 20.15355450078173, 22.020221169036347, 9.253554502160485, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.153554502369673, 22.020221169036347, 22.020221169036347, 20.65355450236548, 20.02022116903634, 20.02022116903634, 20.153548513380233, 22.020221169036347, 20.153548513380233, 22.153514405215034, 21.020221169036326, 21.553554502369195, 20.02022116903634, 22.020221169036347, 21.286887835703002, 20.02022116903634, 21.620221167413348, 22.020221169036347, 20.353554305535248, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 9, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6950779452323635, "mean_inference_ms": 1.219482165083436, "mean_action_processing_ms": 0.1048443783632014, "mean_env_wait_ms": 29.59102216243062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007068157196044922, "StateBufferConnector_ms": 0.004721403121948242, "ViewRequirementAgentConnector_ms": 0.11506080627441406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.095231552765554, "num_env_steps_trained_throughput_per_sec": 30.095231552765554, "timesteps_total": 120000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 66424.57, "sample_time_ms": 63236.611, "load_time_ms": 10.037, "load_throughput": 199265.706, "learn_time_ms": 3175.383, "learn_throughput": 629.845, "synch_weights_time_ms": 2.097}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 4413, "training_iteration": 60, "trial_id": "13850_00001", "date": "2023-12-28_18-53-58", "timestamp": 1703760838, "time_this_iter_s": 66.46037125587463, "time_total_s": 3987.840512275696, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3987.840512275696, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 55.80744680851065, "ram_util_percent": 92.4021276595744}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.822542779147626e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.30541687299393944, "policy_loss": 0.001771265235212114, "vf_loss": 0.30364561156680187, "vf_explained_var": 0.8710930992497338, "kl": 0.0015338355602412257, "entropy": 0.24916245059834585, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 27225.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 122000, "num_env_steps_trained": 122000, "num_agent_steps_sampled": 122000, "num_agent_steps_trained": 122000}, "sampler_results": {"episode_reward_max": 22.15355450236968, "episode_reward_min": 9.253554502160485, "episode_reward_mean": 20.9380210409768, "episode_len_mean": 29.79, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.020221169036326, 22.020221169036347, 22.15355450236967, 22.020221169036347, 22.15355450236968, 20.15355450078173, 22.020221169036347, 9.253554502160485, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.153554502369673, 22.020221169036347, 22.020221169036347, 20.65355450236548, 20.02022116903634, 20.02022116903634, 20.153548513380233, 22.020221169036347, 20.153548513380233, 22.153514405215034, 21.020221169036326, 21.553554502369195, 20.02022116903634, 22.020221169036347, 21.286887835703002, 20.02022116903634, 21.620221167413348, 22.020221169036347, 20.353554305535248, 22.020221169036347, 20.153554502369666, 22.15355450236968, 21.020221169036326, 20.02022116903634, 20.153554502369676, 22.020221169036347, 20.153554502369673, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 17.82022116903634, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.153554502366042, 22.020221169036347, 21.020221169036326, 20.151242298380893, 20.153554502366045, 22.020221169036347, 20.535996203329336, 21.15355441080147, 22.020221169036347, 20.553554502369668, 22.15355449031131, 20.02022116903634, 21.553553715455458, 20.98688783570299, 20.153554502369676, 20.65351440521502, 20.02022116903634, 22.020221169036347, 20.220221063770126, 20.02022116903634, 21.020221169036326, 20.02022116903634, 20.120177620259774, 20.02022116903634, 20.02022116903634, 21.55355450236967, 20.286887835675465, 20.486887835702994, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.153554502160556, 22.15355450236967, 20.02022116903634, 22.020221169036347, 21.153549222085925, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.820221063770113, 22.020221169036347, 22.020221169036347, 20.15355450236967, 21.153554502369662, 21.020221169036326, 20.02022116903634, 20.320221169036326, 22.020221169036347, 20.620221169036338, 21.020221169036326], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6945935002224936, "mean_inference_ms": 1.2195192873928473, "mean_action_processing_ms": 0.10484931821589216, "mean_env_wait_ms": 29.594087469048763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007104158401489258, "StateBufferConnector_ms": 0.004694938659667969, "ViewRequirementAgentConnector_ms": 0.11676168441772461}}, "episode_reward_max": 22.15355450236968, "episode_reward_min": 9.253554502160485, "episode_reward_mean": 20.9380210409768, "episode_len_mean": 29.79, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.020221169036326, 22.020221169036347, 22.15355450236967, 22.020221169036347, 22.15355450236968, 20.15355450078173, 22.020221169036347, 9.253554502160485, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.153554502369673, 22.020221169036347, 22.020221169036347, 20.65355450236548, 20.02022116903634, 20.02022116903634, 20.153548513380233, 22.020221169036347, 20.153548513380233, 22.153514405215034, 21.020221169036326, 21.553554502369195, 20.02022116903634, 22.020221169036347, 21.286887835703002, 20.02022116903634, 21.620221167413348, 22.020221169036347, 20.353554305535248, 22.020221169036347, 20.153554502369666, 22.15355450236968, 21.020221169036326, 20.02022116903634, 20.153554502369676, 22.020221169036347, 20.153554502369673, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 17.82022116903634, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.153554502366042, 22.020221169036347, 21.020221169036326, 20.151242298380893, 20.153554502366045, 22.020221169036347, 20.535996203329336, 21.15355441080147, 22.020221169036347, 20.553554502369668, 22.15355449031131, 20.02022116903634, 21.553553715455458, 20.98688783570299, 20.153554502369676, 20.65351440521502, 20.02022116903634, 22.020221169036347, 20.220221063770126, 20.02022116903634, 21.020221169036326, 20.02022116903634, 20.120177620259774, 20.02022116903634, 20.02022116903634, 21.55355450236967, 20.286887835675465, 20.486887835702994, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.153554502160556, 22.15355450236967, 20.02022116903634, 22.020221169036347, 21.153549222085925, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.820221063770113, 22.020221169036347, 22.020221169036347, 20.15355450236967, 21.153554502369662, 21.020221169036326, 20.02022116903634, 20.320221169036326, 22.020221169036347, 20.620221169036338, 21.020221169036326], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6945935002224936, "mean_inference_ms": 1.2195192873928473, "mean_action_processing_ms": 0.10484931821589216, "mean_env_wait_ms": 29.594087469048763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007104158401489258, "StateBufferConnector_ms": 0.004694938659667969, "ViewRequirementAgentConnector_ms": 0.11676168441772461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122000, "num_agent_steps_trained": 122000, "num_env_steps_sampled": 122000, "num_env_steps_trained": 122000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.88178780151466, "num_env_steps_trained_throughput_per_sec": 29.88178780151466, "timesteps_total": 122000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 122000, "timers": {"training_iteration_time_ms": 66493.703, "sample_time_ms": 63306.83, "load_time_ms": 10.085, "load_throughput": 198306.62, "learn_time_ms": 3174.239, "learn_throughput": 630.072, "synch_weights_time_ms": 2.104}, "counters": {"num_env_steps_sampled": 122000, "num_env_steps_trained": 122000, "num_agent_steps_sampled": 122000, "num_agent_steps_trained": 122000}, "done": false, "episodes_total": 4480, "training_iteration": 61, "trial_id": "13850_00001", "date": "2023-12-28_18-55-05", "timestamp": 1703760905, "time_this_iter_s": 66.93504524230957, "time_total_s": 4054.7755575180054, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4054.7755575180054, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 55.92526315789473, "ram_util_percent": 92.3852631578947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.911271389573813e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2803401003358886, "policy_loss": -0.00021853898134496476, "vf_loss": 0.28055864088651206, "vf_explained_var": 0.8560511484411027, "kl": 0.0017983726349365468, "entropy": 0.18677322914203007, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 27675.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 22.286882555419265, "episode_reward_min": 8.153554502365491, "episode_reward_mean": 20.92802145178878, "episode_len_mean": 29.82, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.220221063770126, 20.02022116903634, 21.020221169036326, 20.02022116903634, 20.120177620259774, 20.02022116903634, 20.02022116903634, 21.55355450236967, 20.286887835675465, 20.486887835702994, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.153554502160556, 22.15355450236967, 20.02022116903634, 22.020221169036347, 21.153549222085925, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.820221063770113, 22.020221169036347, 22.020221169036347, 20.15355450236967, 21.153554502369662, 21.020221169036326, 20.02022116903634, 20.320221169036326, 22.020221169036347, 20.620221169036338, 21.020221169036326, 22.020221169036347, 20.153554410801462, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.1512422983809, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.020221169036326, 20.986887821816246, 20.02022116903634, 22.020221169036347, 20.153554502369666, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.453554502369663, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.15355380702367, 20.28688783570301, 21.15355450236966, 22.020221169036347, 20.686887823644636, 20.42022116903634, 22.020221169036347, 20.153553807023656, 21.386887835703007, 21.15355441080147, 22.020221169036347, 21.020221169036326, 20.68688783567128, 20.02022116903634, 21.120177620259764, 20.153554502342132, 20.153554502369676, 20.153554502369673, 20.15355450236966, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.26932953645411, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.62021941624525, 22.020221169036347, 22.286882555419265, 21.020221169036326, 20.15355450236967, 8.153554502365491, 22.15355450236967, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.694209499592931, "mean_inference_ms": 1.2197562612111816, "mean_action_processing_ms": 0.10487100726301041, "mean_env_wait_ms": 29.601334614271938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007258415222167969, "StateBufferConnector_ms": 0.0047914981842041016, "ViewRequirementAgentConnector_ms": 0.11679506301879883}}, "episode_reward_max": 22.286882555419265, "episode_reward_min": 8.153554502365491, "episode_reward_mean": 20.92802145178878, "episode_len_mean": 29.82, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.220221063770126, 20.02022116903634, 21.020221169036326, 20.02022116903634, 20.120177620259774, 20.02022116903634, 20.02022116903634, 21.55355450236967, 20.286887835675465, 20.486887835702994, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.153554502160556, 22.15355450236967, 20.02022116903634, 22.020221169036347, 21.153549222085925, 22.020221169036347, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.820221063770113, 22.020221169036347, 22.020221169036347, 20.15355450236967, 21.153554502369662, 21.020221169036326, 20.02022116903634, 20.320221169036326, 22.020221169036347, 20.620221169036338, 21.020221169036326, 22.020221169036347, 20.153554410801462, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.1512422983809, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.020221169036326, 20.986887821816246, 20.02022116903634, 22.020221169036347, 20.153554502369666, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.453554502369663, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.15355380702367, 20.28688783570301, 21.15355450236966, 22.020221169036347, 20.686887823644636, 20.42022116903634, 22.020221169036347, 20.153553807023656, 21.386887835703007, 21.15355441080147, 22.020221169036347, 21.020221169036326, 20.68688783567128, 20.02022116903634, 21.120177620259764, 20.153554502342132, 20.153554502369676, 20.153554502369673, 20.15355450236966, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.26932953645411, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.62021941624525, 22.020221169036347, 22.286882555419265, 21.020221169036326, 20.15355450236967, 8.153554502365491, 22.15355450236967, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.694209499592931, "mean_inference_ms": 1.2197562612111816, "mean_action_processing_ms": 0.10487100726301041, "mean_env_wait_ms": 29.601334614271938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007258415222167969, "StateBufferConnector_ms": 0.0047914981842041016, "ViewRequirementAgentConnector_ms": 0.11679506301879883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.596190798951525, "num_env_steps_trained_throughput_per_sec": 29.596190798951525, "timesteps_total": 124000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 66550.367, "sample_time_ms": 63360.645, "load_time_ms": 9.132, "load_throughput": 219003.694, "learn_time_ms": 3178.029, "learn_throughput": 629.321, "synch_weights_time_ms": 2.114}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 4547, "training_iteration": 62, "trial_id": "13850_00001", "date": "2023-12-28_18-56-12", "timestamp": 1703760972, "time_this_iter_s": 67.58079361915588, "time_total_s": 4122.356351137161, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4122.356351137161, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 55.80618556701031, "ram_util_percent": 92.47938144329896}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4556356947869064e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.40733986246089143, "policy_loss": 0.0033151621537076104, "vf_loss": 0.4040247024450865, "vf_explained_var": 0.6645869274934133, "kl": 0.0015005875524540763, "entropy": 0.14632146237625016, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 28125.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "sampler_results": {"episode_reward_max": 22.286882555419265, "episode_reward_min": 2.920174990796628, "episode_reward_mean": 20.596374444928447, "episode_len_mean": 29.28, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.68688783567128, 20.02022116903634, 21.120177620259764, 20.153554502342132, 20.153554502369676, 20.153554502369673, 20.15355450236966, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.26932953645411, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.62021941624525, 22.020221169036347, 22.286882555419265, 21.020221169036326, 20.15355450236967, 8.153554502365491, 22.15355450236967, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.153554502369666, 20.153554502369193, 21.020221169036326, 22.020221169036347, 21.15355380702366, 21.286887835702995, 20.02022116903634, 20.65355450236548, 20.153554502369673, 21.020221169036326, 20.286887822056705, 20.02022116903634, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.020221169036347, 21.65355450236551, 20.62022116720792, 21.020221169036326, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.82022116744841, 20.620221169036338, 21.153554502369662, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.153554502369673, 21.020221169036326, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.553554502369675, 7.5535545021288435, 21.220221063770115, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.286887835703006, 22.020221169036347, 12.820221169036333, 22.020221169036347, 20.286887834115067, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.153554502369676, 21.020221169036326, 20.15355450236966, 21.020221169036326, 20.153514405215024, 22.020221169036347, 2.920174990796628, 21.153554502369666, 21.1535545023696, 21.153250014601593, 22.020221169036347, 20.65355450236967, 22.020221169036347, 20.02022116903634, 21.153549222085925, 21.15355450236967, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6937698543205312, "mean_inference_ms": 1.2213925883141448, "mean_action_processing_ms": 0.10487273482548233, "mean_env_wait_ms": 29.602576465295005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007050991058349609, "StateBufferConnector_ms": 0.00480198860168457, "ViewRequirementAgentConnector_ms": 0.11534523963928223}}, "episode_reward_max": 22.286882555419265, "episode_reward_min": 2.920174990796628, "episode_reward_mean": 20.596374444928447, "episode_len_mean": 29.28, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.68688783567128, 20.02022116903634, 21.120177620259764, 20.153554502342132, 20.153554502369676, 20.153554502369673, 20.15355450236966, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.26932953645411, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.62021941624525, 22.020221169036347, 22.286882555419265, 21.020221169036326, 20.15355450236967, 8.153554502365491, 22.15355450236967, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.153554502369666, 20.153554502369193, 21.020221169036326, 22.020221169036347, 21.15355380702366, 21.286887835702995, 20.02022116903634, 20.65355450236548, 20.153554502369673, 21.020221169036326, 20.286887822056705, 20.02022116903634, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.020221169036347, 21.65355450236551, 20.62022116720792, 21.020221169036326, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.82022116744841, 20.620221169036338, 21.153554502369662, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.153554502369673, 21.020221169036326, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.553554502369675, 7.5535545021288435, 21.220221063770115, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.286887835703006, 22.020221169036347, 12.820221169036333, 22.020221169036347, 20.286887834115067, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.153554502369676, 21.020221169036326, 20.15355450236966, 21.020221169036326, 20.153514405215024, 22.020221169036347, 2.920174990796628, 21.153554502369666, 21.1535545023696, 21.153250014601593, 22.020221169036347, 20.65355450236967, 22.020221169036347, 20.02022116903634, 21.153549222085925, 21.15355450236967, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6937698543205312, "mean_inference_ms": 1.2213925883141448, "mean_action_processing_ms": 0.10487273482548233, "mean_env_wait_ms": 29.602576465295005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007050991058349609, "StateBufferConnector_ms": 0.00480198860168457, "ViewRequirementAgentConnector_ms": 0.11534523963928223}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.12562127166344, "num_env_steps_trained_throughput_per_sec": 30.12562127166344, "timesteps_total": 126000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 126000, "timers": {"training_iteration_time_ms": 66490.551, "sample_time_ms": 63301.49, "load_time_ms": 8.73, "load_throughput": 229104.922, "learn_time_ms": 3177.778, "learn_throughput": 629.371, "synch_weights_time_ms": 2.109}, "counters": {"num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "done": false, "episodes_total": 4616, "training_iteration": 63, "trial_id": "13850_00001", "date": "2023-12-28_18-57-19", "timestamp": 1703761039, "time_this_iter_s": 66.39358162879944, "time_total_s": 4188.749932765961, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4188.749932765961, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 56.243617021276584, "ram_util_percent": 92.49255319148935}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2278178473934532e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7012725564671888, "policy_loss": 0.00484377168946796, "vf_loss": 0.6964287899020646, "vf_explained_var": 0.5852535737885369, "kl": 0.0023719859717284326, "entropy": 0.13902365980876816, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 28575.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 22.153554502369676, "episode_reward_min": 2.920174990796628, "episode_reward_mean": 20.249038538114725, "episode_len_mean": 29.07, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.020221169036326, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.286887835703006, 22.020221169036347, 12.820221169036333, 22.020221169036347, 20.286887834115067, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.153554502369676, 21.020221169036326, 20.15355450236966, 21.020221169036326, 20.153514405215024, 22.020221169036347, 2.920174990796628, 21.153554502369666, 21.1535545023696, 21.153250014601593, 22.020221169036347, 20.65355450236967, 22.020221169036347, 20.02022116903634, 21.153549222085925, 21.15355450236967, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.02022116903634, 22.020221169036347, 21.15355450236967, 20.72022116903634, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 20.286887834115063, 22.020221169036347, 21.020221169036326, 20.02022116903634, 7.420221169004621, 20.02022116903634, 20.153554502369676, 11.602662869996552, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.286887835703002, 18.15355450216056, 14.75355450236967, 21.020221169036326, 21.020221169036326, 20.153553807023656, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.08657988841666, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.15355449031131, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.153554502369662, 20.153554410801462, 21.020221169036326, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.15355450236966, 20.02022116903634, 20.02022116903634, 21.15355450236966, 11.386887835703002, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.15355450236967, 17.120221169036334, 21.020221169036326, 21.15355450236967, 20.02022116903634, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 18, 30, 30, 30, 30, 30, 28, 21, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 26, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6932242280524649, "mean_inference_ms": 1.2219113763410845, "mean_action_processing_ms": 0.10486221254745352, "mean_env_wait_ms": 29.59980117008641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070705413818359375, "StateBufferConnector_ms": 0.004848480224609375, "ViewRequirementAgentConnector_ms": 0.11458921432495117}}, "episode_reward_max": 22.153554502369676, "episode_reward_min": 2.920174990796628, "episode_reward_mean": 20.249038538114725, "episode_len_mean": 29.07, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.020221169036326, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.286887835703006, 22.020221169036347, 12.820221169036333, 22.020221169036347, 20.286887834115067, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.153554502369676, 21.020221169036326, 20.15355450236966, 21.020221169036326, 20.153514405215024, 22.020221169036347, 2.920174990796628, 21.153554502369666, 21.1535545023696, 21.153250014601593, 22.020221169036347, 20.65355450236967, 22.020221169036347, 20.02022116903634, 21.153549222085925, 21.15355450236967, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.02022116903634, 22.020221169036347, 21.15355450236967, 20.72022116903634, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 20.286887834115063, 22.020221169036347, 21.020221169036326, 20.02022116903634, 7.420221169004621, 20.02022116903634, 20.153554502369676, 11.602662869996552, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.286887835703002, 18.15355450216056, 14.75355450236967, 21.020221169036326, 21.020221169036326, 20.153553807023656, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.08657988841666, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.15355449031131, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.153554502369662, 20.153554410801462, 21.020221169036326, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.15355450236966, 20.02022116903634, 20.02022116903634, 21.15355450236966, 11.386887835703002, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.15355450236967, 17.120221169036334, 21.020221169036326, 21.15355450236967, 20.02022116903634, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 18, 30, 30, 30, 30, 30, 28, 21, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 26, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6932242280524649, "mean_inference_ms": 1.2219113763410845, "mean_action_processing_ms": 0.10486221254745352, "mean_env_wait_ms": 29.59980117008641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070705413818359375, "StateBufferConnector_ms": 0.004848480224609375, "ViewRequirementAgentConnector_ms": 0.11458921432495117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.31813318168619, "num_env_steps_trained_throughput_per_sec": 30.31813318168619, "timesteps_total": 128000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 66503.309, "sample_time_ms": 63312.031, "load_time_ms": 9.041, "load_throughput": 221203.982, "learn_time_ms": 3179.688, "learn_throughput": 628.993, "synch_weights_time_ms": 2.104}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 4684, "training_iteration": 64, "trial_id": "13850_00001", "date": "2023-12-28_18-58-25", "timestamp": 1703761105, "time_this_iter_s": 65.97173762321472, "time_total_s": 4254.721670389175, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4254.721670389175, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 55.97765957446807, "ram_util_percent": 92.52659574468085}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.139089236967266e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7971837586164474, "policy_loss": 0.008760072059101528, "vf_loss": 0.7884236889063484, "vf_explained_var": 0.6002336201402876, "kl": 0.002050449888683947, "entropy": 0.16930119971434276, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29025.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_agent_steps_sampled": 130000, "num_agent_steps_trained": 130000}, "sampler_results": {"episode_reward_max": 22.15355449031131, "episode_reward_min": 11.086887835703, "episode_reward_mean": 20.660852627663743, "episode_len_mean": 29.61, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.08657988841666, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.15355449031131, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.153554502369662, 20.153554410801462, 21.020221169036326, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.15355450236966, 20.02022116903634, 20.02022116903634, 21.15355450236966, 11.386887835703002, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.15355450236967, 17.120221169036334, 21.020221169036326, 21.15355450236967, 20.02022116903634, 20.02022116903634, 18.820220473690323, 21.020221169036326, 20.02022116903634, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.72022116903634, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.153554502369662, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.151242298380893, 20.453554502369595, 21.153549222085925, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.153554502369676, 20.02022116903634, 21.620221169036334, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.58688774429213, 22.020221169036347, 18.820221168827224, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.186887036678705, 20.02022116903634, 20.985994152953314, 20.02022116903634, 21.020221169036326, 20.02022116903634, 20.02022116903634, 16.22022116903634, 21.020221169036326, 20.153554502369673, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.820221169036337, 20.02022116903634, 20.153554502369673, 22.020221169036347, 11.086887835703, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.886887835703, 21.25355450236967, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.6202211690358], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 26, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6926484163411685, "mean_inference_ms": 1.2216209259157613, "mean_action_processing_ms": 0.10483958865466582, "mean_env_wait_ms": 29.59419364167663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006989240646362305, "StateBufferConnector_ms": 0.004658222198486328, "ViewRequirementAgentConnector_ms": 0.11406850814819336}}, "episode_reward_max": 22.15355449031131, "episode_reward_min": 11.086887835703, "episode_reward_mean": 20.660852627663743, "episode_len_mean": 29.61, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.08657988841666, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.15355449031131, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.153554502369662, 20.153554410801462, 21.020221169036326, 21.020221169036326, 20.02022116903634, 22.020221169036347, 20.15355450236966, 20.02022116903634, 20.02022116903634, 21.15355450236966, 11.386887835703002, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.15355450236967, 17.120221169036334, 21.020221169036326, 21.15355450236967, 20.02022116903634, 20.02022116903634, 18.820220473690323, 21.020221169036326, 20.02022116903634, 20.02022116903634, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.72022116903634, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.153554502369662, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.151242298380893, 20.453554502369595, 21.153549222085925, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.153554502369676, 20.02022116903634, 21.620221169036334, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.58688774429213, 22.020221169036347, 18.820221168827224, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.186887036678705, 20.02022116903634, 20.985994152953314, 20.02022116903634, 21.020221169036326, 20.02022116903634, 20.02022116903634, 16.22022116903634, 21.020221169036326, 20.153554502369673, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.820221169036337, 20.02022116903634, 20.153554502369673, 22.020221169036347, 11.086887835703, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.886887835703, 21.25355450236967, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.6202211690358], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 26, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6926484163411685, "mean_inference_ms": 1.2216209259157613, "mean_action_processing_ms": 0.10483958865466582, "mean_env_wait_ms": 29.59419364167663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006989240646362305, "StateBufferConnector_ms": 0.004658222198486328, "ViewRequirementAgentConnector_ms": 0.11406850814819336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 130000, "num_agent_steps_trained": 130000, "num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.567181220771364, "num_env_steps_trained_throughput_per_sec": 30.567181220771364, "timesteps_total": 130000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 130000, "timers": {"training_iteration_time_ms": 66461.547, "sample_time_ms": 63272.341, "load_time_ms": 9.3, "load_throughput": 215046.195, "learn_time_ms": 3177.352, "learn_throughput": 629.455, "synch_weights_time_ms": 2.103}, "counters": {"num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_agent_steps_sampled": 130000, "num_agent_steps_trained": 130000}, "done": false, "episodes_total": 4752, "training_iteration": 65, "trial_id": "13850_00001", "date": "2023-12-28_18-59-30", "timestamp": 1703761170, "time_this_iter_s": 65.43430638313293, "time_total_s": 4320.155976772308, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4320.155976772308, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 55.74193548387096, "ram_util_percent": 92.58172043010755}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.069544618483633e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.602362939707107, "policy_loss": 0.0007487097216977013, "vf_loss": 0.6016142296252979, "vf_explained_var": 0.7400775021976895, "kl": 0.0019103272471586309, "entropy": 0.15468698400590156, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29475.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 22.020221169036347, "episode_reward_min": 8.82022116744833, "episode_reward_mean": 20.630545503675418, "episode_len_mean": 29.51, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.186887036678705, 20.02022116903634, 20.985994152953314, 20.02022116903634, 21.020221169036326, 20.02022116903634, 20.02022116903634, 16.22022116903634, 21.020221169036326, 20.153554502369673, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.820221169036337, 20.02022116903634, 20.153554502369673, 22.020221169036347, 11.086887835703, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.886887835703, 21.25355450236967, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.6202211690358, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.353554502337957, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.820221063770113, 20.02022116903634, 22.020221169036347, 21.920221169036342, 21.020221169036326, 20.02022116903634, 11.353554502369668, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.320221168795523, 22.020221169036347, 21.020221169036326, 21.720221169036332, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.02022116903634, 22.020221169036347, 21.153549222085925, 21.320221169036337, 20.153554502369673, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.953554502369663, 20.153554502369673, 21.020221169036326, 20.153554502369673, 21.020221169036326, 8.82022116744833, 21.153554502369666, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.320221168795523, 21.020221169036326, 20.520221169036336], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6921418931677592, "mean_inference_ms": 1.2214523198186245, "mean_action_processing_ms": 0.10483153203835975, "mean_env_wait_ms": 29.590908545475305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006841182708740234, "StateBufferConnector_ms": 0.004648447036743164, "ViewRequirementAgentConnector_ms": 0.1147761344909668}}, "episode_reward_max": 22.020221169036347, "episode_reward_min": 8.82022116744833, "episode_reward_mean": 20.630545503675418, "episode_len_mean": 29.51, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.186887036678705, 20.02022116903634, 20.985994152953314, 20.02022116903634, 21.020221169036326, 20.02022116903634, 20.02022116903634, 16.22022116903634, 21.020221169036326, 20.153554502369673, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.820221169036337, 20.02022116903634, 20.153554502369673, 22.020221169036347, 11.086887835703, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.886887835703, 21.25355450236967, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.6202211690358, 22.020221169036347, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.353554502337957, 20.02022116903634, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.820221063770113, 20.02022116903634, 22.020221169036347, 21.920221169036342, 21.020221169036326, 20.02022116903634, 11.353554502369668, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.320221168795523, 22.020221169036347, 21.020221169036326, 21.720221169036332, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.02022116903634, 22.020221169036347, 21.153549222085925, 21.320221169036337, 20.153554502369673, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.953554502369663, 20.153554502369673, 21.020221169036326, 20.153554502369673, 21.020221169036326, 8.82022116744833, 21.153554502369666, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.320221168795523, 21.020221169036326, 20.520221169036336], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6921418931677592, "mean_inference_ms": 1.2214523198186245, "mean_action_processing_ms": 0.10483153203835975, "mean_env_wait_ms": 29.590908545475305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006841182708740234, "StateBufferConnector_ms": 0.004648447036743164, "ViewRequirementAgentConnector_ms": 0.1147761344909668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.23789482279944, "num_env_steps_trained_throughput_per_sec": 30.23789482279944, "timesteps_total": 132000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 66342.197, "sample_time_ms": 63158.694, "load_time_ms": 9.759, "load_throughput": 204936.09, "learn_time_ms": 3171.151, "learn_throughput": 630.686, "synch_weights_time_ms": 2.143}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 4819, "training_iteration": 66, "trial_id": "13850_00001", "date": "2023-12-28_19-00-36", "timestamp": 1703761236, "time_this_iter_s": 66.14709448814392, "time_total_s": 4386.303071260452, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4386.303071260452, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 55.867021276595736, "ram_util_percent": 92.50106382978721}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5347723092418165e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5678329021152523, "policy_loss": -0.007819023579359055, "vf_loss": 0.5756519267915023, "vf_explained_var": 0.6264912940396203, "kl": 0.0011845160110535962, "entropy": 0.15368235073155828, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29925.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 134000, "num_env_steps_trained": 134000, "num_agent_steps_sampled": 134000, "num_agent_steps_trained": 134000}, "sampler_results": {"episode_reward_max": 22.15355450236968, "episode_reward_min": 2.6868817546179375, "episode_reward_mean": 20.096554310532408, "episode_len_mean": 28.79, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.02022116903634, 22.020221169036347, 21.153549222085925, 21.320221169036337, 20.153554502369673, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.953554502369663, 20.153554502369673, 21.020221169036326, 20.153554502369673, 21.020221169036326, 8.82022116744833, 21.153554502369666, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.320221168795523, 21.020221169036326, 20.520221169036336, 21.38688773043678, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.153554502369673, 4.6868878218158825, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 20.353554502337957, 21.020221169036326, 20.02022116903634, 20.153554502369673, 22.020221169036347, 20.153548513380233, 20.02022116903634, 22.020221169036347, 22.020221169036347, 12.686887835703, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.653554500541254, 21.020221169036326, 22.020221169036347, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 19.88688783570301, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.153554502369673, 22.020221169036347, 20.286887833874598, 21.386887835703007, 4.186887034901677, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.02022116903634, 22.15355450236968, 21.020221169036326, 22.020221169036347, 4.186887034901677, 21.020221169036326, 21.020221169036326, 20.386887833874592, 20.02022116903634, 21.020221169036326, 22.15355450236968, 20.820221063770113, 22.020221169036347, 20.02022116903634, 2.6868817546179375, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 28, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6918718387352812, "mean_inference_ms": 1.2212997750037682, "mean_action_processing_ms": 0.10482656886465712, "mean_env_wait_ms": 29.588751680333463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068972110748291016, "StateBufferConnector_ms": 0.004818916320800781, "ViewRequirementAgentConnector_ms": 0.11541581153869629}}, "episode_reward_max": 22.15355450236968, "episode_reward_min": 2.6868817546179375, "episode_reward_mean": 20.096554310532408, "episode_len_mean": 28.79, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.02022116903634, 22.020221169036347, 21.153549222085925, 21.320221169036337, 20.153554502369673, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.020221169036347, 20.953554502369663, 20.153554502369673, 21.020221169036326, 20.153554502369673, 21.020221169036326, 8.82022116744833, 21.153554502369666, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.320221168795523, 21.020221169036326, 20.520221169036336, 21.38688773043678, 22.020221169036347, 20.02022116903634, 20.02022116903634, 21.020221169036326, 20.153554502369673, 4.6868878218158825, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 20.353554502337957, 21.020221169036326, 20.02022116903634, 20.153554502369673, 22.020221169036347, 20.153548513380233, 20.02022116903634, 22.020221169036347, 22.020221169036347, 12.686887835703, 20.02022116903634, 21.020221169036326, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.653554500541254, 21.020221169036326, 22.020221169036347, 21.020221169036326, 21.020221169036326, 22.020221169036347, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 19.88688783570301, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.153554502369673, 22.020221169036347, 20.286887833874598, 21.386887835703007, 4.186887034901677, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.02022116903634, 22.15355450236968, 21.020221169036326, 22.020221169036347, 4.186887034901677, 21.020221169036326, 21.020221169036326, 20.386887833874592, 20.02022116903634, 21.020221169036326, 22.15355450236968, 20.820221063770113, 22.020221169036347, 20.02022116903634, 2.6868817546179375, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 28, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6918718387352812, "mean_inference_ms": 1.2212997750037682, "mean_action_processing_ms": 0.10482656886465712, "mean_env_wait_ms": 29.588751680333463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068972110748291016, "StateBufferConnector_ms": 0.004818916320800781, "ViewRequirementAgentConnector_ms": 0.11541581153869629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134000, "num_agent_steps_trained": 134000, "num_env_steps_sampled": 134000, "num_env_steps_trained": 134000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.266082215223122, "num_env_steps_trained_throughput_per_sec": 30.266082215223122, "timesteps_total": 134000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 134000, "timers": {"training_iteration_time_ms": 66336.503, "sample_time_ms": 63158.871, "load_time_ms": 9.734, "load_throughput": 205468.676, "learn_time_ms": 3165.234, "learn_throughput": 631.865, "synch_weights_time_ms": 2.216}, "counters": {"num_env_steps_sampled": 134000, "num_env_steps_trained": 134000, "num_agent_steps_sampled": 134000, "num_agent_steps_trained": 134000}, "done": false, "episodes_total": 4890, "training_iteration": 67, "trial_id": "13850_00001", "date": "2023-12-28_19-01-42", "timestamp": 1703761302, "time_this_iter_s": 66.08569693565369, "time_total_s": 4452.388768196106, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4452.388768196106, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 55.92315789473684, "ram_util_percent": 92.29263157894732}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.673861546209083e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.926332412213087, "policy_loss": -0.009000528819031186, "vf_loss": 0.9353329424332414, "vf_explained_var": 0.6475945426358117, "kl": 0.009058951862166402, "entropy": 0.20455772798922328, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 30375.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": 22.15355450236968, "episode_reward_min": 2.6868817546179375, "episode_reward_mean": 20.13122020334816, "episode_len_mean": 28.73, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.020221169036347, 22.020221169036347, 19.88688783570301, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.153554502369673, 22.020221169036347, 20.286887833874598, 21.386887835703007, 4.186887034901677, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.02022116903634, 22.15355450236968, 21.020221169036326, 22.020221169036347, 4.186887034901677, 21.020221169036326, 21.020221169036326, 20.386887833874592, 20.02022116903634, 21.020221169036326, 22.15355450236968, 20.820221063770113, 22.020221169036347, 20.02022116903634, 2.6868817546179375, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.92017762025976, 20.02022116903634, 22.020221169036347, 21.086887835702996, 20.02022116903634, 20.286887835702935, 16.686887835703, 22.020221169036347, 20.686887835703004, 20.02022116903634, 21.020221169036326, 21.020221169036326, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.02022116903634, 18.686887835703004, 21.020221169036326, 20.853554500782018, 21.020221169036326, 22.020221169036347, 20.153554502369676, 22.020221169036347, 21.786887835703002, 21.020221169036326, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.48688774410308, 20.953554502369663, 20.02022116903634, 21.153554502369662, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 15.486887835702996, 20.02022116903634, 21.153554502369666, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.18688703667872, 20.92022116903633, 21.020221169036326, 20.02022116903634, 20.15355450236967, 21.020221169036326, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.953554502369663, 3.486843499488764, 7.353554502365493, 21.020221169036326, 20.02022116903634], "episode_lengths": [30, 30, 28, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 26, 30, 30, 30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 6, 12, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.69156305280261, "mean_inference_ms": 1.2211575907754237, "mean_action_processing_ms": 0.10482390260217951, "mean_env_wait_ms": 29.588065564545495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006995677947998047, "StateBufferConnector_ms": 0.004832029342651367, "ViewRequirementAgentConnector_ms": 0.11518049240112305}}, "episode_reward_max": 22.15355450236968, "episode_reward_min": 2.6868817546179375, "episode_reward_mean": 20.13122020334816, "episode_len_mean": 28.73, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.020221169036347, 22.020221169036347, 19.88688783570301, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.153554502369673, 22.020221169036347, 20.286887833874598, 21.386887835703007, 4.186887034901677, 21.020221169036326, 21.020221169036326, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.02022116903634, 22.15355450236968, 21.020221169036326, 22.020221169036347, 4.186887034901677, 21.020221169036326, 21.020221169036326, 20.386887833874592, 20.02022116903634, 21.020221169036326, 22.15355450236968, 20.820221063770113, 22.020221169036347, 20.02022116903634, 2.6868817546179375, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.92017762025976, 20.02022116903634, 22.020221169036347, 21.086887835702996, 20.02022116903634, 20.286887835702935, 16.686887835703, 22.020221169036347, 20.686887835703004, 20.02022116903634, 21.020221169036326, 21.020221169036326, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.02022116903634, 18.686887835703004, 21.020221169036326, 20.853554500782018, 21.020221169036326, 22.020221169036347, 20.153554502369676, 22.020221169036347, 21.786887835703002, 21.020221169036326, 22.020221169036347, 20.02022116903634, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.48688774410308, 20.953554502369663, 20.02022116903634, 21.153554502369662, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 15.486887835702996, 20.02022116903634, 21.153554502369666, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.18688703667872, 20.92022116903633, 21.020221169036326, 20.02022116903634, 20.15355450236967, 21.020221169036326, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.953554502369663, 3.486843499488764, 7.353554502365493, 21.020221169036326, 20.02022116903634], "episode_lengths": [30, 30, 28, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 26, 30, 30, 30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 6, 12, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.69156305280261, "mean_inference_ms": 1.2211575907754237, "mean_action_processing_ms": 0.10482390260217951, "mean_env_wait_ms": 29.588065564545495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006995677947998047, "StateBufferConnector_ms": 0.004832029342651367, "ViewRequirementAgentConnector_ms": 0.11518049240112305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.143488741161125, "num_env_steps_trained_throughput_per_sec": 30.143488741161125, "timesteps_total": 136000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 66382.287, "sample_time_ms": 63206.208, "load_time_ms": 9.802, "load_throughput": 204048.766, "learn_time_ms": 3163.622, "learn_throughput": 632.187, "synch_weights_time_ms": 2.197}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 4958, "training_iteration": 68, "trial_id": "13850_00001", "date": "2023-12-28_19-02-49", "timestamp": 1703761369, "time_this_iter_s": 66.35449719429016, "time_total_s": 4518.743265390396, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4518.743265390396, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 55.81702127659574, "ram_util_percent": 92.27872340425527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.673861546209083e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5102640029870802, "policy_loss": 0.002191826601823171, "vf_loss": 0.5080721765922176, "vf_explained_var": 0.7869625614749061, "kl": 0.005149132551856233, "entropy": 0.26816819416152105, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 30825.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 138000, "num_env_steps_trained": 138000, "num_agent_steps_sampled": 138000, "num_agent_steps_trained": 138000}, "sampler_results": {"episode_reward_max": 22.15355450236968, "episode_reward_min": 3.486843499488764, "episode_reward_mean": 20.794213573949413, "episode_len_mean": 29.46, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.020221169036326, 20.02022116903634, 21.020221169036326, 20.48688774410308, 20.953554502369663, 20.02022116903634, 21.153554502369662, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 15.486887835702996, 20.02022116903634, 21.153554502369666, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.18688703667872, 20.92022116903633, 21.020221169036326, 20.02022116903634, 20.15355450236967, 21.020221169036326, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.953554502369663, 3.486843499488764, 7.353554502365493, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.28688714035699, 21.020221169036326, 20.420221169036274, 21.153554500781738, 20.720221169032715, 20.15355450078173, 21.020221169036326, 21.020221169036326, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.286887048788795, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.28688783570253, 17.686887835703008, 22.020221169036347, 21.020221169036326, 21.38621410665661, 22.020221169036347, 20.620182900697202, 21.020221169036326, 20.853553703345373, 22.020221169036347, 20.153554502369673, 22.020221169036347, 22.020221169036347, 21.153554502369666, 22.020221169036347, 22.020221169036347, 21.953554502369677, 20.153554502369676, 20.02022116903634, 20.02022116903634, 22.15355450236968, 20.25355450236966, 22.020221169036347, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.15355450236968, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 19.353554502369672, 20.28688783570294, 20.15355450236966, 22.020221169036347, 22.15355450236967], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 6, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6910905356497352, "mean_inference_ms": 1.2209579185586776, "mean_action_processing_ms": 0.10481115106586422, "mean_env_wait_ms": 29.58511024081117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006930351257324219, "StateBufferConnector_ms": 0.004685163497924805, "ViewRequirementAgentConnector_ms": 0.11430597305297852}}, "episode_reward_max": 22.15355450236968, "episode_reward_min": 3.486843499488764, "episode_reward_mean": 20.794213573949413, "episode_len_mean": 29.46, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.020221169036326, 20.02022116903634, 21.020221169036326, 20.48688774410308, 20.953554502369663, 20.02022116903634, 21.153554502369662, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 15.486887835702996, 20.02022116903634, 21.153554502369666, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.18688703667872, 20.92022116903633, 21.020221169036326, 20.02022116903634, 20.15355450236967, 21.020221169036326, 20.02022116903634, 22.020221169036347, 21.020221169036326, 20.953554502369663, 3.486843499488764, 7.353554502365493, 21.020221169036326, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.28688714035699, 21.020221169036326, 20.420221169036274, 21.153554500781738, 20.720221169032715, 20.15355450078173, 21.020221169036326, 21.020221169036326, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.020221169036326, 20.286887048788795, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.28688783570253, 17.686887835703008, 22.020221169036347, 21.020221169036326, 21.38621410665661, 22.020221169036347, 20.620182900697202, 21.020221169036326, 20.853553703345373, 22.020221169036347, 20.153554502369673, 22.020221169036347, 22.020221169036347, 21.153554502369666, 22.020221169036347, 22.020221169036347, 21.953554502369677, 20.153554502369676, 20.02022116903634, 20.02022116903634, 22.15355450236968, 20.25355450236966, 22.020221169036347, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.15355450236968, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 19.353554502369672, 20.28688783570294, 20.15355450236966, 22.020221169036347, 22.15355450236967], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 6, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6910905356497352, "mean_inference_ms": 1.2209579185586776, "mean_action_processing_ms": 0.10481115106586422, "mean_env_wait_ms": 29.58511024081117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006930351257324219, "StateBufferConnector_ms": 0.004685163497924805, "ViewRequirementAgentConnector_ms": 0.11430597305297852}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 138000, "num_agent_steps_trained": 138000, "num_env_steps_sampled": 138000, "num_env_steps_trained": 138000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.415912312682853, "num_env_steps_trained_throughput_per_sec": 30.415912312682853, "timesteps_total": 138000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 138000, "timers": {"training_iteration_time_ms": 66307.47, "sample_time_ms": 63127.664, "load_time_ms": 10.724, "load_throughput": 186500.545, "learn_time_ms": 3166.413, "learn_throughput": 631.63, "synch_weights_time_ms": 2.209}, "counters": {"num_env_steps_sampled": 138000, "num_env_steps_trained": 138000, "num_agent_steps_sampled": 138000, "num_agent_steps_trained": 138000}, "done": false, "episodes_total": 5025, "training_iteration": 69, "trial_id": "13850_00001", "date": "2023-12-28_19-03-54", "timestamp": 1703761434, "time_this_iter_s": 65.7596652507782, "time_total_s": 4584.502930641174, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4584.502930641174, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 55.88829787234041, "ram_util_percent": 92.33297872340421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.673861546209083e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3976345854997635, "policy_loss": -0.03967279192474153, "vf_loss": 0.4373073777142498, "vf_explained_var": 0.6698283345169491, "kl": 0.0024451085138700247, "entropy": 0.3332878590292401, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 31275.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 22.28626434313451, "episode_reward_min": 9.620221169036261, "episode_reward_mean": 20.86883015136202, "episode_len_mean": 29.62, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.853553703345373, 22.020221169036347, 20.153554502369673, 22.020221169036347, 22.020221169036347, 21.153554502369666, 22.020221169036347, 22.020221169036347, 21.953554502369677, 20.153554502369676, 20.02022116903634, 20.02022116903634, 22.15355450236968, 20.25355450236966, 22.020221169036347, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.15355450236968, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 19.353554502369672, 20.28688783570294, 20.15355450236966, 22.020221169036347, 22.15355450236967, 9.620221169036261, 21.020221169036326, 20.486887835702998, 22.020221169036347, 22.15355450236968, 20.553552747991105, 22.020221169036347, 22.020221169036347, 14.020221169036336, 22.020221169036347, 20.153554502369673, 21.020221169036326, 21.020221169036326, 21.15355450236967, 20.55355450078174, 20.42022107746814, 21.020221169036326, 21.15355450236919, 20.02022116903634, 20.353554502337957, 21.020221169036326, 21.020221169036326, 21.020221169008803, 21.15355380702366, 22.020221169036347, 21.220221169036336, 20.286887744107265, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.15354922208594, 22.153250014601607, 20.551242298380892, 22.020221169036347, 20.820221169036337, 22.020221169036347, 22.153554502160564, 20.42022116744477, 20.286887823644644, 21.020221169036326, 21.286880790488254, 21.153554502366042, 20.02022116903634, 20.02022116903634, 20.286583347934933, 21.135996203329878, 20.686887835702944, 22.153554502369676, 21.40266286978744, 22.020221169036347, 20.153554502369676, 22.020221169036347, 21.153554502366042, 21.286847738544733, 22.153554502369676, 20.986886070854034, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.28688783570301, 22.28626434313451, 20.02022116903634, 21.286847738544733, 21.020221169036326, 12.25321173741047, 20.32022116903628, 21.020221169036326], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6906105361201372, "mean_inference_ms": 1.2207495866472065, "mean_action_processing_ms": 0.10479672142958077, "mean_env_wait_ms": 29.582631818927986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006844282150268555, "StateBufferConnector_ms": 0.004724979400634766, "ViewRequirementAgentConnector_ms": 0.1145026683807373}}, "episode_reward_max": 22.28626434313451, "episode_reward_min": 9.620221169036261, "episode_reward_mean": 20.86883015136202, "episode_len_mean": 29.62, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.853553703345373, 22.020221169036347, 20.153554502369673, 22.020221169036347, 22.020221169036347, 21.153554502369666, 22.020221169036347, 22.020221169036347, 21.953554502369677, 20.153554502369676, 20.02022116903634, 20.02022116903634, 22.15355450236968, 20.25355450236966, 22.020221169036347, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.15355450236968, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 19.353554502369672, 20.28688783570294, 20.15355450236966, 22.020221169036347, 22.15355450236967, 9.620221169036261, 21.020221169036326, 20.486887835702998, 22.020221169036347, 22.15355450236968, 20.553552747991105, 22.020221169036347, 22.020221169036347, 14.020221169036336, 22.020221169036347, 20.153554502369673, 21.020221169036326, 21.020221169036326, 21.15355450236967, 20.55355450078174, 20.42022107746814, 21.020221169036326, 21.15355450236919, 20.02022116903634, 20.353554502337957, 21.020221169036326, 21.020221169036326, 21.020221169008803, 21.15355380702366, 22.020221169036347, 21.220221169036336, 20.286887744107265, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.15354922208594, 22.153250014601607, 20.551242298380892, 22.020221169036347, 20.820221169036337, 22.020221169036347, 22.153554502160564, 20.42022116744477, 20.286887823644644, 21.020221169036326, 21.286880790488254, 21.153554502366042, 20.02022116903634, 20.02022116903634, 20.286583347934933, 21.135996203329878, 20.686887835702944, 22.153554502369676, 21.40266286978744, 22.020221169036347, 20.153554502369676, 22.020221169036347, 21.153554502366042, 21.286847738544733, 22.153554502369676, 20.986886070854034, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.28688783570301, 22.28626434313451, 20.02022116903634, 21.286847738544733, 21.020221169036326, 12.25321173741047, 20.32022116903628, 21.020221169036326], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6906105361201372, "mean_inference_ms": 1.2207495866472065, "mean_action_processing_ms": 0.10479672142958077, "mean_env_wait_ms": 29.582631818927986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006844282150268555, "StateBufferConnector_ms": 0.004724979400634766, "ViewRequirementAgentConnector_ms": 0.1145026683807373}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.23380091748394, "num_env_steps_trained_throughput_per_sec": 30.23380091748394, "timesteps_total": 140000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 66277.012, "sample_time_ms": 63096.888, "load_time_ms": 10.283, "load_throughput": 194504.465, "learn_time_ms": 3167.171, "learn_throughput": 631.478, "synch_weights_time_ms": 2.209}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 5093, "training_iteration": 70, "trial_id": "13850_00001", "date": "2023-12-28_19-05-01", "timestamp": 1703761501, "time_this_iter_s": 66.15621876716614, "time_total_s": 4650.65914940834, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4650.65914940834, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 56.005319148936174, "ram_util_percent": 92.39255319148934}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5078073894563648, "policy_loss": 0.003921915971570545, "vf_loss": 0.5038854708874391, "vf_explained_var": 0.7813346053494348, "kl": 0.0031455849417220704, "entropy": 0.36230921804904936, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 31725.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 142000, "num_env_steps_trained": 142000, "num_agent_steps_sampled": 142000, "num_agent_steps_trained": 142000}, "sampler_results": {"episode_reward_max": 22.553554502366044, "episode_reward_min": 9.35355450236966, "episode_reward_mean": 20.613170954956132, "episode_len_mean": 29.47, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.153554502160564, 20.42022116744477, 20.286887823644644, 21.020221169036326, 21.286880790488254, 21.153554502366042, 20.02022116903634, 20.02022116903634, 20.286583347934933, 21.135996203329878, 20.686887835702944, 22.153554502369676, 21.40266286978744, 22.020221169036347, 20.153554502369676, 22.020221169036347, 21.153554502366042, 21.286847738544733, 22.153554502369676, 20.986886070854034, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.28688783570301, 22.28626434313451, 20.02022116903634, 21.286847738544733, 21.020221169036326, 12.25321173741047, 20.32022116903628, 21.020221169036326, 22.020221169036347, 20.153554502369676, 20.920221063770114, 20.153554502369676, 22.020221169036347, 22.553554502366044, 21.153554502369666, 21.15355450236966, 21.920177620259782, 20.153514405215024, 20.153554502369673, 22.020221169036347, 21.15355450236919, 22.020221169036347, 21.320221169036337, 20.02022116903634, 20.153554502369673, 21.1535545023696, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.15355450236968, 20.153554410801462, 20.786887835464018, 21.020221169036326, 21.286887835699375, 21.020221169036326, 21.286882555419258, 20.02022116903634, 21.420221169036328, 20.153554502160556, 20.15355450236967, 21.020221169036326, 21.153554502369662, 22.020221169036347, 21.135996203329878, 22.020221169036347, 20.55355450236965, 9.35355450236966, 20.553554500335974, 9.469329536663212, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.85355450236967, 21.153554502369662, 20.153554502369676, 22.020221169036347, 22.020221169036347, 20.286887823644633, 20.153554502369676, 20.92021528366936, 20.02022116903634, 22.020221169036347, 21.020221169036326, 13.286887835703002, 20.55355450236967, 21.15355441080147, 22.153554502366045, 20.420221168827155, 20.02022116903634, 22.020221169036347, 22.286887835671838, 20.02022116903634, 20.286887835703006], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 15, 30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 19, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6902946284994153, "mean_inference_ms": 1.2206909273270892, "mean_action_processing_ms": 0.1048011993561509, "mean_env_wait_ms": 29.585449260521262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006948947906494141, "StateBufferConnector_ms": 0.004685163497924805, "ViewRequirementAgentConnector_ms": 0.1154022216796875}}, "episode_reward_max": 22.553554502366044, "episode_reward_min": 9.35355450236966, "episode_reward_mean": 20.613170954956132, "episode_len_mean": 29.47, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.153554502160564, 20.42022116744477, 20.286887823644644, 21.020221169036326, 21.286880790488254, 21.153554502366042, 20.02022116903634, 20.02022116903634, 20.286583347934933, 21.135996203329878, 20.686887835702944, 22.153554502369676, 21.40266286978744, 22.020221169036347, 20.153554502369676, 22.020221169036347, 21.153554502366042, 21.286847738544733, 22.153554502369676, 20.986886070854034, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.02022116903634, 20.28688783570301, 22.28626434313451, 20.02022116903634, 21.286847738544733, 21.020221169036326, 12.25321173741047, 20.32022116903628, 21.020221169036326, 22.020221169036347, 20.153554502369676, 20.920221063770114, 20.153554502369676, 22.020221169036347, 22.553554502366044, 21.153554502369666, 21.15355450236966, 21.920177620259782, 20.153514405215024, 20.153554502369673, 22.020221169036347, 21.15355450236919, 22.020221169036347, 21.320221169036337, 20.02022116903634, 20.153554502369673, 21.1535545023696, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.020221169036326, 22.020221169036347, 22.15355450236968, 20.153554410801462, 20.786887835464018, 21.020221169036326, 21.286887835699375, 21.020221169036326, 21.286882555419258, 20.02022116903634, 21.420221169036328, 20.153554502160556, 20.15355450236967, 21.020221169036326, 21.153554502369662, 22.020221169036347, 21.135996203329878, 22.020221169036347, 20.55355450236965, 9.35355450236966, 20.553554500335974, 9.469329536663212, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.85355450236967, 21.153554502369662, 20.153554502369676, 22.020221169036347, 22.020221169036347, 20.286887823644633, 20.153554502369676, 20.92021528366936, 20.02022116903634, 22.020221169036347, 21.020221169036326, 13.286887835703002, 20.55355450236967, 21.15355441080147, 22.153554502366045, 20.420221168827155, 20.02022116903634, 22.020221169036347, 22.286887835671838, 20.02022116903634, 20.286887835703006], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 15, 30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 19, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6902946284994153, "mean_inference_ms": 1.2206909273270892, "mean_action_processing_ms": 0.1048011993561509, "mean_env_wait_ms": 29.585449260521262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006948947906494141, "StateBufferConnector_ms": 0.004685163497924805, "ViewRequirementAgentConnector_ms": 0.1154022216796875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142000, "num_agent_steps_trained": 142000, "num_env_steps_sampled": 142000, "num_env_steps_trained": 142000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.791929182798707, "num_env_steps_trained_throughput_per_sec": 29.791929182798707, "timesteps_total": 142000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 142000, "timers": {"training_iteration_time_ms": 66297.2, "sample_time_ms": 63111.369, "load_time_ms": 10.202, "load_throughput": 196037.195, "learn_time_ms": 3172.978, "learn_throughput": 630.323, "synch_weights_time_ms": 2.198}, "counters": {"num_env_steps_sampled": 142000, "num_env_steps_trained": 142000, "num_agent_steps_sampled": 142000, "num_agent_steps_trained": 142000}, "done": false, "episodes_total": 5161, "training_iteration": 71, "trial_id": "13850_00001", "date": "2023-12-28_19-06-08", "timestamp": 1703761568, "time_this_iter_s": 67.13678121566772, "time_total_s": 4717.795930624008, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4717.795930624008, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 55.91894736842105, "ram_util_percent": 92.4178947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9184653865522706e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5498197488486767, "policy_loss": 0.0002344902687602573, "vf_loss": 0.549585260881318, "vf_explained_var": 0.7078695849577585, "kl": 0.00468670598116442, "entropy": 0.3082552692625258, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 32175.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 22.420221169036328, "episode_reward_min": 6.286887821815881, "episode_reward_mean": 20.295839669115864, "episode_len_mean": 28.93, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.135996203329878, 22.020221169036347, 20.55355450236965, 9.35355450236966, 20.553554500335974, 9.469329536663212, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.85355450236967, 21.153554502369662, 20.153554502369676, 22.020221169036347, 22.020221169036347, 20.286887823644633, 20.153554502369676, 20.92021528366936, 20.02022116903634, 22.020221169036347, 21.020221169036326, 13.286887835703002, 20.55355450236967, 21.15355441080147, 22.153554502366045, 20.420221168827155, 20.02022116903634, 22.020221169036347, 22.286887835671838, 20.02022116903634, 20.286887835703006, 14.35355450236966, 20.153554502369673, 21.020221169036326, 6.286887821815881, 20.02022116903634, 21.020221169036326, 20.153554502369676, 21.020221169036326, 20.42022116903634, 20.02022116903634, 22.020221169036347, 20.153514405215024, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.153554502369662, 21.020221169036326, 7.086887835671288, 21.020221169036326, 21.020221169036326, 7.820221169004621, 21.153554502369662, 22.020221169036347, 21.020221169036326, 21.153554502369662, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.15355450236919, 22.153554502369666, 20.15355450236967, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.15355450236968, 20.43599620332988, 21.020221169036326, 22.020221169036347, 20.15355450236966, 22.020221169036347, 20.02022116903634, 22.420221169036328, 22.020221169036347, 20.153554410801462, 22.020221169036347, 20.786887823648065, 20.985994152953314, 21.15355380702366, 21.020221169036326, 20.02022116903634, 22.086579888625877, 22.020221169036347, 22.020221169036347, 21.820221169036337, 21.020221169036326, 21.020221169036326, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 21.320221169036337, 20.02022116903634, 21.853553703345394, 20.135996203329892, 20.953553703345374], "episode_lengths": [30, 30, 30, 15, 30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 19, 30, 30, 30, 30, 30, 30, 30, 30, 30, 21, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6901573995878328, "mean_inference_ms": 1.2208273261495708, "mean_action_processing_ms": 0.10482010501428181, "mean_env_wait_ms": 29.590809930400464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007163286209106445, "StateBufferConnector_ms": 0.004792928695678711, "ViewRequirementAgentConnector_ms": 0.11704015731811523}}, "episode_reward_max": 22.420221169036328, "episode_reward_min": 6.286887821815881, "episode_reward_mean": 20.295839669115864, "episode_len_mean": 28.93, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.135996203329878, 22.020221169036347, 20.55355450236965, 9.35355450236966, 20.553554500335974, 9.469329536663212, 22.020221169036347, 21.020221169036326, 20.02022116903634, 21.020221169036326, 20.85355450236967, 21.153554502369662, 20.153554502369676, 22.020221169036347, 22.020221169036347, 20.286887823644633, 20.153554502369676, 20.92021528366936, 20.02022116903634, 22.020221169036347, 21.020221169036326, 13.286887835703002, 20.55355450236967, 21.15355441080147, 22.153554502366045, 20.420221168827155, 20.02022116903634, 22.020221169036347, 22.286887835671838, 20.02022116903634, 20.286887835703006, 14.35355450236966, 20.153554502369673, 21.020221169036326, 6.286887821815881, 20.02022116903634, 21.020221169036326, 20.153554502369676, 21.020221169036326, 20.42022116903634, 20.02022116903634, 22.020221169036347, 20.153514405215024, 22.020221169036347, 20.02022116903634, 21.020221169036326, 21.153554502369662, 21.020221169036326, 7.086887835671288, 21.020221169036326, 21.020221169036326, 7.820221169004621, 21.153554502369662, 22.020221169036347, 21.020221169036326, 21.153554502369662, 20.02022116903634, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.15355450236919, 22.153554502369666, 20.15355450236967, 21.020221169036326, 21.020221169036326, 22.020221169036347, 22.15355450236968, 20.43599620332988, 21.020221169036326, 22.020221169036347, 20.15355450236966, 22.020221169036347, 20.02022116903634, 22.420221169036328, 22.020221169036347, 20.153554410801462, 22.020221169036347, 20.786887823648065, 20.985994152953314, 21.15355380702366, 21.020221169036326, 20.02022116903634, 22.086579888625877, 22.020221169036347, 22.020221169036347, 21.820221169036337, 21.020221169036326, 21.020221169036326, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 21.320221169036337, 20.02022116903634, 21.853553703345394, 20.135996203329892, 20.953553703345374], "episode_lengths": [30, 30, 30, 15, 30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 19, 30, 30, 30, 30, 30, 30, 30, 30, 30, 21, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6901573995878328, "mean_inference_ms": 1.2208273261495708, "mean_action_processing_ms": 0.10482010501428181, "mean_env_wait_ms": 29.590809930400464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007163286209106445, "StateBufferConnector_ms": 0.004792928695678711, "ViewRequirementAgentConnector_ms": 0.11704015731811523}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.596845628316043, "num_env_steps_trained_throughput_per_sec": 29.596845628316043, "timesteps_total": 144000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 66297.05, "sample_time_ms": 63114.866, "load_time_ms": 11.614, "load_throughput": 172205.77, "learn_time_ms": 3167.923, "learn_throughput": 631.329, "synch_weights_time_ms": 2.194}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 5230, "training_iteration": 72, "trial_id": "13850_00001", "date": "2023-12-28_19-07-15", "timestamp": 1703761635, "time_this_iter_s": 67.57981204986572, "time_total_s": 4785.375742673874, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4785.375742673874, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 55.97291666666666, "ram_util_percent": 92.434375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.592326932761353e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.46690300969613924, "policy_loss": -0.007174294988314311, "vf_loss": 0.4740773033671495, "vf_explained_var": 0.8048468567265404, "kl": 0.04864122712082303, "entropy": 0.4882023290461964, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 32625.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 146000, "num_env_steps_trained": 146000, "num_agent_steps_sampled": 146000, "num_agent_steps_trained": 146000}, "sampler_results": {"episode_reward_max": 22.420221169036346, "episode_reward_min": 10.153554502160556, "episode_reward_mean": 21.17361924871645, "episode_len_mean": 29.81, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.020221169036326, 22.020221169036347, 22.15355450236968, 20.43599620332988, 21.020221169036326, 22.020221169036347, 20.15355450236966, 22.020221169036347, 20.02022116903634, 22.420221169036328, 22.020221169036347, 20.153554410801462, 22.020221169036347, 20.786887823648065, 20.985994152953314, 21.15355380702366, 21.020221169036326, 20.02022116903634, 22.086579888625877, 22.020221169036347, 22.020221169036347, 21.820221169036337, 21.020221169036326, 21.020221169036326, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 21.320221169036337, 20.02022116903634, 21.853553703345394, 20.135996203329892, 20.953553703345374, 20.26932953666323, 21.119913221959106, 21.28688783411507, 22.020221169036347, 21.020221167185515, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.286887823644637, 22.15355380702367, 22.020221169036347, 21.135996203329878, 21.453554502369585, 22.153514405215034, 22.020221169036347, 21.153554502369662, 21.15351440521502, 20.28688783549389, 22.020221169036347, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.28688783570253, 22.15355450236967, 22.020221169036347, 20.153554502369673, 21.286887744134802, 22.020221169036347, 20.153554502369673, 22.020221169036347, 21.020221169036326, 20.153549222085925, 21.95324655529245, 21.020221169036326, 21.420221169036328, 20.286887048788795, 22.020221169036347, 22.15355450236968, 20.9193293197857, 20.820221169036326, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.153554502369676, 21.151242298380883, 21.120221167448403, 22.020221169036347, 22.1359962033299, 22.020221169036347, 16.420221169032708, 21.020221169036326, 22.020221169036347, 22.020221169036347, 10.153554502160556, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.28626511101364, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.420221169036346, 21.020221169036326, 20.820221063770113], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6897810451419637, "mean_inference_ms": 1.2207293573637066, "mean_action_processing_ms": 0.10482054584062064, "mean_env_wait_ms": 29.58924874046913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007089853286743164, "StateBufferConnector_ms": 0.004723072052001953, "ViewRequirementAgentConnector_ms": 0.1156919002532959}}, "episode_reward_max": 22.420221169036346, "episode_reward_min": 10.153554502160556, "episode_reward_mean": 21.17361924871645, "episode_len_mean": 29.81, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.020221169036326, 22.020221169036347, 22.15355450236968, 20.43599620332988, 21.020221169036326, 22.020221169036347, 20.15355450236966, 22.020221169036347, 20.02022116903634, 22.420221169036328, 22.020221169036347, 20.153554410801462, 22.020221169036347, 20.786887823648065, 20.985994152953314, 21.15355380702366, 21.020221169036326, 20.02022116903634, 22.086579888625877, 22.020221169036347, 22.020221169036347, 21.820221169036337, 21.020221169036326, 21.020221169036326, 22.020221169036347, 21.020221169036326, 22.020221169036347, 22.020221169036347, 21.320221169036337, 20.02022116903634, 21.853553703345394, 20.135996203329892, 20.953553703345374, 20.26932953666323, 21.119913221959106, 21.28688783411507, 22.020221169036347, 21.020221167185515, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.286887823644637, 22.15355380702367, 22.020221169036347, 21.135996203329878, 21.453554502369585, 22.153514405215034, 22.020221169036347, 21.153554502369662, 21.15351440521502, 20.28688783549389, 22.020221169036347, 20.02022116903634, 21.020221169036326, 22.020221169036347, 21.28688783570253, 22.15355450236967, 22.020221169036347, 20.153554502369673, 21.286887744134802, 22.020221169036347, 20.153554502369673, 22.020221169036347, 21.020221169036326, 20.153549222085925, 21.95324655529245, 21.020221169036326, 21.420221169036328, 20.286887048788795, 22.020221169036347, 22.15355450236968, 20.9193293197857, 20.820221169036326, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.153554502369676, 21.151242298380883, 21.120221167448403, 22.020221169036347, 22.1359962033299, 22.020221169036347, 16.420221169032708, 21.020221169036326, 22.020221169036347, 22.020221169036347, 10.153554502160556, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.28626511101364, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.420221169036346, 21.020221169036326, 20.820221063770113], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6897810451419637, "mean_inference_ms": 1.2207293573637066, "mean_action_processing_ms": 0.10482054584062064, "mean_env_wait_ms": 29.58924874046913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007089853286743164, "StateBufferConnector_ms": 0.004723072052001953, "ViewRequirementAgentConnector_ms": 0.1156919002532959}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 146000, "num_agent_steps_trained": 146000, "num_env_steps_sampled": 146000, "num_env_steps_trained": 146000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.496549784350343, "num_env_steps_trained_throughput_per_sec": 30.496549784350343, "timesteps_total": 146000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 146000, "timers": {"training_iteration_time_ms": 66216.301, "sample_time_ms": 63037.037, "load_time_ms": 11.556, "load_throughput": 173077.683, "learn_time_ms": 3165.047, "learn_throughput": 631.902, "synch_weights_time_ms": 2.196}, "counters": {"num_env_steps_sampled": 146000, "num_env_steps_trained": 146000, "num_agent_steps_sampled": 146000, "num_agent_steps_trained": 146000}, "done": false, "episodes_total": 5297, "training_iteration": 73, "trial_id": "13850_00001", "date": "2023-12-28_19-08-21", "timestamp": 1703761701, "time_this_iter_s": 65.58571314811707, "time_total_s": 4850.961455821991, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4850.961455821991, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 55.96129032258064, "ram_util_percent": 92.43655913978493}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4388490399142025e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5872922526796658, "policy_loss": -0.029186551902029248, "vf_loss": 1.6164787976609336, "vf_explained_var": 0.3575317939122518, "kl": 0.004840738202109422, "entropy": 0.7353155174520281, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": 22.420221169036346, "episode_reward_min": 6.2535543969143506, "episode_reward_mean": 20.022036105192264, "episode_len_mean": 28.57, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.9193293197857, 20.820221169036326, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.153554502369676, 21.151242298380883, 21.120221167448403, 22.020221169036347, 22.1359962033299, 22.020221169036347, 16.420221169032708, 21.020221169036326, 22.020221169036347, 22.020221169036347, 10.153554502160556, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.28626511101364, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.420221169036346, 21.020221169036326, 20.820221063770113, 22.020221169036347, 22.020221169036347, 6.2535543969143506, 22.020221169036347, 20.25355448848653, 20.55351440521503, 13.618393695219732, 20.153554502369673, 20.717908965047556, 22.15355450236919, 8.420221169035784, 20.285995956136066, 20.220221169036336, 7.853549222081753, 20.52022116903578, 20.886887730436793, 20.520221169036336, 22.020221169036347, 22.286887742546874, 20.753547819570436, 20.920220972201843, 22.020221169036347, 20.153554502369673, 21.420181071672577, 22.020221169036347, 6.720221169004622, 20.153553807023656, 20.386887835698825, 20.753553007999294, 20.269329536663225, 18.153554502369673, 20.953554502369652, 20.386887835698825, 14.886887823644638, 20.252660714353784, 14.953548513352693, 22.15355450236967, 20.453554488486517, 22.15355450236967, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.28688783411507, 20.41959844413785, 20.286887835703006, 20.720220370012047, 22.020221169036347, 15.08457563171422, 20.02022116903634, 20.252931009801173, 20.02022116903634, 20.286887835703006, 15.453554502369672, 20.786887835675472, 20.619587333268083, 20.669329536659113, 21.286887835703002, 21.753554495381774, 22.020221169036347, 17.086887835703, 22.153554502369676, 20.153554502369666, 20.168435853913547, 22.020221169036347, 22.020221169036347, 20.553554502365493, 20.386887835698825, 20.486887835702994, 22.15355450236968, 17.486887835703], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30, 30, 20, 30, 30, 30, 13, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 28, 30, 30, 21, 30, 23, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 26, 30, 30, 30, 30, 30, 30, 30, 30, 30, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6896475685771044, "mean_inference_ms": 1.2208280444998048, "mean_action_processing_ms": 0.10483807005064255, "mean_env_wait_ms": 29.59329807522189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006945371627807617, "StateBufferConnector_ms": 0.004974365234375, "ViewRequirementAgentConnector_ms": 0.11824870109558105}}, "episode_reward_max": 22.420221169036346, "episode_reward_min": 6.2535543969143506, "episode_reward_mean": 20.022036105192264, "episode_len_mean": 28.57, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.9193293197857, 20.820221169036326, 22.020221169036347, 22.020221169036347, 21.020221169036326, 22.020221169036347, 20.153554502369676, 21.151242298380883, 21.120221167448403, 22.020221169036347, 22.1359962033299, 22.020221169036347, 16.420221169032708, 21.020221169036326, 22.020221169036347, 22.020221169036347, 10.153554502160556, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.28626511101364, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.02022116903634, 22.020221169036347, 22.420221169036346, 21.020221169036326, 20.820221063770113, 22.020221169036347, 22.020221169036347, 6.2535543969143506, 22.020221169036347, 20.25355448848653, 20.55351440521503, 13.618393695219732, 20.153554502369673, 20.717908965047556, 22.15355450236919, 8.420221169035784, 20.285995956136066, 20.220221169036336, 7.853549222081753, 20.52022116903578, 20.886887730436793, 20.520221169036336, 22.020221169036347, 22.286887742546874, 20.753547819570436, 20.920220972201843, 22.020221169036347, 20.153554502369673, 21.420181071672577, 22.020221169036347, 6.720221169004622, 20.153553807023656, 20.386887835698825, 20.753553007999294, 20.269329536663225, 18.153554502369673, 20.953554502369652, 20.386887835698825, 14.886887823644638, 20.252660714353784, 14.953548513352693, 22.15355450236967, 20.453554488486517, 22.15355450236967, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.28688783411507, 20.41959844413785, 20.286887835703006, 20.720220370012047, 22.020221169036347, 15.08457563171422, 20.02022116903634, 20.252931009801173, 20.02022116903634, 20.286887835703006, 15.453554502369672, 20.786887835675472, 20.619587333268083, 20.669329536659113, 21.286887835703002, 21.753554495381774, 22.020221169036347, 17.086887835703, 22.153554502369676, 20.153554502369666, 20.168435853913547, 22.020221169036347, 22.020221169036347, 20.553554502365493, 20.386887835698825, 20.486887835702994, 22.15355450236968, 17.486887835703], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30, 30, 20, 30, 30, 30, 13, 30, 30, 12, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 28, 30, 30, 21, 30, 23, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 26, 30, 30, 30, 30, 30, 30, 30, 30, 30, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6896475685771044, "mean_inference_ms": 1.2208280444998048, "mean_action_processing_ms": 0.10483807005064255, "mean_env_wait_ms": 29.59329807522189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006945371627807617, "StateBufferConnector_ms": 0.004974365234375, "ViewRequirementAgentConnector_ms": 0.11824870109558105}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.577244421089, "num_env_steps_trained_throughput_per_sec": 29.577244421089, "timesteps_total": 148000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 66381.539, "sample_time_ms": 63205.745, "load_time_ms": 11.36, "load_throughput": 176058.161, "learn_time_ms": 3161.776, "learn_throughput": 632.556, "synch_weights_time_ms": 2.194}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 5368, "training_iteration": 74, "trial_id": "13850_00001", "date": "2023-12-28_19-09-29", "timestamp": 1703761769, "time_this_iter_s": 67.6249430179596, "time_total_s": 4918.586398839951, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4918.586398839951, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 55.77731958762886, "ram_util_percent": 92.47628865979381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.194245199571012e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3061605404193202, "policy_loss": 0.006683411945899328, "vf_loss": 1.2994771239492628, "vf_explained_var": 0.1786124951309628, "kl": 0.006344129267017201, "entropy": 0.7425502273109225, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33525.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000}, "sampler_results": {"episode_reward_max": 22.28688783411507, "episode_reward_min": 2.820215087951271, "episode_reward_mean": 19.897388293724397, "episode_len_mean": 28.7, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.02022116903634, 22.020221169036347, 22.28688783411507, 20.41959844413785, 20.286887835703006, 20.720220370012047, 22.020221169036347, 15.08457563171422, 20.02022116903634, 20.252931009801173, 20.02022116903634, 20.286887835703006, 15.453554502369672, 20.786887835675472, 20.619587333268083, 20.669329536659113, 21.286887835703002, 21.753554495381774, 22.020221169036347, 17.086887835703, 22.153554502369676, 20.153554502369666, 20.168435853913547, 22.020221169036347, 22.020221169036347, 20.553554502365493, 20.386887835698825, 20.486887835702994, 22.15355450236968, 17.486887835703, 21.9529302107769, 20.41959767646785, 20.419598445159966, 21.953554502369677, 20.02022116903634, 22.020221169036347, 21.020221169036326, 21.153554502128852, 22.15355450236968, 20.420221169032235, 20.185994152953324, 20.18688703667872, 20.286887833874598, 20.053554502128847, 20.28688782181986, 22.020221169036347, 18.75324655529244, 20.1535544903113, 22.119329229802076, 20.02022116903634, 22.15355380702367, 20.353554502337957, 20.353246553464036, 20.02022116903634, 21.953554502369677, 20.219913221959093, 20.153554502369676, 20.686887835703008, 22.15355450236968, 20.586887835702452, 8.284575631710048, 20.220221063770126, 20.453554490314257, 2.820215087951271, 4.486887730247683, 22.020221169036347, 20.286887833874598, 20.02022116903634, 20.486579888625222, 22.020221169036347, 20.153554502369673, 20.48653381584138, 22.020221169036347, 20.38684428692643, 20.286887835703002, 8.886887835702451, 20.02022116903634, 21.953554502369677, 20.320221063770052, 21.753554502160018, 20.153554502369673, 20.286887835703006, 20.153554502369673, 22.020221169036347, 20.2868878356989, 20.420221169035784, 14.720221169036332, 20.119321497356385, 20.552931778494106, 20.253554397103386, 20.153554502369673, 20.02022116903634, 20.386265111009454, 21.020221169035786, 8.286887835671289, 20.586887835703003, 22.020221169036347, 22.020221169036347, 21.953554502369677, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 26, 30, 30, 30, 30, 30, 30, 30, 30, 30, 27, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 5, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6894656391335872, "mean_inference_ms": 1.2208484029288942, "mean_action_processing_ms": 0.10483533609103808, "mean_env_wait_ms": 29.592658063922944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007004737854003906, "StateBufferConnector_ms": 0.004755258560180664, "ViewRequirementAgentConnector_ms": 0.11626672744750977}}, "episode_reward_max": 22.28688783411507, "episode_reward_min": 2.820215087951271, "episode_reward_mean": 19.897388293724397, "episode_len_mean": 28.7, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.02022116903634, 22.020221169036347, 22.28688783411507, 20.41959844413785, 20.286887835703006, 20.720220370012047, 22.020221169036347, 15.08457563171422, 20.02022116903634, 20.252931009801173, 20.02022116903634, 20.286887835703006, 15.453554502369672, 20.786887835675472, 20.619587333268083, 20.669329536659113, 21.286887835703002, 21.753554495381774, 22.020221169036347, 17.086887835703, 22.153554502369676, 20.153554502369666, 20.168435853913547, 22.020221169036347, 22.020221169036347, 20.553554502365493, 20.386887835698825, 20.486887835702994, 22.15355450236968, 17.486887835703, 21.9529302107769, 20.41959767646785, 20.419598445159966, 21.953554502369677, 20.02022116903634, 22.020221169036347, 21.020221169036326, 21.153554502128852, 22.15355450236968, 20.420221169032235, 20.185994152953324, 20.18688703667872, 20.286887833874598, 20.053554502128847, 20.28688782181986, 22.020221169036347, 18.75324655529244, 20.1535544903113, 22.119329229802076, 20.02022116903634, 22.15355380702367, 20.353554502337957, 20.353246553464036, 20.02022116903634, 21.953554502369677, 20.219913221959093, 20.153554502369676, 20.686887835703008, 22.15355450236968, 20.586887835702452, 8.284575631710048, 20.220221063770126, 20.453554490314257, 2.820215087951271, 4.486887730247683, 22.020221169036347, 20.286887833874598, 20.02022116903634, 20.486579888625222, 22.020221169036347, 20.153554502369673, 20.48653381584138, 22.020221169036347, 20.38684428692643, 20.286887835703002, 8.886887835702451, 20.02022116903634, 21.953554502369677, 20.320221063770052, 21.753554502160018, 20.153554502369673, 20.286887835703006, 20.153554502369673, 22.020221169036347, 20.2868878356989, 20.420221169035784, 14.720221169036332, 20.119321497356385, 20.552931778494106, 20.253554397103386, 20.153554502369673, 20.02022116903634, 20.386265111009454, 21.020221169035786, 8.286887835671289, 20.586887835703003, 22.020221169036347, 22.020221169036347, 21.953554502369677, 22.020221169036347], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 26, 30, 30, 30, 30, 30, 30, 30, 30, 30, 27, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 5, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6894656391335872, "mean_inference_ms": 1.2208484029288942, "mean_action_processing_ms": 0.10483533609103808, "mean_env_wait_ms": 29.592658063922944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007004737854003906, "StateBufferConnector_ms": 0.004755258560180664, "ViewRequirementAgentConnector_ms": 0.11626672744750977}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000, "num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.420557956003297, "num_env_steps_trained_throughput_per_sec": 30.420557956003297, "timesteps_total": 150000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 150000, "timers": {"training_iteration_time_ms": 66413.075, "sample_time_ms": 63236.149, "load_time_ms": 11.707, "load_throughput": 170842.89, "learn_time_ms": 3162.553, "learn_throughput": 632.401, "synch_weights_time_ms": 2.204}, "counters": {"num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000}, "done": false, "episodes_total": 5438, "training_iteration": 75, "trial_id": "13850_00001", "date": "2023-12-28_19-10-34", "timestamp": 1703761834, "time_this_iter_s": 65.74975848197937, "time_total_s": 4984.33615732193, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4984.33615732193, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 55.982795698924726, "ram_util_percent": 92.41612903225803}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.194245199571012e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0579552477039398, "policy_loss": 0.002400601808395651, "vf_loss": 1.0555546447800266, "vf_explained_var": 0.43468080507384405, "kl": 0.010498770300833411, "entropy": 0.6538888002766503, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33975.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": 22.153554502369676, "episode_reward_min": 2.1525803438166617, "episode_reward_mean": 20.09106102446714, "episode_len_mean": 28.99, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.020221169036347, 20.153554502369673, 20.48653381584138, 22.020221169036347, 20.38684428692643, 20.286887835703002, 8.886887835702451, 20.02022116903634, 21.953554502369677, 20.320221063770052, 21.753554502160018, 20.153554502369673, 20.286887835703006, 20.153554502369673, 22.020221169036347, 20.2868878356989, 20.420221169035784, 14.720221169036332, 20.119321497356385, 20.552931778494106, 20.253554397103386, 20.153554502369673, 20.02022116903634, 20.386265111009454, 21.020221169035786, 8.286887835671289, 20.586887835703003, 22.020221169036347, 22.020221169036347, 21.953554502369677, 22.020221169036347, 22.020221169036347, 21.786887835703002, 22.153554502369676, 22.020221169036347, 21.38688783570301, 20.02022116903634, 20.153514405215024, 22.020221169036347, 20.02022116903634, 20.25351095358948, 22.15355450236967, 20.02022116903634, 20.269323547673785, 20.153554502369193, 20.25355448848653, 22.020221169036347, 20.02022116903634, 20.320215089721746, 20.286265111013634, 20.120177620259774, 20.553548526708767, 21.820221063770134, 20.700046177998892, 20.02022116903634, 21.95324655529245, 20.452662550255447, 20.120221169036334, 20.153554502366045, 20.32022116903633, 20.02022116903634, 20.353554397103395, 20.02022116903634, 21.78688782181987, 20.02022116903634, 20.58626509713049, 20.28688773207644, 20.02022116903634, 20.153554502369673, 14.753511636900635, 20.420221169036342, 20.486583347903217, 2.1525803438166617, 20.252931009801173, 22.020221169036347, 21.720221063795595, 21.786887835703013, 20.25355448848653, 20.153554502369676, 20.02022116903634, 22.020221169036347, 20.352930210776893, 21.786844286926442, 2.820215087951271, 20.952930307440276, 20.286887835703002, 20.286887835703006, 22.020221169036347, 20.353554502337957, 22.020221169036347, 20.55355450236966, 20.25355450234206, 20.153548513380233, 22.05324655529245, 20.153554502369673, 20.719609891598985, 22.020221169036347, 21.71790896504755, 22.020221169036347, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 4, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6891740178508303, "mean_inference_ms": 1.2206976460026764, "mean_action_processing_ms": 0.10482441669713935, "mean_env_wait_ms": 29.58945606807998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006865501403808594, "StateBufferConnector_ms": 0.004741668701171875, "ViewRequirementAgentConnector_ms": 0.11403203010559082}}, "episode_reward_max": 22.153554502369676, "episode_reward_min": 2.1525803438166617, "episode_reward_mean": 20.09106102446714, "episode_len_mean": 28.99, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.020221169036347, 20.153554502369673, 20.48653381584138, 22.020221169036347, 20.38684428692643, 20.286887835703002, 8.886887835702451, 20.02022116903634, 21.953554502369677, 20.320221063770052, 21.753554502160018, 20.153554502369673, 20.286887835703006, 20.153554502369673, 22.020221169036347, 20.2868878356989, 20.420221169035784, 14.720221169036332, 20.119321497356385, 20.552931778494106, 20.253554397103386, 20.153554502369673, 20.02022116903634, 20.386265111009454, 21.020221169035786, 8.286887835671289, 20.586887835703003, 22.020221169036347, 22.020221169036347, 21.953554502369677, 22.020221169036347, 22.020221169036347, 21.786887835703002, 22.153554502369676, 22.020221169036347, 21.38688783570301, 20.02022116903634, 20.153514405215024, 22.020221169036347, 20.02022116903634, 20.25351095358948, 22.15355450236967, 20.02022116903634, 20.269323547673785, 20.153554502369193, 20.25355448848653, 22.020221169036347, 20.02022116903634, 20.320215089721746, 20.286265111013634, 20.120177620259774, 20.553548526708767, 21.820221063770134, 20.700046177998892, 20.02022116903634, 21.95324655529245, 20.452662550255447, 20.120221169036334, 20.153554502366045, 20.32022116903633, 20.02022116903634, 20.353554397103395, 20.02022116903634, 21.78688782181987, 20.02022116903634, 20.58626509713049, 20.28688773207644, 20.02022116903634, 20.153554502369673, 14.753511636900635, 20.420221169036342, 20.486583347903217, 2.1525803438166617, 20.252931009801173, 22.020221169036347, 21.720221063795595, 21.786887835703013, 20.25355448848653, 20.153554502369676, 20.02022116903634, 22.020221169036347, 20.352930210776893, 21.786844286926442, 2.820215087951271, 20.952930307440276, 20.286887835703002, 20.286887835703006, 22.020221169036347, 20.353554502337957, 22.020221169036347, 20.55355450236966, 20.25355450234206, 20.153548513380233, 22.05324655529245, 20.153554502369673, 20.719609891598985, 22.020221169036347, 21.71790896504755, 22.020221169036347, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 4, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6891740178508303, "mean_inference_ms": 1.2206976460026764, "mean_action_processing_ms": 0.10482441669713935, "mean_env_wait_ms": 29.58945606807998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006865501403808594, "StateBufferConnector_ms": 0.004741668701171875, "ViewRequirementAgentConnector_ms": 0.11403203010559082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.331565244783064, "num_env_steps_trained_throughput_per_sec": 30.331565244783064, "timesteps_total": 152000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 66392.649, "sample_time_ms": 63214.686, "load_time_ms": 12.149, "load_throughput": 164629.062, "learn_time_ms": 3163.171, "learn_throughput": 632.277, "synch_weights_time_ms": 2.181}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 5507, "training_iteration": 76, "trial_id": "13850_00001", "date": "2023-12-28_19-11-40", "timestamp": 1703761900, "time_this_iter_s": 65.94245409965515, "time_total_s": 5050.278611421585, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5050.278611421585, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 55.94787234042553, "ram_util_percent": 92.45851063829785}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.194245199571012e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.871491400371823, "policy_loss": -0.0017383087674776713, "vf_loss": 0.8732297100789017, "vf_explained_var": 0.4499242660734389, "kl": 0.009948549787990266, "entropy": 0.6011235313945347, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 34425.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 154000, "num_env_steps_trained": 154000, "num_agent_steps_sampled": 154000, "num_agent_steps_trained": 154000}, "sampler_results": {"episode_reward_max": 22.15355449031131, "episode_reward_min": 2.1525803438166617, "episode_reward_mean": 19.98626900247156, "episode_len_mean": 28.67, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.753511636900635, 20.420221169036342, 20.486583347903217, 2.1525803438166617, 20.252931009801173, 22.020221169036347, 21.720221063795595, 21.786887835703013, 20.25355448848653, 20.153554502369676, 20.02022116903634, 22.020221169036347, 20.352930210776893, 21.786844286926442, 2.820215087951271, 20.952930307440276, 20.286887835703002, 20.286887835703006, 22.020221169036347, 20.353554502337957, 22.020221169036347, 20.55355450236966, 20.25355450234206, 20.153548513380233, 22.05324655529245, 20.153554502369673, 20.719609891598985, 22.020221169036347, 21.71790896504755, 22.020221169036347, 20.02022116903634, 21.186887036678705, 20.052660819619994, 20.02022116903634, 20.586887022823305, 20.05355450236967, 20.41959844434697, 6.653554502128844, 20.02022116903634, 20.353554502369118, 22.020221169036347, 20.120177620259774, 20.02022116903634, 20.320221167207933, 22.020221169036347, 20.553510953592554, 22.020221169036347, 4.2202210635810165, 22.020221169036347, 20.25355450236967, 20.220221169036336, 22.020221169036347, 20.85355450236967, 20.02022116903634, 20.153554502369673, 20.453554502369595, 21.586887835702942, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.220221169035785, 11.586804189771795, 20.720221077624988, 21.820221169036337, 22.020221169036347, 22.020221169036347, 20.65354851338022, 22.020221169036347, 22.152931009801186, 22.15355449031131, 20.02022116903634, 20.153548513380233, 20.25355448848653, 22.020221169036347, 20.420221169004623, 20.586264343102794, 10.135996203329888, 20.153554502369673, 20.153554502369673, 22.020221169036347, 16.152931009801172, 21.95355450236913, 20.02022116903634, 20.620221063769574, 20.88688703667872, 22.020221169036347, 20.853553806997414, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.153554502369666, 21.420221169035774, 20.652617311139526, 21.020221169036326, 20.02022116903634, 20.5535537033971], "episode_lengths": [22, 30, 30, 4, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.688853337246504, "mean_inference_ms": 1.2204804460455794, "mean_action_processing_ms": 0.10481006674169768, "mean_env_wait_ms": 29.58483691050336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007016897201538086, "StateBufferConnector_ms": 0.004796028137207031, "ViewRequirementAgentConnector_ms": 0.11432266235351562}}, "episode_reward_max": 22.15355449031131, "episode_reward_min": 2.1525803438166617, "episode_reward_mean": 19.98626900247156, "episode_len_mean": 28.67, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.753511636900635, 20.420221169036342, 20.486583347903217, 2.1525803438166617, 20.252931009801173, 22.020221169036347, 21.720221063795595, 21.786887835703013, 20.25355448848653, 20.153554502369676, 20.02022116903634, 22.020221169036347, 20.352930210776893, 21.786844286926442, 2.820215087951271, 20.952930307440276, 20.286887835703002, 20.286887835703006, 22.020221169036347, 20.353554502337957, 22.020221169036347, 20.55355450236966, 20.25355450234206, 20.153548513380233, 22.05324655529245, 20.153554502369673, 20.719609891598985, 22.020221169036347, 21.71790896504755, 22.020221169036347, 20.02022116903634, 21.186887036678705, 20.052660819619994, 20.02022116903634, 20.586887022823305, 20.05355450236967, 20.41959844434697, 6.653554502128844, 20.02022116903634, 20.353554502369118, 22.020221169036347, 20.120177620259774, 20.02022116903634, 20.320221167207933, 22.020221169036347, 20.553510953592554, 22.020221169036347, 4.2202210635810165, 22.020221169036347, 20.25355450236967, 20.220221169036336, 22.020221169036347, 20.85355450236967, 20.02022116903634, 20.153554502369673, 20.453554502369595, 21.586887835702942, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.220221169035785, 11.586804189771795, 20.720221077624988, 21.820221169036337, 22.020221169036347, 22.020221169036347, 20.65354851338022, 22.020221169036347, 22.152931009801186, 22.15355449031131, 20.02022116903634, 20.153548513380233, 20.25355448848653, 22.020221169036347, 20.420221169004623, 20.586264343102794, 10.135996203329888, 20.153554502369673, 20.153554502369673, 22.020221169036347, 16.152931009801172, 21.95355450236913, 20.02022116903634, 20.620221063769574, 20.88688703667872, 22.020221169036347, 20.853553806997414, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.153554502369666, 21.420221169035774, 20.652617311139526, 21.020221169036326, 20.02022116903634, 20.5535537033971], "episode_lengths": [22, 30, 30, 4, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.688853337246504, "mean_inference_ms": 1.2204804460455794, "mean_action_processing_ms": 0.10481006674169768, "mean_env_wait_ms": 29.58483691050336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007016897201538086, "StateBufferConnector_ms": 0.004796028137207031, "ViewRequirementAgentConnector_ms": 0.11432266235351562}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 154000, "num_agent_steps_trained": 154000, "num_env_steps_sampled": 154000, "num_env_steps_trained": 154000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.530615595050943, "num_env_steps_trained_throughput_per_sec": 30.530615595050943, "timesteps_total": 154000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 154000, "timers": {"training_iteration_time_ms": 66335.394, "sample_time_ms": 63155.984, "load_time_ms": 12.09, "load_throughput": 165429.676, "learn_time_ms": 3164.75, "learn_throughput": 631.961, "synch_weights_time_ms": 2.111}, "counters": {"num_env_steps_sampled": 154000, "num_env_steps_trained": 154000, "num_agent_steps_sampled": 154000, "num_agent_steps_trained": 154000}, "done": false, "episodes_total": 5576, "training_iteration": 77, "trial_id": "13850_00001", "date": "2023-12-28_19-12-46", "timestamp": 1703761966, "time_this_iter_s": 65.51289343833923, "time_total_s": 5115.791504859924, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5115.791504859924, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 55.76451612903226, "ram_util_percent": 92.47204301075269}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.194245199571012e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2598599538082877, "policy_loss": 0.002690092937813865, "vf_loss": 1.257169856544998, "vf_explained_var": 0.4030355864100986, "kl": 0.004028069984151922, "entropy": 0.5297692253192265, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 22.15355450236968, "episode_reward_min": 2.753508324129961, "episode_reward_mean": 20.529291535685292, "episode_len_mean": 29.2, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.152931009801186, 22.15355449031131, 20.02022116903634, 20.153548513380233, 20.25355448848653, 22.020221169036347, 20.420221169004623, 20.586264343102794, 10.135996203329888, 20.153554502369673, 20.153554502369673, 22.020221169036347, 16.152931009801172, 21.95355450236913, 20.02022116903634, 20.620221063769574, 20.88688703667872, 22.020221169036347, 20.853553806997414, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.153554502369666, 21.420221169035774, 20.652617311139526, 21.020221169036326, 20.02022116903634, 20.5535537033971, 22.020221169036347, 21.820221063770134, 22.020221169036347, 20.385994152952772, 21.386277320550054, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.18688703667872, 20.78688782181984, 22.020221169036347, 20.286887835703006, 21.786887835703002, 22.020221169036347, 21.186887730436798, 20.15355450236966, 20.120177620259774, 21.386887835462197, 20.02022116903634, 22.15355450236968, 12.286887821819859, 22.020221169036347, 20.552931009801167, 20.153554502369676, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 2.753508324129961, 22.020221169036347, 22.020221169036347, 20.719913221959107, 20.153554502369673, 20.920221077593958, 22.020221169036347, 20.153554502366045, 22.020221169036347, 8.886887835702451, 20.686881846713664, 21.586887835703003, 22.020221169036347, 14.086887835703, 22.020221169036347, 20.153554502369673, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.55266081961999, 20.585952439054633, 20.02022116903634, 20.18688703667872, 20.920221169036324, 21.95324655529245, 21.186887835703004, 20.286887835703006, 20.520221169004625, 22.020221169036347, 21.95324655529245, 22.020221169036347, 20.052660819619994, 20.18688703667872, 22.020221169036347, 21.020221169036326, 20.153554502369673, 21.42022116903634, 20.420221169032157, 20.7535537033453, 21.920177620259782, 20.920215966957556], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 19, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6886744316037539, "mean_inference_ms": 1.2205104541277976, "mean_action_processing_ms": 0.10481578692739277, "mean_env_wait_ms": 29.585552138937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007132291793823242, "StateBufferConnector_ms": 0.004832029342651367, "ViewRequirementAgentConnector_ms": 0.11656570434570312}}, "episode_reward_max": 22.15355450236968, "episode_reward_min": 2.753508324129961, "episode_reward_mean": 20.529291535685292, "episode_len_mean": 29.2, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.152931009801186, 22.15355449031131, 20.02022116903634, 20.153548513380233, 20.25355448848653, 22.020221169036347, 20.420221169004623, 20.586264343102794, 10.135996203329888, 20.153554502369673, 20.153554502369673, 22.020221169036347, 16.152931009801172, 21.95355450236913, 20.02022116903634, 20.620221063769574, 20.88688703667872, 22.020221169036347, 20.853553806997414, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.153554502369666, 21.420221169035774, 20.652617311139526, 21.020221169036326, 20.02022116903634, 20.5535537033971, 22.020221169036347, 21.820221063770134, 22.020221169036347, 20.385994152952772, 21.386277320550054, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.18688703667872, 20.78688782181984, 22.020221169036347, 20.286887835703006, 21.786887835703002, 22.020221169036347, 21.186887730436798, 20.15355450236966, 20.120177620259774, 21.386887835462197, 20.02022116903634, 22.15355450236968, 12.286887821819859, 22.020221169036347, 20.552931009801167, 20.153554502369676, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 2.753508324129961, 22.020221169036347, 22.020221169036347, 20.719913221959107, 20.153554502369673, 20.920221077593958, 22.020221169036347, 20.153554502366045, 22.020221169036347, 8.886887835702451, 20.686881846713664, 21.586887835703003, 22.020221169036347, 14.086887835703, 22.020221169036347, 20.153554502369673, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.55266081961999, 20.585952439054633, 20.02022116903634, 20.18688703667872, 20.920221169036324, 21.95324655529245, 21.186887835703004, 20.286887835703006, 20.520221169004625, 22.020221169036347, 21.95324655529245, 22.020221169036347, 20.052660819619994, 20.18688703667872, 22.020221169036347, 21.020221169036326, 20.153554502369673, 21.42022116903634, 20.420221169032157, 20.7535537033453, 21.920177620259782, 20.920215966957556], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 16, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 19, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6886744316037539, "mean_inference_ms": 1.2205104541277976, "mean_action_processing_ms": 0.10481578692739277, "mean_env_wait_ms": 29.585552138937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007132291793823242, "StateBufferConnector_ms": 0.004832029342651367, "ViewRequirementAgentConnector_ms": 0.11656570434570312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.865533311238426, "num_env_steps_trained_throughput_per_sec": 29.865533311238426, "timesteps_total": 156000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 66397.144, "sample_time_ms": 63217.169, "load_time_ms": 11.575, "load_throughput": 172781.795, "learn_time_ms": 3165.816, "learn_throughput": 631.749, "synch_weights_time_ms": 2.135}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 5645, "training_iteration": 78, "trial_id": "13850_00001", "date": "2023-12-28_19-13-53", "timestamp": 1703762033, "time_this_iter_s": 66.97137069702148, "time_total_s": 5182.762875556946, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5182.762875556946, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 55.775, "ram_util_percent": 92.48333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.597122599785506e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1665078989871673, "policy_loss": 0.003061655503180292, "vf_loss": 1.1634462549206284, "vf_explained_var": 0.46497590210702683, "kl": 0.0023898975545483363, "entropy": 0.5848683863215977, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 35325.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 158000, "num_env_steps_trained": 158000, "num_agent_steps_sampled": 158000, "num_agent_steps_trained": 158000}, "sampler_results": {"episode_reward_max": 22.15355450236968, "episode_reward_min": 7.420221169004621, "episode_reward_mean": 20.578161828066627, "episode_len_mean": 29.27, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.886887835702451, 20.686881846713664, 21.586887835703003, 22.020221169036347, 14.086887835703, 22.020221169036347, 20.153554502369673, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.55266081961999, 20.585952439054633, 20.02022116903634, 20.18688703667872, 20.920221169036324, 21.95324655529245, 21.186887835703004, 20.286887835703006, 20.520221169004625, 22.020221169036347, 21.95324655529245, 22.020221169036347, 20.052660819619994, 20.18688703667872, 22.020221169036347, 21.020221169036326, 20.153554502369673, 21.42022116903634, 20.420221169032157, 20.7535537033453, 21.920177620259782, 20.920215966957556, 21.886881846713575, 22.020221169036347, 20.086887835703003, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.586887835702917, 20.153554502369676, 22.020221169036347, 21.05294324051096, 22.152931009801186, 22.15355450236968, 21.086887723552504, 21.686887835702997, 20.286887835703006, 20.72022116903634, 22.020221169036347, 20.38688781527793, 20.686887835703, 20.28688783570301, 22.020221169036347, 7.420221169004621, 20.286887835702995, 20.02022116903634, 20.486887835703, 20.153554502366045, 21.920177620259782, 22.020221169036347, 20.553554502369675, 22.153554502369666, 21.086887835702996, 20.553554502128854, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.153554502369673, 22.020221169036347, 22.020221169036347, 20.353554502337957, 20.786887835703006, 20.486887835702994, 20.22022037001205, 21.020221169036336, 20.153554502369673, 22.020221169036347, 8.720221169036263, 20.15293100980118, 11.820221169036333, 22.020221169036347, 21.05355450236966, 22.020221169036347, 20.586887835703003, 20.02022116903634, 22.020221169036347, 21.020221169036326, 21.55293100980118, 21.78688782181987, 20.386887835698825, 21.686887835671303, 22.153554410801476, 20.42022116903634, 20.75355450236966, 21.520221169036347, 22.020221169036347, 20.420221169035784, 20.620221169036338, 22.020221169036347, 20.153548513380233], "episode_lengths": [13, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6885013180517306, "mean_inference_ms": 1.220578478849387, "mean_action_processing_ms": 0.10482380917156872, "mean_env_wait_ms": 29.58883555039565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007193803787231445, "StateBufferConnector_ms": 0.0047626495361328125, "ViewRequirementAgentConnector_ms": 0.11688518524169922}}, "episode_reward_max": 22.15355450236968, "episode_reward_min": 7.420221169004621, "episode_reward_mean": 20.578161828066627, "episode_len_mean": 29.27, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.886887835702451, 20.686881846713664, 21.586887835703003, 22.020221169036347, 14.086887835703, 22.020221169036347, 20.153554502369673, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.55266081961999, 20.585952439054633, 20.02022116903634, 20.18688703667872, 20.920221169036324, 21.95324655529245, 21.186887835703004, 20.286887835703006, 20.520221169004625, 22.020221169036347, 21.95324655529245, 22.020221169036347, 20.052660819619994, 20.18688703667872, 22.020221169036347, 21.020221169036326, 20.153554502369673, 21.42022116903634, 20.420221169032157, 20.7535537033453, 21.920177620259782, 20.920215966957556, 21.886881846713575, 22.020221169036347, 20.086887835703003, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.586887835702917, 20.153554502369676, 22.020221169036347, 21.05294324051096, 22.152931009801186, 22.15355450236968, 21.086887723552504, 21.686887835702997, 20.286887835703006, 20.72022116903634, 22.020221169036347, 20.38688781527793, 20.686887835703, 20.28688783570301, 22.020221169036347, 7.420221169004621, 20.286887835702995, 20.02022116903634, 20.486887835703, 20.153554502366045, 21.920177620259782, 22.020221169036347, 20.553554502369675, 22.153554502369666, 21.086887835702996, 20.553554502128854, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.153554502369673, 22.020221169036347, 22.020221169036347, 20.353554502337957, 20.786887835703006, 20.486887835702994, 20.22022037001205, 21.020221169036336, 20.153554502369673, 22.020221169036347, 8.720221169036263, 20.15293100980118, 11.820221169036333, 22.020221169036347, 21.05355450236966, 22.020221169036347, 20.586887835703003, 20.02022116903634, 22.020221169036347, 21.020221169036326, 21.55293100980118, 21.78688782181987, 20.386887835698825, 21.686887835671303, 22.153554410801476, 20.42022116903634, 20.75355450236966, 21.520221169036347, 22.020221169036347, 20.420221169035784, 20.620221169036338, 22.020221169036347, 20.153548513380233], "episode_lengths": [13, 30, 30, 30, 22, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6885013180517306, "mean_inference_ms": 1.220578478849387, "mean_action_processing_ms": 0.10482380917156872, "mean_env_wait_ms": 29.58883555039565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007193803787231445, "StateBufferConnector_ms": 0.0047626495361328125, "ViewRequirementAgentConnector_ms": 0.11688518524169922}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 158000, "num_agent_steps_trained": 158000, "num_env_steps_sampled": 158000, "num_env_steps_trained": 158000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.869406199612495, "num_env_steps_trained_throughput_per_sec": 29.869406199612495, "timesteps_total": 158000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 158000, "timers": {"training_iteration_time_ms": 66517.453, "sample_time_ms": 63336.482, "load_time_ms": 10.768, "load_throughput": 185734.137, "learn_time_ms": 3167.613, "learn_throughput": 631.39, "synch_weights_time_ms": 2.14}, "counters": {"num_env_steps_sampled": 158000, "num_env_steps_trained": 158000, "num_agent_steps_sampled": 158000, "num_agent_steps_trained": 158000}, "done": false, "episodes_total": 5713, "training_iteration": 79, "trial_id": "13850_00001", "date": "2023-12-28_19-15-00", "timestamp": 1703762100, "time_this_iter_s": 66.96645951271057, "time_total_s": 5249.729335069656, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5249.729335069656, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 55.96842105263158, "ram_util_percent": 92.47894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.798561299892753e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.27821311140226, "policy_loss": 0.006115781035688188, "vf_loss": 1.2720973306314813, "vf_explained_var": 0.5780338127083249, "kl": 0.006910352802754927, "entropy": 0.5579645918475257, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 35775.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": 22.15355450236968, "episode_reward_min": 7.086887835671288, "episode_reward_mean": 20.549442236787215, "episode_len_mean": 29.2, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.020221169036347, 22.020221169036347, 20.353554502337957, 20.786887835703006, 20.486887835702994, 20.22022037001205, 21.020221169036336, 20.153554502369673, 22.020221169036347, 8.720221169036263, 20.15293100980118, 11.820221169036333, 22.020221169036347, 21.05355450236966, 22.020221169036347, 20.586887835703003, 20.02022116903634, 22.020221169036347, 21.020221169036326, 21.55293100980118, 21.78688782181987, 20.386887835698825, 21.686887835671303, 22.153554410801476, 20.42022116903634, 20.75355450236966, 21.520221169036347, 22.020221169036347, 20.420221169035784, 20.620221169036338, 22.020221169036347, 20.153548513380233, 20.02022116903634, 20.45355450236966, 20.286265111013634, 21.78688782181987, 22.020221169036347, 21.153554502369662, 22.020221169036347, 20.02022116903634, 22.15355450236968, 21.05355450236966, 8.153554502365491, 14.75355450236967, 21.58688703664702, 22.020221169036347, 20.32022115515319, 22.020221169036347, 22.15354922208594, 7.086887835671288, 20.92022116903633, 22.020221169036347, 20.42022115697797, 20.986887835702994, 20.18688703667872, 16.18688782364464, 20.02022116903634, 20.619876584081908, 21.420221169036342, 22.020221169036347, 20.519598444346965, 20.151242298380893, 20.22022116903633, 20.15293100980118, 22.020221169036347, 21.820221063770134, 20.753554397071934, 22.020221169036347, 20.751236309391455, 20.420221155153197, 22.020221169036347, 20.520220370012055, 20.119913221959106, 21.920215180046906, 20.82022116879551, 21.520221169036347, 21.31959687744356, 22.020221169036347, 21.220221077468143, 22.020221169036347, 21.452931009801176, 20.320221168795523, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.553554488486043, 22.020221169036347, 22.020221169036347, 20.786887835703006, 22.020221169036347, 20.586887835702452, 21.820221063770134, 20.686887835703004, 22.020221169036347, 20.353554502369665, 20.353553703345383, 22.085953256770967, 21.420221169036342, 20.15293100980118], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 12, 21, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6882988023934784, "mean_inference_ms": 1.2206647609016776, "mean_action_processing_ms": 0.10482940178434198, "mean_env_wait_ms": 29.592654902182588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007340192794799805, "StateBufferConnector_ms": 0.004756927490234375, "ViewRequirementAgentConnector_ms": 0.11684155464172363}}, "episode_reward_max": 22.15355450236968, "episode_reward_min": 7.086887835671288, "episode_reward_mean": 20.549442236787215, "episode_len_mean": 29.2, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.020221169036347, 22.020221169036347, 20.353554502337957, 20.786887835703006, 20.486887835702994, 20.22022037001205, 21.020221169036336, 20.153554502369673, 22.020221169036347, 8.720221169036263, 20.15293100980118, 11.820221169036333, 22.020221169036347, 21.05355450236966, 22.020221169036347, 20.586887835703003, 20.02022116903634, 22.020221169036347, 21.020221169036326, 21.55293100980118, 21.78688782181987, 20.386887835698825, 21.686887835671303, 22.153554410801476, 20.42022116903634, 20.75355450236966, 21.520221169036347, 22.020221169036347, 20.420221169035784, 20.620221169036338, 22.020221169036347, 20.153548513380233, 20.02022116903634, 20.45355450236966, 20.286265111013634, 21.78688782181987, 22.020221169036347, 21.153554502369662, 22.020221169036347, 20.02022116903634, 22.15355450236968, 21.05355450236966, 8.153554502365491, 14.75355450236967, 21.58688703664702, 22.020221169036347, 20.32022115515319, 22.020221169036347, 22.15354922208594, 7.086887835671288, 20.92022116903633, 22.020221169036347, 20.42022115697797, 20.986887835702994, 20.18688703667872, 16.18688782364464, 20.02022116903634, 20.619876584081908, 21.420221169036342, 22.020221169036347, 20.519598444346965, 20.151242298380893, 20.22022116903633, 20.15293100980118, 22.020221169036347, 21.820221063770134, 20.753554397071934, 22.020221169036347, 20.751236309391455, 20.420221155153197, 22.020221169036347, 20.520220370012055, 20.119913221959106, 21.920215180046906, 20.82022116879551, 21.520221169036347, 21.31959687744356, 22.020221169036347, 21.220221077468143, 22.020221169036347, 21.452931009801176, 20.320221168795523, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.553554488486043, 22.020221169036347, 22.020221169036347, 20.786887835703006, 22.020221169036347, 20.586887835702452, 21.820221063770134, 20.686887835703004, 22.020221169036347, 20.353554502369665, 20.353553703345383, 22.085953256770967, 21.420221169036342, 20.15293100980118], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 12, 21, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6882988023934784, "mean_inference_ms": 1.2206647609016776, "mean_action_processing_ms": 0.10482940178434198, "mean_env_wait_ms": 29.592654902182588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007340192794799805, "StateBufferConnector_ms": 0.004756927490234375, "ViewRequirementAgentConnector_ms": 0.11684155464172363}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.77845790582071, "num_env_steps_trained_throughput_per_sec": 29.77845790582071, "timesteps_total": 160000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 66618.604, "sample_time_ms": 63431.956, "load_time_ms": 11.327, "load_throughput": 176571.42, "learn_time_ms": 3172.677, "learn_throughput": 630.382, "synch_weights_time_ms": 2.192}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 5781, "training_iteration": 80, "trial_id": "13850_00001", "date": "2023-12-28_19-16-07", "timestamp": 1703762167, "time_this_iter_s": 67.16744565963745, "time_total_s": 5316.896780729294, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5316.896780729294, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 55.98125000000001, "ram_util_percent": 92.53541666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.798561299892753e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8248160634934902, "policy_loss": 0.0031337709062629277, "vf_loss": 0.8216822923595707, "vf_explained_var": 0.3382992382844289, "kl": 0.01197430510539275, "entropy": 0.46701889018217724, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 36225.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "sampler_results": {"episode_reward_max": 22.085953256770967, "episode_reward_min": 2.753240487601063, "episode_reward_mean": 20.57515006689849, "episode_len_mean": 29.24, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.420221155153197, 22.020221169036347, 20.520220370012055, 20.119913221959106, 21.920215180046906, 20.82022116879551, 21.520221169036347, 21.31959687744356, 22.020221169036347, 21.220221077468143, 22.020221169036347, 21.452931009801176, 20.320221168795523, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.553554488486043, 22.020221169036347, 22.020221169036347, 20.786887835703006, 22.020221169036347, 20.586887835702452, 21.820221063770134, 20.686887835703004, 22.020221169036347, 20.353554502369665, 20.353553703345383, 22.085953256770967, 21.420221169036342, 20.15293100980118, 22.020221169036347, 20.153548513380233, 22.020221169036347, 20.685994152949135, 20.153554502369673, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.586887828923665, 12.385371575831462, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.153554502369666, 22.020221169036347, 18.186887835703004, 20.05355450236967, 10.186881846713563, 20.05355450236967, 22.020221169036347, 20.153554502369673, 20.553554502369675, 20.55324655529243, 22.020221169036347, 22.020221169036347, 21.48688782709548, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.48688783570298, 22.020221169036347, 20.02022116903634, 20.153554502369676, 22.020221169036347, 20.8202211551532, 22.020221169036347, 20.386887835698825, 18.020221169036336, 22.020221169036347, 20.886887835703, 20.75355450236967, 22.020221169036347, 4.820221063581017, 20.02022116903634, 20.48599518907011, 20.18688703667872, 20.45355450212885, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.086887835703003, 20.286844286926435, 2.753240487601063, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.286887835703006, 21.15355450236966, 20.5535545023655, 20.25355450236967, 20.45355370331737, 20.086887835703003, 21.55355450236966, 20.18688703667872, 20.753548513380238], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 19, 30, 30, 30, 30, 30, 30, 28, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 28, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6880505220411695, "mean_inference_ms": 1.220546358301421, "mean_action_processing_ms": 0.10482125041586944, "mean_env_wait_ms": 29.591216785590788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00715947151184082, "StateBufferConnector_ms": 0.004773855209350586, "ViewRequirementAgentConnector_ms": 0.11554479598999023}}, "episode_reward_max": 22.085953256770967, "episode_reward_min": 2.753240487601063, "episode_reward_mean": 20.57515006689849, "episode_len_mean": 29.24, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.420221155153197, 22.020221169036347, 20.520220370012055, 20.119913221959106, 21.920215180046906, 20.82022116879551, 21.520221169036347, 21.31959687744356, 22.020221169036347, 21.220221077468143, 22.020221169036347, 21.452931009801176, 20.320221168795523, 22.020221169036347, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.553554488486043, 22.020221169036347, 22.020221169036347, 20.786887835703006, 22.020221169036347, 20.586887835702452, 21.820221063770134, 20.686887835703004, 22.020221169036347, 20.353554502369665, 20.353553703345383, 22.085953256770967, 21.420221169036342, 20.15293100980118, 22.020221169036347, 20.153548513380233, 22.020221169036347, 20.685994152949135, 20.153554502369673, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.586887828923665, 12.385371575831462, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.153554502369666, 22.020221169036347, 18.186887835703004, 20.05355450236967, 10.186881846713563, 20.05355450236967, 22.020221169036347, 20.153554502369673, 20.553554502369675, 20.55324655529243, 22.020221169036347, 22.020221169036347, 21.48688782709548, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.48688783570298, 22.020221169036347, 20.02022116903634, 20.153554502369676, 22.020221169036347, 20.8202211551532, 22.020221169036347, 20.386887835698825, 18.020221169036336, 22.020221169036347, 20.886887835703, 20.75355450236967, 22.020221169036347, 4.820221063581017, 20.02022116903634, 20.48599518907011, 20.18688703667872, 20.45355450212885, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.086887835703003, 20.286844286926435, 2.753240487601063, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.286887835703006, 21.15355450236966, 20.5535545023655, 20.25355450236967, 20.45355370331737, 20.086887835703003, 21.55355450236966, 20.18688703667872, 20.753548513380238], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 19, 30, 30, 30, 30, 30, 30, 28, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 28, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6880505220411695, "mean_inference_ms": 1.220546358301421, "mean_action_processing_ms": 0.10482125041586944, "mean_env_wait_ms": 29.591216785590788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00715947151184082, "StateBufferConnector_ms": 0.004773855209350586, "ViewRequirementAgentConnector_ms": 0.11554479598999023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.264076672297982, "num_env_steps_trained_throughput_per_sec": 30.264076672297982, "timesteps_total": 162000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 162000, "timers": {"training_iteration_time_ms": 66513.872, "sample_time_ms": 63295.662, "load_time_ms": 11.892, "load_throughput": 168185.56, "learn_time_ms": 3203.659, "learn_throughput": 624.286, "synch_weights_time_ms": 2.21}, "counters": {"num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "done": false, "episodes_total": 5850, "training_iteration": 81, "trial_id": "13850_00001", "date": "2023-12-28_19-17-13", "timestamp": 1703762233, "time_this_iter_s": 66.08968925476074, "time_total_s": 5382.986469984055, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5382.986469984055, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 56.15212765957446, "ram_util_percent": 92.50744680851065}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.798561299892753e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6673031414714123, "policy_loss": 0.0109993353817198, "vf_loss": 1.6563038007252746, "vf_explained_var": 0.37108321176634895, "kl": 0.004040531357834359, "entropy": 0.46985970934232074, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 36675.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": 22.153554502369666, "episode_reward_min": 2.253508324129961, "episode_reward_mean": 20.128904766998392, "episode_len_mean": 28.63, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.386887835698825, 18.020221169036336, 22.020221169036347, 20.886887835703, 20.75355450236967, 22.020221169036347, 4.820221063581017, 20.02022116903634, 20.48599518907011, 20.18688703667872, 20.45355450212885, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.086887835703003, 20.286844286926435, 2.753240487601063, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.286887835703006, 21.15355450236966, 20.5535545023655, 20.25355450236967, 20.45355370331737, 20.086887835703003, 21.55355450236966, 20.18688703667872, 20.753548513380238, 22.020221169036347, 21.752920665013004, 22.153554502366045, 22.153554502369666, 20.153554410801462, 21.01991492847771, 20.153514405215024, 20.320221168795523, 22.020221169036347, 11.453515552047584, 22.020221169036347, 22.020221169036347, 16.720221169036325, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.386887835702993, 20.153514405215024, 2.253508324129961, 20.153554502369193, 21.052931012739798, 22.020221169036347, 20.65355380702366, 20.15355450236966, 22.153554502160564, 22.153554502342136, 20.820221169036337, 21.95324655529245, 8.95355441059235, 21.920221169036342, 21.353241275008642, 20.353554397103455, 22.020221169036347, 20.58658325651996, 20.51991320990026, 20.820221153356343, 22.020221169036347, 21.25355450233797, 18.786583347934926, 21.15093444104594, 21.52022116720793, 22.020221169036347, 22.020221169036347, 20.51932748604582, 20.253510862024896, 22.020221169036347, 20.786887129860318, 22.020221169036347, 13.117015270239454, 22.020221169036347, 20.68599597598194, 22.020221169036347, 20.553554502369668, 20.419916681240725, 22.020221169036347, 22.020221169036347, 19.335996201505303, 20.02022116903634, 9.520215180046888, 21.053549222085927, 20.253511648959343, 22.020221169036347, 22.020221169036347, 21.2862765587531, 21.486583347908688, 22.152931009801186, 20.88688783546219, 21.85355380831961, 20.686887138769062, 22.020221169036347], "episode_lengths": [30, 28, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 17, 30, 30, 25, 30, 30, 30, 30, 30, 4, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 28, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 29, 30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6878332577928257, "mean_inference_ms": 1.2204120754094543, "mean_action_processing_ms": 0.10481737149261569, "mean_env_wait_ms": 29.590531508691893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072002410888671875, "StateBufferConnector_ms": 0.004778385162353516, "ViewRequirementAgentConnector_ms": 0.11456823348999023}}, "episode_reward_max": 22.153554502369666, "episode_reward_min": 2.253508324129961, "episode_reward_mean": 20.128904766998392, "episode_len_mean": 28.63, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.386887835698825, 18.020221169036336, 22.020221169036347, 20.886887835703, 20.75355450236967, 22.020221169036347, 4.820221063581017, 20.02022116903634, 20.48599518907011, 20.18688703667872, 20.45355450212885, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.086887835703003, 20.286844286926435, 2.753240487601063, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.286887835703006, 21.15355450236966, 20.5535545023655, 20.25355450236967, 20.45355370331737, 20.086887835703003, 21.55355450236966, 20.18688703667872, 20.753548513380238, 22.020221169036347, 21.752920665013004, 22.153554502366045, 22.153554502369666, 20.153554410801462, 21.01991492847771, 20.153514405215024, 20.320221168795523, 22.020221169036347, 11.453515552047584, 22.020221169036347, 22.020221169036347, 16.720221169036325, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.386887835702993, 20.153514405215024, 2.253508324129961, 20.153554502369193, 21.052931012739798, 22.020221169036347, 20.65355380702366, 20.15355450236966, 22.153554502160564, 22.153554502342136, 20.820221169036337, 21.95324655529245, 8.95355441059235, 21.920221169036342, 21.353241275008642, 20.353554397103455, 22.020221169036347, 20.58658325651996, 20.51991320990026, 20.820221153356343, 22.020221169036347, 21.25355450233797, 18.786583347934926, 21.15093444104594, 21.52022116720793, 22.020221169036347, 22.020221169036347, 20.51932748604582, 20.253510862024896, 22.020221169036347, 20.786887129860318, 22.020221169036347, 13.117015270239454, 22.020221169036347, 20.68599597598194, 22.020221169036347, 20.553554502369668, 20.419916681240725, 22.020221169036347, 22.020221169036347, 19.335996201505303, 20.02022116903634, 9.520215180046888, 21.053549222085927, 20.253511648959343, 22.020221169036347, 22.020221169036347, 21.2862765587531, 21.486583347908688, 22.152931009801186, 20.88688783546219, 21.85355380831961, 20.686887138769062, 22.020221169036347], "episode_lengths": [30, 28, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 17, 30, 30, 25, 30, 30, 30, 30, 30, 4, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 30, 28, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 29, 30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6878332577928257, "mean_inference_ms": 1.2204120754094543, "mean_action_processing_ms": 0.10481737149261569, "mean_env_wait_ms": 29.590531508691893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072002410888671875, "StateBufferConnector_ms": 0.004778385162353516, "ViewRequirementAgentConnector_ms": 0.11456823348999023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.05628638529348, "num_env_steps_trained_throughput_per_sec": 30.05628638529348, "timesteps_total": 164000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 66410.577, "sample_time_ms": 63190.504, "load_time_ms": 11.541, "load_throughput": 173301.518, "learn_time_ms": 3205.881, "learn_throughput": 623.854, "synch_weights_time_ms": 2.202}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 5920, "training_iteration": 82, "trial_id": "13850_00001", "date": "2023-12-28_19-18-20", "timestamp": 1703762300, "time_this_iter_s": 66.54665565490723, "time_total_s": 5449.533125638962, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5449.533125638962, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 55.87659574468085, "ram_util_percent": 92.48510638297871}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.992806499463766e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2572609340565073, "policy_loss": 7.275913324620988e-05, "vf_loss": 1.2571881836818324, "vf_explained_var": 0.3919076698356205, "kl": 0.007934421223166403, "entropy": 0.43706538438797, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 37125.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 166000, "num_env_steps_trained": 166000, "num_agent_steps_sampled": 166000, "num_agent_steps_trained": 166000}, "sampler_results": {"episode_reward_max": 22.153250014601607, "episode_reward_min": 2.820215087951271, "episode_reward_mean": 20.52573259050713, "episode_len_mean": 29.21, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.786583347934926, 21.15093444104594, 21.52022116720793, 22.020221169036347, 22.020221169036347, 20.51932748604582, 20.253510862024896, 22.020221169036347, 20.786887129860318, 22.020221169036347, 13.117015270239454, 22.020221169036347, 20.68599597598194, 22.020221169036347, 20.553554502369668, 20.419916681240725, 22.020221169036347, 22.020221169036347, 19.335996201505303, 20.02022116903634, 9.520215180046888, 21.053549222085927, 20.253511648959343, 22.020221169036347, 22.020221169036347, 21.2862765587531, 21.486583347908688, 22.152931009801186, 20.88688783546219, 21.85355380831961, 20.686887138769062, 22.020221169036347, 22.020221169036347, 22.020221169036347, 15.253554490311302, 20.68688783545863, 20.286887833905958, 20.520221169036255, 22.020221169036347, 22.020221169036347, 20.5535538070231, 22.020221169036347, 20.51932921478797, 20.353554502337957, 20.02022116903634, 20.35355370334114, 22.020221169036347, 22.020221169036347, 20.153554502366045, 21.353554502369672, 20.386887835698825, 20.286887835703, 22.12017508289226, 20.653554500541258, 22.020221169036347, 21.930722722661553, 20.386887835702996, 20.553251468659372, 7.233074238616063, 21.886849565775904, 21.28688774413479, 20.153554502342132, 20.02022116903634, 21.48688782364807, 22.020221169036347, 20.186887835703004, 20.71987658411352, 20.886887835703003, 20.55294321396869, 22.020221169036347, 21.953554502369677, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.152931009801186, 20.552943213972316, 20.853554502125228, 20.519329321373164, 20.151242298380893, 20.153554502369666, 20.153554502369676, 20.68661998694517, 21.685994159452118, 20.620221169036338, 22.153250014601607, 21.35355450236967, 20.753549300089023, 20.686887835703004, 20.35266081961636, 22.020221169036347, 20.53537271073385, 22.020221169036347, 20.286881846713015, 2.820215087951271, 20.153554502369673, 22.020221169036347, 21.153554490311304, 20.286887835703006, 20.753552659569863, 22.1359962033299], "episode_lengths": [28, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 29, 30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6876535996346723, "mean_inference_ms": 1.2204829650101146, "mean_action_processing_ms": 0.10482514627773344, "mean_env_wait_ms": 29.5935074244302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070743560791015625, "StateBufferConnector_ms": 0.0047795772552490234, "ViewRequirementAgentConnector_ms": 0.11568999290466309}}, "episode_reward_max": 22.153250014601607, "episode_reward_min": 2.820215087951271, "episode_reward_mean": 20.52573259050713, "episode_len_mean": 29.21, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.786583347934926, 21.15093444104594, 21.52022116720793, 22.020221169036347, 22.020221169036347, 20.51932748604582, 20.253510862024896, 22.020221169036347, 20.786887129860318, 22.020221169036347, 13.117015270239454, 22.020221169036347, 20.68599597598194, 22.020221169036347, 20.553554502369668, 20.419916681240725, 22.020221169036347, 22.020221169036347, 19.335996201505303, 20.02022116903634, 9.520215180046888, 21.053549222085927, 20.253511648959343, 22.020221169036347, 22.020221169036347, 21.2862765587531, 21.486583347908688, 22.152931009801186, 20.88688783546219, 21.85355380831961, 20.686887138769062, 22.020221169036347, 22.020221169036347, 22.020221169036347, 15.253554490311302, 20.68688783545863, 20.286887833905958, 20.520221169036255, 22.020221169036347, 22.020221169036347, 20.5535538070231, 22.020221169036347, 20.51932921478797, 20.353554502337957, 20.02022116903634, 20.35355370334114, 22.020221169036347, 22.020221169036347, 20.153554502366045, 21.353554502369672, 20.386887835698825, 20.286887835703, 22.12017508289226, 20.653554500541258, 22.020221169036347, 21.930722722661553, 20.386887835702996, 20.553251468659372, 7.233074238616063, 21.886849565775904, 21.28688774413479, 20.153554502342132, 20.02022116903634, 21.48688782364807, 22.020221169036347, 20.186887835703004, 20.71987658411352, 20.886887835703003, 20.55294321396869, 22.020221169036347, 21.953554502369677, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.152931009801186, 20.552943213972316, 20.853554502125228, 20.519329321373164, 20.151242298380893, 20.153554502369666, 20.153554502369676, 20.68661998694517, 21.685994159452118, 20.620221169036338, 22.153250014601607, 21.35355450236967, 20.753549300089023, 20.686887835703004, 20.35266081961636, 22.020221169036347, 20.53537271073385, 22.020221169036347, 20.286881846713015, 2.820215087951271, 20.153554502369673, 22.020221169036347, 21.153554490311304, 20.286887835703006, 20.753552659569863, 22.1359962033299], "episode_lengths": [28, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 30, 30, 30, 30, 30, 30, 29, 30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6876535996346723, "mean_inference_ms": 1.2204829650101146, "mean_action_processing_ms": 0.10482514627773344, "mean_env_wait_ms": 29.5935074244302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070743560791015625, "StateBufferConnector_ms": 0.0047795772552490234, "ViewRequirementAgentConnector_ms": 0.11568999290466309}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 166000, "num_agent_steps_trained": 166000, "num_env_steps_sampled": 166000, "num_env_steps_trained": 166000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.79065491847413, "num_env_steps_trained_throughput_per_sec": 29.79065491847413, "timesteps_total": 166000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 166000, "timers": {"training_iteration_time_ms": 66565.973, "sample_time_ms": 63338.797, "load_time_ms": 12.522, "load_throughput": 159714.56, "learn_time_ms": 3212.001, "learn_throughput": 622.665, "synch_weights_time_ms": 2.211}, "counters": {"num_env_steps_sampled": 166000, "num_env_steps_trained": 166000, "num_agent_steps_sampled": 166000, "num_agent_steps_trained": 166000}, "done": false, "episodes_total": 5988, "training_iteration": 83, "trial_id": "13850_00001", "date": "2023-12-28_19-19-27", "timestamp": 1703762367, "time_this_iter_s": 67.1400408744812, "time_total_s": 5516.673166513443, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5516.673166513443, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 56.190625000000004, "ram_util_percent": 92.52083333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.992806499463766e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5767079160735011, "policy_loss": 0.004872963130474091, "vf_loss": 0.5718349504636394, "vf_explained_var": 0.5845641040802002, "kl": 0.0033793687109550997, "entropy": 0.4061319808496369, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 37575.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 22.420221169036346, "episode_reward_min": 2.820215087951271, "episode_reward_mean": 20.6231558655249, "episode_len_mean": 29.44, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.55294321396869, 22.020221169036347, 21.953554502369677, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.152931009801186, 20.552943213972316, 20.853554502125228, 20.519329321373164, 20.151242298380893, 20.153554502369666, 20.153554502369676, 20.68661998694517, 21.685994159452118, 20.620221169036338, 22.153250014601607, 21.35355450236967, 20.753549300089023, 20.686887835703004, 20.35266081961636, 22.020221169036347, 20.53537271073385, 22.020221169036347, 20.286881846713015, 2.820215087951271, 20.153554502369673, 22.020221169036347, 21.153554490311304, 20.286887835703006, 20.753552659569863, 22.1359962033299, 22.153554410801476, 20.353554502337957, 22.020221169036347, 20.120221169036334, 20.85355450236967, 20.286887835675465, 22.153514405215034, 20.586881950103496, 22.020221169036347, 22.020221169036347, 22.020221169036347, 8.15355450234158, 22.020221169036347, 20.153548513380233, 20.153554502369673, 20.02022116903634, 20.985040052267394, 20.153554502342132, 20.05355450236967, 20.620221169035784, 21.68688106110068, 20.45266081962009, 20.68688783567128, 22.020221169036347, 20.45355450236966, 22.020221169036347, 22.020221169036347, 21.453554385096815, 20.28688783411507, 20.517864630610674, 20.02022116903634, 20.153554502369673, 21.853553703345394, 22.020221169036347, 22.020221169036347, 21.15294311364234, 20.88688783366192, 22.020221169036347, 22.020221169036347, 20.653554502342132, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.286264343134516, 22.020221169036347, 20.284271143946157, 22.020221169036347, 20.669329536663202, 21.153554502369662, 20.02022116903634, 20.453554502369595, 20.453554490314254, 20.02022116903634, 20.72022116903634, 22.1512422983809, 20.32022116903632, 18.719953320278442, 20.02022116903634, 22.020221169036347, 12.553554502369668, 20.02022116903634, 20.153554502369193, 21.153250014601593, 22.420221169036346, 22.020221169036347, 20.653554502369662, 21.019645373197235, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 28, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6874542979358687, "mean_inference_ms": 1.2204594579364718, "mean_action_processing_ms": 0.10482663008542914, "mean_env_wait_ms": 29.594377621445975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007049560546875, "StateBufferConnector_ms": 0.004759788513183594, "ViewRequirementAgentConnector_ms": 0.1164541244506836}}, "episode_reward_max": 22.420221169036346, "episode_reward_min": 2.820215087951271, "episode_reward_mean": 20.6231558655249, "episode_len_mean": 29.44, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.55294321396869, 22.020221169036347, 21.953554502369677, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.152931009801186, 20.552943213972316, 20.853554502125228, 20.519329321373164, 20.151242298380893, 20.153554502369666, 20.153554502369676, 20.68661998694517, 21.685994159452118, 20.620221169036338, 22.153250014601607, 21.35355450236967, 20.753549300089023, 20.686887835703004, 20.35266081961636, 22.020221169036347, 20.53537271073385, 22.020221169036347, 20.286881846713015, 2.820215087951271, 20.153554502369673, 22.020221169036347, 21.153554490311304, 20.286887835703006, 20.753552659569863, 22.1359962033299, 22.153554410801476, 20.353554502337957, 22.020221169036347, 20.120221169036334, 20.85355450236967, 20.286887835675465, 22.153514405215034, 20.586881950103496, 22.020221169036347, 22.020221169036347, 22.020221169036347, 8.15355450234158, 22.020221169036347, 20.153548513380233, 20.153554502369673, 20.02022116903634, 20.985040052267394, 20.153554502342132, 20.05355450236967, 20.620221169035784, 21.68688106110068, 20.45266081962009, 20.68688783567128, 22.020221169036347, 20.45355450236966, 22.020221169036347, 22.020221169036347, 21.453554385096815, 20.28688783411507, 20.517864630610674, 20.02022116903634, 20.153554502369673, 21.853553703345394, 22.020221169036347, 22.020221169036347, 21.15294311364234, 20.88688783366192, 22.020221169036347, 22.020221169036347, 20.653554502342132, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.286264343134516, 22.020221169036347, 20.284271143946157, 22.020221169036347, 20.669329536663202, 21.153554502369662, 20.02022116903634, 20.453554502369595, 20.453554490314254, 20.02022116903634, 20.72022116903634, 22.1512422983809, 20.32022116903632, 18.719953320278442, 20.02022116903634, 22.020221169036347, 12.553554502369668, 20.02022116903634, 20.153554502369193, 21.153250014601593, 22.420221169036346, 22.020221169036347, 20.653554502369662, 21.019645373197235, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 28, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6874542979358687, "mean_inference_ms": 1.2204594579364718, "mean_action_processing_ms": 0.10482663008542914, "mean_env_wait_ms": 29.594377621445975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007049560546875, "StateBufferConnector_ms": 0.004759788513183594, "ViewRequirementAgentConnector_ms": 0.1164541244506836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.183412649902017, "num_env_steps_trained_throughput_per_sec": 30.183412649902017, "timesteps_total": 168000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 66430.179, "sample_time_ms": 63201.102, "load_time_ms": 13.0, "load_throughput": 153848.558, "learn_time_ms": 3213.401, "learn_throughput": 622.394, "synch_weights_time_ms": 2.234}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 6056, "training_iteration": 84, "trial_id": "13850_00001", "date": "2023-12-28_19-20-33", "timestamp": 1703762433, "time_this_iter_s": 66.27213954925537, "time_total_s": 5582.945306062698, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5582.945306062698, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 56.09255319148937, "ram_util_percent": 92.56595744680855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.496403249731883e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.36012779109593895, "policy_loss": 0.0026327915489673614, "vf_loss": 0.3574949942280849, "vf_explained_var": 0.5836567437648773, "kl": 0.0023124706391598063, "entropy": 0.36030019296540156, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 38025.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 170000, "num_env_steps_trained": 170000, "num_agent_steps_sampled": 170000, "num_agent_steps_trained": 170000}, "sampler_results": {"episode_reward_max": 22.420221169036346, "episode_reward_min": 3.0202150879512706, "episode_reward_mean": 20.261248449471363, "episode_len_mean": 28.97, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.020221169036347, 20.653554502342132, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.286264343134516, 22.020221169036347, 20.284271143946157, 22.020221169036347, 20.669329536663202, 21.153554502369662, 20.02022116903634, 20.453554502369595, 20.453554490314254, 20.02022116903634, 20.72022116903634, 22.1512422983809, 20.32022116903632, 18.719953320278442, 20.02022116903634, 22.020221169036347, 12.553554502369668, 20.02022116903634, 20.153554502369193, 21.153250014601593, 22.420221169036346, 22.020221169036347, 20.653554502369662, 21.019645373197235, 20.02022116903634, 22.119327486286643, 22.020221169036347, 20.153554502369676, 20.786619986945105, 5.386887833874246, 21.153554490311304, 21.12022105701554, 20.05355450236967, 21.020221169036326, 20.319327486312663, 20.02022116903634, 22.020221169036347, 22.153554502369676, 21.853554502369672, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.286887835703002, 22.020221169036347, 22.020221169036347, 20.286887833874598, 20.83599100125466, 20.92017762025976, 20.02022116903634, 22.020221169036347, 20.45355450236549, 20.02022116903634, 20.220221063770126, 20.753553807023653, 20.02022116903634, 20.420181071881693, 20.153549222085925, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.635996098063668, 4.486887730247683, 22.153554502369676, 21.50266286999656, 20.21991252661309, 20.22022116903633, 6.320221168795511, 20.086887835702452, 20.220220473690322, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.15355450236967, 21.42022116903634, 21.28688774392569, 22.020221169036347, 20.153548513380233, 22.020221169036347, 20.220221169036336, 20.086887835703003, 20.02022116903634, 22.020221169036347, 20.453554502369595, 22.020221169036347, 20.55355450236967, 20.135996203329892, 20.586887835702452, 22.020221169036347, 3.0202150879512706, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.086579888625774], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 28, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 9, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6872051942428081, "mean_inference_ms": 1.2203065724476725, "mean_action_processing_ms": 0.10481269894907953, "mean_env_wait_ms": 29.592403646901147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006970405578613281, "StateBufferConnector_ms": 0.004801511764526367, "ViewRequirementAgentConnector_ms": 0.11461281776428223}}, "episode_reward_max": 22.420221169036346, "episode_reward_min": 3.0202150879512706, "episode_reward_mean": 20.261248449471363, "episode_len_mean": 28.97, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.020221169036347, 20.653554502342132, 20.02022116903634, 22.020221169036347, 22.020221169036347, 20.286264343134516, 22.020221169036347, 20.284271143946157, 22.020221169036347, 20.669329536663202, 21.153554502369662, 20.02022116903634, 20.453554502369595, 20.453554490314254, 20.02022116903634, 20.72022116903634, 22.1512422983809, 20.32022116903632, 18.719953320278442, 20.02022116903634, 22.020221169036347, 12.553554502369668, 20.02022116903634, 20.153554502369193, 21.153250014601593, 22.420221169036346, 22.020221169036347, 20.653554502369662, 21.019645373197235, 20.02022116903634, 22.119327486286643, 22.020221169036347, 20.153554502369676, 20.786619986945105, 5.386887833874246, 21.153554490311304, 21.12022105701554, 20.05355450236967, 21.020221169036326, 20.319327486312663, 20.02022116903634, 22.020221169036347, 22.153554502369676, 21.853554502369672, 22.020221169036347, 22.020221169036347, 20.02022116903634, 22.020221169036347, 20.286887835703002, 22.020221169036347, 22.020221169036347, 20.286887833874598, 20.83599100125466, 20.92017762025976, 20.02022116903634, 22.020221169036347, 20.45355450236549, 20.02022116903634, 20.220221063770126, 20.753553807023653, 20.02022116903634, 20.420181071881693, 20.153549222085925, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.635996098063668, 4.486887730247683, 22.153554502369676, 21.50266286999656, 20.21991252661309, 20.22022116903633, 6.320221168795511, 20.086887835702452, 20.220220473690322, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.15355450236967, 21.42022116903634, 21.28688774392569, 22.020221169036347, 20.153548513380233, 22.020221169036347, 20.220221169036336, 20.086887835703003, 20.02022116903634, 22.020221169036347, 20.453554502369595, 22.020221169036347, 20.55355450236967, 20.135996203329892, 20.586887835702452, 22.020221169036347, 3.0202150879512706, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.086579888625774], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 28, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 9, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 7, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6872051942428081, "mean_inference_ms": 1.2203065724476725, "mean_action_processing_ms": 0.10481269894907953, "mean_env_wait_ms": 29.592403646901147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006970405578613281, "StateBufferConnector_ms": 0.004801511764526367, "ViewRequirementAgentConnector_ms": 0.11461281776428223}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 170000, "num_agent_steps_trained": 170000, "num_env_steps_sampled": 170000, "num_env_steps_trained": 170000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.346890244765817, "num_env_steps_trained_throughput_per_sec": 30.346890244765817, "timesteps_total": 170000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 170000, "timers": {"training_iteration_time_ms": 66446.139, "sample_time_ms": 63218.159, "load_time_ms": 13.146, "load_throughput": 152140.624, "learn_time_ms": 3212.162, "learn_throughput": 622.634, "synch_weights_time_ms": 2.232}, "counters": {"num_env_steps_sampled": 170000, "num_env_steps_trained": 170000, "num_agent_steps_sampled": 170000, "num_agent_steps_trained": 170000}, "done": false, "episodes_total": 6126, "training_iteration": 85, "trial_id": "13850_00001", "date": "2023-12-28_19-21-39", "timestamp": 1703762499, "time_this_iter_s": 65.90953469276428, "time_total_s": 5648.854840755463, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5648.854840755463, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 55.94468085106383, "ram_util_percent": 92.75000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2482016248659414e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8399624455802971, "policy_loss": 0.00518873671690623, "vf_loss": 0.8347737129819062, "vf_explained_var": 0.5915612314807044, "kl": 0.003269216818610487, "entropy": 0.2844310929874579, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 38475.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": 22.420221169036346, "episode_reward_min": 3.0202150879512706, "episode_reward_mean": 20.543466245526687, "episode_len_mean": 29.16, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.486887730247683, 22.153554502369676, 21.50266286999656, 20.21991252661309, 20.22022116903633, 6.320221168795511, 20.086887835702452, 20.220220473690322, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.15355450236967, 21.42022116903634, 21.28688774392569, 22.020221169036347, 20.153548513380233, 22.020221169036347, 20.220221169036336, 20.086887835703003, 20.02022116903634, 22.020221169036347, 20.453554502369595, 22.020221169036347, 20.55355450236967, 20.135996203329892, 20.586887835702452, 22.020221169036347, 3.0202150879512706, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.086579888625774, 20.886887835703, 20.02022116903634, 22.020221169036347, 13.353554502369667, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.853553703345394, 22.020221169036347, 20.15355450236967, 22.020221169036347, 22.020221169036347, 22.153554410801476, 20.18688703667872, 21.286887140356985, 21.020221169036326, 20.02022116903634, 22.1512422983809, 22.153514405215034, 21.020221169036326, 22.020221169036347, 21.886881846713575, 22.020221169036347, 20.452943238574786, 20.4193274847247, 22.420221169036346, 22.020221169036347, 20.286887835703006, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.153554490311304, 22.15354922208594, 20.15293100980118, 22.020221169036347, 17.82022116903634, 22.153554502369676, 22.020221169036347, 20.953516221968652, 20.18688703667872, 22.020221169036347, 20.320221169036273, 20.58684773854828, 20.02022116903634, 20.153554502369673, 22.020221169036347, 20.02022116903634, 22.153554502366045, 20.086887835703003, 20.15355450236966, 21.5535538085562, 20.02022116903634, 20.55266071435378, 22.020221169036347, 22.020221169036347, 21.286880201712005, 20.153554502369676, 20.02022116903634, 22.020221169036347, 18.2868877441348, 22.020221169036347, 20.65355361211602, 20.02022116903634, 20.15355450078173, 20.852618410578586, 20.92022107759754], "episode_lengths": [7, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 21, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 28, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6870097048266552, "mean_inference_ms": 1.2203676435256703, "mean_action_processing_ms": 0.10481762934349362, "mean_env_wait_ms": 29.59469933176618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007003068923950195, "StateBufferConnector_ms": 0.004823923110961914, "ViewRequirementAgentConnector_ms": 0.11568212509155273}}, "episode_reward_max": 22.420221169036346, "episode_reward_min": 3.0202150879512706, "episode_reward_mean": 20.543466245526687, "episode_len_mean": 29.16, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.486887730247683, 22.153554502369676, 21.50266286999656, 20.21991252661309, 20.22022116903633, 6.320221168795511, 20.086887835702452, 20.220220473690322, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.15355450236967, 21.42022116903634, 21.28688774392569, 22.020221169036347, 20.153548513380233, 22.020221169036347, 20.220221169036336, 20.086887835703003, 20.02022116903634, 22.020221169036347, 20.453554502369595, 22.020221169036347, 20.55355450236967, 20.135996203329892, 20.586887835702452, 22.020221169036347, 3.0202150879512706, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.086579888625774, 20.886887835703, 20.02022116903634, 22.020221169036347, 13.353554502369667, 22.020221169036347, 22.020221169036347, 21.020221169036326, 21.853553703345394, 22.020221169036347, 20.15355450236967, 22.020221169036347, 22.020221169036347, 22.153554410801476, 20.18688703667872, 21.286887140356985, 21.020221169036326, 20.02022116903634, 22.1512422983809, 22.153514405215034, 21.020221169036326, 22.020221169036347, 21.886881846713575, 22.020221169036347, 20.452943238574786, 20.4193274847247, 22.420221169036346, 22.020221169036347, 20.286887835703006, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.153554490311304, 22.15354922208594, 20.15293100980118, 22.020221169036347, 17.82022116903634, 22.153554502369676, 22.020221169036347, 20.953516221968652, 20.18688703667872, 22.020221169036347, 20.320221169036273, 20.58684773854828, 20.02022116903634, 20.153554502369673, 22.020221169036347, 20.02022116903634, 22.153554502366045, 20.086887835703003, 20.15355450236966, 21.5535538085562, 20.02022116903634, 20.55266071435378, 22.020221169036347, 22.020221169036347, 21.286880201712005, 20.153554502369676, 20.02022116903634, 22.020221169036347, 18.2868877441348, 22.020221169036347, 20.65355361211602, 20.02022116903634, 20.15355450078173, 20.852618410578586, 20.92022107759754], "episode_lengths": [7, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 5, 30, 30, 30, 30, 30, 30, 30, 30, 21, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 28, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6870097048266552, "mean_inference_ms": 1.2203676435256703, "mean_action_processing_ms": 0.10481762934349362, "mean_env_wait_ms": 29.59469933176618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007003068923950195, "StateBufferConnector_ms": 0.004823923110961914, "ViewRequirementAgentConnector_ms": 0.11568212509155273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.736534119398577, "num_env_steps_trained_throughput_per_sec": 29.736534119398577, "timesteps_total": 172000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 66578.076, "sample_time_ms": 63346.39, "load_time_ms": 13.868, "load_throughput": 144219.153, "learn_time_ms": 3215.108, "learn_throughput": 622.063, "synch_weights_time_ms": 2.26}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 6193, "training_iteration": 86, "trial_id": "13850_00001", "date": "2023-12-28_19-22-46", "timestamp": 1703762566, "time_this_iter_s": 67.26260280609131, "time_total_s": 5716.117443561554, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5716.117443561554, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 55.81666666666666, "ram_util_percent": 92.58541666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1241008124329707e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8129599922667775, "policy_loss": 0.0024497127532958985, "vf_loss": 0.8105102797990872, "vf_explained_var": 0.6809341171052721, "kl": 0.0026248841779056343, "entropy": 0.25628857910633085, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 38925.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 174000, "num_env_steps_trained": 174000, "num_agent_steps_sampled": 174000, "num_agent_steps_trained": 174000}, "sampler_results": {"episode_reward_max": 22.15355450236968, "episode_reward_min": 6.686887835671289, "episode_reward_mean": 20.689871383658716, "episode_len_mean": 29.46, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.020221169036347, 17.82022116903634, 22.153554502369676, 22.020221169036347, 20.953516221968652, 20.18688703667872, 22.020221169036347, 20.320221169036273, 20.58684773854828, 20.02022116903634, 20.153554502369673, 22.020221169036347, 20.02022116903634, 22.153554502366045, 20.086887835703003, 20.15355450236966, 21.5535538085562, 20.02022116903634, 20.55266071435378, 22.020221169036347, 22.020221169036347, 21.286880201712005, 20.153554502369676, 20.02022116903634, 22.020221169036347, 18.2868877441348, 22.020221169036347, 20.65355361211602, 20.02022116903634, 20.15355450078173, 20.852618410578586, 20.92022107759754, 20.88661997464598, 20.820221063770113, 22.020221169036347, 20.32022107147169, 6.686887835671289, 21.020221169036326, 13.697025007089408, 21.653554502369662, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.58688783411534, 20.153554502369673, 21.153549222085925, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.953554502369663, 20.151242298380893, 21.151242298380883, 20.786847738548353, 22.15355450236968, 20.153554502369673, 8.253554488485976, 20.153549222085925, 22.020221169036347, 21.886844286922276, 22.020221169036347, 20.42022116903634, 22.15355450236968, 21.31960990894047, 22.020221169036347, 20.02022116903634, 20.6202211690327, 20.786583346346927, 20.135996203329892, 22.020221169036347, 20.086579888625774, 22.020221169036347, 22.020221169036347, 20.553554502156377, 20.286887835702995, 22.020221169036347, 22.1359962033299, 20.45351291084473, 21.453554502369677, 22.020221169036347, 22.020221169036347, 20.38688773025165, 21.020221169036326, 22.020221169036347, 21.753554500541274, 22.020221169036347, 20.22022037001205, 20.319018411707336, 22.020221169036347, 20.386887128037806, 22.020221169036347, 20.02022116903634, 20.553554495381704, 20.28626434313451, 20.586887036678707, 20.02022116903634, 20.386887835698825, 22.15355450236967, 20.02022116903634, 20.15355450236967], "episode_lengths": [30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 28, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 19, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6868382624715033, "mean_inference_ms": 1.2204020056007052, "mean_action_processing_ms": 0.10482799062607842, "mean_env_wait_ms": 29.597495757805174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007023334503173828, "StateBufferConnector_ms": 0.0047490596771240234, "ViewRequirementAgentConnector_ms": 0.11620664596557617}}, "episode_reward_max": 22.15355450236968, "episode_reward_min": 6.686887835671289, "episode_reward_mean": 20.689871383658716, "episode_len_mean": 29.46, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.020221169036347, 17.82022116903634, 22.153554502369676, 22.020221169036347, 20.953516221968652, 20.18688703667872, 22.020221169036347, 20.320221169036273, 20.58684773854828, 20.02022116903634, 20.153554502369673, 22.020221169036347, 20.02022116903634, 22.153554502366045, 20.086887835703003, 20.15355450236966, 21.5535538085562, 20.02022116903634, 20.55266071435378, 22.020221169036347, 22.020221169036347, 21.286880201712005, 20.153554502369676, 20.02022116903634, 22.020221169036347, 18.2868877441348, 22.020221169036347, 20.65355361211602, 20.02022116903634, 20.15355450078173, 20.852618410578586, 20.92022107759754, 20.88661997464598, 20.820221063770113, 22.020221169036347, 20.32022107147169, 6.686887835671289, 21.020221169036326, 13.697025007089408, 21.653554502369662, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.58688783411534, 20.153554502369673, 21.153549222085925, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.953554502369663, 20.151242298380893, 21.151242298380883, 20.786847738548353, 22.15355450236968, 20.153554502369673, 8.253554488485976, 20.153549222085925, 22.020221169036347, 21.886844286922276, 22.020221169036347, 20.42022116903634, 22.15355450236968, 21.31960990894047, 22.020221169036347, 20.02022116903634, 20.6202211690327, 20.786583346346927, 20.135996203329892, 22.020221169036347, 20.086579888625774, 22.020221169036347, 22.020221169036347, 20.553554502156377, 20.286887835702995, 22.020221169036347, 22.1359962033299, 20.45351291084473, 21.453554502369677, 22.020221169036347, 22.020221169036347, 20.38688773025165, 21.020221169036326, 22.020221169036347, 21.753554500541274, 22.020221169036347, 20.22022037001205, 20.319018411707336, 22.020221169036347, 20.386887128037806, 22.020221169036347, 20.02022116903634, 20.553554495381704, 20.28626434313451, 20.586887036678707, 20.02022116903634, 20.386887835698825, 22.15355450236967, 20.02022116903634, 20.15355450236967], "episode_lengths": [30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 28, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 11, 30, 19, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6868382624715033, "mean_inference_ms": 1.2204020056007052, "mean_action_processing_ms": 0.10482799062607842, "mean_env_wait_ms": 29.597495757805174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007023334503173828, "StateBufferConnector_ms": 0.0047490596771240234, "ViewRequirementAgentConnector_ms": 0.11620664596557617}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174000, "num_agent_steps_trained": 174000, "num_env_steps_sampled": 174000, "num_env_steps_trained": 174000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.972553269538274, "num_env_steps_trained_throughput_per_sec": 29.972553269538274, "timesteps_total": 174000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 174000, "timers": {"training_iteration_time_ms": 66700.04, "sample_time_ms": 63469.757, "load_time_ms": 13.867, "load_throughput": 144224.856, "learn_time_ms": 3213.708, "learn_throughput": 622.334, "synch_weights_time_ms": 2.259}, "counters": {"num_env_steps_sampled": 174000, "num_env_steps_trained": 174000, "num_agent_steps_sampled": 174000, "num_agent_steps_trained": 174000}, "done": false, "episodes_total": 6261, "training_iteration": 87, "trial_id": "13850_00001", "date": "2023-12-28_19-23-53", "timestamp": 1703762633, "time_this_iter_s": 66.73251461982727, "time_total_s": 5782.849958181381, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5782.849958181381, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 55.82947368421053, "ram_util_percent": 92.681052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.620504062164854e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.660904376556476, "policy_loss": 0.003169483906692929, "vf_loss": 1.6577348878979683, "vf_explained_var": 0.25898047473695546, "kl": 0.002094501081427123, "entropy": 0.25425627676977053, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 39375.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": 22.15355450236967, "episode_reward_min": 1.8643544626778887, "episode_reward_mean": 20.504358455731463, "episode_len_mean": 29.28, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.020221169036347, 20.086579888625774, 22.020221169036347, 22.020221169036347, 20.553554502156377, 20.286887835702995, 22.020221169036347, 22.1359962033299, 20.45351291084473, 21.453554502369677, 22.020221169036347, 22.020221169036347, 20.38688773025165, 21.020221169036326, 22.020221169036347, 21.753554500541274, 22.020221169036347, 20.22022037001205, 20.319018411707336, 22.020221169036347, 20.386887128037806, 22.020221169036347, 20.02022116903634, 20.553554495381704, 20.28626434313451, 20.586887036678707, 20.02022116903634, 20.386887835698825, 22.15355450236967, 20.02022116903634, 20.15355450236967, 22.020221169036347, 21.020221169036326, 20.120177620259774, 20.15355450078173, 21.153554502369662, 20.02022116903634, 20.086579888625774, 21.151242298380883, 22.020221169036347, 20.953552645924994, 21.820221169000998, 20.28688783411507, 20.02022116903634, 21.020221169036326, 20.45355450236966, 22.1512422983809, 22.020221169036347, 20.55355450236919, 21.686887730436794, 21.020221169036326, 21.12022116903633, 21.020221169036326, 20.086887835703003, 22.020221169036347, 15.486887835703005, 20.486887835702994, 20.02022116903634, 21.020221169036326, 18.186887835703008, 22.020221169036347, 22.020221169036347, 20.753554500781455, 8.153549222085381, 22.020221169036347, 20.353554502337957, 20.920221169036342, 1.8643544626778887, 21.920177620259782, 21.352660819588294, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.6202211690358, 20.820221169036337, 22.020221169036347, 22.020221169036347, 21.186887835703, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.686887835671303, 20.02022116903634, 20.818711830840193, 20.02022116903634, 21.120221169036338, 11.820221169036333, 21.020221169036326, 20.153554502369673, 20.153554502342132, 21.01790894621389, 20.286887835703006, 20.38688782181986, 22.020221169036347, 20.386887835698825, 20.286887835703002, 20.386887835702996, 16.186887835703, 20.852628343161044, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 28, 30, 30, 30, 13, 30, 30, 30, 3, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6867537502142695, "mean_inference_ms": 1.220463883439804, "mean_action_processing_ms": 0.10483957544496178, "mean_env_wait_ms": 29.600316680307518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038116455078125, "StateBufferConnector_ms": 0.004812002182006836, "ViewRequirementAgentConnector_ms": 0.11678671836853027}}, "episode_reward_max": 22.15355450236967, "episode_reward_min": 1.8643544626778887, "episode_reward_mean": 20.504358455731463, "episode_len_mean": 29.28, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.020221169036347, 20.086579888625774, 22.020221169036347, 22.020221169036347, 20.553554502156377, 20.286887835702995, 22.020221169036347, 22.1359962033299, 20.45351291084473, 21.453554502369677, 22.020221169036347, 22.020221169036347, 20.38688773025165, 21.020221169036326, 22.020221169036347, 21.753554500541274, 22.020221169036347, 20.22022037001205, 20.319018411707336, 22.020221169036347, 20.386887128037806, 22.020221169036347, 20.02022116903634, 20.553554495381704, 20.28626434313451, 20.586887036678707, 20.02022116903634, 20.386887835698825, 22.15355450236967, 20.02022116903634, 20.15355450236967, 22.020221169036347, 21.020221169036326, 20.120177620259774, 20.15355450078173, 21.153554502369662, 20.02022116903634, 20.086579888625774, 21.151242298380883, 22.020221169036347, 20.953552645924994, 21.820221169000998, 20.28688783411507, 20.02022116903634, 21.020221169036326, 20.45355450236966, 22.1512422983809, 22.020221169036347, 20.55355450236919, 21.686887730436794, 21.020221169036326, 21.12022116903633, 21.020221169036326, 20.086887835703003, 22.020221169036347, 15.486887835703005, 20.486887835702994, 20.02022116903634, 21.020221169036326, 18.186887835703008, 22.020221169036347, 22.020221169036347, 20.753554500781455, 8.153549222085381, 22.020221169036347, 20.353554502337957, 20.920221169036342, 1.8643544626778887, 21.920177620259782, 21.352660819588294, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.6202211690358, 20.820221169036337, 22.020221169036347, 22.020221169036347, 21.186887835703, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.686887835671303, 20.02022116903634, 20.818711830840193, 20.02022116903634, 21.120221169036338, 11.820221169036333, 21.020221169036326, 20.153554502369673, 20.153554502342132, 21.01790894621389, 20.286887835703006, 20.38688782181986, 22.020221169036347, 20.386887835698825, 20.286887835703002, 20.386887835702996, 16.186887835703, 20.852628343161044, 20.02022116903634], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 22, 30, 30, 30, 28, 30, 30, 30, 13, 30, 30, 30, 3, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6867537502142695, "mean_inference_ms": 1.220463883439804, "mean_action_processing_ms": 0.10483957544496178, "mean_env_wait_ms": 29.600316680307518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007038116455078125, "StateBufferConnector_ms": 0.004812002182006836, "ViewRequirementAgentConnector_ms": 0.11678671836853027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.84053446457141, "num_env_steps_trained_throughput_per_sec": 29.84053446457141, "timesteps_total": 176000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 66705.648, "sample_time_ms": 63475.028, "load_time_ms": 15.492, "load_throughput": 129100.196, "learn_time_ms": 3212.439, "learn_throughput": 622.58, "synch_weights_time_ms": 2.238}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 6330, "training_iteration": 88, "trial_id": "13850_00001", "date": "2023-12-28_19-25-00", "timestamp": 1703762700, "time_this_iter_s": 67.02727389335632, "time_total_s": 5849.877232074738, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5849.877232074738, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 55.8621052631579, "ram_util_percent": 92.6768421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.810252031082427e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3570775607973338, "policy_loss": 0.005525600827402539, "vf_loss": 1.3515519588440656, "vf_explained_var": 0.3549434333377414, "kl": 0.001570588499225779, "entropy": 0.25629454288217757, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 39825.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 178000, "num_env_steps_trained": 178000, "num_agent_steps_sampled": 178000, "num_agent_steps_trained": 178000}, "sampler_results": {"episode_reward_max": 22.1535545023696, "episode_reward_min": 5.220221155149215, "episode_reward_mean": 20.535457042863786, "episode_len_mean": 29.18, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.352660819588294, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.6202211690358, 20.820221169036337, 22.020221169036347, 22.020221169036347, 21.186887835703, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.686887835671303, 20.02022116903634, 20.818711830840193, 20.02022116903634, 21.120221169036338, 11.820221169036333, 21.020221169036326, 20.153554502369673, 20.153554502342132, 21.01790894621389, 20.286887835703006, 20.38688782181986, 22.020221169036347, 20.386887835698825, 20.286887835703002, 20.386887835702996, 16.186887835703, 20.852628343161044, 20.02022116903634, 20.419946300539593, 20.753510953588915, 21.020221169036326, 20.952613825699256, 20.820221169036337, 21.38626434313451, 20.153554502369666, 21.020221169036326, 20.02022116903634, 20.286887833874246, 11.286887835703, 22.020221169036347, 20.720221169036336, 22.020221169036347, 22.1535545023696, 22.020221169036347, 21.353246555292372, 21.420221169036342, 20.453548513380234, 20.753554500755488, 20.153554502369673, 20.586887835702917, 22.020221169036347, 8.420221169035784, 21.020221169036326, 21.686887835671303, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.153554502366045, 22.020221169036347, 22.020221169036347, 21.886887821819872, 12.553554502369668, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.420221063770114, 21.153554502369666, 22.020221169036347, 22.020221169036347, 21.886887835703007, 21.91960990897261, 20.02022116903634, 22.020221169036347, 20.02022116903634, 20.286887835703006, 21.0202151800469, 5.220221155149215, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.92022116903633, 20.920221169036342, 20.05355450236967, 21.020221169036326, 20.953554502369663, 21.920177620259782, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.752931009801177, 22.152931009801186, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.15355441080147], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.68657970867623, "mean_inference_ms": 1.2203709144848849, "mean_action_processing_ms": 0.1048349541095098, "mean_env_wait_ms": 29.598951038902285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006899833679199219, "StateBufferConnector_ms": 0.004740238189697266, "ViewRequirementAgentConnector_ms": 0.11471962928771973}}, "episode_reward_max": 22.1535545023696, "episode_reward_min": 5.220221155149215, "episode_reward_mean": 20.535457042863786, "episode_len_mean": 29.18, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.352660819588294, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.6202211690358, 20.820221169036337, 22.020221169036347, 22.020221169036347, 21.186887835703, 22.020221169036347, 22.020221169036347, 20.02022116903634, 21.686887835671303, 20.02022116903634, 20.818711830840193, 20.02022116903634, 21.120221169036338, 11.820221169036333, 21.020221169036326, 20.153554502369673, 20.153554502342132, 21.01790894621389, 20.286887835703006, 20.38688782181986, 22.020221169036347, 20.386887835698825, 20.286887835703002, 20.386887835702996, 16.186887835703, 20.852628343161044, 20.02022116903634, 20.419946300539593, 20.753510953588915, 21.020221169036326, 20.952613825699256, 20.820221169036337, 21.38626434313451, 20.153554502369666, 21.020221169036326, 20.02022116903634, 20.286887833874246, 11.286887835703, 22.020221169036347, 20.720221169036336, 22.020221169036347, 22.1535545023696, 22.020221169036347, 21.353246555292372, 21.420221169036342, 20.453548513380234, 20.753554500755488, 20.153554502369673, 20.586887835702917, 22.020221169036347, 8.420221169035784, 21.020221169036326, 21.686887835671303, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.153554502366045, 22.020221169036347, 22.020221169036347, 21.886887821819872, 12.553554502369668, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.420221063770114, 21.153554502369666, 22.020221169036347, 22.020221169036347, 21.886887835703007, 21.91960990897261, 20.02022116903634, 22.020221169036347, 20.02022116903634, 20.286887835703006, 21.0202151800469, 5.220221155149215, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.92022116903633, 20.920221169036342, 20.05355450236967, 21.020221169036326, 20.953554502369663, 21.920177620259782, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.752931009801177, 22.152931009801186, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.15355441080147], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 13, 30, 30, 30, 30, 30, 30, 30, 30, 30, 18, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.68657970867623, "mean_inference_ms": 1.2203709144848849, "mean_action_processing_ms": 0.1048349541095098, "mean_env_wait_ms": 29.598951038902285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006899833679199219, "StateBufferConnector_ms": 0.004740238189697266, "ViewRequirementAgentConnector_ms": 0.11471962928771973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 178000, "num_agent_steps_trained": 178000, "num_env_steps_sampled": 178000, "num_env_steps_trained": 178000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 30.402206793789684, "num_env_steps_trained_throughput_per_sec": 30.402206793789684, "timesteps_total": 178000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 178000, "timers": {"training_iteration_time_ms": 66588.303, "sample_time_ms": 63360.199, "load_time_ms": 14.895, "load_throughput": 134271.222, "learn_time_ms": 3210.532, "learn_throughput": 622.95, "synch_weights_time_ms": 2.223}, "counters": {"num_env_steps_sampled": 178000, "num_env_steps_trained": 178000, "num_agent_steps_sampled": 178000, "num_agent_steps_trained": 178000}, "done": false, "episodes_total": 6399, "training_iteration": 89, "trial_id": "13850_00001", "date": "2023-12-28_19-26-06", "timestamp": 1703762766, "time_this_iter_s": 65.78938627243042, "time_total_s": 5915.666618347168, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5915.666618347168, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 55.86808510638297, "ram_util_percent": 92.5648936170213}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4051260155412134e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.750123072216908, "policy_loss": 0.0033337124685446423, "vf_loss": 1.7467893687221738, "vf_explained_var": 0.3816284322738647, "kl": 0.002728965051309449, "entropy": 0.3009392757217089, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 40275.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 22.286887835703006, "episode_reward_min": 5.220221155149215, "episode_reward_mean": 20.78764141538584, "episode_len_mean": 29.51, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.420221063770114, 21.153554502369666, 22.020221169036347, 22.020221169036347, 21.886887835703007, 21.91960990897261, 20.02022116903634, 22.020221169036347, 20.02022116903634, 20.286887835703006, 21.0202151800469, 5.220221155149215, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.92022116903633, 20.920221169036342, 20.05355450236967, 21.020221169036326, 20.953554502369663, 21.920177620259782, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.752931009801177, 22.152931009801186, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.15355441080147, 21.820221063770134, 22.020221169036347, 20.620220475226542, 20.586887835702992, 21.15355380702366, 20.68688783567128, 20.586887835703006, 20.55355450236967, 20.55355450236965, 22.020221169036347, 21.920177620259782, 20.753554500541252, 22.020221169036347, 21.020221169036326, 20.75355450236967, 22.020221169036347, 20.286887835702995, 20.353553701568686, 21.020221169036326, 22.020221169036347, 15.53307422476575, 22.286887835703006, 20.753553703345386, 20.420221169036335, 20.15355450236967, 20.153554502369673, 22.020221169036347, 22.153554502369676, 21.920177620259782, 20.520221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.85294324230554, 22.152931009801186, 22.28688783411507, 21.12022116903217, 20.02022116903634, 21.120221169004633, 21.186887835703, 21.153554502369662, 22.020221169036347, 22.020221169036347, 20.953246555292427, 21.153554502369666, 20.02022116903634, 20.953246555292427, 20.719952626492987, 20.986887835702937, 21.386887821819325, 21.020221169036326, 21.153554502369666, 20.186887835702997, 20.986887036678652, 22.020221169036347, 20.153554502369193, 20.420221169036328, 21.020221169036326, 22.020221169036347, 21.020221169036326, 6.020221168795512, 20.420221169035784, 21.153554488486535, 21.153554502369666, 20.22022116903633, 21.286844286926446, 21.153554502369666, 20.420221169036328], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6864318148651517, "mean_inference_ms": 1.2203695875468565, "mean_action_processing_ms": 0.10483706895879914, "mean_env_wait_ms": 29.60063186549865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007050037384033203, "StateBufferConnector_ms": 0.004724979400634766, "ViewRequirementAgentConnector_ms": 0.11572885513305664}}, "episode_reward_max": 22.286887835703006, "episode_reward_min": 5.220221155149215, "episode_reward_mean": 20.78764141538584, "episode_len_mean": 29.51, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.420221063770114, 21.153554502369666, 22.020221169036347, 22.020221169036347, 21.886887835703007, 21.91960990897261, 20.02022116903634, 22.020221169036347, 20.02022116903634, 20.286887835703006, 21.0202151800469, 5.220221155149215, 21.020221169036326, 20.02022116903634, 20.02022116903634, 20.92022116903633, 20.920221169036342, 20.05355450236967, 21.020221169036326, 20.953554502369663, 21.920177620259782, 20.02022116903634, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.020221169036326, 20.752931009801177, 22.152931009801186, 22.020221169036347, 22.020221169036347, 22.020221169036347, 21.15355441080147, 21.820221063770134, 22.020221169036347, 20.620220475226542, 20.586887835702992, 21.15355380702366, 20.68688783567128, 20.586887835703006, 20.55355450236967, 20.55355450236965, 22.020221169036347, 21.920177620259782, 20.753554500541252, 22.020221169036347, 21.020221169036326, 20.75355450236967, 22.020221169036347, 20.286887835702995, 20.353553701568686, 21.020221169036326, 22.020221169036347, 15.53307422476575, 22.286887835703006, 20.753553703345386, 20.420221169036335, 20.15355450236967, 20.153554502369673, 22.020221169036347, 22.153554502369676, 21.920177620259782, 20.520221169036326, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.85294324230554, 22.152931009801186, 22.28688783411507, 21.12022116903217, 20.02022116903634, 21.120221169004633, 21.186887835703, 21.153554502369662, 22.020221169036347, 22.020221169036347, 20.953246555292427, 21.153554502369666, 20.02022116903634, 20.953246555292427, 20.719952626492987, 20.986887835702937, 21.386887821819325, 21.020221169036326, 21.153554502369666, 20.186887835702997, 20.986887036678652, 22.020221169036347, 20.153554502369193, 20.420221169036328, 21.020221169036326, 22.020221169036347, 21.020221169036326, 6.020221168795512, 20.420221169035784, 21.153554488486535, 21.153554502369666, 20.22022116903633, 21.286844286926446, 21.153554502369666, 20.420221169036328], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 8, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 23, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6864318148651517, "mean_inference_ms": 1.2203695875468565, "mean_action_processing_ms": 0.10483706895879914, "mean_env_wait_ms": 29.60063186549865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007050037384033203, "StateBufferConnector_ms": 0.004724979400634766, "ViewRequirementAgentConnector_ms": 0.11572885513305664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.605224069486543, "num_env_steps_trained_throughput_per_sec": 29.605224069486543, "timesteps_total": 180000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 66627.604, "sample_time_ms": 63369.684, "load_time_ms": 14.234, "load_throughput": 140507.048, "learn_time_ms": 3241.061, "learn_throughput": 617.082, "synch_weights_time_ms": 2.173}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 6467, "training_iteration": 90, "trial_id": "13850_00001", "date": "2023-12-28_19-27-14", "timestamp": 1703762834, "time_this_iter_s": 67.56067538261414, "time_total_s": 5983.227293729782, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5983.227293729782, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 56.23333333333333, "ram_util_percent": 92.60312499999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.025630077706067e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4295524276461866, "policy_loss": 0.01044263717201021, "vf_loss": 2.419109799042344, "vf_explained_var": 0.1278286099433899, "kl": 0.002737113892302124, "entropy": 0.19924496248364448, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 40725.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 182000, "num_env_steps_trained": 182000, "num_agent_steps_sampled": 182000, "num_agent_steps_trained": 182000}, "sampler_results": {"episode_reward_max": 22.15355450236968, "episode_reward_min": 6.020221168795512, "episode_reward_mean": 20.30649636427566, "episode_len_mean": 28.74, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.120221169004633, 21.186887835703, 21.153554502369662, 22.020221169036347, 22.020221169036347, 20.953246555292427, 21.153554502369666, 20.02022116903634, 20.953246555292427, 20.719952626492987, 20.986887835702937, 21.386887821819325, 21.020221169036326, 21.153554502369666, 20.186887835702997, 20.986887036678652, 22.020221169036347, 20.153554502369193, 20.420221169036328, 21.020221169036326, 22.020221169036347, 21.020221169036326, 6.020221168795512, 20.420221169035784, 21.153554488486535, 21.153554502369666, 20.22022116903633, 21.286844286926446, 21.153554502369666, 20.420221169036328, 22.020221169036347, 22.020221169036347, 20.72022116879551, 22.020221169036347, 22.020221169036347, 20.853553703345373, 20.02022116903634, 20.02022116903634, 21.05355450236966, 6.786583347694108, 20.25355450236966, 21.420221169036342, 22.020221169036347, 20.02022116903634, 22.15355450236967, 21.753554500541274, 22.020221169036347, 21.052660819619984, 22.15355450236968, 21.12022116903633, 20.38688783570299, 20.153554502369676, 22.020221169036347, 21.020221169036326, 20.252356701022727, 22.020221169036347, 22.020221169036347, 21.753554500541274, 22.020221169036347, 9.620221169036261, 20.02022116903634, 21.020221169036326, 20.420221169036328, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 6.686887835462177, 21.78688782181987, 11.086887835703, 21.353554502369672, 21.652931009801176, 20.420221169036328, 20.153554502369193, 21.78688782181987, 21.65355450236551, 22.020221169036347, 22.020221169036347, 22.052623061641278, 21.386579888625782, 21.020221169036326, 21.853553703345394, 21.820221063770134, 21.55355450236967, 17.65293100980117, 21.486887835703012, 12.686887835702999, 14.620220370012046, 21.820221063770134, 22.020221169036347, 10.720221169036336, 22.020221169036347, 21.55355450236967, 20.953554502369666, 21.720221168795536, 22.020221169036347, 21.353554502369672, 21.25355450236967, 20.620221156977973], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 26, 30, 19, 22, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6863892242608297, "mean_inference_ms": 1.220484494107948, "mean_action_processing_ms": 0.1048491307690509, "mean_env_wait_ms": 29.603801503467995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007039785385131836, "StateBufferConnector_ms": 0.004687070846557617, "ViewRequirementAgentConnector_ms": 0.11587691307067871}}, "episode_reward_max": 22.15355450236968, "episode_reward_min": 6.020221168795512, "episode_reward_mean": 20.30649636427566, "episode_len_mean": 28.74, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.120221169004633, 21.186887835703, 21.153554502369662, 22.020221169036347, 22.020221169036347, 20.953246555292427, 21.153554502369666, 20.02022116903634, 20.953246555292427, 20.719952626492987, 20.986887835702937, 21.386887821819325, 21.020221169036326, 21.153554502369666, 20.186887835702997, 20.986887036678652, 22.020221169036347, 20.153554502369193, 20.420221169036328, 21.020221169036326, 22.020221169036347, 21.020221169036326, 6.020221168795512, 20.420221169035784, 21.153554488486535, 21.153554502369666, 20.22022116903633, 21.286844286926446, 21.153554502369666, 20.420221169036328, 22.020221169036347, 22.020221169036347, 20.72022116879551, 22.020221169036347, 22.020221169036347, 20.853553703345373, 20.02022116903634, 20.02022116903634, 21.05355450236966, 6.786583347694108, 20.25355450236966, 21.420221169036342, 22.020221169036347, 20.02022116903634, 22.15355450236967, 21.753554500541274, 22.020221169036347, 21.052660819619984, 22.15355450236968, 21.12022116903633, 20.38688783570299, 20.153554502369676, 22.020221169036347, 21.020221169036326, 20.252356701022727, 22.020221169036347, 22.020221169036347, 21.753554500541274, 22.020221169036347, 9.620221169036261, 20.02022116903634, 21.020221169036326, 20.420221169036328, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 6.686887835462177, 21.78688782181987, 11.086887835703, 21.353554502369672, 21.652931009801176, 20.420221169036328, 20.153554502369193, 21.78688782181987, 21.65355450236551, 22.020221169036347, 22.020221169036347, 22.052623061641278, 21.386579888625782, 21.020221169036326, 21.853553703345394, 21.820221063770134, 21.55355450236967, 17.65293100980117, 21.486887835703012, 12.686887835702999, 14.620220370012046, 21.820221063770134, 22.020221169036347, 10.720221169036336, 22.020221169036347, 21.55355450236967, 20.953554502369666, 21.720221168795536, 22.020221169036347, 21.353554502369672, 21.25355450236967, 20.620221156977973], "episode_lengths": [30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 14, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 26, 30, 19, 22, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6863892242608297, "mean_inference_ms": 1.220484494107948, "mean_action_processing_ms": 0.1048491307690509, "mean_env_wait_ms": 29.603801503467995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007039785385131836, "StateBufferConnector_ms": 0.004687070846557617, "ViewRequirementAgentConnector_ms": 0.11587691307067871}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182000, "num_agent_steps_trained": 182000, "num_env_steps_sampled": 182000, "num_env_steps_trained": 182000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.868738509598654, "num_env_steps_trained_throughput_per_sec": 29.868738509598654, "timesteps_total": 182000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 182000, "timers": {"training_iteration_time_ms": 66715.073, "sample_time_ms": 63494.69, "load_time_ms": 13.629, "load_throughput": 146749.681, "learn_time_ms": 3204.137, "learn_throughput": 624.193, "synch_weights_time_ms": 2.163}, "counters": {"num_env_steps_sampled": 182000, "num_env_steps_trained": 182000, "num_agent_steps_sampled": 182000, "num_agent_steps_trained": 182000}, "done": false, "episodes_total": 6537, "training_iteration": 91, "trial_id": "13850_00001", "date": "2023-12-28_19-28-20", "timestamp": 1703762900, "time_this_iter_s": 66.9643669128418, "time_total_s": 6050.191660642624, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6050.191660642624, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 55.75833333333333, "ram_util_percent": 92.61562500000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.5128150388530334e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.48259788736701, "policy_loss": 0.0052727819482485455, "vf_loss": 1.4773250981337493, "vf_explained_var": 0.38930651280615064, "kl": 0.0022104215080038436, "entropy": 0.17475906491279602, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 41175.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": 22.153554502369676, "episode_reward_min": 6.053554502128845, "episode_reward_mean": 20.373495641762652, "episode_len_mean": 28.79, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.686887835462177, 21.78688782181987, 11.086887835703, 21.353554502369672, 21.652931009801176, 20.420221169036328, 20.153554502369193, 21.78688782181987, 21.65355450236551, 22.020221169036347, 22.020221169036347, 22.052623061641278, 21.386579888625782, 21.020221169036326, 21.853553703345394, 21.820221063770134, 21.55355450236967, 17.65293100980117, 21.486887835703012, 12.686887835702999, 14.620220370012046, 21.820221063770134, 22.020221169036347, 10.720221169036336, 22.020221169036347, 21.55355450236967, 20.953554502369666, 21.720221168795536, 22.020221169036347, 21.353554502369672, 21.25355450236967, 20.620221156977973, 22.020221169036347, 20.92017762025976, 20.02022116903634, 22.020221169036347, 13.320221169036332, 20.420221169036328, 9.9529310098011, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.153554502369676, 22.020221169036347, 21.95324655529245, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.62022116903215, 22.152931009801186, 20.85355450212885, 22.020221169036347, 22.020221169036347, 20.620221169035773, 21.420221169036342, 20.65355450236967, 21.15355450236966, 21.020221169036326, 21.55355450236967, 21.020221169036326, 21.020221169036326, 20.620221169035773, 20.720221169036325, 21.220215180046903, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 6.053554502128845, 22.020221169036347, 21.153554502160556, 20.52021596696118, 20.02022116903634, 22.153554502369676, 20.186887835702997, 22.020221169036347, 20.820221063770113, 21.65355450236551, 22.020221169036347, 22.15355380702367, 22.020221169036347, 18.72022116903634, 20.02022116903634, 20.286887835702995, 22.020221169036347, 22.020221169036347, 21.25355450236967, 21.220221169036336, 17.186887835703008, 22.020221169036347, 20.520221169036326, 20.652660819619427, 22.020221169036347, 21.985994152953335, 21.020221169036326, 21.020221169036326, 22.020221169036347], "episode_lengths": [10, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 26, 30, 19, 22, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6862881924682382, "mean_inference_ms": 1.2205657932912573, "mean_action_processing_ms": 0.10485975063001587, "mean_env_wait_ms": 29.605295631985623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070722103118896484, "StateBufferConnector_ms": 0.004711151123046875, "ViewRequirementAgentConnector_ms": 0.11548399925231934}}, "episode_reward_max": 22.153554502369676, "episode_reward_min": 6.053554502128845, "episode_reward_mean": 20.373495641762652, "episode_len_mean": 28.79, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.686887835462177, 21.78688782181987, 11.086887835703, 21.353554502369672, 21.652931009801176, 20.420221169036328, 20.153554502369193, 21.78688782181987, 21.65355450236551, 22.020221169036347, 22.020221169036347, 22.052623061641278, 21.386579888625782, 21.020221169036326, 21.853553703345394, 21.820221063770134, 21.55355450236967, 17.65293100980117, 21.486887835703012, 12.686887835702999, 14.620220370012046, 21.820221063770134, 22.020221169036347, 10.720221169036336, 22.020221169036347, 21.55355450236967, 20.953554502369666, 21.720221168795536, 22.020221169036347, 21.353554502369672, 21.25355450236967, 20.620221156977973, 22.020221169036347, 20.92017762025976, 20.02022116903634, 22.020221169036347, 13.320221169036332, 20.420221169036328, 9.9529310098011, 21.020221169036326, 22.020221169036347, 22.020221169036347, 20.02022116903634, 20.02022116903634, 20.153554502369676, 22.020221169036347, 21.95324655529245, 22.020221169036347, 20.02022116903634, 21.020221169036326, 20.62022116903215, 22.152931009801186, 20.85355450212885, 22.020221169036347, 22.020221169036347, 20.620221169035773, 21.420221169036342, 20.65355450236967, 21.15355450236966, 21.020221169036326, 21.55355450236967, 21.020221169036326, 21.020221169036326, 20.620221169035773, 20.720221169036325, 21.220215180046903, 22.020221169036347, 22.020221169036347, 22.020221169036347, 22.020221169036347, 20.02022116903634, 6.053554502128845, 22.020221169036347, 21.153554502160556, 20.52021596696118, 20.02022116903634, 22.153554502369676, 20.186887835702997, 22.020221169036347, 20.820221063770113, 21.65355450236551, 22.020221169036347, 22.15355380702367, 22.020221169036347, 18.72022116903634, 20.02022116903634, 20.286887835702995, 22.020221169036347, 22.020221169036347, 21.25355450236967, 21.220221169036336, 17.186887835703008, 22.020221169036347, 20.520221169036326, 20.652660819619427, 22.020221169036347, 21.985994152953335, 21.020221169036326, 21.020221169036326, 22.020221169036347], "episode_lengths": [10, 30, 16, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 26, 30, 19, 22, 30, 30, 17, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 20, 30, 15, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 25, 30, 30, 30, 30, 30, 30, 30, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6862881924682382, "mean_inference_ms": 1.2205657932912573, "mean_action_processing_ms": 0.10485975063001587, "mean_env_wait_ms": 29.605295631985623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070722103118896484, "StateBufferConnector_ms": 0.004711151123046875, "ViewRequirementAgentConnector_ms": 0.11548399925231934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 29.23239605155128, "num_env_steps_trained_throughput_per_sec": 29.23239605155128, "timesteps_total": 184000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 66902.616, "sample_time_ms": 63507.144, "load_time_ms": 14.199, "load_throughput": 140859.064, "learn_time_ms": 3378.613, "learn_throughput": 591.959, "synch_weights_time_ms": 2.209}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 6605, "training_iteration": 92, "trial_id": "13850_00001", "date": "2023-12-28_19-29-29", "timestamp": 1703762969, "time_this_iter_s": 68.42745876312256, "time_total_s": 6118.6191194057465, "pid": 390996, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-fast-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6118.6191194057465, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 57.87216494845361, "ram_util_percent": 92.63608247422681}}
