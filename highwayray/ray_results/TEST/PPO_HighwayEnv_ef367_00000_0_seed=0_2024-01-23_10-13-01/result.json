{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 5.000000000000001e-05, "total_loss": 5.430875803568425, "policy_loss": -0.039715050940967014, "vf_loss": 5.464936678837507, "vf_explained_var": 0.06771673730805389, "kl": 0.02827085117980826, "entropy": 2.787214755298745, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1170.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 10000}, "sampler_results": {"episode_reward_max": 58.10766463148413, "episode_reward_min": 0.7634336301162048, "episode_reward_mean": 9.805139625937766, "episode_len_mean": 12.78255033557047, "episode_media": {}, "episodes_this_iter": 745, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.043792351033929, 1.8055475989721468, 18.284232503256995, 2.702844252098222, 8.271556269112935, 11.300096590841664, 10.121607831910177, 30.02954986285157, 8.737769377935754, 21.643147021317194, 4.0816130776330715, 22.248109921997877, 1.6133489972484751, 7.217065480445908, 8.35230721930576, 2.3619323779667325, 12.033924171817818, 3.9242852016696324, 1.5191290285222423, 19.914406891973375, 9.794166801710666, 1.5364724901738955, 21.380145954274855, 0.7877784874254673, 8.056948647304191, 9.604522311917345, 2.9388069856569743, 5.285914176621217, 6.243081442746346, 11.049891524438232, 5.469286015937016, 12.929705294088466, 0.9121455950796005, 7.869872251041471, 3.562343995465875, 15.377263960744436, 10.519555915228095, 7.410753105539039, 0.8769660113530404, 5.541710188520337, 1.742708641005796, 10.013867170791084, 7.663716373486039, 11.42171003031753, 4.151215403791157, 3.9432691519191683, 7.06810063915922, 19.741891130268673, 7.520683140450263, 17.175638503109113, 4.012341406287774, 18.96121818864745, 1.5136285902923095, 24.582785352599267, 3.308630043438247, 13.228966795608052, 7.320426778206525, 1.5265699364505079, 13.69432238302682, 7.367792230584019, 19.798696571117404, 7.5507117439759535, 12.097448554591123, 10.985697004913893, 3.0882151451071747, 11.308401725627544, 58.10766463148413, 18.73102819845345, 6.921557252461687, 17.589591009305316, 31.05096053077466, 6.883668148568697, 3.2424268364956346, 1.5954289350804591, 1.8173803612628197, 1.7339753606877641, 5.378087159386992, 12.792503460439224, 20.069815587871815, 4.178504267712712, 33.958438526387006, 0.7678562555892715, 24.85732745461604, 4.23295805451737, 1.859879780437483, 19.667435594970716, 4.229503038974772, 9.528166095356577, 5.725827959848707, 3.6088126492764343, 5.841839001017195, 2.7128714188277296, 12.856553140187028, 1.5156686238418142, 2.7148650364795275, 17.569306557309364, 2.7649661530189347, 7.03657276932941, 23.1484427783443, 14.342020097754736, 4.209289557736543, 10.594378920680427, 9.544325201750999, 3.317573591649676, 14.38270890859459, 7.2628001845321535, 8.13532822004234, 5.421261014225161, 13.440293735998042, 17.92610976258398, 11.173061413448263, 10.76277327015823, 12.637233481070488, 0.7655687020732764, 8.164833523630561, 11.644822327972223, 3.2413992139589545, 8.84504390333456, 26.033199943847237, 34.85133933929186, 15.186553281884683, 11.881706722405744, 8.129188241640142, 14.544391879579376, 18.90535262427446, 3.0899175599910995, 9.464394005481775, 12.069123782884226, 4.22645208410732, 7.897241378516416, 12.90666351427453, 2.664901692936457, 10.278648163557547, 10.279305378460121, 4.173551721683736, 8.825771155803283, 5.399147511190966, 5.628844961815531, 8.91215922542037, 13.794591277928554, 0.8812579059326731, 9.674731184582622, 5.062231168705832, 4.952279215496682, 14.866587750271442, 0.7734472701484263, 11.858945803938646, 5.9824922680082295, 7.813356876030498, 5.663834879113535, 8.050014342698868, 3.3104606552944573, 7.190879395980935, 7.29458020644342, 4.855121773114968, 24.627807097026288, 0.8879708753746006, 12.314336279004777, 2.4305965781864503, 22.190859217064315, 4.656222615881011, 8.017833752945911, 34.31064528145694, 6.806290477802499, 7.217280479359841, 9.478869719209554, 30.780174535683184, 10.46078284252342, 13.803686340459317, 7.046099723175596, 4.675565900152893, 11.104349312803317, 10.977058603478316, 17.80641173243236, 8.187424410708262, 8.042104101638923, 8.688412351345145, 8.65302902884193, 2.3418863415963114, 21.734645086941963, 0.7634336301162048, 8.262702350007622, 5.394354486572199, 8.703638755312964, 2.6985984167138435, 5.59110084749141, 16.940982603258018, 7.46681246529592, 3.201646702194823, 13.270699584728039, 4.618031605689376, 2.3998720144577703, 4.151881514149166, 4.510651028361442, 13.23363320193192, 10.342938529554315, 3.1655888622360613, 17.06688733955605, 3.126843644815452, 5.099431968871088, 27.215717982168226, 1.6062096662383558, 10.839670075903905, 1.5602549316039918, 4.006016990922696, 5.336191656276951, 7.645982316973227, 10.127548851750586, 4.542809731686045, 11.85014458381922, 1.798948602536435, 22.606706184835254, 12.279399275940605, 2.386477901728188, 11.91152616248389, 18.582519321789658, 7.345283417608911, 0.7938463191797659, 20.805881740639663, 12.825962979576522, 0.8863609732137587, 15.355974917777802, 5.215285481968056, 5.62281710783013, 4.635615917000435, 2.687768852087359, 3.333134826188835, 7.392627881574732, 8.599448322322067, 5.479474152991669, 2.340525609817118, 1.7427772464769378, 19.882902544731934, 4.608682385881363, 12.726181738935544, 3.6261064934479412, 24.649517317124385, 10.300294842297411, 6.418161401401615, 10.534790512131812, 14.321391691713288, 11.184982977523449, 3.1356130192899636, 6.482497068428695, 8.624031574683142, 3.6740699537620793, 1.7455073551693314, 14.403501960268613, 4.65948304510834, 8.31682173574092, 3.0078471986840363, 13.039075563553478, 10.556670522287853, 3.201247689854812, 6.349663886063977, 9.834705383723552, 11.355027561712655, 4.075770610424538, 16.01147846966557, 3.686782611510038, 3.2761457596262007, 3.8982275061122804, 27.476353863720817, 15.53400985264701, 11.714131336422358, 6.21600284600975, 3.7930632597458342, 5.459892122661158, 10.357720782705345, 1.5681575162039643, 2.3916722012094755, 17.52525198752163, 14.37138295749399, 13.130980119064406, 19.50021148552068, 3.311976897430764, 10.074781291898208, 5.334934383069462, 7.998337614022417, 1.5548148222484415, 4.059786280946623, 49.442773391660644, 7.04069492870905, 4.564878291069936, 8.105022735241237, 4.51760050500423, 1.7603387145713523, 8.729291562421873, 5.535242776280936, 3.0438237204567944, 3.0814108543355427, 2.93739294151868, 3.6721795527851744, 20.370967558352692, 11.168040702623525, 4.7708078043002065, 1.5594643281034046, 13.446204666770955, 14.544562899233549, 13.010765577849886, 15.969979258403981, 1.7531110479124579, 7.020312597054009, 14.347842237698712, 5.631366924496512, 10.84662450078031, 3.637232580027608, 16.136453858229764, 29.855410790557038, 2.735838672663098, 9.5437359346904, 10.299371586101604, 5.481200835164194, 6.302483605856465, 12.311490501715392, 3.9825260184585995, 4.543648310996368, 15.804839206967841, 5.622692889375464, 1.8081139169034512, 25.645982976380377, 7.379847788849479, 30.240361247841957, 9.553345544181925, 11.131060988509782, 21.82672355150558, 15.662900598333966, 12.416265130113972, 17.525643323161567, 24.376627508680244, 18.736655432121413, 0.8824655238154341, 9.877465864156422, 15.39373722794964, 12.287676770109673, 10.370328867246345, 8.717420546952141, 3.6575325096529854, 3.2380302970445407, 23.976084660242645, 4.5846049813089405, 10.963911454821549, 2.943247241630343, 8.553879752812005, 16.419114947252087, 22.905169904048993, 7.8205463910800725, 8.967707525653008, 21.35802856032226, 4.759333740929364, 14.255052779531011, 2.366170036237917, 20.048797845774693, 2.938214410917564, 2.6823639835049193, 10.44549364207684, 0.7714167433518191, 35.60917897855135, 11.228210868004034, 2.7266627080568697, 14.79227324624686, 9.465554496209942, 30.398532433543657, 9.78521791312841, 16.36702208667552, 3.662523167611544, 14.52912561835947, 27.170444486581093, 32.61480019908793, 7.1766901625246025, 2.3649677022475966, 34.241249577965114, 20.308964573874224, 2.6635053088933187, 19.536661559224843, 4.513757400609664, 12.08528958964106, 6.400685975546796, 3.645788284718588, 9.712396460642012, 5.366191936354695, 12.876973188979042, 9.626921003208341, 3.3382460075440914, 8.773180498387768, 0.8829449627564464, 9.060258573125605, 4.033112025680193, 9.149229268927984, 1.800591616795798, 12.708462986223473, 16.219559194743034, 8.652058378143824, 15.919462886479616, 34.236782475123974, 15.686027078150486, 2.7096541078536585, 16.3840969536128, 9.27129265222641, 2.696780801933309, 7.900511708593261, 8.12697781329413, 10.38477080725366, 9.138494139811852, 13.835501981915817, 8.762999503483849, 18.02326511223691, 4.67728278101902, 12.813712260076722, 12.109612949087616, 4.809517025773635, 3.3391762091058665, 7.987143814688699, 8.105058440263555, 11.386188666940399, 23.56735622900214, 15.056757655792977, 13.530817319880907, 1.8151544367077097, 10.258162096176488, 1.8087125431202669, 16.308256380964547, 0.7674503393045765, 9.443222484190283, 20.778478643974427, 1.7830280807885535, 11.358253885220789, 3.7983714046654917, 9.136286676653036, 21.98045295706404, 0.7715554764178877, 1.782180560330752, 14.89238113454025, 4.231731679503912, 13.134315019342282, 6.0414984789355195, 2.390039800623728, 24.001421237411837, 7.788569592464602, 16.264218540766, 6.403825385916521, 2.3902819433019307, 8.210250626374087, 2.387915567509207, 1.7900230163276447, 6.024786044860558, 4.7735755843319145, 1.8411332738042336, 15.132718084929028, 6.042932845377208, 8.57348571491167, 3.3445827162986985, 36.103355120991495, 5.183384138392694, 11.191143626652185, 4.728414850397865, 2.3449925956024495, 8.9091705514191, 1.792095149151168, 8.638484777509333, 3.3168974867065724, 11.302893458524402, 13.28896378856906, 2.445737556822519, 3.779128550870491, 55.402114709570554, 6.427126302178084, 8.777481178075202, 5.665220319462067, 11.168973793266394, 3.9955424384500935, 8.515311613635241, 11.387692369355708, 1.8210405670798093, 5.668184567326808, 10.189739643562183, 7.144550080844262, 4.572400926532178, 16.801137707950655, 3.217290031472469, 9.11648829553758, 10.691123836761257, 7.934788079491583, 6.268259290710065, 0.8879708753746006, 18.79486849536466, 5.958593028016166, 4.597294337643429, 8.184709059068458, 22.88701943034972, 20.603332147357417, 5.510955619145799, 6.639691056291207, 5.995432734464301, 1.5795248926828536, 3.2040477286730815, 32.58237302133149, 9.891138742204658, 8.7080053271342, 3.3041743708569458, 25.44171600975518, 2.9415608698290923, 4.6025251708742525, 12.755503954929509, 18.62353139558741, 3.3059744639994526, 3.081952148634723, 12.23767791603922, 3.59343574618444, 2.417160281498068, 15.23085262447105, 22.087477543689765, 1.7811532330942739, 9.898884643784896, 38.50409324905015, 22.15632179245495, 4.222251687955699, 3.6172116758907236, 15.215315431605848, 9.089560239900521, 10.477664796142163, 7.970795352555546, 14.731458078137567, 8.148617827562065, 7.789316932593781, 10.241310978273166, 10.083167751862208, 2.9384675117822336, 20.09527014794046, 11.498571920776783, 8.865551713378125, 1.5847087994408868, 2.7116992926601533, 7.123250560539139, 10.020232756558135, 5.42773211705133, 8.269334271428486, 7.653328699186117, 2.944996112342779, 12.392190408245664, 30.263235526233533, 5.419817579604861, 7.935896714219017, 3.978972775422637, 8.676931977420743, 7.772163143330407, 5.434733371961964, 5.638603145870552, 7.9208695667311115, 26.521016336760674, 8.133121170768455, 5.0190449397370855, 12.360317547431892, 8.715174052998925, 15.537939616036699, 1.8344921518576176, 5.088456294700627, 3.0614156427930257, 6.488908679976775, 4.022268280712166, 4.437200587783223, 14.831764154125777, 11.34524905843115, 7.075275409480106, 8.034235134448808, 7.854259464985926, 9.443227288812038, 3.676836690938665, 3.6685265280785933, 9.132958601635957, 16.18430011524019, 5.907829557950537, 9.547512048542849, 19.84210159811089, 3.992241775058311, 33.071614976717335, 7.74753783271866, 45.51459917938074, 13.205336799592162, 7.332543640563732, 9.383168433623927, 14.38455187181802, 5.339522816913477, 16.69610903604747, 13.701959681150356, 4.66696430636947, 2.419179141676339, 6.505751295046147, 5.224717601098948, 6.496496673504377, 8.700500824659322, 15.582937525559778, 4.422148114740522, 7.786310855571266, 5.698837899840424, 0.8879708753746006, 30.85388096825871, 4.665119037216243, 7.829619257262771, 3.3307325336988964, 6.991484597838129, 2.364960219664079, 5.985416873742253, 4.515146417676216, 2.677193836246257, 7.819411095313464, 3.980498853700925, 17.847936547735777, 9.48180019189411, 8.516508425000952, 10.61633949363766, 9.760940247077901, 14.304377580865435, 2.3632261596668838, 13.736976791713623, 6.153269046342792, 8.892590316555461, 4.02916810646404, 4.2948290375336216, 5.4584786486147445, 5.371806489259896, 20.095455764477972, 1.8028575420533115, 6.338185684710593, 7.8143226866819715, 4.55532985338966, 4.477831150114908, 13.317932536979226, 4.760720040747174, 0.8824289039198221, 10.861851723659955, 6.179011618863798, 31.015751981936685, 16.25466655504056, 1.787300985287945, 4.594621553745638, 5.109758571504629, 10.326837557285474, 7.333861044775521, 5.441476740894198, 29.950194477022485, 11.177871748365513, 4.566184356023568, 26.93951029441671, 9.165464955743499, 3.232552296090668, 5.53251583167354, 21.21462999327688, 9.517210623773185, 6.875302881506828, 12.975485569138181, 0.877494811928693, 3.645403508790652, 6.229421758930864, 5.457344134247274, 9.55744976893014, 16.489198114376887, 3.2028610150364765, 5.516557591110207, 14.677497388241292, 8.684158828486195, 10.134307820896046, 7.812375683513056, 12.904217846791898, 9.484447700530886, 0.778549950798932, 30.990393701414682, 1.5180453160459852, 10.66008182603345, 9.564381311479112, 19.982923848543148, 8.474488127331837, 3.5041267561257152, 5.0348645277810835, 24.753242903890087, 11.11593627226026, 5.456117455911093, 29.568012675206717, 18.406554937143248, 12.78789163005578, 13.763118406706665, 4.700038881054172, 13.62252991235154, 16.866132206287062, 0.7716719110405267, 10.332590674484026, 16.647334049656283, 4.788833692719889, 18.412205821148923, 29.10501564158219, 10.257470148719054, 12.669277367326439, 3.6994214128818372, 5.473516168468704, 3.7914179387396727, 15.549951593325043, 10.33926137034417, 0.7638331667017249, 6.810662797505359, 1.5858113831375824, 14.65292279454149, 1.6143394636182178, 2.7421893555446095, 5.316861553241834, 11.631150806792839, 32.850242883251, 8.855216037164412, 16.9604036738891, 2.9443634244704637, 14.853776098634196, 8.231736145870022, 7.28883676641535, 5.2252584306045, 11.406182435438938, 6.199081986485712, 18.300038988294055, 15.926423793849024, 25.455335220211712, 6.37169683166122, 5.401263893717167, 6.090662724355681, 2.764665296047302, 19.632790682922746, 4.727738007624455, 16.750196076071184, 5.641776142714671, 4.695149388791136, 13.604422553755253, 5.463013210891235, 4.583742925782739, 5.3913318183587595, 0.7768597642634895, 8.869901853919721, 24.10541263394558, 2.95704117355801, 13.334927899793588, 18.04006756750283, 9.69917830701391, 4.617481030059265, 4.216301600248587, 15.152487963951565, 11.03403357857135, 2.3968559071359046, 7.288885467423619, 1.5578358365800318], "episode_lengths": [11, 3, 22, 4, 11, 14, 14, 39, 12, 27, 6, 27, 3, 10, 10, 4, 15, 6, 3, 25, 12, 3, 26, 2, 11, 12, 5, 7, 8, 15, 8, 17, 2, 11, 5, 18, 13, 9, 2, 7, 3, 12, 10, 15, 6, 6, 10, 24, 9, 22, 6, 24, 3, 32, 5, 17, 10, 3, 18, 9, 25, 11, 16, 14, 5, 15, 69, 23, 9, 22, 39, 10, 5, 3, 3, 3, 7, 16, 25, 6, 41, 2, 31, 6, 3, 24, 6, 13, 7, 5, 8, 4, 17, 3, 4, 23, 4, 9, 28, 19, 6, 13, 13, 5, 19, 10, 11, 7, 18, 24, 13, 14, 17, 2, 11, 14, 5, 12, 32, 44, 19, 15, 11, 19, 24, 4, 12, 16, 6, 10, 15, 4, 14, 14, 6, 11, 7, 8, 12, 18, 2, 12, 7, 6, 19, 2, 14, 8, 11, 7, 10, 5, 10, 9, 7, 31, 2, 16, 4, 25, 7, 10, 44, 8, 10, 13, 38, 14, 16, 9, 7, 15, 14, 23, 11, 10, 11, 11, 4, 27, 2, 10, 8, 11, 4, 8, 22, 9, 5, 17, 6, 4, 6, 7, 17, 13, 5, 22, 5, 7, 34, 3, 14, 3, 5, 8, 11, 13, 7, 14, 3, 28, 16, 4, 15, 24, 9, 2, 25, 16, 2, 18, 8, 8, 7, 4, 5, 10, 12, 8, 4, 3, 25, 7, 16, 5, 31, 14, 9, 13, 17, 13, 5, 9, 12, 5, 3, 19, 7, 10, 5, 17, 14, 5, 9, 13, 14, 6, 21, 6, 5, 6, 33, 20, 14, 9, 5, 8, 14, 3, 4, 22, 19, 17, 25, 5, 14, 8, 11, 3, 6, 63, 10, 6, 11, 7, 3, 12, 8, 5, 5, 5, 6, 25, 14, 7, 3, 16, 19, 16, 20, 3, 10, 19, 7, 14, 5, 20, 37, 4, 13, 14, 7, 9, 16, 5, 7, 20, 8, 3, 34, 10, 35, 13, 15, 28, 19, 15, 22, 30, 23, 2, 12, 20, 16, 13, 12, 6, 5, 29, 6, 13, 5, 12, 21, 28, 11, 11, 26, 7, 17, 4, 26, 5, 4, 14, 2, 44, 15, 4, 19, 13, 39, 12, 20, 5, 19, 33, 40, 9, 4, 44, 24, 4, 25, 7, 16, 8, 5, 12, 7, 17, 13, 5, 12, 2, 11, 6, 12, 3, 17, 21, 11, 21, 43, 21, 4, 21, 12, 4, 11, 10, 13, 11, 18, 12, 23, 7, 16, 16, 7, 5, 11, 10, 15, 29, 19, 16, 3, 13, 3, 20, 2, 13, 26, 3, 15, 6, 11, 27, 2, 3, 17, 6, 17, 8, 4, 29, 10, 21, 8, 4, 10, 4, 3, 8, 7, 3, 20, 8, 12, 5, 44, 7, 14, 7, 4, 12, 3, 11, 5, 14, 16, 4, 6, 65, 9, 12, 8, 15, 6, 12, 15, 3, 8, 14, 10, 7, 21, 5, 12, 13, 10, 9, 2, 22, 8, 6, 11, 28, 26, 7, 8, 8, 3, 5, 41, 13, 11, 5, 31, 5, 6, 17, 22, 5, 4, 16, 5, 4, 20, 28, 3, 13, 48, 27, 6, 5, 18, 12, 14, 10, 19, 11, 10, 13, 13, 5, 26, 14, 11, 3, 4, 10, 14, 8, 11, 10, 5, 15, 37, 7, 11, 5, 12, 10, 7, 8, 11, 32, 11, 7, 15, 11, 19, 3, 7, 5, 9, 6, 7, 20, 15, 10, 10, 10, 13, 5, 5, 12, 20, 8, 13, 26, 6, 43, 9, 56, 16, 9, 13, 18, 8, 21, 18, 6, 4, 9, 8, 9, 12, 20, 6, 10, 7, 2, 39, 7, 11, 4, 9, 4, 7, 7, 4, 11, 6, 23, 12, 11, 13, 13, 18, 4, 18, 9, 12, 6, 6, 8, 8, 25, 3, 9, 11, 6, 7, 17, 7, 2, 13, 9, 38, 21, 3, 6, 7, 14, 10, 8, 37, 15, 6, 34, 11, 4, 7, 28, 13, 9, 16, 2, 5, 9, 8, 13, 21, 5, 7, 19, 12, 12, 10, 17, 13, 2, 39, 3, 13, 13, 25, 12, 5, 7, 31, 15, 8, 35, 24, 16, 18, 7, 18, 21, 2, 14, 20, 7, 24, 36, 14, 17, 5, 8, 5, 19, 12, 2, 10, 3, 19, 3, 4, 7, 15, 42, 12, 22, 5, 19, 10, 10, 8, 15, 8, 23, 20, 30, 9, 8, 9, 4, 24, 6, 22, 8, 7, 18, 7, 6, 7, 2, 12, 30, 5, 18, 22, 12, 6, 6, 20, 15, 4, 10, 3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 323.8043568624614, "mean_inference_ms": 660.28987877102, "mean_action_processing_ms": 33.13465932003942, "mean_env_wait_ms": 3745.616674170063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.035814290662867, "StateBufferConnector_ms": 1.4292525685073545, "ViewRequirementAgentConnector_ms": 30.170587988037948}}, "episode_reward_max": 58.10766463148413, "episode_reward_min": 0.7634336301162048, "episode_reward_mean": 9.805139625937766, "episode_len_mean": 12.78255033557047, "episodes_this_iter": 745, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.043792351033929, 1.8055475989721468, 18.284232503256995, 2.702844252098222, 8.271556269112935, 11.300096590841664, 10.121607831910177, 30.02954986285157, 8.737769377935754, 21.643147021317194, 4.0816130776330715, 22.248109921997877, 1.6133489972484751, 7.217065480445908, 8.35230721930576, 2.3619323779667325, 12.033924171817818, 3.9242852016696324, 1.5191290285222423, 19.914406891973375, 9.794166801710666, 1.5364724901738955, 21.380145954274855, 0.7877784874254673, 8.056948647304191, 9.604522311917345, 2.9388069856569743, 5.285914176621217, 6.243081442746346, 11.049891524438232, 5.469286015937016, 12.929705294088466, 0.9121455950796005, 7.869872251041471, 3.562343995465875, 15.377263960744436, 10.519555915228095, 7.410753105539039, 0.8769660113530404, 5.541710188520337, 1.742708641005796, 10.013867170791084, 7.663716373486039, 11.42171003031753, 4.151215403791157, 3.9432691519191683, 7.06810063915922, 19.741891130268673, 7.520683140450263, 17.175638503109113, 4.012341406287774, 18.96121818864745, 1.5136285902923095, 24.582785352599267, 3.308630043438247, 13.228966795608052, 7.320426778206525, 1.5265699364505079, 13.69432238302682, 7.367792230584019, 19.798696571117404, 7.5507117439759535, 12.097448554591123, 10.985697004913893, 3.0882151451071747, 11.308401725627544, 58.10766463148413, 18.73102819845345, 6.921557252461687, 17.589591009305316, 31.05096053077466, 6.883668148568697, 3.2424268364956346, 1.5954289350804591, 1.8173803612628197, 1.7339753606877641, 5.378087159386992, 12.792503460439224, 20.069815587871815, 4.178504267712712, 33.958438526387006, 0.7678562555892715, 24.85732745461604, 4.23295805451737, 1.859879780437483, 19.667435594970716, 4.229503038974772, 9.528166095356577, 5.725827959848707, 3.6088126492764343, 5.841839001017195, 2.7128714188277296, 12.856553140187028, 1.5156686238418142, 2.7148650364795275, 17.569306557309364, 2.7649661530189347, 7.03657276932941, 23.1484427783443, 14.342020097754736, 4.209289557736543, 10.594378920680427, 9.544325201750999, 3.317573591649676, 14.38270890859459, 7.2628001845321535, 8.13532822004234, 5.421261014225161, 13.440293735998042, 17.92610976258398, 11.173061413448263, 10.76277327015823, 12.637233481070488, 0.7655687020732764, 8.164833523630561, 11.644822327972223, 3.2413992139589545, 8.84504390333456, 26.033199943847237, 34.85133933929186, 15.186553281884683, 11.881706722405744, 8.129188241640142, 14.544391879579376, 18.90535262427446, 3.0899175599910995, 9.464394005481775, 12.069123782884226, 4.22645208410732, 7.897241378516416, 12.90666351427453, 2.664901692936457, 10.278648163557547, 10.279305378460121, 4.173551721683736, 8.825771155803283, 5.399147511190966, 5.628844961815531, 8.91215922542037, 13.794591277928554, 0.8812579059326731, 9.674731184582622, 5.062231168705832, 4.952279215496682, 14.866587750271442, 0.7734472701484263, 11.858945803938646, 5.9824922680082295, 7.813356876030498, 5.663834879113535, 8.050014342698868, 3.3104606552944573, 7.190879395980935, 7.29458020644342, 4.855121773114968, 24.627807097026288, 0.8879708753746006, 12.314336279004777, 2.4305965781864503, 22.190859217064315, 4.656222615881011, 8.017833752945911, 34.31064528145694, 6.806290477802499, 7.217280479359841, 9.478869719209554, 30.780174535683184, 10.46078284252342, 13.803686340459317, 7.046099723175596, 4.675565900152893, 11.104349312803317, 10.977058603478316, 17.80641173243236, 8.187424410708262, 8.042104101638923, 8.688412351345145, 8.65302902884193, 2.3418863415963114, 21.734645086941963, 0.7634336301162048, 8.262702350007622, 5.394354486572199, 8.703638755312964, 2.6985984167138435, 5.59110084749141, 16.940982603258018, 7.46681246529592, 3.201646702194823, 13.270699584728039, 4.618031605689376, 2.3998720144577703, 4.151881514149166, 4.510651028361442, 13.23363320193192, 10.342938529554315, 3.1655888622360613, 17.06688733955605, 3.126843644815452, 5.099431968871088, 27.215717982168226, 1.6062096662383558, 10.839670075903905, 1.5602549316039918, 4.006016990922696, 5.336191656276951, 7.645982316973227, 10.127548851750586, 4.542809731686045, 11.85014458381922, 1.798948602536435, 22.606706184835254, 12.279399275940605, 2.386477901728188, 11.91152616248389, 18.582519321789658, 7.345283417608911, 0.7938463191797659, 20.805881740639663, 12.825962979576522, 0.8863609732137587, 15.355974917777802, 5.215285481968056, 5.62281710783013, 4.635615917000435, 2.687768852087359, 3.333134826188835, 7.392627881574732, 8.599448322322067, 5.479474152991669, 2.340525609817118, 1.7427772464769378, 19.882902544731934, 4.608682385881363, 12.726181738935544, 3.6261064934479412, 24.649517317124385, 10.300294842297411, 6.418161401401615, 10.534790512131812, 14.321391691713288, 11.184982977523449, 3.1356130192899636, 6.482497068428695, 8.624031574683142, 3.6740699537620793, 1.7455073551693314, 14.403501960268613, 4.65948304510834, 8.31682173574092, 3.0078471986840363, 13.039075563553478, 10.556670522287853, 3.201247689854812, 6.349663886063977, 9.834705383723552, 11.355027561712655, 4.075770610424538, 16.01147846966557, 3.686782611510038, 3.2761457596262007, 3.8982275061122804, 27.476353863720817, 15.53400985264701, 11.714131336422358, 6.21600284600975, 3.7930632597458342, 5.459892122661158, 10.357720782705345, 1.5681575162039643, 2.3916722012094755, 17.52525198752163, 14.37138295749399, 13.130980119064406, 19.50021148552068, 3.311976897430764, 10.074781291898208, 5.334934383069462, 7.998337614022417, 1.5548148222484415, 4.059786280946623, 49.442773391660644, 7.04069492870905, 4.564878291069936, 8.105022735241237, 4.51760050500423, 1.7603387145713523, 8.729291562421873, 5.535242776280936, 3.0438237204567944, 3.0814108543355427, 2.93739294151868, 3.6721795527851744, 20.370967558352692, 11.168040702623525, 4.7708078043002065, 1.5594643281034046, 13.446204666770955, 14.544562899233549, 13.010765577849886, 15.969979258403981, 1.7531110479124579, 7.020312597054009, 14.347842237698712, 5.631366924496512, 10.84662450078031, 3.637232580027608, 16.136453858229764, 29.855410790557038, 2.735838672663098, 9.5437359346904, 10.299371586101604, 5.481200835164194, 6.302483605856465, 12.311490501715392, 3.9825260184585995, 4.543648310996368, 15.804839206967841, 5.622692889375464, 1.8081139169034512, 25.645982976380377, 7.379847788849479, 30.240361247841957, 9.553345544181925, 11.131060988509782, 21.82672355150558, 15.662900598333966, 12.416265130113972, 17.525643323161567, 24.376627508680244, 18.736655432121413, 0.8824655238154341, 9.877465864156422, 15.39373722794964, 12.287676770109673, 10.370328867246345, 8.717420546952141, 3.6575325096529854, 3.2380302970445407, 23.976084660242645, 4.5846049813089405, 10.963911454821549, 2.943247241630343, 8.553879752812005, 16.419114947252087, 22.905169904048993, 7.8205463910800725, 8.967707525653008, 21.35802856032226, 4.759333740929364, 14.255052779531011, 2.366170036237917, 20.048797845774693, 2.938214410917564, 2.6823639835049193, 10.44549364207684, 0.7714167433518191, 35.60917897855135, 11.228210868004034, 2.7266627080568697, 14.79227324624686, 9.465554496209942, 30.398532433543657, 9.78521791312841, 16.36702208667552, 3.662523167611544, 14.52912561835947, 27.170444486581093, 32.61480019908793, 7.1766901625246025, 2.3649677022475966, 34.241249577965114, 20.308964573874224, 2.6635053088933187, 19.536661559224843, 4.513757400609664, 12.08528958964106, 6.400685975546796, 3.645788284718588, 9.712396460642012, 5.366191936354695, 12.876973188979042, 9.626921003208341, 3.3382460075440914, 8.773180498387768, 0.8829449627564464, 9.060258573125605, 4.033112025680193, 9.149229268927984, 1.800591616795798, 12.708462986223473, 16.219559194743034, 8.652058378143824, 15.919462886479616, 34.236782475123974, 15.686027078150486, 2.7096541078536585, 16.3840969536128, 9.27129265222641, 2.696780801933309, 7.900511708593261, 8.12697781329413, 10.38477080725366, 9.138494139811852, 13.835501981915817, 8.762999503483849, 18.02326511223691, 4.67728278101902, 12.813712260076722, 12.109612949087616, 4.809517025773635, 3.3391762091058665, 7.987143814688699, 8.105058440263555, 11.386188666940399, 23.56735622900214, 15.056757655792977, 13.530817319880907, 1.8151544367077097, 10.258162096176488, 1.8087125431202669, 16.308256380964547, 0.7674503393045765, 9.443222484190283, 20.778478643974427, 1.7830280807885535, 11.358253885220789, 3.7983714046654917, 9.136286676653036, 21.98045295706404, 0.7715554764178877, 1.782180560330752, 14.89238113454025, 4.231731679503912, 13.134315019342282, 6.0414984789355195, 2.390039800623728, 24.001421237411837, 7.788569592464602, 16.264218540766, 6.403825385916521, 2.3902819433019307, 8.210250626374087, 2.387915567509207, 1.7900230163276447, 6.024786044860558, 4.7735755843319145, 1.8411332738042336, 15.132718084929028, 6.042932845377208, 8.57348571491167, 3.3445827162986985, 36.103355120991495, 5.183384138392694, 11.191143626652185, 4.728414850397865, 2.3449925956024495, 8.9091705514191, 1.792095149151168, 8.638484777509333, 3.3168974867065724, 11.302893458524402, 13.28896378856906, 2.445737556822519, 3.779128550870491, 55.402114709570554, 6.427126302178084, 8.777481178075202, 5.665220319462067, 11.168973793266394, 3.9955424384500935, 8.515311613635241, 11.387692369355708, 1.8210405670798093, 5.668184567326808, 10.189739643562183, 7.144550080844262, 4.572400926532178, 16.801137707950655, 3.217290031472469, 9.11648829553758, 10.691123836761257, 7.934788079491583, 6.268259290710065, 0.8879708753746006, 18.79486849536466, 5.958593028016166, 4.597294337643429, 8.184709059068458, 22.88701943034972, 20.603332147357417, 5.510955619145799, 6.639691056291207, 5.995432734464301, 1.5795248926828536, 3.2040477286730815, 32.58237302133149, 9.891138742204658, 8.7080053271342, 3.3041743708569458, 25.44171600975518, 2.9415608698290923, 4.6025251708742525, 12.755503954929509, 18.62353139558741, 3.3059744639994526, 3.081952148634723, 12.23767791603922, 3.59343574618444, 2.417160281498068, 15.23085262447105, 22.087477543689765, 1.7811532330942739, 9.898884643784896, 38.50409324905015, 22.15632179245495, 4.222251687955699, 3.6172116758907236, 15.215315431605848, 9.089560239900521, 10.477664796142163, 7.970795352555546, 14.731458078137567, 8.148617827562065, 7.789316932593781, 10.241310978273166, 10.083167751862208, 2.9384675117822336, 20.09527014794046, 11.498571920776783, 8.865551713378125, 1.5847087994408868, 2.7116992926601533, 7.123250560539139, 10.020232756558135, 5.42773211705133, 8.269334271428486, 7.653328699186117, 2.944996112342779, 12.392190408245664, 30.263235526233533, 5.419817579604861, 7.935896714219017, 3.978972775422637, 8.676931977420743, 7.772163143330407, 5.434733371961964, 5.638603145870552, 7.9208695667311115, 26.521016336760674, 8.133121170768455, 5.0190449397370855, 12.360317547431892, 8.715174052998925, 15.537939616036699, 1.8344921518576176, 5.088456294700627, 3.0614156427930257, 6.488908679976775, 4.022268280712166, 4.437200587783223, 14.831764154125777, 11.34524905843115, 7.075275409480106, 8.034235134448808, 7.854259464985926, 9.443227288812038, 3.676836690938665, 3.6685265280785933, 9.132958601635957, 16.18430011524019, 5.907829557950537, 9.547512048542849, 19.84210159811089, 3.992241775058311, 33.071614976717335, 7.74753783271866, 45.51459917938074, 13.205336799592162, 7.332543640563732, 9.383168433623927, 14.38455187181802, 5.339522816913477, 16.69610903604747, 13.701959681150356, 4.66696430636947, 2.419179141676339, 6.505751295046147, 5.224717601098948, 6.496496673504377, 8.700500824659322, 15.582937525559778, 4.422148114740522, 7.786310855571266, 5.698837899840424, 0.8879708753746006, 30.85388096825871, 4.665119037216243, 7.829619257262771, 3.3307325336988964, 6.991484597838129, 2.364960219664079, 5.985416873742253, 4.515146417676216, 2.677193836246257, 7.819411095313464, 3.980498853700925, 17.847936547735777, 9.48180019189411, 8.516508425000952, 10.61633949363766, 9.760940247077901, 14.304377580865435, 2.3632261596668838, 13.736976791713623, 6.153269046342792, 8.892590316555461, 4.02916810646404, 4.2948290375336216, 5.4584786486147445, 5.371806489259896, 20.095455764477972, 1.8028575420533115, 6.338185684710593, 7.8143226866819715, 4.55532985338966, 4.477831150114908, 13.317932536979226, 4.760720040747174, 0.8824289039198221, 10.861851723659955, 6.179011618863798, 31.015751981936685, 16.25466655504056, 1.787300985287945, 4.594621553745638, 5.109758571504629, 10.326837557285474, 7.333861044775521, 5.441476740894198, 29.950194477022485, 11.177871748365513, 4.566184356023568, 26.93951029441671, 9.165464955743499, 3.232552296090668, 5.53251583167354, 21.21462999327688, 9.517210623773185, 6.875302881506828, 12.975485569138181, 0.877494811928693, 3.645403508790652, 6.229421758930864, 5.457344134247274, 9.55744976893014, 16.489198114376887, 3.2028610150364765, 5.516557591110207, 14.677497388241292, 8.684158828486195, 10.134307820896046, 7.812375683513056, 12.904217846791898, 9.484447700530886, 0.778549950798932, 30.990393701414682, 1.5180453160459852, 10.66008182603345, 9.564381311479112, 19.982923848543148, 8.474488127331837, 3.5041267561257152, 5.0348645277810835, 24.753242903890087, 11.11593627226026, 5.456117455911093, 29.568012675206717, 18.406554937143248, 12.78789163005578, 13.763118406706665, 4.700038881054172, 13.62252991235154, 16.866132206287062, 0.7716719110405267, 10.332590674484026, 16.647334049656283, 4.788833692719889, 18.412205821148923, 29.10501564158219, 10.257470148719054, 12.669277367326439, 3.6994214128818372, 5.473516168468704, 3.7914179387396727, 15.549951593325043, 10.33926137034417, 0.7638331667017249, 6.810662797505359, 1.5858113831375824, 14.65292279454149, 1.6143394636182178, 2.7421893555446095, 5.316861553241834, 11.631150806792839, 32.850242883251, 8.855216037164412, 16.9604036738891, 2.9443634244704637, 14.853776098634196, 8.231736145870022, 7.28883676641535, 5.2252584306045, 11.406182435438938, 6.199081986485712, 18.300038988294055, 15.926423793849024, 25.455335220211712, 6.37169683166122, 5.401263893717167, 6.090662724355681, 2.764665296047302, 19.632790682922746, 4.727738007624455, 16.750196076071184, 5.641776142714671, 4.695149388791136, 13.604422553755253, 5.463013210891235, 4.583742925782739, 5.3913318183587595, 0.7768597642634895, 8.869901853919721, 24.10541263394558, 2.95704117355801, 13.334927899793588, 18.04006756750283, 9.69917830701391, 4.617481030059265, 4.216301600248587, 15.152487963951565, 11.03403357857135, 2.3968559071359046, 7.288885467423619, 1.5578358365800318], "episode_lengths": [11, 3, 22, 4, 11, 14, 14, 39, 12, 27, 6, 27, 3, 10, 10, 4, 15, 6, 3, 25, 12, 3, 26, 2, 11, 12, 5, 7, 8, 15, 8, 17, 2, 11, 5, 18, 13, 9, 2, 7, 3, 12, 10, 15, 6, 6, 10, 24, 9, 22, 6, 24, 3, 32, 5, 17, 10, 3, 18, 9, 25, 11, 16, 14, 5, 15, 69, 23, 9, 22, 39, 10, 5, 3, 3, 3, 7, 16, 25, 6, 41, 2, 31, 6, 3, 24, 6, 13, 7, 5, 8, 4, 17, 3, 4, 23, 4, 9, 28, 19, 6, 13, 13, 5, 19, 10, 11, 7, 18, 24, 13, 14, 17, 2, 11, 14, 5, 12, 32, 44, 19, 15, 11, 19, 24, 4, 12, 16, 6, 10, 15, 4, 14, 14, 6, 11, 7, 8, 12, 18, 2, 12, 7, 6, 19, 2, 14, 8, 11, 7, 10, 5, 10, 9, 7, 31, 2, 16, 4, 25, 7, 10, 44, 8, 10, 13, 38, 14, 16, 9, 7, 15, 14, 23, 11, 10, 11, 11, 4, 27, 2, 10, 8, 11, 4, 8, 22, 9, 5, 17, 6, 4, 6, 7, 17, 13, 5, 22, 5, 7, 34, 3, 14, 3, 5, 8, 11, 13, 7, 14, 3, 28, 16, 4, 15, 24, 9, 2, 25, 16, 2, 18, 8, 8, 7, 4, 5, 10, 12, 8, 4, 3, 25, 7, 16, 5, 31, 14, 9, 13, 17, 13, 5, 9, 12, 5, 3, 19, 7, 10, 5, 17, 14, 5, 9, 13, 14, 6, 21, 6, 5, 6, 33, 20, 14, 9, 5, 8, 14, 3, 4, 22, 19, 17, 25, 5, 14, 8, 11, 3, 6, 63, 10, 6, 11, 7, 3, 12, 8, 5, 5, 5, 6, 25, 14, 7, 3, 16, 19, 16, 20, 3, 10, 19, 7, 14, 5, 20, 37, 4, 13, 14, 7, 9, 16, 5, 7, 20, 8, 3, 34, 10, 35, 13, 15, 28, 19, 15, 22, 30, 23, 2, 12, 20, 16, 13, 12, 6, 5, 29, 6, 13, 5, 12, 21, 28, 11, 11, 26, 7, 17, 4, 26, 5, 4, 14, 2, 44, 15, 4, 19, 13, 39, 12, 20, 5, 19, 33, 40, 9, 4, 44, 24, 4, 25, 7, 16, 8, 5, 12, 7, 17, 13, 5, 12, 2, 11, 6, 12, 3, 17, 21, 11, 21, 43, 21, 4, 21, 12, 4, 11, 10, 13, 11, 18, 12, 23, 7, 16, 16, 7, 5, 11, 10, 15, 29, 19, 16, 3, 13, 3, 20, 2, 13, 26, 3, 15, 6, 11, 27, 2, 3, 17, 6, 17, 8, 4, 29, 10, 21, 8, 4, 10, 4, 3, 8, 7, 3, 20, 8, 12, 5, 44, 7, 14, 7, 4, 12, 3, 11, 5, 14, 16, 4, 6, 65, 9, 12, 8, 15, 6, 12, 15, 3, 8, 14, 10, 7, 21, 5, 12, 13, 10, 9, 2, 22, 8, 6, 11, 28, 26, 7, 8, 8, 3, 5, 41, 13, 11, 5, 31, 5, 6, 17, 22, 5, 4, 16, 5, 4, 20, 28, 3, 13, 48, 27, 6, 5, 18, 12, 14, 10, 19, 11, 10, 13, 13, 5, 26, 14, 11, 3, 4, 10, 14, 8, 11, 10, 5, 15, 37, 7, 11, 5, 12, 10, 7, 8, 11, 32, 11, 7, 15, 11, 19, 3, 7, 5, 9, 6, 7, 20, 15, 10, 10, 10, 13, 5, 5, 12, 20, 8, 13, 26, 6, 43, 9, 56, 16, 9, 13, 18, 8, 21, 18, 6, 4, 9, 8, 9, 12, 20, 6, 10, 7, 2, 39, 7, 11, 4, 9, 4, 7, 7, 4, 11, 6, 23, 12, 11, 13, 13, 18, 4, 18, 9, 12, 6, 6, 8, 8, 25, 3, 9, 11, 6, 7, 17, 7, 2, 13, 9, 38, 21, 3, 6, 7, 14, 10, 8, 37, 15, 6, 34, 11, 4, 7, 28, 13, 9, 16, 2, 5, 9, 8, 13, 21, 5, 7, 19, 12, 12, 10, 17, 13, 2, 39, 3, 13, 13, 25, 12, 5, 7, 31, 15, 8, 35, 24, 16, 18, 7, 18, 21, 2, 14, 20, 7, 24, 36, 14, 17, 5, 8, 5, 19, 12, 2, 10, 3, 19, 3, 4, 7, 15, 42, 12, 22, 5, 19, 10, 10, 8, 15, 8, 23, 20, 30, 9, 8, 9, 4, 24, 6, 22, 8, 7, 18, 7, 6, 7, 2, 12, 30, 5, 18, 22, 12, 6, 6, 20, 15, 4, 10, 3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 323.8043568624614, "mean_inference_ms": 660.28987877102, "mean_action_processing_ms": 33.13465932003942, "mean_env_wait_ms": 3745.616674170063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.035814290662867, "StateBufferConnector_ms": 1.4292525685073545, "ViewRequirementAgentConnector_ms": 30.170587988037948}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 10000, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 9.418879892991745, "num_env_steps_trained_throughput_per_sec": 9.418879892991745, "timesteps_total": 10000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 10000, "timers": {"training_iteration_time_ms": 1061697.311, "sample_time_ms": 984963.587, "load_time_ms": 2280.899, "load_throughput": 4384.237, "learn_time_ms": 73443.28, "learn_throughput": 136.159, "synch_weights_time_ms": 984.759}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 10000}, "done": false, "episodes_total": 745, "training_iteration": 1, "trial_id": "ef367_00000", "date": "2024-01-23_10-36-30", "timestamp": 1705977390, "time_this_iter_s": 1061.9022161960602, "time_total_s": 1061.9022161960602, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 1061.9022161960602, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 1.1132293080054274, "ram_util_percent": 13.727679782903662}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 6.799001817214183, "policy_loss": -0.02421824447492249, "vf_loss": 6.818234071059105, "vf_explained_var": 0.06342393098733363, "kl": 0.01661999364911865, "entropy": 2.711260731301756, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3510.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 64.72435208639253, "episode_reward_min": 0.7634336301162048, "episode_reward_mean": 16.309915296689365, "episode_len_mean": 20.66595744680851, "episode_media": {}, "episodes_this_iter": 470, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.486502279552002, 8.280246661544597, 16.746090278710806, 16.802483496869435, 29.877071308967427, 3.9128839986631014, 27.1112939220191, 7.817600680537506, 37.22690864032232, 0.790363566179278, 9.207653515412249, 11.294024263855919, 13.094113702092399, 3.232911565019434, 21.886443721086636, 9.457333137992785, 5.482831955484271, 19.751181941030676, 31.133633063249775, 2.963752769184771, 7.04111388899338, 9.101679621044324, 35.178834753253696, 48.49939188673671, 11.350864950141062, 1.5217404772357637, 18.481378225681446, 14.415131333674159, 11.349105545384166, 15.843748957046646, 24.418851807047677, 18.46646953658764, 8.334161572367519, 27.41000322509405, 41.918526729758135, 5.637631546534791, 13.385426444485226, 30.97432688896872, 39.77309709615037, 4.531578371742197, 19.908844556045704, 45.77844073973669, 13.82364199207275, 32.31779980563233, 10.55730562004882, 10.307976701249439, 34.039388623297434, 20.646269002588834, 3.793124409768131, 6.281491547425796, 11.326882853916043, 8.60371722838888, 9.892604808388837, 10.190891386792977, 4.133988650255051, 17.305714732419826, 4.66724319442305, 4.032470288347066, 24.99307814668279, 16.771266542910883, 9.051791580959996, 20.467547559707747, 6.051053048465507, 35.190473956107276, 11.977159072294683, 1.603303538507781, 27.334725587544025, 15.434059978479059, 26.389370758174547, 12.240849656180043, 26.713536016038535, 1.860985235129478, 19.090989725343206, 22.27054039092093, 11.362494034576935, 11.350548750507357, 34.317485820566404, 17.377382468591346, 12.948076421596546, 7.743681863212539, 18.363582573963583, 22.149523199304884, 36.12157560521527, 2.7547381317649524, 5.909360371144933, 13.177780866425737, 5.440200756306886, 32.91780033895193, 6.892682388100964, 6.159849077295665, 15.534869467832136, 13.809946988196675, 35.32857515514246, 3.6454250412346894, 13.978603958928492, 21.847269674363396, 0.768880579103872, 14.952990605327308, 6.351162586773451, 9.501108301762226, 9.70721738231217, 13.290539768178851, 4.603236287800002, 33.49251717580176, 22.298057927074375, 16.98004115621815, 22.05261653153397, 24.708689762970735, 20.15371686289322, 19.731768956683585, 7.136648760891005, 27.705004968524168, 8.152589357320037, 8.599749788128173, 7.384181650802614, 18.118606205210806, 42.21231158169599, 7.991824173288724, 1.7698110333159902, 56.14014789783705, 10.807812871991999, 26.052454638422198, 15.491999018888585, 4.894550668829033, 18.53136414752874, 13.038743745230544, 16.55261225195302, 4.010408507671149, 30.428485248634786, 5.476574393428953, 23.402267871543433, 35.80211663491565, 5.492645742055804, 18.82224114691355, 6.162044949448675, 8.536786754250176, 9.603278961674649, 7.150014336470813, 12.844184519943838, 24.647032335823752, 4.229015987760567, 22.8770320585811, 13.68604064291011, 22.68094059236034, 14.478645541398071, 19.0498462117842, 25.36744116666606, 12.864469163708055, 22.046845000536088, 26.939363307272636, 12.3508937330365, 10.884571975393738, 4.6582206216397966, 20.471824644137833, 12.839848332866609, 16.7337935011139, 6.032047000441988, 6.521820637150362, 19.23928700777377, 7.417187218662103, 15.107050126937247, 4.047233641578687, 17.816092640061555, 26.599584536416316, 33.080217144210316, 11.345245369664992, 28.07918980169138, 10.30643996478576, 3.3031659258287878, 3.819359635493669, 10.326862237814353, 10.254437085492995, 24.186892386261928, 56.01175588455457, 10.34560008411244, 9.022440001136667, 8.982835634020438, 6.942155347278826, 11.762324952443334, 3.334917257739208, 2.939461561489479, 12.973982211188655, 21.54572318388479, 8.107515998787507, 27.051029878749652, 19.08719472104528, 25.594650461842885, 6.475499885548796, 9.55488947138201, 16.077973052662113, 6.949057597436855, 10.39417894628943, 12.3420722090274, 6.814671350097386, 29.433507121201362, 16.770542979086503, 11.19152361659063, 18.92282680915997, 20.5253435228683, 13.390662744506756, 10.41661092973271, 22.53595940758792, 0.7634336301162048, 5.06356005284492, 62.490386339512675, 4.745712290663314, 14.333592202783375, 12.06033722732747, 19.803983348027753, 3.9849772700894435, 16.466385062351065, 20.91485711158171, 32.674570783915726, 16.8558497805621, 10.951796656839575, 9.949617287444513, 36.971232774387346, 6.223180401896059, 13.68324458952447, 0.8817595576892994, 15.814509013806848, 16.630615457637635, 36.20011360040506, 4.800470667153242, 12.305404105299937, 1.7716090765328336, 20.913595748485587, 25.605302055413482, 3.1426453911552694, 31.113333281283403, 14.985512248101502, 12.488231477654324, 22.33208012053167, 3.277773601570473, 32.37675390150734, 17.45057098389837, 2.707739603871301, 8.776394711110145, 17.62805359442398, 27.613095168509872, 5.675100856183837, 12.817714701235987, 25.65929188397736, 42.880073785320306, 9.75070226078888, 32.47790716317871, 25.028859143795394, 30.840113676606027, 7.356438685915502, 4.175576285172506, 5.433257595288307, 7.010334959224182, 3.189349888705882, 15.756480298194766, 5.69727410944087, 4.590999940728689, 46.78406786797465, 5.40451055235009, 20.578391865137053, 20.491064233571496, 11.373499708085673, 14.194905693735976, 7.902096546710775, 11.24618390921124, 32.39150435734481, 11.753562513835913, 10.95541932758488, 20.847258699622287, 12.982583150484418, 36.541002878170026, 27.28153144499651, 11.397275372534818, 46.09626090763722, 64.72435208639253, 8.675121886205021, 8.476076529360135, 8.625828684429772, 44.33790123263698, 32.74961804494176, 1.5692312686800935, 22.91631358214407, 20.266694248863903, 13.186381685505095, 8.244112360545977, 49.896908821078334, 13.239789889361116, 24.60895303596896, 20.922404365632982, 8.664569622586278, 16.710576252261724, 0.7874976956379418, 0.8874251199163626, 12.81481913972437, 12.368197632770734, 3.603551916320883, 29.980576433931212, 38.66048071914031, 6.178026731712757, 4.678732980481133, 0.8879708753746006, 4.295361567632318, 6.4533796873932925, 9.457573843999945, 15.83465482142972, 19.96115199585169, 8.655502082000373, 9.463279570549542, 3.1880370028757223, 0.8046888618507279, 12.60569829211174, 8.148881764572593, 18.920922598166932, 10.446594247320553, 6.499471620565707, 5.557881816821376, 47.953583824104975, 10.420725867084348, 10.07441194140318, 7.376005476885065, 3.7317625391662483, 16.502902514829554, 17.145942943582572, 7.755444975494957, 23.448182449969092, 13.887437104404356, 20.892733634496906, 25.78016604428912, 15.817586874452154, 13.73197253050256, 29.97513148296284, 59.05946546904493, 7.783629737370319, 6.498476191811077, 8.685562685849122, 18.245835196949443, 10.477085387525767, 11.791497042640433, 54.16881152184457, 4.007596272124819, 11.867137465920955, 28.76797555318244, 13.061742647496505, 25.120279058678598, 23.47409750672531, 4.625790250364825, 43.90010896334961, 9.392550919783583, 11.44414706191389, 34.9264992015979, 30.592999542624984, 14.450662026859836, 12.181084053251942, 28.48898397986736, 8.841229329721394, 6.305944352796578, 13.270925405896575, 9.711404113768074, 29.433038315026028, 15.820536150002896, 7.506333143389925, 11.202462537472533, 8.664774906336623, 6.558220372478109, 10.42219328064396, 13.213004968844459, 22.98961734510578, 15.422640771837422, 16.839350029630342, 27.652105817933883, 17.358098328919446, 0.8969842193715934, 15.242039466712429, 8.836166174793503, 40.89855044079704, 4.969651460112832, 3.1575334446057766, 7.0740902122691525, 26.36239907703491, 6.127757225556291, 6.5508826834709355, 10.7187437879189, 9.013377081794966, 5.7241446128745785, 12.580254320946525, 14.684001969836789, 15.309109863328212, 7.924364415767674, 19.04995693739867, 3.793265541054923, 26.707249935746166, 1.5305981998020335, 28.207569886390207, 19.910953109345744, 4.494439486220273, 8.796519049403972, 26.948822447594374, 34.30738697335975, 11.886030051431256, 14.182607476935136, 12.866796104266376, 56.803956403563724, 0.7645687704553505, 3.011309540438502, 16.58738655642712, 49.197645825399476, 5.69382856076493, 3.6589562347644704, 8.04074704500239, 6.562127319971445, 1.770543004473903, 7.88888418532625, 53.73064715650937, 26.109599078971833, 14.845217303359004, 6.792294992303643, 5.998563878076073, 26.863492058381627, 7.60787807456065, 16.6158489701446, 6.295873030708508, 4.006263064305899, 5.482452810317307, 9.401822866431193, 15.652505515601193, 6.876158714784196, 13.311063746592174, 10.825817687373926, 7.7665984338295795, 14.375996526163707, 2.356932564253375, 10.325135487446577, 14.151266798512731, 26.60896416045213, 14.017340553082443, 8.753136577845103, 7.023259524028644, 8.688306338110165, 34.34807981156882, 34.92315310508493, 9.58254702609131, 21.83149348212463, 25.165968753270302, 45.691666711112376, 5.882753295149602, 13.910792889543838, 48.53870318738087, 19.153063283206656, 6.300868222791839, 15.441227832031313, 30.298815649006013, 5.609366637824818, 33.438243294658356, 3.2111074221151994, 9.895196451942347, 59.98592074270157, 18.690302944891307, 36.69135917902396, 15.710902344925701, 11.161334049907559, 15.459735155287987, 25.55723193023642, 58.60494612198423, 14.599680496955125, 10.343782233387339, 13.13666806303933, 44.52802684272944, 31.689379279544852, 20.069992344998543, 0.7849761037021437, 10.165098454175032], "episode_lengths": [9, 11, 21, 21, 36, 6, 34, 11, 46, 2, 13, 15, 17, 5, 27, 13, 7, 25, 39, 5, 10, 11, 45, 61, 15, 3, 24, 19, 15, 20, 29, 24, 11, 35, 51, 8, 18, 38, 50, 6, 25, 57, 17, 41, 13, 14, 42, 27, 5, 8, 13, 11, 14, 14, 6, 22, 6, 5, 31, 21, 12, 25, 9, 43, 16, 3, 34, 18, 31, 16, 34, 3, 24, 27, 15, 15, 41, 23, 15, 11, 23, 27, 44, 4, 8, 17, 7, 41, 9, 9, 21, 18, 44, 5, 18, 27, 2, 19, 9, 13, 13, 17, 7, 41, 26, 21, 28, 31, 26, 24, 10, 35, 11, 11, 9, 24, 52, 11, 3, 69, 14, 33, 20, 6, 22, 17, 21, 5, 38, 8, 29, 44, 8, 24, 8, 12, 13, 10, 17, 31, 6, 28, 18, 27, 18, 24, 31, 17, 26, 32, 16, 15, 7, 25, 17, 22, 8, 9, 24, 10, 20, 6, 21, 32, 41, 14, 36, 14, 5, 5, 14, 14, 30, 67, 14, 11, 12, 10, 15, 5, 5, 17, 27, 11, 33, 23, 31, 9, 13, 19, 9, 14, 16, 9, 36, 22, 15, 24, 26, 17, 14, 29, 2, 7, 80, 6, 17, 15, 26, 5, 21, 27, 40, 22, 14, 13, 47, 9, 18, 2, 20, 21, 44, 6, 16, 3, 27, 32, 5, 38, 20, 16, 28, 5, 38, 22, 4, 11, 23, 33, 8, 17, 34, 52, 13, 40, 31, 40, 10, 6, 7, 9, 5, 20, 7, 6, 60, 7, 26, 25, 14, 19, 10, 15, 39, 16, 14, 27, 17, 46, 32, 15, 57, 82, 12, 10, 11, 54, 43, 3, 27, 25, 17, 11, 64, 16, 30, 25, 12, 21, 2, 2, 17, 15, 5, 35, 48, 9, 6, 2, 6, 9, 13, 18, 25, 12, 13, 5, 2, 16, 11, 24, 14, 9, 7, 57, 14, 12, 10, 6, 20, 21, 11, 29, 17, 25, 32, 20, 17, 37, 74, 11, 9, 12, 24, 14, 16, 69, 6, 16, 36, 17, 30, 29, 7, 52, 13, 15, 45, 39, 19, 16, 36, 12, 9, 17, 13, 36, 21, 9, 14, 12, 9, 14, 15, 29, 20, 21, 35, 22, 2, 19, 12, 50, 6, 5, 10, 31, 9, 9, 13, 12, 7, 16, 19, 21, 11, 23, 5, 33, 3, 33, 25, 7, 11, 34, 41, 16, 18, 17, 68, 2, 4, 22, 60, 7, 5, 11, 8, 3, 11, 67, 33, 19, 9, 7, 33, 11, 21, 8, 6, 8, 13, 20, 9, 17, 14, 11, 18, 4, 14, 19, 33, 18, 12, 9, 11, 43, 44, 13, 28, 30, 53, 7, 18, 59, 25, 8, 19, 39, 8, 39, 5, 13, 74, 24, 45, 20, 15, 20, 31, 70, 18, 12, 17, 54, 41, 25, 2, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 285.17094880584415, "mean_inference_ms": 662.5011432238547, "mean_action_processing_ms": 32.57040709799504, "mean_env_wait_ms": 3761.8702926034603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.6249924517692405, "StateBufferConnector_ms": 2.2867471106508943, "ViewRequirementAgentConnector_ms": 27.699170315519293}}, "episode_reward_max": 64.72435208639253, "episode_reward_min": 0.7634336301162048, "episode_reward_mean": 16.309915296689365, "episode_len_mean": 20.66595744680851, "episodes_this_iter": 470, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.486502279552002, 8.280246661544597, 16.746090278710806, 16.802483496869435, 29.877071308967427, 3.9128839986631014, 27.1112939220191, 7.817600680537506, 37.22690864032232, 0.790363566179278, 9.207653515412249, 11.294024263855919, 13.094113702092399, 3.232911565019434, 21.886443721086636, 9.457333137992785, 5.482831955484271, 19.751181941030676, 31.133633063249775, 2.963752769184771, 7.04111388899338, 9.101679621044324, 35.178834753253696, 48.49939188673671, 11.350864950141062, 1.5217404772357637, 18.481378225681446, 14.415131333674159, 11.349105545384166, 15.843748957046646, 24.418851807047677, 18.46646953658764, 8.334161572367519, 27.41000322509405, 41.918526729758135, 5.637631546534791, 13.385426444485226, 30.97432688896872, 39.77309709615037, 4.531578371742197, 19.908844556045704, 45.77844073973669, 13.82364199207275, 32.31779980563233, 10.55730562004882, 10.307976701249439, 34.039388623297434, 20.646269002588834, 3.793124409768131, 6.281491547425796, 11.326882853916043, 8.60371722838888, 9.892604808388837, 10.190891386792977, 4.133988650255051, 17.305714732419826, 4.66724319442305, 4.032470288347066, 24.99307814668279, 16.771266542910883, 9.051791580959996, 20.467547559707747, 6.051053048465507, 35.190473956107276, 11.977159072294683, 1.603303538507781, 27.334725587544025, 15.434059978479059, 26.389370758174547, 12.240849656180043, 26.713536016038535, 1.860985235129478, 19.090989725343206, 22.27054039092093, 11.362494034576935, 11.350548750507357, 34.317485820566404, 17.377382468591346, 12.948076421596546, 7.743681863212539, 18.363582573963583, 22.149523199304884, 36.12157560521527, 2.7547381317649524, 5.909360371144933, 13.177780866425737, 5.440200756306886, 32.91780033895193, 6.892682388100964, 6.159849077295665, 15.534869467832136, 13.809946988196675, 35.32857515514246, 3.6454250412346894, 13.978603958928492, 21.847269674363396, 0.768880579103872, 14.952990605327308, 6.351162586773451, 9.501108301762226, 9.70721738231217, 13.290539768178851, 4.603236287800002, 33.49251717580176, 22.298057927074375, 16.98004115621815, 22.05261653153397, 24.708689762970735, 20.15371686289322, 19.731768956683585, 7.136648760891005, 27.705004968524168, 8.152589357320037, 8.599749788128173, 7.384181650802614, 18.118606205210806, 42.21231158169599, 7.991824173288724, 1.7698110333159902, 56.14014789783705, 10.807812871991999, 26.052454638422198, 15.491999018888585, 4.894550668829033, 18.53136414752874, 13.038743745230544, 16.55261225195302, 4.010408507671149, 30.428485248634786, 5.476574393428953, 23.402267871543433, 35.80211663491565, 5.492645742055804, 18.82224114691355, 6.162044949448675, 8.536786754250176, 9.603278961674649, 7.150014336470813, 12.844184519943838, 24.647032335823752, 4.229015987760567, 22.8770320585811, 13.68604064291011, 22.68094059236034, 14.478645541398071, 19.0498462117842, 25.36744116666606, 12.864469163708055, 22.046845000536088, 26.939363307272636, 12.3508937330365, 10.884571975393738, 4.6582206216397966, 20.471824644137833, 12.839848332866609, 16.7337935011139, 6.032047000441988, 6.521820637150362, 19.23928700777377, 7.417187218662103, 15.107050126937247, 4.047233641578687, 17.816092640061555, 26.599584536416316, 33.080217144210316, 11.345245369664992, 28.07918980169138, 10.30643996478576, 3.3031659258287878, 3.819359635493669, 10.326862237814353, 10.254437085492995, 24.186892386261928, 56.01175588455457, 10.34560008411244, 9.022440001136667, 8.982835634020438, 6.942155347278826, 11.762324952443334, 3.334917257739208, 2.939461561489479, 12.973982211188655, 21.54572318388479, 8.107515998787507, 27.051029878749652, 19.08719472104528, 25.594650461842885, 6.475499885548796, 9.55488947138201, 16.077973052662113, 6.949057597436855, 10.39417894628943, 12.3420722090274, 6.814671350097386, 29.433507121201362, 16.770542979086503, 11.19152361659063, 18.92282680915997, 20.5253435228683, 13.390662744506756, 10.41661092973271, 22.53595940758792, 0.7634336301162048, 5.06356005284492, 62.490386339512675, 4.745712290663314, 14.333592202783375, 12.06033722732747, 19.803983348027753, 3.9849772700894435, 16.466385062351065, 20.91485711158171, 32.674570783915726, 16.8558497805621, 10.951796656839575, 9.949617287444513, 36.971232774387346, 6.223180401896059, 13.68324458952447, 0.8817595576892994, 15.814509013806848, 16.630615457637635, 36.20011360040506, 4.800470667153242, 12.305404105299937, 1.7716090765328336, 20.913595748485587, 25.605302055413482, 3.1426453911552694, 31.113333281283403, 14.985512248101502, 12.488231477654324, 22.33208012053167, 3.277773601570473, 32.37675390150734, 17.45057098389837, 2.707739603871301, 8.776394711110145, 17.62805359442398, 27.613095168509872, 5.675100856183837, 12.817714701235987, 25.65929188397736, 42.880073785320306, 9.75070226078888, 32.47790716317871, 25.028859143795394, 30.840113676606027, 7.356438685915502, 4.175576285172506, 5.433257595288307, 7.010334959224182, 3.189349888705882, 15.756480298194766, 5.69727410944087, 4.590999940728689, 46.78406786797465, 5.40451055235009, 20.578391865137053, 20.491064233571496, 11.373499708085673, 14.194905693735976, 7.902096546710775, 11.24618390921124, 32.39150435734481, 11.753562513835913, 10.95541932758488, 20.847258699622287, 12.982583150484418, 36.541002878170026, 27.28153144499651, 11.397275372534818, 46.09626090763722, 64.72435208639253, 8.675121886205021, 8.476076529360135, 8.625828684429772, 44.33790123263698, 32.74961804494176, 1.5692312686800935, 22.91631358214407, 20.266694248863903, 13.186381685505095, 8.244112360545977, 49.896908821078334, 13.239789889361116, 24.60895303596896, 20.922404365632982, 8.664569622586278, 16.710576252261724, 0.7874976956379418, 0.8874251199163626, 12.81481913972437, 12.368197632770734, 3.603551916320883, 29.980576433931212, 38.66048071914031, 6.178026731712757, 4.678732980481133, 0.8879708753746006, 4.295361567632318, 6.4533796873932925, 9.457573843999945, 15.83465482142972, 19.96115199585169, 8.655502082000373, 9.463279570549542, 3.1880370028757223, 0.8046888618507279, 12.60569829211174, 8.148881764572593, 18.920922598166932, 10.446594247320553, 6.499471620565707, 5.557881816821376, 47.953583824104975, 10.420725867084348, 10.07441194140318, 7.376005476885065, 3.7317625391662483, 16.502902514829554, 17.145942943582572, 7.755444975494957, 23.448182449969092, 13.887437104404356, 20.892733634496906, 25.78016604428912, 15.817586874452154, 13.73197253050256, 29.97513148296284, 59.05946546904493, 7.783629737370319, 6.498476191811077, 8.685562685849122, 18.245835196949443, 10.477085387525767, 11.791497042640433, 54.16881152184457, 4.007596272124819, 11.867137465920955, 28.76797555318244, 13.061742647496505, 25.120279058678598, 23.47409750672531, 4.625790250364825, 43.90010896334961, 9.392550919783583, 11.44414706191389, 34.9264992015979, 30.592999542624984, 14.450662026859836, 12.181084053251942, 28.48898397986736, 8.841229329721394, 6.305944352796578, 13.270925405896575, 9.711404113768074, 29.433038315026028, 15.820536150002896, 7.506333143389925, 11.202462537472533, 8.664774906336623, 6.558220372478109, 10.42219328064396, 13.213004968844459, 22.98961734510578, 15.422640771837422, 16.839350029630342, 27.652105817933883, 17.358098328919446, 0.8969842193715934, 15.242039466712429, 8.836166174793503, 40.89855044079704, 4.969651460112832, 3.1575334446057766, 7.0740902122691525, 26.36239907703491, 6.127757225556291, 6.5508826834709355, 10.7187437879189, 9.013377081794966, 5.7241446128745785, 12.580254320946525, 14.684001969836789, 15.309109863328212, 7.924364415767674, 19.04995693739867, 3.793265541054923, 26.707249935746166, 1.5305981998020335, 28.207569886390207, 19.910953109345744, 4.494439486220273, 8.796519049403972, 26.948822447594374, 34.30738697335975, 11.886030051431256, 14.182607476935136, 12.866796104266376, 56.803956403563724, 0.7645687704553505, 3.011309540438502, 16.58738655642712, 49.197645825399476, 5.69382856076493, 3.6589562347644704, 8.04074704500239, 6.562127319971445, 1.770543004473903, 7.88888418532625, 53.73064715650937, 26.109599078971833, 14.845217303359004, 6.792294992303643, 5.998563878076073, 26.863492058381627, 7.60787807456065, 16.6158489701446, 6.295873030708508, 4.006263064305899, 5.482452810317307, 9.401822866431193, 15.652505515601193, 6.876158714784196, 13.311063746592174, 10.825817687373926, 7.7665984338295795, 14.375996526163707, 2.356932564253375, 10.325135487446577, 14.151266798512731, 26.60896416045213, 14.017340553082443, 8.753136577845103, 7.023259524028644, 8.688306338110165, 34.34807981156882, 34.92315310508493, 9.58254702609131, 21.83149348212463, 25.165968753270302, 45.691666711112376, 5.882753295149602, 13.910792889543838, 48.53870318738087, 19.153063283206656, 6.300868222791839, 15.441227832031313, 30.298815649006013, 5.609366637824818, 33.438243294658356, 3.2111074221151994, 9.895196451942347, 59.98592074270157, 18.690302944891307, 36.69135917902396, 15.710902344925701, 11.161334049907559, 15.459735155287987, 25.55723193023642, 58.60494612198423, 14.599680496955125, 10.343782233387339, 13.13666806303933, 44.52802684272944, 31.689379279544852, 20.069992344998543, 0.7849761037021437, 10.165098454175032], "episode_lengths": [9, 11, 21, 21, 36, 6, 34, 11, 46, 2, 13, 15, 17, 5, 27, 13, 7, 25, 39, 5, 10, 11, 45, 61, 15, 3, 24, 19, 15, 20, 29, 24, 11, 35, 51, 8, 18, 38, 50, 6, 25, 57, 17, 41, 13, 14, 42, 27, 5, 8, 13, 11, 14, 14, 6, 22, 6, 5, 31, 21, 12, 25, 9, 43, 16, 3, 34, 18, 31, 16, 34, 3, 24, 27, 15, 15, 41, 23, 15, 11, 23, 27, 44, 4, 8, 17, 7, 41, 9, 9, 21, 18, 44, 5, 18, 27, 2, 19, 9, 13, 13, 17, 7, 41, 26, 21, 28, 31, 26, 24, 10, 35, 11, 11, 9, 24, 52, 11, 3, 69, 14, 33, 20, 6, 22, 17, 21, 5, 38, 8, 29, 44, 8, 24, 8, 12, 13, 10, 17, 31, 6, 28, 18, 27, 18, 24, 31, 17, 26, 32, 16, 15, 7, 25, 17, 22, 8, 9, 24, 10, 20, 6, 21, 32, 41, 14, 36, 14, 5, 5, 14, 14, 30, 67, 14, 11, 12, 10, 15, 5, 5, 17, 27, 11, 33, 23, 31, 9, 13, 19, 9, 14, 16, 9, 36, 22, 15, 24, 26, 17, 14, 29, 2, 7, 80, 6, 17, 15, 26, 5, 21, 27, 40, 22, 14, 13, 47, 9, 18, 2, 20, 21, 44, 6, 16, 3, 27, 32, 5, 38, 20, 16, 28, 5, 38, 22, 4, 11, 23, 33, 8, 17, 34, 52, 13, 40, 31, 40, 10, 6, 7, 9, 5, 20, 7, 6, 60, 7, 26, 25, 14, 19, 10, 15, 39, 16, 14, 27, 17, 46, 32, 15, 57, 82, 12, 10, 11, 54, 43, 3, 27, 25, 17, 11, 64, 16, 30, 25, 12, 21, 2, 2, 17, 15, 5, 35, 48, 9, 6, 2, 6, 9, 13, 18, 25, 12, 13, 5, 2, 16, 11, 24, 14, 9, 7, 57, 14, 12, 10, 6, 20, 21, 11, 29, 17, 25, 32, 20, 17, 37, 74, 11, 9, 12, 24, 14, 16, 69, 6, 16, 36, 17, 30, 29, 7, 52, 13, 15, 45, 39, 19, 16, 36, 12, 9, 17, 13, 36, 21, 9, 14, 12, 9, 14, 15, 29, 20, 21, 35, 22, 2, 19, 12, 50, 6, 5, 10, 31, 9, 9, 13, 12, 7, 16, 19, 21, 11, 23, 5, 33, 3, 33, 25, 7, 11, 34, 41, 16, 18, 17, 68, 2, 4, 22, 60, 7, 5, 11, 8, 3, 11, 67, 33, 19, 9, 7, 33, 11, 21, 8, 6, 8, 13, 20, 9, 17, 14, 11, 18, 4, 14, 19, 33, 18, 12, 9, 11, 43, 44, 13, 28, 30, 53, 7, 18, 59, 25, 8, 19, 39, 8, 39, 5, 13, 74, 24, 45, 20, 15, 20, 31, 70, 18, 12, 17, 54, 41, 25, 2, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 285.17094880584415, "mean_inference_ms": 662.5011432238547, "mean_action_processing_ms": 32.57040709799504, "mean_env_wait_ms": 3761.8702926034603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.6249924517692405, "StateBufferConnector_ms": 2.2867471106508943, "ViewRequirementAgentConnector_ms": 27.699170315519293}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 9.412294761650344, "num_env_steps_trained_throughput_per_sec": 9.412294761650344, "timesteps_total": 20000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 1062068.718, "sample_time_ms": 982433.819, "load_time_ms": 1806.393, "load_throughput": 5535.894, "learn_time_ms": 76864.274, "learn_throughput": 130.099, "synch_weights_time_ms": 932.56}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 1215, "training_iteration": 2, "trial_id": "ef367_00000", "date": "2024-01-23_10-54-13", "timestamp": 1705978453, "time_this_iter_s": 1062.6262035369873, "time_total_s": 2124.5284197330475, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 2124.5284197330475, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 0.8804495912806539, "ram_util_percent": 16.753269754768393}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 7.693538737500835, "policy_loss": -0.021895532611295836, "vf_loss": 7.711346769740439, "vf_explained_var": 0.03989866686682416, "kl": 0.013624984904023363, "entropy": 2.6324870091218213, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 5850.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000}, "sampler_results": {"episode_reward_max": 190.9477937678587, "episode_reward_min": 0.7670107068943232, "episode_reward_mean": 22.17311806970499, "episode_len_mean": 27.900584795321638, "episode_media": {}, "episodes_this_iter": 342, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.475028976130194, 6.821527046512476, 14.818053265849057, 68.37852188654567, 16.208977777837024, 5.0302964321503545, 11.6370929804195, 12.298150195698879, 22.057815488925616, 8.570397094999423, 22.807073969709464, 26.312742432349868, 11.376548817066052, 25.648100669731146, 6.274992519016943, 56.33593527199849, 12.801888421331592, 4.872231681466493, 22.844363607035074, 10.446576002090898, 14.846085172665116, 17.63036307455285, 46.63616764330609, 34.17422338216525, 4.616156903089768, 10.650543596935167, 4.5904571710676665, 14.89624764209897, 26.429041955079363, 26.130296932873488, 6.238888529173028, 4.4925824877478995, 69.47432898128719, 18.55039001830942, 6.491796034056546, 18.92460973389014, 22.55659584748237, 37.04938281611149, 36.515253363505515, 5.424004608583742, 12.359263662183064, 75.89599356162614, 72.66441396254048, 25.826049717975476, 10.41079732107088, 6.235904934291634, 3.84134005981423, 6.859337028775817, 27.515806734249693, 26.25853045993899, 8.70340361823005, 7.724763529675351, 62.4850696740032, 4.017896219488299, 23.811794916671985, 17.737842599545893, 2.6801384314543366, 14.614028770533213, 15.505674603491842, 18.50968364377329, 190.9477937678587, 20.428795021613116, 3.0184431673268532, 27.762705736884197, 4.06606354577119, 9.456893722078242, 82.30817068515539, 32.770659469284105, 23.547556929833572, 12.435254909860024, 13.003929878454858, 8.030988712283289, 4.080386442927525, 23.189289028587464, 34.90271273126762, 6.534067105358827, 26.402707275936443, 3.794334836805103, 77.69670638236086, 33.399695651221315, 15.056557658371052, 11.974048899021788, 6.912195411936642, 8.315843622078257, 28.523931584182804, 17.498026414983283, 8.437418752569435, 8.740121054806979, 17.93170055450596, 28.883235833814073, 39.893983997558024, 42.503934118730655, 43.28521305458336, 1.5392303962847422, 12.392295484690449, 19.997613706610803, 13.808583748109307, 23.23920996135911, 6.154883981692229, 4.941794179032883, 18.25589764653591, 45.19269076537341, 3.137541355014769, 22.301918996058166, 18.15252998605516, 0.7670107068943232, 62.70297595753151, 39.80799713715301, 7.041346029361609, 10.409550072410006, 12.459369240180571, 27.898248860612906, 39.10852161795527, 31.787239248629387, 12.295104402851658, 9.80294319791607, 15.271467398166338, 11.321911311267122, 11.571139363467728, 6.146958424050726, 36.54580682651192, 3.817984704319815, 7.069883134448625, 19.748037630726866, 19.327740481268187, 5.365245242821436, 25.374062896609, 15.102982544123432, 11.309777495719786, 30.469884330733073, 23.37683903449208, 16.399913360911267, 11.549386065085862, 22.120955118530496, 103.89020093607161, 19.854715926854603, 0.7754641973273319, 34.689801529581054, 6.298633005720944, 22.22154746492671, 3.689296558141456, 22.66148129439789, 10.289506177388693, 10.993299980891479, 11.15772276282322, 23.207597451610383, 5.279043557669693, 11.674519553447352, 33.62837898287189, 38.86930445809166, 18.253591334104417, 21.937672789276704, 18.738865845577386, 10.446747178412252, 35.47184439648186, 8.22539178856608, 27.207367027324025, 20.29022091721356, 3.864199480418277, 33.03284758655936, 7.050128534408916, 34.68433423879385, 39.6730742858546, 15.929831296901737, 0.8745447412273158, 21.571099573646926, 29.690708987817562, 28.33762865059723, 13.553576537182181, 63.0252085948566, 56.30248006357495, 45.03454448441716, 59.53108165543181, 29.437216034301255, 9.02628935700702, 10.66435421827069, 65.8908704403009, 15.611089236384803, 35.57168116521213, 17.16235881252676, 9.131185461390166, 18.02359940709049, 3.308280210998629, 114.43771200300894, 19.081810429541726, 6.222675335154365, 20.72758477453494, 17.305051123363903, 18.947752654765996, 31.27701662890142, 15.573861546909127, 24.815779976077906, 3.578385444610469, 7.727231135436899, 11.6843235003035, 55.72276861256369, 8.272963943888117, 17.974885374232663, 5.236251220718148, 6.946417388644586, 7.036502988244993, 29.30485716871038, 62.689084915208134, 20.681083608476705, 79.82255481306866, 6.229347769545246, 5.481489889074681, 5.647036654701066, 18.10755248424988, 17.411837081428764, 5.155113230229552, 5.0210540964930015, 24.576886478190634, 38.19621226247871, 14.570620691900826, 16.239169794408095, 13.253961452071591, 23.18285685161305, 31.80236366129336, 23.39905407623605, 19.538968664579812, 6.81227617802567, 38.18223492345647, 7.770681336554386, 16.739288115612116, 3.793126294221962, 25.8193838053365, 68.37810391147359, 11.320104849690278, 35.91627871387975, 17.034295446695502, 13.717335310865304, 22.543961473115317, 4.949528627952776, 3.1057686363783352, 21.62923160957169, 79.37420129853723, 16.00600405523875, 3.141659766666198, 6.57407967235789, 29.072490988891214, 6.193196014372001, 27.21425661821853, 9.53684910835846, 12.830858642376256, 12.758161083612247, 32.46723716509972, 27.76313305913158, 19.5890111141921, 19.483711129735227, 11.791026558439128, 0.7884456218126381, 9.525552232390174, 6.989666637394475, 24.788679873252285, 24.24282212497518, 21.259914176043857, 21.90508418311989, 35.6961240188531, 7.165323308819291, 4.83206661949427, 8.81581551531415, 10.315206755880892, 7.4077103028912825, 13.68219515163029, 8.723789941269349, 49.84358086343766, 70.29730785121703, 17.213667536267888, 18.716802549901235, 28.461943334700045, 1.5898245062355465, 58.5434177297915, 38.07245678883499, 41.96325611083428, 15.305838700629351, 6.669109933091963, 14.835984499349884, 37.60412172445061, 59.29115102965443, 9.633533334206442, 33.34998579819582, 71.35240354111083, 61.193397435697314, 29.42235875789384, 13.119722246994685, 43.97225623574731, 4.175961483771652, 18.270048126205207, 6.984171446236706, 15.188054909221865, 24.298225668332318, 36.92686717442635, 15.329914570892164, 17.44689282031497, 30.841381726012393, 8.66824840491864, 27.845864855665276, 5.111496999242862, 49.434957152220576, 8.502253274982758, 6.968116533161295, 8.149993198495032, 24.037175691177556, 5.966371647602556, 10.43558537505196, 24.607333492086582, 40.383194985908524, 62.65476077937301, 29.22424556572788, 12.724361844927952, 3.021477254444962, 6.152741530197898, 15.922456989271021, 25.232828129746363, 6.492584561088206, 37.809082584006234, 30.27114711346863, 128.93104286000766, 17.2132340779143, 8.769005703501813, 8.592404954647492, 45.46553041317479, 8.22202407514355, 6.487327378165184, 44.093941532210096, 14.232542399695499, 8.033867624693025, 38.47418628886652, 4.662100968164749, 1.5940327165836372, 3.9782484449310194, 8.569659257214814, 2.3645709242010478, 9.590789072456577, 19.78201331660053, 33.76678016357793, 4.588505622631882, 16.233847269819098, 10.439891960210216, 12.888986217285687, 12.632248455228808], "episode_lengths": [39, 9, 19, 81, 20, 7, 16, 16, 29, 12, 28, 33, 15, 33, 9, 70, 16, 6, 28, 14, 20, 23, 59, 41, 6, 14, 6, 20, 33, 33, 8, 6, 87, 24, 9, 24, 28, 46, 47, 7, 14, 92, 91, 31, 14, 8, 5, 8, 33, 33, 11, 10, 80, 5, 29, 22, 4, 19, 19, 22, 248, 25, 4, 36, 6, 12, 100, 40, 28, 16, 17, 11, 5, 29, 46, 8, 32, 5, 97, 43, 20, 16, 10, 11, 35, 22, 12, 12, 23, 36, 47, 51, 52, 3, 16, 24, 17, 30, 8, 6, 22, 54, 5, 28, 23, 2, 77, 48, 9, 14, 16, 34, 47, 38, 16, 12, 20, 15, 15, 9, 46, 5, 10, 25, 24, 7, 31, 19, 15, 40, 29, 20, 15, 28, 135, 25, 2, 43, 9, 29, 6, 28, 14, 15, 15, 30, 8, 14, 41, 49, 23, 28, 24, 14, 43, 11, 35, 24, 5, 42, 9, 42, 50, 21, 2, 27, 38, 36, 17, 79, 69, 56, 71, 37, 12, 14, 82, 20, 45, 21, 12, 23, 5, 140, 24, 8, 26, 23, 24, 38, 20, 31, 5, 9, 16, 69, 11, 23, 8, 10, 9, 35, 77, 26, 98, 9, 8, 8, 21, 22, 7, 6, 32, 45, 18, 20, 17, 30, 39, 29, 25, 9, 48, 11, 20, 5, 34, 87, 15, 45, 22, 18, 27, 6, 5, 26, 91, 20, 5, 9, 37, 8, 35, 13, 16, 17, 41, 35, 24, 25, 16, 2, 13, 10, 31, 31, 27, 28, 45, 9, 7, 12, 14, 10, 18, 12, 59, 84, 21, 24, 35, 3, 73, 47, 48, 20, 8, 19, 45, 74, 13, 41, 84, 77, 37, 17, 55, 6, 24, 9, 20, 30, 46, 20, 22, 38, 12, 34, 6, 58, 12, 9, 10, 31, 9, 14, 30, 51, 82, 36, 17, 4, 9, 20, 32, 9, 45, 38, 163, 22, 12, 11, 57, 11, 9, 55, 19, 11, 48, 7, 3, 5, 11, 4, 13, 26, 43, 6, 20, 14, 15, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 265.46488223049096, "mean_inference_ms": 664.3323847637186, "mean_action_processing_ms": 32.12806116469687, "mean_env_wait_ms": 3780.4535216487393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.4527386392069142, "StateBufferConnector_ms": 1.1466596558777213, "ViewRequirementAgentConnector_ms": 29.974871838999075}}, "episode_reward_max": 190.9477937678587, "episode_reward_min": 0.7670107068943232, "episode_reward_mean": 22.17311806970499, "episode_len_mean": 27.900584795321638, "episodes_this_iter": 342, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.475028976130194, 6.821527046512476, 14.818053265849057, 68.37852188654567, 16.208977777837024, 5.0302964321503545, 11.6370929804195, 12.298150195698879, 22.057815488925616, 8.570397094999423, 22.807073969709464, 26.312742432349868, 11.376548817066052, 25.648100669731146, 6.274992519016943, 56.33593527199849, 12.801888421331592, 4.872231681466493, 22.844363607035074, 10.446576002090898, 14.846085172665116, 17.63036307455285, 46.63616764330609, 34.17422338216525, 4.616156903089768, 10.650543596935167, 4.5904571710676665, 14.89624764209897, 26.429041955079363, 26.130296932873488, 6.238888529173028, 4.4925824877478995, 69.47432898128719, 18.55039001830942, 6.491796034056546, 18.92460973389014, 22.55659584748237, 37.04938281611149, 36.515253363505515, 5.424004608583742, 12.359263662183064, 75.89599356162614, 72.66441396254048, 25.826049717975476, 10.41079732107088, 6.235904934291634, 3.84134005981423, 6.859337028775817, 27.515806734249693, 26.25853045993899, 8.70340361823005, 7.724763529675351, 62.4850696740032, 4.017896219488299, 23.811794916671985, 17.737842599545893, 2.6801384314543366, 14.614028770533213, 15.505674603491842, 18.50968364377329, 190.9477937678587, 20.428795021613116, 3.0184431673268532, 27.762705736884197, 4.06606354577119, 9.456893722078242, 82.30817068515539, 32.770659469284105, 23.547556929833572, 12.435254909860024, 13.003929878454858, 8.030988712283289, 4.080386442927525, 23.189289028587464, 34.90271273126762, 6.534067105358827, 26.402707275936443, 3.794334836805103, 77.69670638236086, 33.399695651221315, 15.056557658371052, 11.974048899021788, 6.912195411936642, 8.315843622078257, 28.523931584182804, 17.498026414983283, 8.437418752569435, 8.740121054806979, 17.93170055450596, 28.883235833814073, 39.893983997558024, 42.503934118730655, 43.28521305458336, 1.5392303962847422, 12.392295484690449, 19.997613706610803, 13.808583748109307, 23.23920996135911, 6.154883981692229, 4.941794179032883, 18.25589764653591, 45.19269076537341, 3.137541355014769, 22.301918996058166, 18.15252998605516, 0.7670107068943232, 62.70297595753151, 39.80799713715301, 7.041346029361609, 10.409550072410006, 12.459369240180571, 27.898248860612906, 39.10852161795527, 31.787239248629387, 12.295104402851658, 9.80294319791607, 15.271467398166338, 11.321911311267122, 11.571139363467728, 6.146958424050726, 36.54580682651192, 3.817984704319815, 7.069883134448625, 19.748037630726866, 19.327740481268187, 5.365245242821436, 25.374062896609, 15.102982544123432, 11.309777495719786, 30.469884330733073, 23.37683903449208, 16.399913360911267, 11.549386065085862, 22.120955118530496, 103.89020093607161, 19.854715926854603, 0.7754641973273319, 34.689801529581054, 6.298633005720944, 22.22154746492671, 3.689296558141456, 22.66148129439789, 10.289506177388693, 10.993299980891479, 11.15772276282322, 23.207597451610383, 5.279043557669693, 11.674519553447352, 33.62837898287189, 38.86930445809166, 18.253591334104417, 21.937672789276704, 18.738865845577386, 10.446747178412252, 35.47184439648186, 8.22539178856608, 27.207367027324025, 20.29022091721356, 3.864199480418277, 33.03284758655936, 7.050128534408916, 34.68433423879385, 39.6730742858546, 15.929831296901737, 0.8745447412273158, 21.571099573646926, 29.690708987817562, 28.33762865059723, 13.553576537182181, 63.0252085948566, 56.30248006357495, 45.03454448441716, 59.53108165543181, 29.437216034301255, 9.02628935700702, 10.66435421827069, 65.8908704403009, 15.611089236384803, 35.57168116521213, 17.16235881252676, 9.131185461390166, 18.02359940709049, 3.308280210998629, 114.43771200300894, 19.081810429541726, 6.222675335154365, 20.72758477453494, 17.305051123363903, 18.947752654765996, 31.27701662890142, 15.573861546909127, 24.815779976077906, 3.578385444610469, 7.727231135436899, 11.6843235003035, 55.72276861256369, 8.272963943888117, 17.974885374232663, 5.236251220718148, 6.946417388644586, 7.036502988244993, 29.30485716871038, 62.689084915208134, 20.681083608476705, 79.82255481306866, 6.229347769545246, 5.481489889074681, 5.647036654701066, 18.10755248424988, 17.411837081428764, 5.155113230229552, 5.0210540964930015, 24.576886478190634, 38.19621226247871, 14.570620691900826, 16.239169794408095, 13.253961452071591, 23.18285685161305, 31.80236366129336, 23.39905407623605, 19.538968664579812, 6.81227617802567, 38.18223492345647, 7.770681336554386, 16.739288115612116, 3.793126294221962, 25.8193838053365, 68.37810391147359, 11.320104849690278, 35.91627871387975, 17.034295446695502, 13.717335310865304, 22.543961473115317, 4.949528627952776, 3.1057686363783352, 21.62923160957169, 79.37420129853723, 16.00600405523875, 3.141659766666198, 6.57407967235789, 29.072490988891214, 6.193196014372001, 27.21425661821853, 9.53684910835846, 12.830858642376256, 12.758161083612247, 32.46723716509972, 27.76313305913158, 19.5890111141921, 19.483711129735227, 11.791026558439128, 0.7884456218126381, 9.525552232390174, 6.989666637394475, 24.788679873252285, 24.24282212497518, 21.259914176043857, 21.90508418311989, 35.6961240188531, 7.165323308819291, 4.83206661949427, 8.81581551531415, 10.315206755880892, 7.4077103028912825, 13.68219515163029, 8.723789941269349, 49.84358086343766, 70.29730785121703, 17.213667536267888, 18.716802549901235, 28.461943334700045, 1.5898245062355465, 58.5434177297915, 38.07245678883499, 41.96325611083428, 15.305838700629351, 6.669109933091963, 14.835984499349884, 37.60412172445061, 59.29115102965443, 9.633533334206442, 33.34998579819582, 71.35240354111083, 61.193397435697314, 29.42235875789384, 13.119722246994685, 43.97225623574731, 4.175961483771652, 18.270048126205207, 6.984171446236706, 15.188054909221865, 24.298225668332318, 36.92686717442635, 15.329914570892164, 17.44689282031497, 30.841381726012393, 8.66824840491864, 27.845864855665276, 5.111496999242862, 49.434957152220576, 8.502253274982758, 6.968116533161295, 8.149993198495032, 24.037175691177556, 5.966371647602556, 10.43558537505196, 24.607333492086582, 40.383194985908524, 62.65476077937301, 29.22424556572788, 12.724361844927952, 3.021477254444962, 6.152741530197898, 15.922456989271021, 25.232828129746363, 6.492584561088206, 37.809082584006234, 30.27114711346863, 128.93104286000766, 17.2132340779143, 8.769005703501813, 8.592404954647492, 45.46553041317479, 8.22202407514355, 6.487327378165184, 44.093941532210096, 14.232542399695499, 8.033867624693025, 38.47418628886652, 4.662100968164749, 1.5940327165836372, 3.9782484449310194, 8.569659257214814, 2.3645709242010478, 9.590789072456577, 19.78201331660053, 33.76678016357793, 4.588505622631882, 16.233847269819098, 10.439891960210216, 12.888986217285687, 12.632248455228808], "episode_lengths": [39, 9, 19, 81, 20, 7, 16, 16, 29, 12, 28, 33, 15, 33, 9, 70, 16, 6, 28, 14, 20, 23, 59, 41, 6, 14, 6, 20, 33, 33, 8, 6, 87, 24, 9, 24, 28, 46, 47, 7, 14, 92, 91, 31, 14, 8, 5, 8, 33, 33, 11, 10, 80, 5, 29, 22, 4, 19, 19, 22, 248, 25, 4, 36, 6, 12, 100, 40, 28, 16, 17, 11, 5, 29, 46, 8, 32, 5, 97, 43, 20, 16, 10, 11, 35, 22, 12, 12, 23, 36, 47, 51, 52, 3, 16, 24, 17, 30, 8, 6, 22, 54, 5, 28, 23, 2, 77, 48, 9, 14, 16, 34, 47, 38, 16, 12, 20, 15, 15, 9, 46, 5, 10, 25, 24, 7, 31, 19, 15, 40, 29, 20, 15, 28, 135, 25, 2, 43, 9, 29, 6, 28, 14, 15, 15, 30, 8, 14, 41, 49, 23, 28, 24, 14, 43, 11, 35, 24, 5, 42, 9, 42, 50, 21, 2, 27, 38, 36, 17, 79, 69, 56, 71, 37, 12, 14, 82, 20, 45, 21, 12, 23, 5, 140, 24, 8, 26, 23, 24, 38, 20, 31, 5, 9, 16, 69, 11, 23, 8, 10, 9, 35, 77, 26, 98, 9, 8, 8, 21, 22, 7, 6, 32, 45, 18, 20, 17, 30, 39, 29, 25, 9, 48, 11, 20, 5, 34, 87, 15, 45, 22, 18, 27, 6, 5, 26, 91, 20, 5, 9, 37, 8, 35, 13, 16, 17, 41, 35, 24, 25, 16, 2, 13, 10, 31, 31, 27, 28, 45, 9, 7, 12, 14, 10, 18, 12, 59, 84, 21, 24, 35, 3, 73, 47, 48, 20, 8, 19, 45, 74, 13, 41, 84, 77, 37, 17, 55, 6, 24, 9, 20, 30, 46, 20, 22, 38, 12, 34, 6, 58, 12, 9, 10, 31, 9, 14, 30, 51, 82, 36, 17, 4, 9, 20, 32, 9, 45, 38, 163, 22, 12, 11, 57, 11, 9, 55, 19, 11, 48, 7, 3, 5, 11, 4, 13, 26, 43, 6, 20, 14, 15, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 265.46488223049096, "mean_inference_ms": 664.3323847637186, "mean_action_processing_ms": 32.12806116469687, "mean_env_wait_ms": 3780.4535216487393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.4527386392069142, "StateBufferConnector_ms": 1.1466596558777213, "ViewRequirementAgentConnector_ms": 29.974871838999075}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000, "num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 9.40679781646378, "num_env_steps_trained_throughput_per_sec": 9.40679781646378, "timesteps_total": 30000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 30000, "timers": {"training_iteration_time_ms": 1062399.469, "sample_time_ms": 980259.207, "load_time_ms": 2081.856, "load_throughput": 4803.405, "learn_time_ms": 78640.097, "learn_throughput": 127.162, "synch_weights_time_ms": 1390.866}, "counters": {"num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000}, "done": false, "episodes_total": 1557, "training_iteration": 3, "trial_id": "ef367_00000", "date": "2024-01-23_11-11-56", "timestamp": 1705979516, "time_this_iter_s": 1063.2428648471832, "time_total_s": 3187.7712845802307, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 3187.7712845802307, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 1.036137281292059, "ram_util_percent": 19.044347240915208}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 8.450175870178093, "policy_loss": -0.021198005173514542, "vf_loss": 8.467388902770148, "vf_explained_var": 0.027657294426208887, "kl": 0.013283287546942416, "entropy": 2.5792990187294462, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 8190.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 187.26871685843489, "episode_reward_min": 1.7445556457819758, "episode_reward_mean": 32.3120569000229, "episode_len_mean": 40.013392857142854, "episode_media": {}, "episodes_this_iter": 224, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.059444297112435, 6.207753060341603, 7.628437072021979, 1.7445556457819758, 76.33109360313726, 10.351727497862033, 20.681264223715846, 22.916038721383423, 14.90115578020901, 28.085309889785567, 78.33671550027466, 99.42473739418922, 6.270666048537004, 4.65438941570368, 16.04261363611476, 34.755421536042185, 48.2502997020395, 10.038551385453086, 2.7056328513978816, 52.40459699656615, 58.353381588662835, 6.13162588263718, 91.19108177209262, 21.725108170399558, 32.60598587805299, 12.981336998672347, 36.819762705574384, 10.787496804414081, 16.943330823338925, 17.752217813917678, 29.630759186953796, 90.0879514367952, 21.200784448940542, 8.651818113755935, 46.3596790044871, 6.3028703250402405, 50.88256804754715, 10.813408429997233, 82.41445193530639, 36.852034848069955, 7.7446678432456135, 28.814162046255067, 26.539021712647273, 14.899835879452564, 6.242415755622551, 7.055422226520877, 22.181188150547072, 12.575382181230944, 40.16900558994477, 106.71912021070204, 16.01074152850427, 7.009647872961608, 68.61537268348242, 23.576023066194402, 4.579919362250454, 12.972826358766195, 39.12013712419319, 78.50722717922854, 59.237451005490215, 41.13175172591868, 42.577713669838985, 72.76526276239417, 27.186087001027428, 5.721015887555927, 24.07709197778331, 18.313242493855935, 20.552287035724692, 40.51227677328857, 32.57937604712341, 8.905951562036858, 21.877714756266332, 45.01369280213286, 45.11632149960486, 11.031004055689063, 21.97921686514125, 25.11488622436516, 13.709283249860503, 6.995036856496582, 19.12757197533374, 8.617648394945174, 23.18376274321725, 14.923106244314802, 10.91438108990782, 7.8964686944104105, 25.622888565787417, 37.426346542476715, 8.60947254665668, 7.229609050609467, 40.237291215877164, 44.57062498517635, 112.34416128821175, 7.866447877420408, 9.587731447464545, 4.222581319784281, 31.86845520822402, 14.071936036219958, 9.527146731471966, 110.62349102379032, 80.52765964853575, 20.06418542202211, 70.54996113559758, 18.044674079643105, 61.50637770401122, 7.853099144733361, 17.541957684597588, 7.419712167576574, 53.20283029355021, 38.860854098013874, 6.306247712605493, 5.628570933200038, 4.732812799720626, 10.199460980397493, 8.719578746963093, 20.33896799381328, 14.643234074029438, 63.081398765869686, 35.963295545642, 12.196682171682886, 47.16004137095307, 14.878656606608564, 38.375884452741616, 74.36430158422918, 54.38270264298119, 41.27104761777593, 19.12910958078584, 3.7941067671189144, 61.78282889875679, 24.785601362627613, 7.3255481338434505, 24.100880942234674, 43.30182525426959, 32.1312222893671, 12.549212715382453, 1.776940182205316, 21.137816940705893, 20.970784093086912, 19.565079496870432, 37.00886634684562, 15.218709804521438, 10.373968599646384, 18.849994166211246, 6.3262931207143165, 9.785430311127902, 9.175114292561418, 16.213424744340625, 8.622349440276384, 47.10528097002742, 32.012489376912434, 89.29164849262968, 7.695155068300098, 22.652862418355056, 153.0854779087502, 44.77709220314899, 80.73977600859054, 9.531901835240719, 9.350267478831517, 26.005770241819494, 130.14727488739715, 9.387369928122354, 56.416698167143934, 21.257133646904364, 3.271638001174708, 41.67073647527001, 7.880821631111726, 1.7853278339857928, 8.4651896326079, 62.13840253373373, 11.516515586350964, 14.671749595270157, 14.916993228265328, 70.17900220948532, 34.92973418336812, 56.085789120919365, 12.232477126159374, 28.658702064473356, 108.29905197518966, 44.32373842898555, 7.079933944197468, 75.84282054520989, 38.616206762289565, 32.14201108049447, 90.08384512591324, 118.67131635293052, 10.410508343594705, 28.229983238428765, 26.235980466929995, 3.0947080026481157, 66.52585482916528, 7.3663878620847445, 16.620257197212943, 15.484921478032751, 22.394307708352088, 35.02635865710345, 22.65836628797472, 45.27228746187041, 6.186526010600758, 11.590912902169434, 63.19882569381451, 92.51861438198652, 34.36293712785345, 63.01557784051595, 6.236621180319521, 31.419021020461244, 41.27691435979091, 8.615001827525418, 19.242937660816263, 187.26871685843489, 158.52857096100968, 31.994700557836307, 7.86311338809455, 10.268422392104153, 8.381878444862588, 7.78111650139005, 3.8186037858404314, 5.367807938267072, 26.74622811410648, 4.9514159078362825, 21.81609953428489, 47.77302737482765, 54.349453876716886, 12.610822798381138, 20.124672712483672, 27.455543378795515, 103.68127213308084], "episode_lengths": [72, 8, 11, 3, 95, 14, 26, 28, 19, 35, 100, 123, 8, 6, 21, 43, 60, 12, 4, 65, 69, 9, 116, 25, 41, 16, 46, 13, 21, 23, 37, 110, 28, 12, 55, 8, 64, 14, 100, 45, 10, 35, 33, 19, 9, 9, 29, 16, 47, 129, 20, 9, 81, 28, 6, 15, 47, 96, 72, 51, 50, 84, 34, 7, 30, 23, 26, 51, 40, 11, 27, 55, 56, 15, 26, 31, 17, 10, 23, 12, 29, 18, 13, 11, 32, 48, 12, 10, 48, 52, 141, 11, 13, 6, 40, 18, 13, 143, 99, 26, 81, 22, 75, 11, 22, 10, 66, 49, 9, 8, 6, 14, 11, 26, 18, 75, 45, 14, 57, 18, 47, 89, 66, 51, 23, 5, 75, 30, 9, 29, 53, 38, 16, 3, 26, 27, 24, 44, 19, 13, 25, 8, 13, 12, 21, 12, 57, 39, 104, 9, 28, 195, 54, 98, 12, 13, 32, 163, 13, 66, 26, 4, 50, 11, 3, 11, 78, 15, 19, 19, 86, 41, 70, 16, 35, 130, 56, 9, 92, 46, 39, 114, 150, 13, 35, 32, 4, 84, 9, 20, 20, 28, 45, 27, 56, 8, 16, 76, 116, 41, 76, 8, 39, 53, 11, 25, 235, 199, 40, 11, 14, 12, 11, 5, 7, 33, 6, 29, 57, 66, 16, 25, 36, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 245.23290637790868, "mean_inference_ms": 669.983681366419, "mean_action_processing_ms": 32.02308485570472, "mean_env_wait_ms": 3807.7387630205985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.7907084141458784, "StateBufferConnector_ms": 1.1369041034153529, "ViewRequirementAgentConnector_ms": 29.239171956266677}}, "episode_reward_max": 187.26871685843489, "episode_reward_min": 1.7445556457819758, "episode_reward_mean": 32.3120569000229, "episode_len_mean": 40.013392857142854, "episodes_this_iter": 224, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.059444297112435, 6.207753060341603, 7.628437072021979, 1.7445556457819758, 76.33109360313726, 10.351727497862033, 20.681264223715846, 22.916038721383423, 14.90115578020901, 28.085309889785567, 78.33671550027466, 99.42473739418922, 6.270666048537004, 4.65438941570368, 16.04261363611476, 34.755421536042185, 48.2502997020395, 10.038551385453086, 2.7056328513978816, 52.40459699656615, 58.353381588662835, 6.13162588263718, 91.19108177209262, 21.725108170399558, 32.60598587805299, 12.981336998672347, 36.819762705574384, 10.787496804414081, 16.943330823338925, 17.752217813917678, 29.630759186953796, 90.0879514367952, 21.200784448940542, 8.651818113755935, 46.3596790044871, 6.3028703250402405, 50.88256804754715, 10.813408429997233, 82.41445193530639, 36.852034848069955, 7.7446678432456135, 28.814162046255067, 26.539021712647273, 14.899835879452564, 6.242415755622551, 7.055422226520877, 22.181188150547072, 12.575382181230944, 40.16900558994477, 106.71912021070204, 16.01074152850427, 7.009647872961608, 68.61537268348242, 23.576023066194402, 4.579919362250454, 12.972826358766195, 39.12013712419319, 78.50722717922854, 59.237451005490215, 41.13175172591868, 42.577713669838985, 72.76526276239417, 27.186087001027428, 5.721015887555927, 24.07709197778331, 18.313242493855935, 20.552287035724692, 40.51227677328857, 32.57937604712341, 8.905951562036858, 21.877714756266332, 45.01369280213286, 45.11632149960486, 11.031004055689063, 21.97921686514125, 25.11488622436516, 13.709283249860503, 6.995036856496582, 19.12757197533374, 8.617648394945174, 23.18376274321725, 14.923106244314802, 10.91438108990782, 7.8964686944104105, 25.622888565787417, 37.426346542476715, 8.60947254665668, 7.229609050609467, 40.237291215877164, 44.57062498517635, 112.34416128821175, 7.866447877420408, 9.587731447464545, 4.222581319784281, 31.86845520822402, 14.071936036219958, 9.527146731471966, 110.62349102379032, 80.52765964853575, 20.06418542202211, 70.54996113559758, 18.044674079643105, 61.50637770401122, 7.853099144733361, 17.541957684597588, 7.419712167576574, 53.20283029355021, 38.860854098013874, 6.306247712605493, 5.628570933200038, 4.732812799720626, 10.199460980397493, 8.719578746963093, 20.33896799381328, 14.643234074029438, 63.081398765869686, 35.963295545642, 12.196682171682886, 47.16004137095307, 14.878656606608564, 38.375884452741616, 74.36430158422918, 54.38270264298119, 41.27104761777593, 19.12910958078584, 3.7941067671189144, 61.78282889875679, 24.785601362627613, 7.3255481338434505, 24.100880942234674, 43.30182525426959, 32.1312222893671, 12.549212715382453, 1.776940182205316, 21.137816940705893, 20.970784093086912, 19.565079496870432, 37.00886634684562, 15.218709804521438, 10.373968599646384, 18.849994166211246, 6.3262931207143165, 9.785430311127902, 9.175114292561418, 16.213424744340625, 8.622349440276384, 47.10528097002742, 32.012489376912434, 89.29164849262968, 7.695155068300098, 22.652862418355056, 153.0854779087502, 44.77709220314899, 80.73977600859054, 9.531901835240719, 9.350267478831517, 26.005770241819494, 130.14727488739715, 9.387369928122354, 56.416698167143934, 21.257133646904364, 3.271638001174708, 41.67073647527001, 7.880821631111726, 1.7853278339857928, 8.4651896326079, 62.13840253373373, 11.516515586350964, 14.671749595270157, 14.916993228265328, 70.17900220948532, 34.92973418336812, 56.085789120919365, 12.232477126159374, 28.658702064473356, 108.29905197518966, 44.32373842898555, 7.079933944197468, 75.84282054520989, 38.616206762289565, 32.14201108049447, 90.08384512591324, 118.67131635293052, 10.410508343594705, 28.229983238428765, 26.235980466929995, 3.0947080026481157, 66.52585482916528, 7.3663878620847445, 16.620257197212943, 15.484921478032751, 22.394307708352088, 35.02635865710345, 22.65836628797472, 45.27228746187041, 6.186526010600758, 11.590912902169434, 63.19882569381451, 92.51861438198652, 34.36293712785345, 63.01557784051595, 6.236621180319521, 31.419021020461244, 41.27691435979091, 8.615001827525418, 19.242937660816263, 187.26871685843489, 158.52857096100968, 31.994700557836307, 7.86311338809455, 10.268422392104153, 8.381878444862588, 7.78111650139005, 3.8186037858404314, 5.367807938267072, 26.74622811410648, 4.9514159078362825, 21.81609953428489, 47.77302737482765, 54.349453876716886, 12.610822798381138, 20.124672712483672, 27.455543378795515, 103.68127213308084], "episode_lengths": [72, 8, 11, 3, 95, 14, 26, 28, 19, 35, 100, 123, 8, 6, 21, 43, 60, 12, 4, 65, 69, 9, 116, 25, 41, 16, 46, 13, 21, 23, 37, 110, 28, 12, 55, 8, 64, 14, 100, 45, 10, 35, 33, 19, 9, 9, 29, 16, 47, 129, 20, 9, 81, 28, 6, 15, 47, 96, 72, 51, 50, 84, 34, 7, 30, 23, 26, 51, 40, 11, 27, 55, 56, 15, 26, 31, 17, 10, 23, 12, 29, 18, 13, 11, 32, 48, 12, 10, 48, 52, 141, 11, 13, 6, 40, 18, 13, 143, 99, 26, 81, 22, 75, 11, 22, 10, 66, 49, 9, 8, 6, 14, 11, 26, 18, 75, 45, 14, 57, 18, 47, 89, 66, 51, 23, 5, 75, 30, 9, 29, 53, 38, 16, 3, 26, 27, 24, 44, 19, 13, 25, 8, 13, 12, 21, 12, 57, 39, 104, 9, 28, 195, 54, 98, 12, 13, 32, 163, 13, 66, 26, 4, 50, 11, 3, 11, 78, 15, 19, 19, 86, 41, 70, 16, 35, 130, 56, 9, 92, 46, 39, 114, 150, 13, 35, 32, 4, 84, 9, 20, 20, 28, 45, 27, 56, 8, 16, 76, 116, 41, 76, 8, 39, 53, 11, 25, 235, 199, 40, 11, 14, 12, 11, 5, 7, 33, 6, 29, 57, 66, 16, 25, 36, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 245.23290637790868, "mean_inference_ms": 669.983681366419, "mean_action_processing_ms": 32.02308485570472, "mean_env_wait_ms": 3807.7387630205985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.7907084141458784, "StateBufferConnector_ms": 1.1369041034153529, "ViewRequirementAgentConnector_ms": 29.239171956266677}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 9.274603911162302, "num_env_steps_trained_throughput_per_sec": 9.274603911162302, "timesteps_total": 40000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 1066352.882, "sample_time_ms": 983103.873, "load_time_ms": 1894.188, "load_throughput": 5279.308, "learn_time_ms": 80071.916, "learn_throughput": 124.888, "synch_weights_time_ms": 1255.718}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 1781, "training_iteration": 4, "trial_id": "ef367_00000", "date": "2024-01-23_11-29-54", "timestamp": 1705980594, "time_this_iter_s": 1078.391774892807, "time_total_s": 4266.163059473038, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 4266.163059473038, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 0.8001997336884155, "ram_util_percent": 19.32896138482024}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 9.05040811351222, "policy_loss": -0.01646769822248791, "vf_loss": 9.0639101466562, "vf_explained_var": 0.0007115889054078322, "kl": 0.009885566998395021, "entropy": 2.5449407817970995, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 10530.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 50000}, "sampler_results": {"episode_reward_max": 248.38436628139593, "episode_reward_min": 0.7768597642634895, "episode_reward_mean": 53.46586200011421, "episode_len_mean": 65.13793103448276, "episode_media": {}, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [87.69957781593256, 105.6278311831185, 13.972062431871297, 15.16309396869663, 61.70644870764873, 20.254217391079127, 81.81705423705306, 38.08221560913186, 4.588195971506985, 31.743674223391164, 47.20033547826666, 1.7773799611422145, 32.02759422955241, 76.11786262984477, 11.38259814211462, 0.7768597642634895, 11.139923131201575, 13.331407205090226, 54.873518012319394, 46.78006724893232, 162.06371343913406, 25.38652946523022, 12.006637468099086, 20.710156509724833, 33.031633326555365, 7.830100296782871, 12.133342222724576, 82.629175948049, 54.91526302537105, 9.988044250359073, 105.09955566252414, 67.31686237176051, 129.4915811556219, 47.84063568476267, 50.297554220010255, 44.42931615118066, 64.15384996372015, 40.284697285866606, 19.5674993724678, 57.75865329203924, 5.970321964169909, 70.68941976667297, 85.55162896152135, 87.33461075725747, 48.890135342786536, 22.350660584242892, 50.91730241587899, 157.17398905451242, 3.814657943804931, 88.47377080429033, 56.99325127224885, 48.83628300148184, 70.2208169272351, 20.761096322022766, 25.990216902224326, 11.852455568781663, 16.079401517860756, 17.796811592271997, 29.898211420373826, 84.87807911409618, 248.38436628139593, 174.2061535843353, 14.29028044607594, 45.017063763657504, 113.91480267751628, 20.23242744337273, 180.04830591315113, 94.62062733304003, 44.005216548092655, 8.690299816343586, 10.2662828924071, 24.56241858344344, 57.99772128487411, 5.386913505822166, 45.638863427753854, 84.65749956566931, 10.307473510487647, 29.109676027696022, 162.54628680692062, 5.586319730989067, 165.32203101504246, 116.56612033658229, 37.81621374309308, 17.125917759573035, 53.578763400008384, 49.25142530401116, 73.9698775105408, 26.108041669272723, 25.48355569362143, 42.83923543082625, 42.949892915169166, 116.87322765510437, 44.5289841179082, 25.45508597861338, 16.36699181080535, 44.14509277606276, 36.629073754871776, 5.377547735921874, 46.44417534916704, 54.516077083539855, 138.67311742475871, 66.03843494514837, 60.40797000261881, 45.33843376785333, 83.80670957387923, 91.77966639920405, 16.515775190524216, 99.1376686257437, 54.61113812868132, 11.89899165804639, 35.21021649877259, 73.51837603419412, 52.39463137818475, 42.544295110503896, 58.999390203440555, 42.87900720103817], "episode_lengths": [103, 129, 18, 19, 72, 25, 96, 45, 6, 37, 59, 3, 38, 88, 15, 2, 15, 17, 69, 57, 198, 31, 14, 26, 40, 11, 16, 100, 63, 13, 126, 80, 158, 58, 65, 54, 80, 47, 23, 71, 7, 89, 110, 109, 58, 28, 59, 192, 5, 109, 70, 59, 83, 25, 34, 14, 21, 22, 37, 102, 310, 216, 18, 54, 134, 24, 216, 117, 55, 12, 13, 31, 69, 7, 53, 104, 14, 36, 202, 7, 200, 146, 44, 22, 64, 59, 91, 33, 32, 53, 53, 146, 54, 30, 21, 54, 44, 7, 56, 63, 166, 79, 70, 54, 100, 108, 20, 120, 66, 16, 43, 85, 66, 55, 72, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 231.23411988287236, "mean_inference_ms": 674.7273773908688, "mean_action_processing_ms": 31.532388185755835, "mean_env_wait_ms": 3841.6300385624745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.165498610200553, "StateBufferConnector_ms": 1.0487069343698436, "ViewRequirementAgentConnector_ms": 31.096449597128505}}, "episode_reward_max": 248.38436628139593, "episode_reward_min": 0.7768597642634895, "episode_reward_mean": 53.46586200011421, "episode_len_mean": 65.13793103448276, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [87.69957781593256, 105.6278311831185, 13.972062431871297, 15.16309396869663, 61.70644870764873, 20.254217391079127, 81.81705423705306, 38.08221560913186, 4.588195971506985, 31.743674223391164, 47.20033547826666, 1.7773799611422145, 32.02759422955241, 76.11786262984477, 11.38259814211462, 0.7768597642634895, 11.139923131201575, 13.331407205090226, 54.873518012319394, 46.78006724893232, 162.06371343913406, 25.38652946523022, 12.006637468099086, 20.710156509724833, 33.031633326555365, 7.830100296782871, 12.133342222724576, 82.629175948049, 54.91526302537105, 9.988044250359073, 105.09955566252414, 67.31686237176051, 129.4915811556219, 47.84063568476267, 50.297554220010255, 44.42931615118066, 64.15384996372015, 40.284697285866606, 19.5674993724678, 57.75865329203924, 5.970321964169909, 70.68941976667297, 85.55162896152135, 87.33461075725747, 48.890135342786536, 22.350660584242892, 50.91730241587899, 157.17398905451242, 3.814657943804931, 88.47377080429033, 56.99325127224885, 48.83628300148184, 70.2208169272351, 20.761096322022766, 25.990216902224326, 11.852455568781663, 16.079401517860756, 17.796811592271997, 29.898211420373826, 84.87807911409618, 248.38436628139593, 174.2061535843353, 14.29028044607594, 45.017063763657504, 113.91480267751628, 20.23242744337273, 180.04830591315113, 94.62062733304003, 44.005216548092655, 8.690299816343586, 10.2662828924071, 24.56241858344344, 57.99772128487411, 5.386913505822166, 45.638863427753854, 84.65749956566931, 10.307473510487647, 29.109676027696022, 162.54628680692062, 5.586319730989067, 165.32203101504246, 116.56612033658229, 37.81621374309308, 17.125917759573035, 53.578763400008384, 49.25142530401116, 73.9698775105408, 26.108041669272723, 25.48355569362143, 42.83923543082625, 42.949892915169166, 116.87322765510437, 44.5289841179082, 25.45508597861338, 16.36699181080535, 44.14509277606276, 36.629073754871776, 5.377547735921874, 46.44417534916704, 54.516077083539855, 138.67311742475871, 66.03843494514837, 60.40797000261881, 45.33843376785333, 83.80670957387923, 91.77966639920405, 16.515775190524216, 99.1376686257437, 54.61113812868132, 11.89899165804639, 35.21021649877259, 73.51837603419412, 52.39463137818475, 42.544295110503896, 58.999390203440555, 42.87900720103817], "episode_lengths": [103, 129, 18, 19, 72, 25, 96, 45, 6, 37, 59, 3, 38, 88, 15, 2, 15, 17, 69, 57, 198, 31, 14, 26, 40, 11, 16, 100, 63, 13, 126, 80, 158, 58, 65, 54, 80, 47, 23, 71, 7, 89, 110, 109, 58, 28, 59, 192, 5, 109, 70, 59, 83, 25, 34, 14, 21, 22, 37, 102, 310, 216, 18, 54, 134, 24, 216, 117, 55, 12, 13, 31, 69, 7, 53, 104, 14, 36, 202, 7, 200, 146, 44, 22, 64, 59, 91, 33, 32, 53, 53, 146, 54, 30, 21, 54, 44, 7, 56, 63, 166, 79, 70, 54, 100, 108, 20, 120, 66, 16, 43, 85, 66, 55, 72, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 231.23411988287236, "mean_inference_ms": 674.7273773908688, "mean_action_processing_ms": 31.532388185755835, "mean_env_wait_ms": 3841.6300385624745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.165498610200553, "StateBufferConnector_ms": 1.0487069343698436, "ViewRequirementAgentConnector_ms": 31.096449597128505}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 50000, "num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 9.252336478326631, "num_env_steps_trained_throughput_per_sec": 9.252336478326631, "timesteps_total": 50000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 50000, "timers": {"training_iteration_time_ms": 1069243.912, "sample_time_ms": 985081.825, "load_time_ms": 1773.684, "load_throughput": 5637.984, "learn_time_ms": 81106.563, "learn_throughput": 123.295, "synch_weights_time_ms": 1250.221}, "counters": {"num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 50000}, "done": false, "episodes_total": 1897, "training_iteration": 5, "trial_id": "ef367_00000", "date": "2024-01-23_11-47-55", "timestamp": 1705981675, "time_this_iter_s": 1080.9854128360748, "time_total_s": 5347.148472309113, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 5347.148472309113, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 0.8002666666666667, "ram_util_percent": 19.6568}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 9.359719069187458, "policy_loss": -0.016777260962109537, "vf_loss": 9.373427669818584, "vf_explained_var": -0.01388806764386658, "kl": 0.010228906448862138, "entropy": 2.5202114209150657, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 12870.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 310.57082966544107, "episode_reward_min": 3.058341245744971, "episode_reward_mean": 76.87469430076473, "episode_len_mean": 94.17, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.99772128487411, 5.386913505822166, 45.638863427753854, 84.65749956566931, 10.307473510487647, 29.109676027696022, 162.54628680692062, 5.586319730989067, 165.32203101504246, 116.56612033658229, 37.81621374309308, 17.125917759573035, 53.578763400008384, 49.25142530401116, 73.9698775105408, 26.108041669272723, 25.48355569362143, 42.83923543082625, 42.949892915169166, 116.87322765510437, 44.5289841179082, 25.45508597861338, 16.36699181080535, 44.14509277606276, 36.629073754871776, 5.377547735921874, 46.44417534916704, 54.516077083539855, 138.67311742475871, 66.03843494514837, 60.40797000261881, 45.33843376785333, 83.80670957387923, 91.77966639920405, 16.515775190524216, 99.1376686257437, 54.61113812868132, 11.89899165804639, 35.21021649877259, 73.51837603419412, 52.39463137818475, 42.544295110503896, 58.999390203440555, 42.87900720103817, 54.19212826725448, 43.64174399121428, 215.95993997930213, 161.27493828155505, 150.4084958740674, 16.9061904800795, 174.0609351085456, 65.3177222222108, 40.18059620554051, 45.96722969785606, 13.729798362473387, 143.3186531971993, 102.96574696582009, 195.4617720830775, 82.79103368340043, 52.48991207705165, 228.51132223088294, 49.31321813797321, 242.27110544480618, 97.04670692239064, 31.896718289758315, 17.799304696209788, 39.37076363024457, 60.175426655794425, 144.10935563534915, 19.18527790394436, 114.45933069391148, 236.969463500009, 63.814502922247236, 77.7748510365711, 122.59967084804983, 63.94185573944852, 65.0133753447619, 37.56836110599107, 261.93049902777216, 50.2476144524483, 17.258424125722943, 15.706962692907645, 310.57082966544107, 24.22905607987891, 65.4405601818807, 87.98749999322501, 66.13858635808984, 13.871010605282573, 159.26972884857128, 256.8386744355947, 3.058341245744971, 40.105083726761684, 184.67701062824213, 97.68010937766772, 37.23263431469927, 144.2439057504245, 51.03042283799267, 33.65760192657859, 43.34509524346374, 36.13042430054999], "episode_lengths": [69, 7, 53, 104, 14, 36, 202, 7, 200, 146, 44, 22, 64, 59, 91, 33, 32, 53, 53, 146, 54, 30, 21, 54, 44, 7, 56, 63, 166, 79, 70, 54, 100, 108, 20, 120, 66, 16, 43, 85, 66, 55, 72, 52, 69, 54, 270, 201, 183, 21, 212, 74, 50, 53, 18, 174, 124, 236, 102, 60, 282, 60, 306, 116, 40, 24, 49, 74, 172, 25, 134, 295, 78, 97, 151, 77, 77, 44, 327, 62, 21, 20, 395, 31, 81, 110, 84, 18, 191, 317, 4, 49, 228, 120, 44, 178, 62, 42, 52, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 221.72094301168224, "mean_inference_ms": 676.1540285131621, "mean_action_processing_ms": 31.877182281082128, "mean_env_wait_ms": 3841.913298668606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4937305450439453, "StateBufferConnector_ms": 0.5426995754241943, "ViewRequirementAgentConnector_ms": 37.6667697429657}}, "episode_reward_max": 310.57082966544107, "episode_reward_min": 3.058341245744971, "episode_reward_mean": 76.87469430076473, "episode_len_mean": 94.17, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [57.99772128487411, 5.386913505822166, 45.638863427753854, 84.65749956566931, 10.307473510487647, 29.109676027696022, 162.54628680692062, 5.586319730989067, 165.32203101504246, 116.56612033658229, 37.81621374309308, 17.125917759573035, 53.578763400008384, 49.25142530401116, 73.9698775105408, 26.108041669272723, 25.48355569362143, 42.83923543082625, 42.949892915169166, 116.87322765510437, 44.5289841179082, 25.45508597861338, 16.36699181080535, 44.14509277606276, 36.629073754871776, 5.377547735921874, 46.44417534916704, 54.516077083539855, 138.67311742475871, 66.03843494514837, 60.40797000261881, 45.33843376785333, 83.80670957387923, 91.77966639920405, 16.515775190524216, 99.1376686257437, 54.61113812868132, 11.89899165804639, 35.21021649877259, 73.51837603419412, 52.39463137818475, 42.544295110503896, 58.999390203440555, 42.87900720103817, 54.19212826725448, 43.64174399121428, 215.95993997930213, 161.27493828155505, 150.4084958740674, 16.9061904800795, 174.0609351085456, 65.3177222222108, 40.18059620554051, 45.96722969785606, 13.729798362473387, 143.3186531971993, 102.96574696582009, 195.4617720830775, 82.79103368340043, 52.48991207705165, 228.51132223088294, 49.31321813797321, 242.27110544480618, 97.04670692239064, 31.896718289758315, 17.799304696209788, 39.37076363024457, 60.175426655794425, 144.10935563534915, 19.18527790394436, 114.45933069391148, 236.969463500009, 63.814502922247236, 77.7748510365711, 122.59967084804983, 63.94185573944852, 65.0133753447619, 37.56836110599107, 261.93049902777216, 50.2476144524483, 17.258424125722943, 15.706962692907645, 310.57082966544107, 24.22905607987891, 65.4405601818807, 87.98749999322501, 66.13858635808984, 13.871010605282573, 159.26972884857128, 256.8386744355947, 3.058341245744971, 40.105083726761684, 184.67701062824213, 97.68010937766772, 37.23263431469927, 144.2439057504245, 51.03042283799267, 33.65760192657859, 43.34509524346374, 36.13042430054999], "episode_lengths": [69, 7, 53, 104, 14, 36, 202, 7, 200, 146, 44, 22, 64, 59, 91, 33, 32, 53, 53, 146, 54, 30, 21, 54, 44, 7, 56, 63, 166, 79, 70, 54, 100, 108, 20, 120, 66, 16, 43, 85, 66, 55, 72, 52, 69, 54, 270, 201, 183, 21, 212, 74, 50, 53, 18, 174, 124, 236, 102, 60, 282, 60, 306, 116, 40, 24, 49, 74, 172, 25, 134, 295, 78, 97, 151, 77, 77, 44, 327, 62, 21, 20, 395, 31, 81, 110, 84, 18, 191, 317, 4, 49, 228, 120, 44, 178, 62, 42, 52, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 221.72094301168224, "mean_inference_ms": 676.1540285131621, "mean_action_processing_ms": 31.877182281082128, "mean_env_wait_ms": 3841.913298668606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4937305450439453, "StateBufferConnector_ms": 0.5426995754241943, "ViewRequirementAgentConnector_ms": 37.6667697429657}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 9.189384710802184, "num_env_steps_trained_throughput_per_sec": 9.189384710802184, "timesteps_total": 60000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 1072405.276, "sample_time_ms": 987111.135, "load_time_ms": 1968.698, "load_throughput": 5079.5, "learn_time_ms": 82113.678, "learn_throughput": 121.782, "synch_weights_time_ms": 1181.216}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 1953, "training_iteration": 6, "trial_id": "ef367_00000", "date": "2024-01-23_12-06-04", "timestamp": 1705982764, "time_this_iter_s": 1088.3717901706696, "time_total_s": 6435.520262479782, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 6435.520262479782, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 0.8002652519893899, "ram_util_percent": 20.09840848806366}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 9.518666633989056, "policy_loss": -0.019465491839517384, "vf_loss": 9.53491030921284, "vf_explained_var": -0.08424658556269785, "kl": 0.010739355951544637, "entropy": 2.492864152814588, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15210.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000}, "sampler_results": {"episode_reward_max": 464.9584847479494, "episode_reward_min": 3.058341245744971, "episode_reward_mean": 112.80672297008525, "episode_len_mean": 139.53, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.77966639920405, 16.515775190524216, 99.1376686257437, 54.61113812868132, 11.89899165804639, 35.21021649877259, 73.51837603419412, 52.39463137818475, 42.544295110503896, 58.999390203440555, 42.87900720103817, 54.19212826725448, 43.64174399121428, 215.95993997930213, 161.27493828155505, 150.4084958740674, 16.9061904800795, 174.0609351085456, 65.3177222222108, 40.18059620554051, 45.96722969785606, 13.729798362473387, 143.3186531971993, 102.96574696582009, 195.4617720830775, 82.79103368340043, 52.48991207705165, 228.51132223088294, 49.31321813797321, 242.27110544480618, 97.04670692239064, 31.896718289758315, 17.799304696209788, 39.37076363024457, 60.175426655794425, 144.10935563534915, 19.18527790394436, 114.45933069391148, 236.969463500009, 63.814502922247236, 77.7748510365711, 122.59967084804983, 63.94185573944852, 65.0133753447619, 37.56836110599107, 261.93049902777216, 50.2476144524483, 17.258424125722943, 15.706962692907645, 310.57082966544107, 24.22905607987891, 65.4405601818807, 87.98749999322501, 66.13858635808984, 13.871010605282573, 159.26972884857128, 256.8386744355947, 3.058341245744971, 40.105083726761684, 184.67701062824213, 97.68010937766772, 37.23263431469927, 144.2439057504245, 51.03042283799267, 33.65760192657859, 43.34509524346374, 36.13042430054999, 167.53746017044983, 78.2816110046141, 286.02624631820055, 47.68778068262619, 405.727735452302, 16.79871497722109, 253.78935546634906, 429.9993482441206, 6.2371200842143235, 96.79362401730742, 42.81434690426929, 24.55992157689412, 75.02625505089748, 75.91907870911136, 111.90500879599003, 259.5909692920024, 464.9584847479494, 321.33914631833136, 30.36026348572432, 35.704298170135935, 163.19918856376108, 246.81792961281351, 61.98601832511433, 39.71955127605861, 118.28540370731159, 75.7964899360799, 55.493190701240486, 192.95717427074314, 36.30145811265676, 299.0547973974663, 246.38754868519018, 294.1661813537289, 368.8239161353826], "episode_lengths": [108, 20, 120, 66, 16, 43, 85, 66, 55, 72, 52, 69, 54, 270, 201, 183, 21, 212, 74, 50, 53, 18, 174, 124, 236, 102, 60, 282, 60, 306, 116, 40, 24, 49, 74, 172, 25, 134, 295, 78, 97, 151, 77, 77, 44, 327, 62, 21, 20, 395, 31, 81, 110, 84, 18, 191, 317, 4, 49, 228, 120, 44, 178, 62, 42, 52, 43, 205, 94, 359, 54, 512, 20, 303, 556, 8, 117, 51, 29, 91, 93, 141, 326, 600, 405, 38, 43, 202, 305, 76, 49, 141, 89, 69, 229, 43, 381, 303, 364, 473]}, "sampler_perf": {"mean_raw_obs_processing_ms": 215.78990461891533, "mean_inference_ms": 675.8486748059945, "mean_action_processing_ms": 32.10191308534729, "mean_env_wait_ms": 3847.5967986061605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.0802323818206787, "StateBufferConnector_ms": 0.54345703125, "ViewRequirementAgentConnector_ms": 35.84546375274658}}, "episode_reward_max": 464.9584847479494, "episode_reward_min": 3.058341245744971, "episode_reward_mean": 112.80672297008525, "episode_len_mean": 139.53, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [91.77966639920405, 16.515775190524216, 99.1376686257437, 54.61113812868132, 11.89899165804639, 35.21021649877259, 73.51837603419412, 52.39463137818475, 42.544295110503896, 58.999390203440555, 42.87900720103817, 54.19212826725448, 43.64174399121428, 215.95993997930213, 161.27493828155505, 150.4084958740674, 16.9061904800795, 174.0609351085456, 65.3177222222108, 40.18059620554051, 45.96722969785606, 13.729798362473387, 143.3186531971993, 102.96574696582009, 195.4617720830775, 82.79103368340043, 52.48991207705165, 228.51132223088294, 49.31321813797321, 242.27110544480618, 97.04670692239064, 31.896718289758315, 17.799304696209788, 39.37076363024457, 60.175426655794425, 144.10935563534915, 19.18527790394436, 114.45933069391148, 236.969463500009, 63.814502922247236, 77.7748510365711, 122.59967084804983, 63.94185573944852, 65.0133753447619, 37.56836110599107, 261.93049902777216, 50.2476144524483, 17.258424125722943, 15.706962692907645, 310.57082966544107, 24.22905607987891, 65.4405601818807, 87.98749999322501, 66.13858635808984, 13.871010605282573, 159.26972884857128, 256.8386744355947, 3.058341245744971, 40.105083726761684, 184.67701062824213, 97.68010937766772, 37.23263431469927, 144.2439057504245, 51.03042283799267, 33.65760192657859, 43.34509524346374, 36.13042430054999, 167.53746017044983, 78.2816110046141, 286.02624631820055, 47.68778068262619, 405.727735452302, 16.79871497722109, 253.78935546634906, 429.9993482441206, 6.2371200842143235, 96.79362401730742, 42.81434690426929, 24.55992157689412, 75.02625505089748, 75.91907870911136, 111.90500879599003, 259.5909692920024, 464.9584847479494, 321.33914631833136, 30.36026348572432, 35.704298170135935, 163.19918856376108, 246.81792961281351, 61.98601832511433, 39.71955127605861, 118.28540370731159, 75.7964899360799, 55.493190701240486, 192.95717427074314, 36.30145811265676, 299.0547973974663, 246.38754868519018, 294.1661813537289, 368.8239161353826], "episode_lengths": [108, 20, 120, 66, 16, 43, 85, 66, 55, 72, 52, 69, 54, 270, 201, 183, 21, 212, 74, 50, 53, 18, 174, 124, 236, 102, 60, 282, 60, 306, 116, 40, 24, 49, 74, 172, 25, 134, 295, 78, 97, 151, 77, 77, 44, 327, 62, 21, 20, 395, 31, 81, 110, 84, 18, 191, 317, 4, 49, 228, 120, 44, 178, 62, 42, 52, 43, 205, 94, 359, 54, 512, 20, 303, 556, 8, 117, 51, 29, 91, 93, 141, 326, 600, 405, 38, 43, 202, 305, 76, 49, 141, 89, 69, 229, 43, 381, 303, 364, 473]}, "sampler_perf": {"mean_raw_obs_processing_ms": 215.78990461891533, "mean_inference_ms": 675.8486748059945, "mean_action_processing_ms": 32.10191308534729, "mean_env_wait_ms": 3847.5967986061605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.0802323818206787, "StateBufferConnector_ms": 0.54345703125, "ViewRequirementAgentConnector_ms": 35.84546375274658}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000, "num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 9.148962219228478, "num_env_steps_trained_throughput_per_sec": 9.148962219228478, "timesteps_total": 70000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 70000, "timers": {"training_iteration_time_ms": 1075350.248, "sample_time_ms": 989395.579, "load_time_ms": 1873.565, "load_throughput": 5337.419, "learn_time_ms": 82667.968, "learn_throughput": 120.966, "synch_weights_time_ms": 1381.723}, "counters": {"num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000}, "done": false, "episodes_total": 1986, "training_iteration": 7, "trial_id": "ef367_00000", "date": "2024-01-23_12-24-17", "timestamp": 1705983857, "time_this_iter_s": 1093.1777760982513, "time_total_s": 7528.698038578033, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 7528.698038578033, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 0.8003973509933774, "ram_util_percent": 20.58655629139073}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 9.86674046597929, "policy_loss": -0.015286004156447375, "vf_loss": 9.87893502875271, "vf_explained_var": -0.48483369429396767, "kl": 0.010304815873696676, "entropy": 2.479474335246616, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 17550.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 474.75035549922853, "episode_reward_min": 3.058341245744971, "episode_reward_mean": 160.1130813200661, "episode_len_mean": 199.98, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [242.27110544480618, 97.04670692239064, 31.896718289758315, 17.799304696209788, 39.37076363024457, 60.175426655794425, 144.10935563534915, 19.18527790394436, 114.45933069391148, 236.969463500009, 63.814502922247236, 77.7748510365711, 122.59967084804983, 63.94185573944852, 65.0133753447619, 37.56836110599107, 261.93049902777216, 50.2476144524483, 17.258424125722943, 15.706962692907645, 310.57082966544107, 24.22905607987891, 65.4405601818807, 87.98749999322501, 66.13858635808984, 13.871010605282573, 159.26972884857128, 256.8386744355947, 3.058341245744971, 40.105083726761684, 184.67701062824213, 97.68010937766772, 37.23263431469927, 144.2439057504245, 51.03042283799267, 33.65760192657859, 43.34509524346374, 36.13042430054999, 167.53746017044983, 78.2816110046141, 286.02624631820055, 47.68778068262619, 405.727735452302, 16.79871497722109, 253.78935546634906, 429.9993482441206, 6.2371200842143235, 96.79362401730742, 42.81434690426929, 24.55992157689412, 75.02625505089748, 75.91907870911136, 111.90500879599003, 259.5909692920024, 464.9584847479494, 321.33914631833136, 30.36026348572432, 35.704298170135935, 163.19918856376108, 246.81792961281351, 61.98601832511433, 39.71955127605861, 118.28540370731159, 75.7964899360799, 55.493190701240486, 192.95717427074314, 36.30145811265676, 299.0547973974663, 246.38754868519018, 294.1661813537289, 368.8239161353826, 462.69649596022265, 42.338530826309764, 467.73228859947926, 367.6556030991119, 333.4055297857853, 471.57194529600855, 82.88397685040911, 472.5131699232776, 143.8105391908259, 344.2422925647554, 106.7652218479524, 52.35975123459861, 220.05698631018868, 63.965314756136294, 143.63429422517302, 394.4585366564475, 467.0877757565069, 471.318253343196, 23.37176117050309, 111.26642505303204, 5.632203556273163, 59.37004634049316, 469.7697921691924, 266.98564264532047, 43.44823201486889, 100.81589612878022, 474.75035549922853, 10.394768111449832, 472.3147393563966], "episode_lengths": [306, 116, 40, 24, 49, 74, 172, 25, 134, 295, 78, 97, 151, 77, 77, 44, 327, 62, 21, 20, 395, 31, 81, 110, 84, 18, 191, 317, 4, 49, 228, 120, 44, 178, 62, 42, 52, 43, 205, 94, 359, 54, 512, 20, 303, 556, 8, 117, 51, 29, 91, 93, 141, 326, 600, 405, 38, 43, 202, 305, 76, 49, 141, 89, 69, 229, 43, 381, 303, 364, 473, 600, 51, 600, 463, 423, 600, 104, 600, 170, 420, 125, 66, 261, 76, 177, 497, 600, 600, 28, 133, 8, 69, 600, 336, 52, 118, 600, 14, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 210.31927691231434, "mean_inference_ms": 675.3565305242582, "mean_action_processing_ms": 32.35374504778921, "mean_env_wait_ms": 3859.8886721035633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.931286096572876, "StateBufferConnector_ms": 0.5443425178527832, "ViewRequirementAgentConnector_ms": 33.45833396911621}}, "episode_reward_max": 474.75035549922853, "episode_reward_min": 3.058341245744971, "episode_reward_mean": 160.1130813200661, "episode_len_mean": 199.98, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [242.27110544480618, 97.04670692239064, 31.896718289758315, 17.799304696209788, 39.37076363024457, 60.175426655794425, 144.10935563534915, 19.18527790394436, 114.45933069391148, 236.969463500009, 63.814502922247236, 77.7748510365711, 122.59967084804983, 63.94185573944852, 65.0133753447619, 37.56836110599107, 261.93049902777216, 50.2476144524483, 17.258424125722943, 15.706962692907645, 310.57082966544107, 24.22905607987891, 65.4405601818807, 87.98749999322501, 66.13858635808984, 13.871010605282573, 159.26972884857128, 256.8386744355947, 3.058341245744971, 40.105083726761684, 184.67701062824213, 97.68010937766772, 37.23263431469927, 144.2439057504245, 51.03042283799267, 33.65760192657859, 43.34509524346374, 36.13042430054999, 167.53746017044983, 78.2816110046141, 286.02624631820055, 47.68778068262619, 405.727735452302, 16.79871497722109, 253.78935546634906, 429.9993482441206, 6.2371200842143235, 96.79362401730742, 42.81434690426929, 24.55992157689412, 75.02625505089748, 75.91907870911136, 111.90500879599003, 259.5909692920024, 464.9584847479494, 321.33914631833136, 30.36026348572432, 35.704298170135935, 163.19918856376108, 246.81792961281351, 61.98601832511433, 39.71955127605861, 118.28540370731159, 75.7964899360799, 55.493190701240486, 192.95717427074314, 36.30145811265676, 299.0547973974663, 246.38754868519018, 294.1661813537289, 368.8239161353826, 462.69649596022265, 42.338530826309764, 467.73228859947926, 367.6556030991119, 333.4055297857853, 471.57194529600855, 82.88397685040911, 472.5131699232776, 143.8105391908259, 344.2422925647554, 106.7652218479524, 52.35975123459861, 220.05698631018868, 63.965314756136294, 143.63429422517302, 394.4585366564475, 467.0877757565069, 471.318253343196, 23.37176117050309, 111.26642505303204, 5.632203556273163, 59.37004634049316, 469.7697921691924, 266.98564264532047, 43.44823201486889, 100.81589612878022, 474.75035549922853, 10.394768111449832, 472.3147393563966], "episode_lengths": [306, 116, 40, 24, 49, 74, 172, 25, 134, 295, 78, 97, 151, 77, 77, 44, 327, 62, 21, 20, 395, 31, 81, 110, 84, 18, 191, 317, 4, 49, 228, 120, 44, 178, 62, 42, 52, 43, 205, 94, 359, 54, 512, 20, 303, 556, 8, 117, 51, 29, 91, 93, 141, 326, 600, 405, 38, 43, 202, 305, 76, 49, 141, 89, 69, 229, 43, 381, 303, 364, 473, 600, 51, 600, 463, 423, 600, 104, 600, 170, 420, 125, 66, 261, 76, 177, 497, 600, 600, 28, 133, 8, 69, 600, 336, 52, 118, 600, 14, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 210.31927691231434, "mean_inference_ms": 675.3565305242582, "mean_action_processing_ms": 32.35374504778921, "mean_env_wait_ms": 3859.8886721035633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.931286096572876, "StateBufferConnector_ms": 0.5443425178527832, "ViewRequirementAgentConnector_ms": 33.45833396911621}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.986545123847266, "num_env_steps_trained_throughput_per_sec": 8.986545123847266, "timesteps_total": 80000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 1080028.299, "sample_time_ms": 992054.77, "load_time_ms": 2018.746, "load_throughput": 4953.571, "learn_time_ms": 84600.021, "learn_throughput": 118.203, "synch_weights_time_ms": 1323.142}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 2015, "training_iteration": 8, "trial_id": "ef367_00000", "date": "2024-01-23_12-42-50", "timestamp": 1705984970, "time_this_iter_s": 1112.9264242649078, "time_total_s": 8641.624462842941, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 8641.624462842941, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 0.8001297016861219, "ram_util_percent": 20.656809338521402}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 9.941245111848554, "policy_loss": -0.01571662734127325, "vf_loss": 9.953932382917811, "vf_explained_var": -0.10801645428196997, "kl": 0.010097831050892963, "entropy": 2.441595779932462, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19890.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "sampler_results": {"episode_reward_max": 474.75035549922853, "episode_reward_min": 5.632203556273163, "episode_reward_mean": 222.01117257648514, "episode_len_mean": 278.9, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [97.68010937766772, 37.23263431469927, 144.2439057504245, 51.03042283799267, 33.65760192657859, 43.34509524346374, 36.13042430054999, 167.53746017044983, 78.2816110046141, 286.02624631820055, 47.68778068262619, 405.727735452302, 16.79871497722109, 253.78935546634906, 429.9993482441206, 6.2371200842143235, 96.79362401730742, 42.81434690426929, 24.55992157689412, 75.02625505089748, 75.91907870911136, 111.90500879599003, 259.5909692920024, 464.9584847479494, 321.33914631833136, 30.36026348572432, 35.704298170135935, 163.19918856376108, 246.81792961281351, 61.98601832511433, 39.71955127605861, 118.28540370731159, 75.7964899360799, 55.493190701240486, 192.95717427074314, 36.30145811265676, 299.0547973974663, 246.38754868519018, 294.1661813537289, 368.8239161353826, 462.69649596022265, 42.338530826309764, 467.73228859947926, 367.6556030991119, 333.4055297857853, 471.57194529600855, 82.88397685040911, 472.5131699232776, 143.8105391908259, 344.2422925647554, 106.7652218479524, 52.35975123459861, 220.05698631018868, 63.965314756136294, 143.63429422517302, 394.4585366564475, 467.0877757565069, 471.318253343196, 23.37176117050309, 111.26642505303204, 5.632203556273163, 59.37004634049316, 469.7697921691924, 266.98564264532047, 43.44823201486889, 100.81589612878022, 474.75035549922853, 10.394768111449832, 472.3147393563966, 470.6922695866203, 51.13996390018097, 105.31445154953495, 100.5144116141556, 252.71232591276015, 92.60263136652651, 181.9769098997233, 390.5103129580345, 471.9109668925751, 431.49138945802935, 95.64150196711958, 468.20361716011996, 360.4054901750614, 469.8948323973061, 468.2803782011653, 471.7816800532996, 128.30511850627155, 473.2540063748739, 467.52789686463035, 229.4503935388718, 364.83021946613565, 472.8388667035927, 471.2175097614236, 41.18813308002108, 469.11572231686256, 140.31973060850518, 78.02960932420821, 20.248080340145766, 467.28144719474983, 220.18759462459042, 254.26761628186435], "episode_lengths": [120, 44, 178, 62, 42, 52, 43, 205, 94, 359, 54, 512, 20, 303, 556, 8, 117, 51, 29, 91, 93, 141, 326, 600, 405, 38, 43, 202, 305, 76, 49, 141, 89, 69, 229, 43, 381, 303, 364, 473, 600, 51, 600, 463, 423, 600, 104, 600, 170, 420, 125, 66, 261, 76, 177, 497, 600, 600, 28, 133, 8, 69, 600, 336, 52, 118, 600, 14, 600, 600, 62, 131, 118, 319, 109, 223, 488, 600, 545, 117, 600, 458, 600, 600, 600, 152, 600, 600, 280, 465, 600, 600, 50, 600, 166, 91, 25, 600, 273, 317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 202.52958099962964, "mean_inference_ms": 675.0236998158305, "mean_action_processing_ms": 32.17754900278331, "mean_env_wait_ms": 3879.143202849902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.2618446350097656, "StateBufferConnector_ms": 1.0534188747406006, "ViewRequirementAgentConnector_ms": 25.669851541519165}}, "episode_reward_max": 474.75035549922853, "episode_reward_min": 5.632203556273163, "episode_reward_mean": 222.01117257648514, "episode_len_mean": 278.9, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [97.68010937766772, 37.23263431469927, 144.2439057504245, 51.03042283799267, 33.65760192657859, 43.34509524346374, 36.13042430054999, 167.53746017044983, 78.2816110046141, 286.02624631820055, 47.68778068262619, 405.727735452302, 16.79871497722109, 253.78935546634906, 429.9993482441206, 6.2371200842143235, 96.79362401730742, 42.81434690426929, 24.55992157689412, 75.02625505089748, 75.91907870911136, 111.90500879599003, 259.5909692920024, 464.9584847479494, 321.33914631833136, 30.36026348572432, 35.704298170135935, 163.19918856376108, 246.81792961281351, 61.98601832511433, 39.71955127605861, 118.28540370731159, 75.7964899360799, 55.493190701240486, 192.95717427074314, 36.30145811265676, 299.0547973974663, 246.38754868519018, 294.1661813537289, 368.8239161353826, 462.69649596022265, 42.338530826309764, 467.73228859947926, 367.6556030991119, 333.4055297857853, 471.57194529600855, 82.88397685040911, 472.5131699232776, 143.8105391908259, 344.2422925647554, 106.7652218479524, 52.35975123459861, 220.05698631018868, 63.965314756136294, 143.63429422517302, 394.4585366564475, 467.0877757565069, 471.318253343196, 23.37176117050309, 111.26642505303204, 5.632203556273163, 59.37004634049316, 469.7697921691924, 266.98564264532047, 43.44823201486889, 100.81589612878022, 474.75035549922853, 10.394768111449832, 472.3147393563966, 470.6922695866203, 51.13996390018097, 105.31445154953495, 100.5144116141556, 252.71232591276015, 92.60263136652651, 181.9769098997233, 390.5103129580345, 471.9109668925751, 431.49138945802935, 95.64150196711958, 468.20361716011996, 360.4054901750614, 469.8948323973061, 468.2803782011653, 471.7816800532996, 128.30511850627155, 473.2540063748739, 467.52789686463035, 229.4503935388718, 364.83021946613565, 472.8388667035927, 471.2175097614236, 41.18813308002108, 469.11572231686256, 140.31973060850518, 78.02960932420821, 20.248080340145766, 467.28144719474983, 220.18759462459042, 254.26761628186435], "episode_lengths": [120, 44, 178, 62, 42, 52, 43, 205, 94, 359, 54, 512, 20, 303, 556, 8, 117, 51, 29, 91, 93, 141, 326, 600, 405, 38, 43, 202, 305, 76, 49, 141, 89, 69, 229, 43, 381, 303, 364, 473, 600, 51, 600, 463, 423, 600, 104, 600, 170, 420, 125, 66, 261, 76, 177, 497, 600, 600, 28, 133, 8, 69, 600, 336, 52, 118, 600, 14, 600, 600, 62, 131, 118, 319, 109, 223, 488, 600, 545, 117, 600, 458, 600, 600, 600, 152, 600, 600, 280, 465, 600, 600, 50, 600, 166, 91, 25, 600, 273, 317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 202.52958099962964, "mean_inference_ms": 675.0236998158305, "mean_action_processing_ms": 32.17754900278331, "mean_env_wait_ms": 3879.143202849902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.2618446350097656, "StateBufferConnector_ms": 1.0534188747406006, "ViewRequirementAgentConnector_ms": 25.669851541519165}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 9.01488002914722, "num_env_steps_trained_throughput_per_sec": 9.01488002914722, "timesteps_total": 90000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 1083278.161, "sample_time_ms": 994426.799, "load_time_ms": 1952.42, "load_throughput": 5121.849, "learn_time_ms": 85602.105, "learn_throughput": 116.82, "synch_weights_time_ms": 1264.562}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "episodes_total": 2046, "training_iteration": 9, "trial_id": "ef367_00000", "date": "2024-01-23_13-01-20", "timestamp": 1705986080, "time_this_iter_s": 1109.4028499126434, "time_total_s": 9751.027312755585, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 9751.027312755585, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 0.8005825242718447, "ram_util_percent": 20.641812297734628}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 9.806249450210831, "policy_loss": -0.013616632323107149, "vf_loss": 9.817030457146148, "vf_explained_var": -0.37498294779887564, "kl": 0.009452139152197824, "entropy": 2.4576680285298926, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 22230.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 477.43504136016514, "episode_reward_min": 4.589477787872343, "episode_reward_mean": 236.56937393195392, "episode_len_mean": 297.13, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.338530826309764, 467.73228859947926, 367.6556030991119, 333.4055297857853, 471.57194529600855, 82.88397685040911, 472.5131699232776, 143.8105391908259, 344.2422925647554, 106.7652218479524, 52.35975123459861, 220.05698631018868, 63.965314756136294, 143.63429422517302, 394.4585366564475, 467.0877757565069, 471.318253343196, 23.37176117050309, 111.26642505303204, 5.632203556273163, 59.37004634049316, 469.7697921691924, 266.98564264532047, 43.44823201486889, 100.81589612878022, 474.75035549922853, 10.394768111449832, 472.3147393563966, 470.6922695866203, 51.13996390018097, 105.31445154953495, 100.5144116141556, 252.71232591276015, 92.60263136652651, 181.9769098997233, 390.5103129580345, 471.9109668925751, 431.49138945802935, 95.64150196711958, 468.20361716011996, 360.4054901750614, 469.8948323973061, 468.2803782011653, 471.7816800532996, 128.30511850627155, 473.2540063748739, 467.52789686463035, 229.4503935388718, 364.83021946613565, 472.8388667035927, 471.2175097614236, 41.18813308002108, 469.11572231686256, 140.31973060850518, 78.02960932420821, 20.248080340145766, 467.28144719474983, 220.18759462459042, 254.26761628186435, 146.6895825880251, 39.12487007010172, 39.02607672866436, 167.13960315482709, 68.29164057223966, 473.5217055273606, 75.23058366203473, 293.57720085826577, 430.4696301765467, 308.87590948620635, 56.4523653314067, 43.83382561213538, 9.441160195074417, 66.90908124871895, 247.96248406284343, 467.4875067934737, 41.2187589820706, 471.29256600746965, 477.43504136016514, 470.9055342678632, 468.6006578694812, 83.52579475274878, 4.589477787872343, 5.351728071683602, 474.3823886685895, 73.27088799305292, 71.69579808538768, 471.70770746564733, 469.0291825545, 43.040701315572996, 92.98628210653088, 32.05531843579192, 92.52217246930294, 467.6218514697704, 42.90275713382166, 8.608263414751967, 77.27998403220631, 162.00501093284788, 56.06966638964932, 159.39385625200788, 40.35782891802338], "episode_lengths": [51, 600, 463, 423, 600, 104, 600, 170, 420, 125, 66, 261, 76, 177, 497, 600, 600, 28, 133, 8, 69, 600, 336, 52, 118, 600, 14, 600, 600, 62, 131, 118, 319, 109, 223, 488, 600, 545, 117, 600, 458, 600, 600, 600, 152, 600, 600, 280, 465, 600, 600, 50, 600, 166, 91, 25, 600, 273, 317, 175, 47, 48, 194, 80, 600, 90, 369, 552, 376, 65, 53, 13, 75, 306, 600, 47, 600, 600, 600, 600, 101, 6, 7, 600, 88, 84, 600, 600, 54, 109, 39, 104, 600, 50, 11, 90, 198, 67, 187, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 196.55343219847663, "mean_inference_ms": 677.2341121496448, "mean_action_processing_ms": 31.892827183041234, "mean_env_wait_ms": 3905.1403882271484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.7079768180847168, "StateBufferConnector_ms": 1.050868272781372, "ViewRequirementAgentConnector_ms": 26.05917525291443}}, "episode_reward_max": 477.43504136016514, "episode_reward_min": 4.589477787872343, "episode_reward_mean": 236.56937393195392, "episode_len_mean": 297.13, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.338530826309764, 467.73228859947926, 367.6556030991119, 333.4055297857853, 471.57194529600855, 82.88397685040911, 472.5131699232776, 143.8105391908259, 344.2422925647554, 106.7652218479524, 52.35975123459861, 220.05698631018868, 63.965314756136294, 143.63429422517302, 394.4585366564475, 467.0877757565069, 471.318253343196, 23.37176117050309, 111.26642505303204, 5.632203556273163, 59.37004634049316, 469.7697921691924, 266.98564264532047, 43.44823201486889, 100.81589612878022, 474.75035549922853, 10.394768111449832, 472.3147393563966, 470.6922695866203, 51.13996390018097, 105.31445154953495, 100.5144116141556, 252.71232591276015, 92.60263136652651, 181.9769098997233, 390.5103129580345, 471.9109668925751, 431.49138945802935, 95.64150196711958, 468.20361716011996, 360.4054901750614, 469.8948323973061, 468.2803782011653, 471.7816800532996, 128.30511850627155, 473.2540063748739, 467.52789686463035, 229.4503935388718, 364.83021946613565, 472.8388667035927, 471.2175097614236, 41.18813308002108, 469.11572231686256, 140.31973060850518, 78.02960932420821, 20.248080340145766, 467.28144719474983, 220.18759462459042, 254.26761628186435, 146.6895825880251, 39.12487007010172, 39.02607672866436, 167.13960315482709, 68.29164057223966, 473.5217055273606, 75.23058366203473, 293.57720085826577, 430.4696301765467, 308.87590948620635, 56.4523653314067, 43.83382561213538, 9.441160195074417, 66.90908124871895, 247.96248406284343, 467.4875067934737, 41.2187589820706, 471.29256600746965, 477.43504136016514, 470.9055342678632, 468.6006578694812, 83.52579475274878, 4.589477787872343, 5.351728071683602, 474.3823886685895, 73.27088799305292, 71.69579808538768, 471.70770746564733, 469.0291825545, 43.040701315572996, 92.98628210653088, 32.05531843579192, 92.52217246930294, 467.6218514697704, 42.90275713382166, 8.608263414751967, 77.27998403220631, 162.00501093284788, 56.06966638964932, 159.39385625200788, 40.35782891802338], "episode_lengths": [51, 600, 463, 423, 600, 104, 600, 170, 420, 125, 66, 261, 76, 177, 497, 600, 600, 28, 133, 8, 69, 600, 336, 52, 118, 600, 14, 600, 600, 62, 131, 118, 319, 109, 223, 488, 600, 545, 117, 600, 458, 600, 600, 600, 152, 600, 600, 280, 465, 600, 600, 50, 600, 166, 91, 25, 600, 273, 317, 175, 47, 48, 194, 80, 600, 90, 369, 552, 376, 65, 53, 13, 75, 306, 600, 47, 600, 600, 600, 600, 101, 6, 7, 600, 88, 84, 600, 600, 54, 109, 39, 104, 600, 50, 11, 90, 198, 67, 187, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 196.55343219847663, "mean_inference_ms": 677.2341121496448, "mean_action_processing_ms": 31.892827183041234, "mean_env_wait_ms": 3905.1403882271484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.7079768180847168, "StateBufferConnector_ms": 1.050868272781372, "ViewRequirementAgentConnector_ms": 26.05917525291443}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.95692944579077, "num_env_steps_trained_throughput_per_sec": 8.95692944579077, "timesteps_total": 100000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 1086595.744, "sample_time_ms": 996867.279, "load_time_ms": 1890.001, "load_throughput": 5291.004, "learn_time_ms": 86567.494, "learn_throughput": 115.517, "synch_weights_time_ms": 1238.604}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 2087, "training_iteration": 10, "trial_id": "ef367_00000", "date": "2024-01-23_13-19-56", "timestamp": 1705987196, "time_this_iter_s": 1116.620573759079, "time_total_s": 10867.647886514664, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 10867.647886514664, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 0.8003883495145631, "ram_util_percent": 20.672297734627833}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 9.158088787804301, "policy_loss": -0.01612598900165823, "vf_loss": 9.171623847015903, "vf_explained_var": -0.06950984182011367, "kl": 0.008636386499645782, "entropy": 2.42056343463751, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24570.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_agent_steps_sampled": 110000, "num_agent_steps_trained": 110000}, "sampler_results": {"episode_reward_max": 477.43504136016514, "episode_reward_min": 3.779710158178037, "episode_reward_mean": 252.96275159075245, "episode_len_mean": 318.21, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [266.98564264532047, 43.44823201486889, 100.81589612878022, 474.75035549922853, 10.394768111449832, 472.3147393563966, 470.6922695866203, 51.13996390018097, 105.31445154953495, 100.5144116141556, 252.71232591276015, 92.60263136652651, 181.9769098997233, 390.5103129580345, 471.9109668925751, 431.49138945802935, 95.64150196711958, 468.20361716011996, 360.4054901750614, 469.8948323973061, 468.2803782011653, 471.7816800532996, 128.30511850627155, 473.2540063748739, 467.52789686463035, 229.4503935388718, 364.83021946613565, 472.8388667035927, 471.2175097614236, 41.18813308002108, 469.11572231686256, 140.31973060850518, 78.02960932420821, 20.248080340145766, 467.28144719474983, 220.18759462459042, 254.26761628186435, 146.6895825880251, 39.12487007010172, 39.02607672866436, 167.13960315482709, 68.29164057223966, 473.5217055273606, 75.23058366203473, 293.57720085826577, 430.4696301765467, 308.87590948620635, 56.4523653314067, 43.83382561213538, 9.441160195074417, 66.90908124871895, 247.96248406284343, 467.4875067934737, 41.2187589820706, 471.29256600746965, 477.43504136016514, 470.9055342678632, 468.6006578694812, 83.52579475274878, 4.589477787872343, 5.351728071683602, 474.3823886685895, 73.27088799305292, 71.69579808538768, 471.70770746564733, 469.0291825545, 43.040701315572996, 92.98628210653088, 32.05531843579192, 92.52217246930294, 467.6218514697704, 42.90275713382166, 8.608263414751967, 77.27998403220631, 162.00501093284788, 56.06966638964932, 159.39385625200788, 40.35782891802338, 474.93820133733095, 466.0946215314428, 180.26755669921346, 471.8581125523442, 53.5207152049085, 469.3553770218814, 71.87219498875102, 473.3487092325896, 466.13587561255343, 29.780445304349477, 68.49858375961091, 469.6125783762365, 469.95734198764, 6.522348872263889, 238.08239294612915, 470.9083210964535, 474.33841185720564, 469.4057132316147, 471.1942944536922, 322.54576234460166, 332.53073586651414, 3.779710158178037], "episode_lengths": [336, 52, 118, 600, 14, 600, 600, 62, 131, 118, 319, 109, 223, 488, 600, 545, 117, 600, 458, 600, 600, 600, 152, 600, 600, 280, 465, 600, 600, 50, 600, 166, 91, 25, 600, 273, 317, 175, 47, 48, 194, 80, 600, 90, 369, 552, 376, 65, 53, 13, 75, 306, 600, 47, 600, 600, 600, 600, 101, 6, 7, 600, 88, 84, 600, 600, 54, 109, 39, 104, 600, 50, 11, 90, 198, 67, 187, 48, 600, 600, 218, 600, 64, 600, 87, 600, 600, 36, 79, 600, 600, 8, 293, 600, 600, 600, 600, 379, 410, 5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 193.63507727901617, "mean_inference_ms": 678.2827895848658, "mean_action_processing_ms": 32.067750592408856, "mean_env_wait_ms": 3914.303592875142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.199077844619751, "StateBufferConnector_ms": 1.940197229385376, "ViewRequirementAgentConnector_ms": 23.596664905548096}}, "episode_reward_max": 477.43504136016514, "episode_reward_min": 3.779710158178037, "episode_reward_mean": 252.96275159075245, "episode_len_mean": 318.21, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [266.98564264532047, 43.44823201486889, 100.81589612878022, 474.75035549922853, 10.394768111449832, 472.3147393563966, 470.6922695866203, 51.13996390018097, 105.31445154953495, 100.5144116141556, 252.71232591276015, 92.60263136652651, 181.9769098997233, 390.5103129580345, 471.9109668925751, 431.49138945802935, 95.64150196711958, 468.20361716011996, 360.4054901750614, 469.8948323973061, 468.2803782011653, 471.7816800532996, 128.30511850627155, 473.2540063748739, 467.52789686463035, 229.4503935388718, 364.83021946613565, 472.8388667035927, 471.2175097614236, 41.18813308002108, 469.11572231686256, 140.31973060850518, 78.02960932420821, 20.248080340145766, 467.28144719474983, 220.18759462459042, 254.26761628186435, 146.6895825880251, 39.12487007010172, 39.02607672866436, 167.13960315482709, 68.29164057223966, 473.5217055273606, 75.23058366203473, 293.57720085826577, 430.4696301765467, 308.87590948620635, 56.4523653314067, 43.83382561213538, 9.441160195074417, 66.90908124871895, 247.96248406284343, 467.4875067934737, 41.2187589820706, 471.29256600746965, 477.43504136016514, 470.9055342678632, 468.6006578694812, 83.52579475274878, 4.589477787872343, 5.351728071683602, 474.3823886685895, 73.27088799305292, 71.69579808538768, 471.70770746564733, 469.0291825545, 43.040701315572996, 92.98628210653088, 32.05531843579192, 92.52217246930294, 467.6218514697704, 42.90275713382166, 8.608263414751967, 77.27998403220631, 162.00501093284788, 56.06966638964932, 159.39385625200788, 40.35782891802338, 474.93820133733095, 466.0946215314428, 180.26755669921346, 471.8581125523442, 53.5207152049085, 469.3553770218814, 71.87219498875102, 473.3487092325896, 466.13587561255343, 29.780445304349477, 68.49858375961091, 469.6125783762365, 469.95734198764, 6.522348872263889, 238.08239294612915, 470.9083210964535, 474.33841185720564, 469.4057132316147, 471.1942944536922, 322.54576234460166, 332.53073586651414, 3.779710158178037], "episode_lengths": [336, 52, 118, 600, 14, 600, 600, 62, 131, 118, 319, 109, 223, 488, 600, 545, 117, 600, 458, 600, 600, 600, 152, 600, 600, 280, 465, 600, 600, 50, 600, 166, 91, 25, 600, 273, 317, 175, 47, 48, 194, 80, 600, 90, 369, 552, 376, 65, 53, 13, 75, 306, 600, 47, 600, 600, 600, 600, 101, 6, 7, 600, 88, 84, 600, 600, 54, 109, 39, 104, 600, 50, 11, 90, 198, 67, 187, 48, 600, 600, 218, 600, 64, 600, 87, 600, 600, 36, 79, 600, 600, 8, 293, 600, 600, 600, 600, 379, 410, 5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 193.63507727901617, "mean_inference_ms": 678.2827895848658, "mean_action_processing_ms": 32.067750592408856, "mean_env_wait_ms": 3914.303592875142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.199077844619751, "StateBufferConnector_ms": 1.940197229385376, "ViewRequirementAgentConnector_ms": 23.596664905548096}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110000, "num_agent_steps_trained": 110000, "num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.897788865151274, "num_env_steps_trained_throughput_per_sec": 8.897788865151274, "timesteps_total": 110000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 110000, "timers": {"training_iteration_time_ms": 1092813.479, "sample_time_ms": 1000776.796, "load_time_ms": 1790.022, "load_throughput": 5586.523, "learn_time_ms": 88983.616, "learn_throughput": 112.38, "synch_weights_time_ms": 1230.528}, "counters": {"num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_agent_steps_sampled": 110000, "num_agent_steps_trained": 110000}, "done": false, "episodes_total": 2109, "training_iteration": 11, "trial_id": "ef367_00000", "date": "2024-01-23_13-38-40", "timestamp": 1705988320, "time_this_iter_s": 1124.0107419490814, "time_total_s": 11991.658628463745, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 11991.658628463745, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 0.8003843689942345, "ram_util_percent": 20.87783472133248}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 8.257435612189465, "policy_loss": -0.017100189574078745, "vf_loss": 8.271662842616056, "vf_explained_var": -0.04789882332850725, "kl": 0.009576517391872033, "entropy": 2.3842417158632196, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 26910.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 478.9209025424309, "episode_reward_min": 3.779710158178037, "episode_reward_mean": 263.2212886253076, "episode_len_mean": 331.08, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [468.2803782011653, 471.7816800532996, 128.30511850627155, 473.2540063748739, 467.52789686463035, 229.4503935388718, 364.83021946613565, 472.8388667035927, 471.2175097614236, 41.18813308002108, 469.11572231686256, 140.31973060850518, 78.02960932420821, 20.248080340145766, 467.28144719474983, 220.18759462459042, 254.26761628186435, 146.6895825880251, 39.12487007010172, 39.02607672866436, 167.13960315482709, 68.29164057223966, 473.5217055273606, 75.23058366203473, 293.57720085826577, 430.4696301765467, 308.87590948620635, 56.4523653314067, 43.83382561213538, 9.441160195074417, 66.90908124871895, 247.96248406284343, 467.4875067934737, 41.2187589820706, 471.29256600746965, 477.43504136016514, 470.9055342678632, 468.6006578694812, 83.52579475274878, 4.589477787872343, 5.351728071683602, 474.3823886685895, 73.27088799305292, 71.69579808538768, 471.70770746564733, 469.0291825545, 43.040701315572996, 92.98628210653088, 32.05531843579192, 92.52217246930294, 467.6218514697704, 42.90275713382166, 8.608263414751967, 77.27998403220631, 162.00501093284788, 56.06966638964932, 159.39385625200788, 40.35782891802338, 474.93820133733095, 466.0946215314428, 180.26755669921346, 471.8581125523442, 53.5207152049085, 469.3553770218814, 71.87219498875102, 473.3487092325896, 466.13587561255343, 29.780445304349477, 68.49858375961091, 469.6125783762365, 469.95734198764, 6.522348872263889, 238.08239294612915, 470.9083210964535, 474.33841185720564, 469.4057132316147, 471.1942944536922, 322.54576234460166, 332.53073586651414, 3.779710158178037, 475.49063701567985, 334.8612054009008, 46.60398563175686, 394.57168619821516, 473.7272475165868, 83.75878670757052, 189.21920051683028, 478.9209025424309, 25.774387009727683, 478.59696268669353, 303.80353530536837, 78.22471250095633, 469.2907671542626, 469.6652686432428, 467.5863492829185, 94.37750120143052, 55.43893859172227, 476.4480533972359, 470.4591272976901, 470.7551574480864], "episode_lengths": [600, 600, 152, 600, 600, 280, 465, 600, 600, 50, 600, 166, 91, 25, 600, 273, 317, 175, 47, 48, 194, 80, 600, 90, 369, 552, 376, 65, 53, 13, 75, 306, 600, 47, 600, 600, 600, 600, 101, 6, 7, 600, 88, 84, 600, 600, 54, 109, 39, 104, 600, 50, 11, 90, 198, 67, 187, 48, 600, 600, 218, 600, 64, 600, 87, 600, 600, 36, 79, 600, 600, 8, 293, 600, 600, 600, 600, 379, 410, 5, 600, 414, 54, 494, 600, 100, 228, 600, 31, 600, 380, 94, 600, 600, 600, 115, 67, 600, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 190.75356226700373, "mean_inference_ms": 678.9344067515135, "mean_action_processing_ms": 31.940177312743437, "mean_env_wait_ms": 3930.702464372919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.6920592784881592, "StateBufferConnector_ms": 2.348266839981079, "ViewRequirementAgentConnector_ms": 27.16584062576294}}, "episode_reward_max": 478.9209025424309, "episode_reward_min": 3.779710158178037, "episode_reward_mean": 263.2212886253076, "episode_len_mean": 331.08, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [468.2803782011653, 471.7816800532996, 128.30511850627155, 473.2540063748739, 467.52789686463035, 229.4503935388718, 364.83021946613565, 472.8388667035927, 471.2175097614236, 41.18813308002108, 469.11572231686256, 140.31973060850518, 78.02960932420821, 20.248080340145766, 467.28144719474983, 220.18759462459042, 254.26761628186435, 146.6895825880251, 39.12487007010172, 39.02607672866436, 167.13960315482709, 68.29164057223966, 473.5217055273606, 75.23058366203473, 293.57720085826577, 430.4696301765467, 308.87590948620635, 56.4523653314067, 43.83382561213538, 9.441160195074417, 66.90908124871895, 247.96248406284343, 467.4875067934737, 41.2187589820706, 471.29256600746965, 477.43504136016514, 470.9055342678632, 468.6006578694812, 83.52579475274878, 4.589477787872343, 5.351728071683602, 474.3823886685895, 73.27088799305292, 71.69579808538768, 471.70770746564733, 469.0291825545, 43.040701315572996, 92.98628210653088, 32.05531843579192, 92.52217246930294, 467.6218514697704, 42.90275713382166, 8.608263414751967, 77.27998403220631, 162.00501093284788, 56.06966638964932, 159.39385625200788, 40.35782891802338, 474.93820133733095, 466.0946215314428, 180.26755669921346, 471.8581125523442, 53.5207152049085, 469.3553770218814, 71.87219498875102, 473.3487092325896, 466.13587561255343, 29.780445304349477, 68.49858375961091, 469.6125783762365, 469.95734198764, 6.522348872263889, 238.08239294612915, 470.9083210964535, 474.33841185720564, 469.4057132316147, 471.1942944536922, 322.54576234460166, 332.53073586651414, 3.779710158178037, 475.49063701567985, 334.8612054009008, 46.60398563175686, 394.57168619821516, 473.7272475165868, 83.75878670757052, 189.21920051683028, 478.9209025424309, 25.774387009727683, 478.59696268669353, 303.80353530536837, 78.22471250095633, 469.2907671542626, 469.6652686432428, 467.5863492829185, 94.37750120143052, 55.43893859172227, 476.4480533972359, 470.4591272976901, 470.7551574480864], "episode_lengths": [600, 600, 152, 600, 600, 280, 465, 600, 600, 50, 600, 166, 91, 25, 600, 273, 317, 175, 47, 48, 194, 80, 600, 90, 369, 552, 376, 65, 53, 13, 75, 306, 600, 47, 600, 600, 600, 600, 101, 6, 7, 600, 88, 84, 600, 600, 54, 109, 39, 104, 600, 50, 11, 90, 198, 67, 187, 48, 600, 600, 218, 600, 64, 600, 87, 600, 600, 36, 79, 600, 600, 8, 293, 600, 600, 600, 600, 379, 410, 5, 600, 414, 54, 494, 600, 100, 228, 600, 31, 600, 380, 94, 600, 600, 600, 115, 67, 600, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 190.75356226700373, "mean_inference_ms": 678.9344067515135, "mean_action_processing_ms": 31.940177312743437, "mean_env_wait_ms": 3930.702464372919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.6920592784881592, "StateBufferConnector_ms": 2.348266839981079, "ViewRequirementAgentConnector_ms": 27.16584062576294}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.784269975445273, "num_env_steps_trained_throughput_per_sec": 8.784269975445273, "timesteps_total": 120000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 1100409.315, "sample_time_ms": 1006529.551, "load_time_ms": 1864.79, "load_throughput": 5362.535, "learn_time_ms": 90758.807, "learn_throughput": 110.182, "synch_weights_time_ms": 1224.962}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 2129, "training_iteration": 12, "trial_id": "ef367_00000", "date": "2024-01-23_13-57-39", "timestamp": 1705989459, "time_this_iter_s": 1138.5213403701782, "time_total_s": 13130.179968833923, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 13130.179968833923, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 0.8001266624445852, "ram_util_percent": 20.87542748575047}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 9.968913249887972, "policy_loss": -0.01750016285894582, "vf_loss": 9.982831081365928, "vf_explained_var": -0.2831754265942125, "kl": 0.011941050943903641, "entropy": 2.409813790851169, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29250.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_agent_steps_sampled": 130000, "num_agent_steps_trained": 130000}, "sampler_results": {"episode_reward_max": 480.90396863102666, "episode_reward_min": 3.779710158178037, "episode_reward_mean": 289.9443958767374, "episode_len_mean": 364.87, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [247.96248406284343, 467.4875067934737, 41.2187589820706, 471.29256600746965, 477.43504136016514, 470.9055342678632, 468.6006578694812, 83.52579475274878, 4.589477787872343, 5.351728071683602, 474.3823886685895, 73.27088799305292, 71.69579808538768, 471.70770746564733, 469.0291825545, 43.040701315572996, 92.98628210653088, 32.05531843579192, 92.52217246930294, 467.6218514697704, 42.90275713382166, 8.608263414751967, 77.27998403220631, 162.00501093284788, 56.06966638964932, 159.39385625200788, 40.35782891802338, 474.93820133733095, 466.0946215314428, 180.26755669921346, 471.8581125523442, 53.5207152049085, 469.3553770218814, 71.87219498875102, 473.3487092325896, 466.13587561255343, 29.780445304349477, 68.49858375961091, 469.6125783762365, 469.95734198764, 6.522348872263889, 238.08239294612915, 470.9083210964535, 474.33841185720564, 469.4057132316147, 471.1942944536922, 322.54576234460166, 332.53073586651414, 3.779710158178037, 475.49063701567985, 334.8612054009008, 46.60398563175686, 394.57168619821516, 473.7272475165868, 83.75878670757052, 189.21920051683028, 478.9209025424309, 25.774387009727683, 478.59696268669353, 303.80353530536837, 78.22471250095633, 469.2907671542626, 469.6652686432428, 467.5863492829185, 94.37750120143052, 55.43893859172227, 476.4480533972359, 470.4591272976901, 470.7551574480864, 475.6834059657661, 480.90396863102666, 34.13508387013024, 158.489577427948, 473.8347392354281, 477.4946741493238, 5.438897856245466, 473.6801872052643, 473.8702767834901, 468.3212387874887, 469.9963204077078, 474.192198976589, 472.71546432681794, 471.2425010266827, 30.126214530662534, 54.14498558868956, 110.33608510765322, 478.3582379321898, 48.37575552978559, 477.25592590346605, 40.552304217963226, 95.9615604058118, 473.56979514412456, 469.75595919887223, 96.46358860200836, 474.0249695005355, 469.92569354904316, 469.9278610811087, 72.47476199542277, 477.58286311756433, 380.1828675409935], "episode_lengths": [306, 600, 47, 600, 600, 600, 600, 101, 6, 7, 600, 88, 84, 600, 600, 54, 109, 39, 104, 600, 50, 11, 90, 198, 67, 187, 48, 600, 600, 218, 600, 64, 600, 87, 600, 600, 36, 79, 600, 600, 8, 293, 600, 600, 600, 600, 379, 410, 5, 600, 414, 54, 494, 600, 100, 228, 600, 31, 600, 380, 94, 600, 600, 600, 115, 67, 600, 600, 600, 600, 600, 39, 183, 600, 600, 7, 600, 600, 600, 600, 600, 600, 600, 35, 62, 128, 600, 57, 600, 47, 112, 600, 600, 113, 600, 600, 600, 83, 600, 469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 187.89466445321054, "mean_inference_ms": 680.1047654583293, "mean_action_processing_ms": 32.37786565977942, "mean_env_wait_ms": 3943.536001505459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.3591415882110596, "StateBufferConnector_ms": 2.3221113681793213, "ViewRequirementAgentConnector_ms": 28.676044464111328}}, "episode_reward_max": 480.90396863102666, "episode_reward_min": 3.779710158178037, "episode_reward_mean": 289.9443958767374, "episode_len_mean": 364.87, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [247.96248406284343, 467.4875067934737, 41.2187589820706, 471.29256600746965, 477.43504136016514, 470.9055342678632, 468.6006578694812, 83.52579475274878, 4.589477787872343, 5.351728071683602, 474.3823886685895, 73.27088799305292, 71.69579808538768, 471.70770746564733, 469.0291825545, 43.040701315572996, 92.98628210653088, 32.05531843579192, 92.52217246930294, 467.6218514697704, 42.90275713382166, 8.608263414751967, 77.27998403220631, 162.00501093284788, 56.06966638964932, 159.39385625200788, 40.35782891802338, 474.93820133733095, 466.0946215314428, 180.26755669921346, 471.8581125523442, 53.5207152049085, 469.3553770218814, 71.87219498875102, 473.3487092325896, 466.13587561255343, 29.780445304349477, 68.49858375961091, 469.6125783762365, 469.95734198764, 6.522348872263889, 238.08239294612915, 470.9083210964535, 474.33841185720564, 469.4057132316147, 471.1942944536922, 322.54576234460166, 332.53073586651414, 3.779710158178037, 475.49063701567985, 334.8612054009008, 46.60398563175686, 394.57168619821516, 473.7272475165868, 83.75878670757052, 189.21920051683028, 478.9209025424309, 25.774387009727683, 478.59696268669353, 303.80353530536837, 78.22471250095633, 469.2907671542626, 469.6652686432428, 467.5863492829185, 94.37750120143052, 55.43893859172227, 476.4480533972359, 470.4591272976901, 470.7551574480864, 475.6834059657661, 480.90396863102666, 34.13508387013024, 158.489577427948, 473.8347392354281, 477.4946741493238, 5.438897856245466, 473.6801872052643, 473.8702767834901, 468.3212387874887, 469.9963204077078, 474.192198976589, 472.71546432681794, 471.2425010266827, 30.126214530662534, 54.14498558868956, 110.33608510765322, 478.3582379321898, 48.37575552978559, 477.25592590346605, 40.552304217963226, 95.9615604058118, 473.56979514412456, 469.75595919887223, 96.46358860200836, 474.0249695005355, 469.92569354904316, 469.9278610811087, 72.47476199542277, 477.58286311756433, 380.1828675409935], "episode_lengths": [306, 600, 47, 600, 600, 600, 600, 101, 6, 7, 600, 88, 84, 600, 600, 54, 109, 39, 104, 600, 50, 11, 90, 198, 67, 187, 48, 600, 600, 218, 600, 64, 600, 87, 600, 600, 36, 79, 600, 600, 8, 293, 600, 600, 600, 600, 379, 410, 5, 600, 414, 54, 494, 600, 100, 228, 600, 31, 600, 380, 94, 600, 600, 600, 115, 67, 600, 600, 600, 600, 600, 39, 183, 600, 600, 7, 600, 600, 600, 600, 600, 600, 600, 35, 62, 128, 600, 57, 600, 47, 112, 600, 600, 113, 600, 600, 600, 83, 600, 469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 187.89466445321054, "mean_inference_ms": 680.1047654583293, "mean_action_processing_ms": 32.37786565977942, "mean_env_wait_ms": 3943.536001505459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.3591415882110596, "StateBufferConnector_ms": 2.3221113681793213, "ViewRequirementAgentConnector_ms": 28.676044464111328}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 130000, "num_agent_steps_trained": 130000, "num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.749515499665772, "num_env_steps_trained_throughput_per_sec": 8.749515499665772, "timesteps_total": 130000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 130000, "timers": {"training_iteration_time_ms": 1108395.256, "sample_time_ms": 1012812.275, "load_time_ms": 1989.888, "load_throughput": 5025.408, "learn_time_ms": 92477.01, "learn_throughput": 108.135, "synch_weights_time_ms": 1084.847}, "counters": {"num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_agent_steps_sampled": 130000, "num_agent_steps_trained": 130000}, "done": false, "episodes_total": 2160, "training_iteration": 13, "trial_id": "ef367_00000", "date": "2024-01-23_14-16-43", "timestamp": 1705990603, "time_this_iter_s": 1143.9518947601318, "time_total_s": 14274.131863594055, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 14274.131863594055, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 0.8003150598613737, "ram_util_percent": 20.761751732829243}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 9.972447462774749, "policy_loss": -0.015059828608193332, "vf_loss": 9.984002623395023, "vf_explained_var": -0.31712293879598635, "kl": 0.011682208234116033, "entropy": 2.4306888150353716, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 31590.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 480.90396863102666, "episode_reward_min": 3.779710158178037, "episode_reward_mean": 309.64137553974246, "episode_len_mean": 389.84, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.05531843579192, 92.52217246930294, 467.6218514697704, 42.90275713382166, 8.608263414751967, 77.27998403220631, 162.00501093284788, 56.06966638964932, 159.39385625200788, 40.35782891802338, 474.93820133733095, 466.0946215314428, 180.26755669921346, 471.8581125523442, 53.5207152049085, 469.3553770218814, 71.87219498875102, 473.3487092325896, 466.13587561255343, 29.780445304349477, 68.49858375961091, 469.6125783762365, 469.95734198764, 6.522348872263889, 238.08239294612915, 470.9083210964535, 474.33841185720564, 469.4057132316147, 471.1942944536922, 322.54576234460166, 332.53073586651414, 3.779710158178037, 475.49063701567985, 334.8612054009008, 46.60398563175686, 394.57168619821516, 473.7272475165868, 83.75878670757052, 189.21920051683028, 478.9209025424309, 25.774387009727683, 478.59696268669353, 303.80353530536837, 78.22471250095633, 469.2907671542626, 469.6652686432428, 467.5863492829185, 94.37750120143052, 55.43893859172227, 476.4480533972359, 470.4591272976901, 470.7551574480864, 475.6834059657661, 480.90396863102666, 34.13508387013024, 158.489577427948, 473.8347392354281, 477.4946741493238, 5.438897856245466, 473.6801872052643, 473.8702767834901, 468.3212387874887, 469.9963204077078, 474.192198976589, 472.71546432681794, 471.2425010266827, 30.126214530662534, 54.14498558868956, 110.33608510765322, 478.3582379321898, 48.37575552978559, 477.25592590346605, 40.552304217963226, 95.9615604058118, 473.56979514412456, 469.75595919887223, 96.46358860200836, 474.0249695005355, 469.92569354904316, 469.9278610811087, 72.47476199542277, 477.58286311756433, 380.1828675409935, 474.8770436575212, 469.15944140250934, 476.60544316488506, 472.57118359267014, 476.2450236752138, 471.8614230183856, 60.846712745009384, 87.3793859674778, 476.1163935698808, 471.26900350893993, 52.93970156087918, 469.88510788541856, 49.233079870713794, 475.3713654902616, 468.66604874790823, 474.62854738450386, 476.525559203276], "episode_lengths": [39, 104, 600, 50, 11, 90, 198, 67, 187, 48, 600, 600, 218, 600, 64, 600, 87, 600, 600, 36, 79, 600, 600, 8, 293, 600, 600, 600, 600, 379, 410, 5, 600, 414, 54, 494, 600, 100, 228, 600, 31, 600, 380, 94, 600, 600, 600, 115, 67, 600, 600, 600, 600, 600, 39, 183, 600, 600, 7, 600, 600, 600, 600, 600, 600, 600, 35, 62, 128, 600, 57, 600, 47, 112, 600, 600, 113, 600, 600, 600, 83, 600, 469, 600, 600, 600, 600, 600, 600, 72, 108, 600, 600, 59, 600, 60, 600, 600, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 185.56315718348122, "mean_inference_ms": 681.4817985434347, "mean_action_processing_ms": 32.31755027087854, "mean_env_wait_ms": 3949.866585508128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8550896644592285, "StateBufferConnector_ms": 2.3219125270843506, "ViewRequirementAgentConnector_ms": 27.33297109603882}}, "episode_reward_max": 480.90396863102666, "episode_reward_min": 3.779710158178037, "episode_reward_mean": 309.64137553974246, "episode_len_mean": 389.84, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.05531843579192, 92.52217246930294, 467.6218514697704, 42.90275713382166, 8.608263414751967, 77.27998403220631, 162.00501093284788, 56.06966638964932, 159.39385625200788, 40.35782891802338, 474.93820133733095, 466.0946215314428, 180.26755669921346, 471.8581125523442, 53.5207152049085, 469.3553770218814, 71.87219498875102, 473.3487092325896, 466.13587561255343, 29.780445304349477, 68.49858375961091, 469.6125783762365, 469.95734198764, 6.522348872263889, 238.08239294612915, 470.9083210964535, 474.33841185720564, 469.4057132316147, 471.1942944536922, 322.54576234460166, 332.53073586651414, 3.779710158178037, 475.49063701567985, 334.8612054009008, 46.60398563175686, 394.57168619821516, 473.7272475165868, 83.75878670757052, 189.21920051683028, 478.9209025424309, 25.774387009727683, 478.59696268669353, 303.80353530536837, 78.22471250095633, 469.2907671542626, 469.6652686432428, 467.5863492829185, 94.37750120143052, 55.43893859172227, 476.4480533972359, 470.4591272976901, 470.7551574480864, 475.6834059657661, 480.90396863102666, 34.13508387013024, 158.489577427948, 473.8347392354281, 477.4946741493238, 5.438897856245466, 473.6801872052643, 473.8702767834901, 468.3212387874887, 469.9963204077078, 474.192198976589, 472.71546432681794, 471.2425010266827, 30.126214530662534, 54.14498558868956, 110.33608510765322, 478.3582379321898, 48.37575552978559, 477.25592590346605, 40.552304217963226, 95.9615604058118, 473.56979514412456, 469.75595919887223, 96.46358860200836, 474.0249695005355, 469.92569354904316, 469.9278610811087, 72.47476199542277, 477.58286311756433, 380.1828675409935, 474.8770436575212, 469.15944140250934, 476.60544316488506, 472.57118359267014, 476.2450236752138, 471.8614230183856, 60.846712745009384, 87.3793859674778, 476.1163935698808, 471.26900350893993, 52.93970156087918, 469.88510788541856, 49.233079870713794, 475.3713654902616, 468.66604874790823, 474.62854738450386, 476.525559203276], "episode_lengths": [39, 104, 600, 50, 11, 90, 198, 67, 187, 48, 600, 600, 218, 600, 64, 600, 87, 600, 600, 36, 79, 600, 600, 8, 293, 600, 600, 600, 600, 379, 410, 5, 600, 414, 54, 494, 600, 100, 228, 600, 31, 600, 380, 94, 600, 600, 600, 115, 67, 600, 600, 600, 600, 600, 39, 183, 600, 600, 7, 600, 600, 600, 600, 600, 600, 600, 35, 62, 128, 600, 57, 600, 47, 112, 600, 600, 113, 600, 600, 600, 83, 600, 469, 600, 600, 600, 600, 600, 600, 72, 108, 600, 600, 59, 600, 60, 600, 600, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 185.56315718348122, "mean_inference_ms": 681.4817985434347, "mean_action_processing_ms": 32.31755027087854, "mean_env_wait_ms": 3949.866585508128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8550896644592285, "StateBufferConnector_ms": 2.3219125270843506, "ViewRequirementAgentConnector_ms": 27.33297109603882}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.702367704368289, "num_env_steps_trained_throughput_per_sec": 8.702367704368289, "timesteps_total": 140000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 1115483.398, "sample_time_ms": 1017854.803, "load_time_ms": 2010.441, "load_throughput": 4974.033, "learn_time_ms": 94502.617, "learn_throughput": 105.817, "synch_weights_time_ms": 1084.521}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 2177, "training_iteration": 14, "trial_id": "ef367_00000", "date": "2024-01-23_14-35-52", "timestamp": 1705991752, "time_this_iter_s": 1149.2319819927216, "time_total_s": 15423.363845586777, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 15423.363845586777, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 0.8002510985561834, "ram_util_percent": 20.94965473948525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 9.887695417241154, "policy_loss": -0.016038745699617534, "vf_loss": 9.900585797709278, "vf_explained_var": -0.014858127277121585, "kl": 0.010494530591159075, "entropy": 2.4143181941448115, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33930.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000}, "sampler_results": {"episode_reward_max": 484.22732899728385, "episode_reward_min": 3.779710158178037, "episode_reward_mean": 335.7635190515712, "episode_len_mean": 423.28, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [466.13587561255343, 29.780445304349477, 68.49858375961091, 469.6125783762365, 469.95734198764, 6.522348872263889, 238.08239294612915, 470.9083210964535, 474.33841185720564, 469.4057132316147, 471.1942944536922, 322.54576234460166, 332.53073586651414, 3.779710158178037, 475.49063701567985, 334.8612054009008, 46.60398563175686, 394.57168619821516, 473.7272475165868, 83.75878670757052, 189.21920051683028, 478.9209025424309, 25.774387009727683, 478.59696268669353, 303.80353530536837, 78.22471250095633, 469.2907671542626, 469.6652686432428, 467.5863492829185, 94.37750120143052, 55.43893859172227, 476.4480533972359, 470.4591272976901, 470.7551574480864, 475.6834059657661, 480.90396863102666, 34.13508387013024, 158.489577427948, 473.8347392354281, 477.4946741493238, 5.438897856245466, 473.6801872052643, 473.8702767834901, 468.3212387874887, 469.9963204077078, 474.192198976589, 472.71546432681794, 471.2425010266827, 30.126214530662534, 54.14498558868956, 110.33608510765322, 478.3582379321898, 48.37575552978559, 477.25592590346605, 40.552304217963226, 95.9615604058118, 473.56979514412456, 469.75595919887223, 96.46358860200836, 474.0249695005355, 469.92569354904316, 469.9278610811087, 72.47476199542277, 477.58286311756433, 380.1828675409935, 474.8770436575212, 469.15944140250934, 476.60544316488506, 472.57118359267014, 476.2450236752138, 471.8614230183856, 60.846712745009384, 87.3793859674778, 476.1163935698808, 471.26900350893993, 52.93970156087918, 469.88510788541856, 49.233079870713794, 475.3713654902616, 468.66604874790823, 474.62854738450386, 476.525559203276, 107.14412028795083, 88.83846530729602, 267.16640454529215, 484.22732899728385, 474.7696579077326, 265.0072756827709, 53.86704215880068, 442.14458285409506, 474.5955422449644, 472.2719819697887, 470.21841228445345, 473.89809275007013, 3.887986598521901, 476.76633977225407, 468.68227922117484, 476.7972576445048, 470.31758937999183, 441.6861895925683], "episode_lengths": [600, 36, 79, 600, 600, 8, 293, 600, 600, 600, 600, 379, 410, 5, 600, 414, 54, 494, 600, 100, 228, 600, 31, 600, 380, 94, 600, 600, 600, 115, 67, 600, 600, 600, 600, 600, 39, 183, 600, 600, 7, 600, 600, 600, 600, 600, 600, 600, 35, 62, 128, 600, 57, 600, 47, 112, 600, 600, 113, 600, 600, 600, 83, 600, 469, 600, 600, 600, 600, 600, 600, 72, 108, 600, 600, 59, 600, 60, 600, 600, 600, 600, 122, 107, 342, 600, 600, 342, 63, 562, 600, 600, 600, 600, 5, 600, 600, 600, 600, 564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 183.30263990478826, "mean_inference_ms": 682.3046086492172, "mean_action_processing_ms": 32.21972807896265, "mean_env_wait_ms": 3966.1597216006653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.0553150177001953, "StateBufferConnector_ms": 2.323058605194092, "ViewRequirementAgentConnector_ms": 28.372937440872192}}, "episode_reward_max": 484.22732899728385, "episode_reward_min": 3.779710158178037, "episode_reward_mean": 335.7635190515712, "episode_len_mean": 423.28, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [466.13587561255343, 29.780445304349477, 68.49858375961091, 469.6125783762365, 469.95734198764, 6.522348872263889, 238.08239294612915, 470.9083210964535, 474.33841185720564, 469.4057132316147, 471.1942944536922, 322.54576234460166, 332.53073586651414, 3.779710158178037, 475.49063701567985, 334.8612054009008, 46.60398563175686, 394.57168619821516, 473.7272475165868, 83.75878670757052, 189.21920051683028, 478.9209025424309, 25.774387009727683, 478.59696268669353, 303.80353530536837, 78.22471250095633, 469.2907671542626, 469.6652686432428, 467.5863492829185, 94.37750120143052, 55.43893859172227, 476.4480533972359, 470.4591272976901, 470.7551574480864, 475.6834059657661, 480.90396863102666, 34.13508387013024, 158.489577427948, 473.8347392354281, 477.4946741493238, 5.438897856245466, 473.6801872052643, 473.8702767834901, 468.3212387874887, 469.9963204077078, 474.192198976589, 472.71546432681794, 471.2425010266827, 30.126214530662534, 54.14498558868956, 110.33608510765322, 478.3582379321898, 48.37575552978559, 477.25592590346605, 40.552304217963226, 95.9615604058118, 473.56979514412456, 469.75595919887223, 96.46358860200836, 474.0249695005355, 469.92569354904316, 469.9278610811087, 72.47476199542277, 477.58286311756433, 380.1828675409935, 474.8770436575212, 469.15944140250934, 476.60544316488506, 472.57118359267014, 476.2450236752138, 471.8614230183856, 60.846712745009384, 87.3793859674778, 476.1163935698808, 471.26900350893993, 52.93970156087918, 469.88510788541856, 49.233079870713794, 475.3713654902616, 468.66604874790823, 474.62854738450386, 476.525559203276, 107.14412028795083, 88.83846530729602, 267.16640454529215, 484.22732899728385, 474.7696579077326, 265.0072756827709, 53.86704215880068, 442.14458285409506, 474.5955422449644, 472.2719819697887, 470.21841228445345, 473.89809275007013, 3.887986598521901, 476.76633977225407, 468.68227922117484, 476.7972576445048, 470.31758937999183, 441.6861895925683], "episode_lengths": [600, 36, 79, 600, 600, 8, 293, 600, 600, 600, 600, 379, 410, 5, 600, 414, 54, 494, 600, 100, 228, 600, 31, 600, 380, 94, 600, 600, 600, 115, 67, 600, 600, 600, 600, 600, 39, 183, 600, 600, 7, 600, 600, 600, 600, 600, 600, 600, 35, 62, 128, 600, 57, 600, 47, 112, 600, 600, 113, 600, 600, 600, 83, 600, 469, 600, 600, 600, 600, 600, 600, 72, 108, 600, 600, 59, 600, 60, 600, 600, 600, 600, 122, 107, 342, 600, 600, 342, 63, 562, 600, 600, 600, 600, 5, 600, 600, 600, 600, 564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 183.30263990478826, "mean_inference_ms": 682.3046086492172, "mean_action_processing_ms": 32.21972807896265, "mean_env_wait_ms": 3966.1597216006653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.0553150177001953, "StateBufferConnector_ms": 2.323058605194092, "ViewRequirementAgentConnector_ms": 28.372937440872192}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000, "num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.69557322157378, "num_env_steps_trained_throughput_per_sec": 8.69557322157378, "timesteps_total": 150000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 150000, "timers": {"training_iteration_time_ms": 1122403.635, "sample_time_ms": 1022783.043, "load_time_ms": 2268.269, "load_throughput": 4408.649, "learn_time_ms": 96268.441, "learn_throughput": 103.876, "synch_weights_time_ms": 1053.562}, "counters": {"num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000}, "done": false, "episodes_total": 2195, "training_iteration": 15, "trial_id": "ef367_00000", "date": "2024-01-23_14-55-03", "timestamp": 1705992903, "time_this_iter_s": 1151.0165431499481, "time_total_s": 16574.380388736725, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 16574.380388736725, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 0.8003140703517588, "ram_util_percent": 20.933731155778894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 9.978335072036483, "policy_loss": -0.017637391324736115, "vf_loss": 9.993006250593398, "vf_explained_var": -0.046169610359729864, "kl": 0.009887351410321167, "entropy": 2.4059821313263003, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 36270.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": 484.22732899728385, "episode_reward_min": 3.887986598521901, "episode_reward_mean": 362.46587041287404, "episode_len_mean": 457.96, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [469.2907671542626, 469.6652686432428, 467.5863492829185, 94.37750120143052, 55.43893859172227, 476.4480533972359, 470.4591272976901, 470.7551574480864, 475.6834059657661, 480.90396863102666, 34.13508387013024, 158.489577427948, 473.8347392354281, 477.4946741493238, 5.438897856245466, 473.6801872052643, 473.8702767834901, 468.3212387874887, 469.9963204077078, 474.192198976589, 472.71546432681794, 471.2425010266827, 30.126214530662534, 54.14498558868956, 110.33608510765322, 478.3582379321898, 48.37575552978559, 477.25592590346605, 40.552304217963226, 95.9615604058118, 473.56979514412456, 469.75595919887223, 96.46358860200836, 474.0249695005355, 469.92569354904316, 469.9278610811087, 72.47476199542277, 477.58286311756433, 380.1828675409935, 474.8770436575212, 469.15944140250934, 476.60544316488506, 472.57118359267014, 476.2450236752138, 471.8614230183856, 60.846712745009384, 87.3793859674778, 476.1163935698808, 471.26900350893993, 52.93970156087918, 469.88510788541856, 49.233079870713794, 475.3713654902616, 468.66604874790823, 474.62854738450386, 476.525559203276, 107.14412028795083, 88.83846530729602, 267.16640454529215, 484.22732899728385, 474.7696579077326, 265.0072756827709, 53.86704215880068, 442.14458285409506, 474.5955422449644, 472.2719819697887, 470.21841228445345, 473.89809275007013, 3.887986598521901, 476.76633977225407, 468.68227922117484, 476.7972576445048, 470.31758937999183, 441.6861895925683, 469.53072142377704, 471.8494930947169, 474.1240560008542, 476.4725052332882, 469.6517408354365, 74.85126742758803, 469.21465223676313, 473.44062155871313, 475.23526000522, 476.7754120561341, 477.8794857579432, 474.5922870427063, 146.823863266538, 474.5307786989713, 51.92782273521137, 467.0446443103415, 469.3942673139697, 470.9250016359874, 470.60265662386416, 459.7549974986997, 469.0560161870684, 475.43428461506187, 468.51239396849707, 476.9680802014899, 55.077573867695016, 87.41101743350367], "episode_lengths": [600, 600, 600, 115, 67, 600, 600, 600, 600, 600, 39, 183, 600, 600, 7, 600, 600, 600, 600, 600, 600, 600, 35, 62, 128, 600, 57, 600, 47, 112, 600, 600, 113, 600, 600, 600, 83, 600, 469, 600, 600, 600, 600, 600, 600, 72, 108, 600, 600, 59, 600, 60, 600, 600, 600, 600, 122, 107, 342, 600, 600, 342, 63, 562, 600, 600, 600, 600, 5, 600, 600, 600, 600, 564, 600, 600, 600, 600, 600, 88, 600, 600, 600, 600, 600, 600, 175, 600, 64, 600, 600, 600, 600, 582, 600, 600, 600, 600, 62, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 181.73950477351877, "mean_inference_ms": 684.7331645607036, "mean_action_processing_ms": 32.289535037934186, "mean_env_wait_ms": 3979.7233482132624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.1740036010742188, "StateBufferConnector_ms": 1.0174002647399902, "ViewRequirementAgentConnector_ms": 30.232510805130005}}, "episode_reward_max": 484.22732899728385, "episode_reward_min": 3.887986598521901, "episode_reward_mean": 362.46587041287404, "episode_len_mean": 457.96, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [469.2907671542626, 469.6652686432428, 467.5863492829185, 94.37750120143052, 55.43893859172227, 476.4480533972359, 470.4591272976901, 470.7551574480864, 475.6834059657661, 480.90396863102666, 34.13508387013024, 158.489577427948, 473.8347392354281, 477.4946741493238, 5.438897856245466, 473.6801872052643, 473.8702767834901, 468.3212387874887, 469.9963204077078, 474.192198976589, 472.71546432681794, 471.2425010266827, 30.126214530662534, 54.14498558868956, 110.33608510765322, 478.3582379321898, 48.37575552978559, 477.25592590346605, 40.552304217963226, 95.9615604058118, 473.56979514412456, 469.75595919887223, 96.46358860200836, 474.0249695005355, 469.92569354904316, 469.9278610811087, 72.47476199542277, 477.58286311756433, 380.1828675409935, 474.8770436575212, 469.15944140250934, 476.60544316488506, 472.57118359267014, 476.2450236752138, 471.8614230183856, 60.846712745009384, 87.3793859674778, 476.1163935698808, 471.26900350893993, 52.93970156087918, 469.88510788541856, 49.233079870713794, 475.3713654902616, 468.66604874790823, 474.62854738450386, 476.525559203276, 107.14412028795083, 88.83846530729602, 267.16640454529215, 484.22732899728385, 474.7696579077326, 265.0072756827709, 53.86704215880068, 442.14458285409506, 474.5955422449644, 472.2719819697887, 470.21841228445345, 473.89809275007013, 3.887986598521901, 476.76633977225407, 468.68227922117484, 476.7972576445048, 470.31758937999183, 441.6861895925683, 469.53072142377704, 471.8494930947169, 474.1240560008542, 476.4725052332882, 469.6517408354365, 74.85126742758803, 469.21465223676313, 473.44062155871313, 475.23526000522, 476.7754120561341, 477.8794857579432, 474.5922870427063, 146.823863266538, 474.5307786989713, 51.92782273521137, 467.0446443103415, 469.3942673139697, 470.9250016359874, 470.60265662386416, 459.7549974986997, 469.0560161870684, 475.43428461506187, 468.51239396849707, 476.9680802014899, 55.077573867695016, 87.41101743350367], "episode_lengths": [600, 600, 600, 115, 67, 600, 600, 600, 600, 600, 39, 183, 600, 600, 7, 600, 600, 600, 600, 600, 600, 600, 35, 62, 128, 600, 57, 600, 47, 112, 600, 600, 113, 600, 600, 600, 83, 600, 469, 600, 600, 600, 600, 600, 600, 72, 108, 600, 600, 59, 600, 60, 600, 600, 600, 600, 122, 107, 342, 600, 600, 342, 63, 562, 600, 600, 600, 600, 5, 600, 600, 600, 600, 564, 600, 600, 600, 600, 600, 88, 600, 600, 600, 600, 600, 600, 175, 600, 64, 600, 600, 600, 600, 582, 600, 600, 600, 600, 62, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 181.73950477351877, "mean_inference_ms": 684.7331645607036, "mean_action_processing_ms": 32.289535037934186, "mean_env_wait_ms": 3979.7233482132624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.1740036010742188, "StateBufferConnector_ms": 1.0174002647399902, "ViewRequirementAgentConnector_ms": 30.232510805130005}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.70100125939545, "num_env_steps_trained_throughput_per_sec": 8.70100125939545, "timesteps_total": 160000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 1128511.722, "sample_time_ms": 1026522.497, "load_time_ms": 2357.456, "load_throughput": 4241.861, "learn_time_ms": 98548.852, "learn_throughput": 101.473, "synch_weights_time_ms": 1052.883}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 2221, "training_iteration": 16, "trial_id": "ef367_00000", "date": "2024-01-23_15-14-14", "timestamp": 1705994054, "time_this_iter_s": 1149.4304580688477, "time_total_s": 17723.810846805573, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 17723.810846805573, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 0.8005025125628141, "ram_util_percent": 20.851821608040204}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 9.987275425185505, "policy_loss": -0.014041100223906911, "vf_loss": 9.998364054851043, "vf_explained_var": -0.08029109366938599, "kl": 0.00984158918246945, "entropy": 2.382967168958778, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 38610.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 170000, "num_env_steps_trained": 170000, "num_agent_steps_sampled": 170000, "num_agent_steps_trained": 170000}, "sampler_results": {"episode_reward_max": 484.22732899728385, "episode_reward_min": 3.887986598521901, "episode_reward_mean": 360.0977804446436, "episode_len_mean": 455.09, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [472.71546432681794, 471.2425010266827, 30.126214530662534, 54.14498558868956, 110.33608510765322, 478.3582379321898, 48.37575552978559, 477.25592590346605, 40.552304217963226, 95.9615604058118, 473.56979514412456, 469.75595919887223, 96.46358860200836, 474.0249695005355, 469.92569354904316, 469.9278610811087, 72.47476199542277, 477.58286311756433, 380.1828675409935, 474.8770436575212, 469.15944140250934, 476.60544316488506, 472.57118359267014, 476.2450236752138, 471.8614230183856, 60.846712745009384, 87.3793859674778, 476.1163935698808, 471.26900350893993, 52.93970156087918, 469.88510788541856, 49.233079870713794, 475.3713654902616, 468.66604874790823, 474.62854738450386, 476.525559203276, 107.14412028795083, 88.83846530729602, 267.16640454529215, 484.22732899728385, 474.7696579077326, 265.0072756827709, 53.86704215880068, 442.14458285409506, 474.5955422449644, 472.2719819697887, 470.21841228445345, 473.89809275007013, 3.887986598521901, 476.76633977225407, 468.68227922117484, 476.7972576445048, 470.31758937999183, 441.6861895925683, 469.53072142377704, 471.8494930947169, 474.1240560008542, 476.4725052332882, 469.6517408354365, 74.85126742758803, 469.21465223676313, 473.44062155871313, 475.23526000522, 476.7754120561341, 477.8794857579432, 474.5922870427063, 146.823863266538, 474.5307786989713, 51.92782273521137, 467.0446443103415, 469.3942673139697, 470.9250016359874, 470.60265662386416, 459.7549974986997, 469.0560161870684, 475.43428461506187, 468.51239396849707, 476.9680802014899, 55.077573867695016, 87.41101743350367, 447.3279324083805, 102.97343961394289, 468.3986944792195, 57.121293534545565, 200.17751823942817, 469.88491781917503, 143.8513128874522, 473.473737260909, 440.23765397532526, 470.2133943294467, 473.8272216756184, 72.92717917805263, 470.76829418312485, 469.3814049747449, 81.22987949920976, 482.3537279760648, 468.46995268177346, 471.342204536068, 468.3412683365142, 470.95170790095045], "episode_lengths": [600, 600, 35, 62, 128, 600, 57, 600, 47, 112, 600, 600, 113, 600, 600, 600, 83, 600, 469, 600, 600, 600, 600, 600, 600, 72, 108, 600, 600, 59, 600, 60, 600, 600, 600, 600, 122, 107, 342, 600, 600, 342, 63, 562, 600, 600, 600, 600, 5, 600, 600, 600, 600, 564, 600, 600, 600, 600, 600, 88, 600, 600, 600, 600, 600, 600, 175, 600, 64, 600, 600, 600, 600, 582, 600, 600, 600, 600, 62, 102, 565, 120, 600, 68, 249, 600, 171, 600, 565, 600, 600, 88, 600, 600, 98, 600, 600, 600, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 180.34005615351046, "mean_inference_ms": 686.0953951781441, "mean_action_processing_ms": 32.68169934896218, "mean_env_wait_ms": 3981.5634513114014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.5296547412872314, "StateBufferConnector_ms": 1.016265869140625, "ViewRequirementAgentConnector_ms": 31.93845772743225}}, "episode_reward_max": 484.22732899728385, "episode_reward_min": 3.887986598521901, "episode_reward_mean": 360.0977804446436, "episode_len_mean": 455.09, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [472.71546432681794, 471.2425010266827, 30.126214530662534, 54.14498558868956, 110.33608510765322, 478.3582379321898, 48.37575552978559, 477.25592590346605, 40.552304217963226, 95.9615604058118, 473.56979514412456, 469.75595919887223, 96.46358860200836, 474.0249695005355, 469.92569354904316, 469.9278610811087, 72.47476199542277, 477.58286311756433, 380.1828675409935, 474.8770436575212, 469.15944140250934, 476.60544316488506, 472.57118359267014, 476.2450236752138, 471.8614230183856, 60.846712745009384, 87.3793859674778, 476.1163935698808, 471.26900350893993, 52.93970156087918, 469.88510788541856, 49.233079870713794, 475.3713654902616, 468.66604874790823, 474.62854738450386, 476.525559203276, 107.14412028795083, 88.83846530729602, 267.16640454529215, 484.22732899728385, 474.7696579077326, 265.0072756827709, 53.86704215880068, 442.14458285409506, 474.5955422449644, 472.2719819697887, 470.21841228445345, 473.89809275007013, 3.887986598521901, 476.76633977225407, 468.68227922117484, 476.7972576445048, 470.31758937999183, 441.6861895925683, 469.53072142377704, 471.8494930947169, 474.1240560008542, 476.4725052332882, 469.6517408354365, 74.85126742758803, 469.21465223676313, 473.44062155871313, 475.23526000522, 476.7754120561341, 477.8794857579432, 474.5922870427063, 146.823863266538, 474.5307786989713, 51.92782273521137, 467.0446443103415, 469.3942673139697, 470.9250016359874, 470.60265662386416, 459.7549974986997, 469.0560161870684, 475.43428461506187, 468.51239396849707, 476.9680802014899, 55.077573867695016, 87.41101743350367, 447.3279324083805, 102.97343961394289, 468.3986944792195, 57.121293534545565, 200.17751823942817, 469.88491781917503, 143.8513128874522, 473.473737260909, 440.23765397532526, 470.2133943294467, 473.8272216756184, 72.92717917805263, 470.76829418312485, 469.3814049747449, 81.22987949920976, 482.3537279760648, 468.46995268177346, 471.342204536068, 468.3412683365142, 470.95170790095045], "episode_lengths": [600, 600, 35, 62, 128, 600, 57, 600, 47, 112, 600, 600, 113, 600, 600, 600, 83, 600, 469, 600, 600, 600, 600, 600, 600, 72, 108, 600, 600, 59, 600, 60, 600, 600, 600, 600, 122, 107, 342, 600, 600, 342, 63, 562, 600, 600, 600, 600, 5, 600, 600, 600, 600, 564, 600, 600, 600, 600, 600, 88, 600, 600, 600, 600, 600, 600, 175, 600, 64, 600, 600, 600, 600, 582, 600, 600, 600, 600, 62, 102, 565, 120, 600, 68, 249, 600, 171, 600, 565, 600, 600, 88, 600, 600, 98, 600, 600, 600, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 180.34005615351046, "mean_inference_ms": 686.0953951781441, "mean_action_processing_ms": 32.68169934896218, "mean_env_wait_ms": 3981.5634513114014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.5296547412872314, "StateBufferConnector_ms": 1.016265869140625, "ViewRequirementAgentConnector_ms": 31.93845772743225}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 170000, "num_agent_steps_trained": 170000, "num_env_steps_sampled": 170000, "num_env_steps_trained": 170000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.675898697186609, "num_env_steps_trained_throughput_per_sec": 8.675898697186609, "timesteps_total": 170000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 170000, "timers": {"training_iteration_time_ms": 1134471.544, "sample_time_ms": 1029687.243, "load_time_ms": 2361.455, "load_throughput": 4234.678, "learn_time_ms": 101508.707, "learn_throughput": 98.514, "synch_weights_time_ms": 883.801}, "counters": {"num_env_steps_sampled": 170000, "num_env_steps_trained": 170000, "num_agent_steps_sampled": 170000, "num_agent_steps_trained": 170000}, "done": false, "episodes_total": 2241, "training_iteration": 17, "trial_id": "ef367_00000", "date": "2024-01-23_15-33-27", "timestamp": 1705995207, "time_this_iter_s": 1152.7467141151428, "time_total_s": 18876.557560920715, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 18876.557560920715, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 0.8006913890634821, "ram_util_percent": 20.93576367064739}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 9.97602221598992, "policy_loss": -0.011838082816356267, "vf_loss": 9.985003059745853, "vf_explained_var": -0.004890505778483855, "kl": 0.009524098467381607, "entropy": 2.3888595630979945, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 40950.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 484.22732899728385, "episode_reward_min": 0.7750408806170728, "episode_reward_mean": 372.77808714686756, "episode_len_mean": 471.89, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.1828675409935, 474.8770436575212, 469.15944140250934, 476.60544316488506, 472.57118359267014, 476.2450236752138, 471.8614230183856, 60.846712745009384, 87.3793859674778, 476.1163935698808, 471.26900350893993, 52.93970156087918, 469.88510788541856, 49.233079870713794, 475.3713654902616, 468.66604874790823, 474.62854738450386, 476.525559203276, 107.14412028795083, 88.83846530729602, 267.16640454529215, 484.22732899728385, 474.7696579077326, 265.0072756827709, 53.86704215880068, 442.14458285409506, 474.5955422449644, 472.2719819697887, 470.21841228445345, 473.89809275007013, 3.887986598521901, 476.76633977225407, 468.68227922117484, 476.7972576445048, 470.31758937999183, 441.6861895925683, 469.53072142377704, 471.8494930947169, 474.1240560008542, 476.4725052332882, 469.6517408354365, 74.85126742758803, 469.21465223676313, 473.44062155871313, 475.23526000522, 476.7754120561341, 477.8794857579432, 474.5922870427063, 146.823863266538, 474.5307786989713, 51.92782273521137, 467.0446443103415, 469.3942673139697, 470.9250016359874, 470.60265662386416, 459.7549974986997, 469.0560161870684, 475.43428461506187, 468.51239396849707, 476.9680802014899, 55.077573867695016, 87.41101743350367, 447.3279324083805, 102.97343961394289, 468.3986944792195, 57.121293534545565, 200.17751823942817, 469.88491781917503, 143.8513128874522, 473.473737260909, 440.23765397532526, 470.2133943294467, 473.8272216756184, 72.92717917805263, 470.76829418312485, 469.3814049747449, 81.22987949920976, 482.3537279760648, 468.46995268177346, 471.342204536068, 468.3412683365142, 470.95170790095045, 481.34194879599414, 469.4329501502794, 468.5376983940718, 475.08194191714244, 471.3509914182769, 476.4770797814117, 471.5569170901002, 472.62023313785045, 471.61513909314795, 471.3657974218768, 68.82235614795121, 467.0044669731596, 469.4202492776038, 116.04607292494633, 0.7750408806170728, 176.37541875457262, 51.39012814480577, 471.61076667699695], "episode_lengths": [469, 600, 600, 600, 600, 600, 600, 72, 108, 600, 600, 59, 600, 60, 600, 600, 600, 600, 122, 107, 342, 600, 600, 342, 63, 562, 600, 600, 600, 600, 5, 600, 600, 600, 600, 564, 600, 600, 600, 600, 600, 88, 600, 600, 600, 600, 600, 600, 175, 600, 64, 600, 600, 600, 600, 582, 600, 600, 600, 600, 62, 102, 565, 120, 600, 68, 249, 600, 171, 600, 565, 600, 600, 88, 600, 600, 98, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 85, 600, 600, 146, 2, 224, 60, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 178.6194256112433, "mean_inference_ms": 686.1322399993104, "mean_action_processing_ms": 32.576632599623295, "mean_env_wait_ms": 3995.647979788174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.002391815185547, "StateBufferConnector_ms": 1.0103375911712646, "ViewRequirementAgentConnector_ms": 31.615115642547607}}, "episode_reward_max": 484.22732899728385, "episode_reward_min": 0.7750408806170728, "episode_reward_mean": 372.77808714686756, "episode_len_mean": 471.89, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [380.1828675409935, 474.8770436575212, 469.15944140250934, 476.60544316488506, 472.57118359267014, 476.2450236752138, 471.8614230183856, 60.846712745009384, 87.3793859674778, 476.1163935698808, 471.26900350893993, 52.93970156087918, 469.88510788541856, 49.233079870713794, 475.3713654902616, 468.66604874790823, 474.62854738450386, 476.525559203276, 107.14412028795083, 88.83846530729602, 267.16640454529215, 484.22732899728385, 474.7696579077326, 265.0072756827709, 53.86704215880068, 442.14458285409506, 474.5955422449644, 472.2719819697887, 470.21841228445345, 473.89809275007013, 3.887986598521901, 476.76633977225407, 468.68227922117484, 476.7972576445048, 470.31758937999183, 441.6861895925683, 469.53072142377704, 471.8494930947169, 474.1240560008542, 476.4725052332882, 469.6517408354365, 74.85126742758803, 469.21465223676313, 473.44062155871313, 475.23526000522, 476.7754120561341, 477.8794857579432, 474.5922870427063, 146.823863266538, 474.5307786989713, 51.92782273521137, 467.0446443103415, 469.3942673139697, 470.9250016359874, 470.60265662386416, 459.7549974986997, 469.0560161870684, 475.43428461506187, 468.51239396849707, 476.9680802014899, 55.077573867695016, 87.41101743350367, 447.3279324083805, 102.97343961394289, 468.3986944792195, 57.121293534545565, 200.17751823942817, 469.88491781917503, 143.8513128874522, 473.473737260909, 440.23765397532526, 470.2133943294467, 473.8272216756184, 72.92717917805263, 470.76829418312485, 469.3814049747449, 81.22987949920976, 482.3537279760648, 468.46995268177346, 471.342204536068, 468.3412683365142, 470.95170790095045, 481.34194879599414, 469.4329501502794, 468.5376983940718, 475.08194191714244, 471.3509914182769, 476.4770797814117, 471.5569170901002, 472.62023313785045, 471.61513909314795, 471.3657974218768, 68.82235614795121, 467.0044669731596, 469.4202492776038, 116.04607292494633, 0.7750408806170728, 176.37541875457262, 51.39012814480577, 471.61076667699695], "episode_lengths": [469, 600, 600, 600, 600, 600, 600, 72, 108, 600, 600, 59, 600, 60, 600, 600, 600, 600, 122, 107, 342, 600, 600, 342, 63, 562, 600, 600, 600, 600, 5, 600, 600, 600, 600, 564, 600, 600, 600, 600, 600, 88, 600, 600, 600, 600, 600, 600, 175, 600, 64, 600, 600, 600, 600, 582, 600, 600, 600, 600, 62, 102, 565, 120, 600, 68, 249, 600, 171, 600, 565, 600, 600, 88, 600, 600, 98, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 85, 600, 600, 146, 2, 224, 60, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 178.6194256112433, "mean_inference_ms": 686.1322399993104, "mean_action_processing_ms": 32.576632599623295, "mean_env_wait_ms": 3995.647979788174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.002391815185547, "StateBufferConnector_ms": 1.0103375911712646, "ViewRequirementAgentConnector_ms": 31.615115642547607}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.723483358910956, "num_env_steps_trained_throughput_per_sec": 8.723483358910956, "timesteps_total": 180000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 1137826.032, "sample_time_ms": 1032302.81, "load_time_ms": 2463.856, "load_throughput": 4058.679, "learn_time_ms": 101956.62, "learn_throughput": 98.081, "synch_weights_time_ms": 1073.036}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 2259, "training_iteration": 18, "trial_id": "ef367_00000", "date": "2024-01-23_15-52-33", "timestamp": 1705996353, "time_this_iter_s": 1146.4732842445374, "time_total_s": 20023.030845165253, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 20023.030845165253, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 0.8002510985561834, "ram_util_percent": 20.880414312617702}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 9.92954103101013, "policy_loss": -0.017083055323037583, "vf_loss": 9.943357290263869, "vf_explained_var": -0.30840938610908314, "kl": 0.01088928582743952, "entropy": 2.369692969220316, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 43290.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 190000, "num_env_steps_trained": 190000, "num_agent_steps_sampled": 190000, "num_agent_steps_trained": 190000}, "sampler_results": {"episode_reward_max": 482.3537279760648, "episode_reward_min": 0.7750408806170728, "episode_reward_mean": 376.2321437578423, "episode_len_mean": 476.94, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.86704215880068, 442.14458285409506, 474.5955422449644, 472.2719819697887, 470.21841228445345, 473.89809275007013, 3.887986598521901, 476.76633977225407, 468.68227922117484, 476.7972576445048, 470.31758937999183, 441.6861895925683, 469.53072142377704, 471.8494930947169, 474.1240560008542, 476.4725052332882, 469.6517408354365, 74.85126742758803, 469.21465223676313, 473.44062155871313, 475.23526000522, 476.7754120561341, 477.8794857579432, 474.5922870427063, 146.823863266538, 474.5307786989713, 51.92782273521137, 467.0446443103415, 469.3942673139697, 470.9250016359874, 470.60265662386416, 459.7549974986997, 469.0560161870684, 475.43428461506187, 468.51239396849707, 476.9680802014899, 55.077573867695016, 87.41101743350367, 447.3279324083805, 102.97343961394289, 468.3986944792195, 57.121293534545565, 200.17751823942817, 469.88491781917503, 143.8513128874522, 473.473737260909, 440.23765397532526, 470.2133943294467, 473.8272216756184, 72.92717917805263, 470.76829418312485, 469.3814049747449, 81.22987949920976, 482.3537279760648, 468.46995268177346, 471.342204536068, 468.3412683365142, 470.95170790095045, 481.34194879599414, 469.4329501502794, 468.5376983940718, 475.08194191714244, 471.3509914182769, 476.4770797814117, 471.5569170901002, 472.62023313785045, 471.61513909314795, 471.3657974218768, 68.82235614795121, 467.0044669731596, 469.4202492776038, 116.04607292494633, 0.7750408806170728, 176.37541875457262, 51.39012814480577, 471.61076667699695, 42.26997216102932, 477.90413019691897, 467.47377045527304, 474.6461101825013, 48.95301475056655, 475.0917454520376, 465.438820082558, 78.13058926896741, 470.8361167524952, 468.7716388613837, 439.755084128508, 474.06330988947957, 469.4139970674371, 473.76677776034506, 471.6682281131259, 469.41536726125724, 34.30841493769916, 32.71930209889591, 474.0331865707941, 466.8472315966046, 473.3627734493782, 469.75083649972214, 470.68764449468335, 127.61418378060169], "episode_lengths": [63, 562, 600, 600, 600, 600, 5, 600, 600, 600, 600, 564, 600, 600, 600, 600, 600, 88, 600, 600, 600, 600, 600, 600, 175, 600, 64, 600, 600, 600, 600, 582, 600, 600, 600, 600, 62, 102, 565, 120, 600, 68, 249, 600, 171, 600, 565, 600, 600, 88, 600, 600, 98, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 85, 600, 600, 146, 2, 224, 60, 600, 51, 600, 600, 600, 58, 600, 600, 87, 600, 600, 560, 600, 600, 600, 600, 600, 41, 39, 600, 600, 600, 600, 600, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 177.40538643767076, "mean_inference_ms": 687.1468957496398, "mean_action_processing_ms": 32.5946365758191, "mean_env_wait_ms": 4006.74677565797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.3137402534484863, "StateBufferConnector_ms": 0.8271245956420898, "ViewRequirementAgentConnector_ms": 33.09878182411194}}, "episode_reward_max": 482.3537279760648, "episode_reward_min": 0.7750408806170728, "episode_reward_mean": 376.2321437578423, "episode_len_mean": 476.94, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [53.86704215880068, 442.14458285409506, 474.5955422449644, 472.2719819697887, 470.21841228445345, 473.89809275007013, 3.887986598521901, 476.76633977225407, 468.68227922117484, 476.7972576445048, 470.31758937999183, 441.6861895925683, 469.53072142377704, 471.8494930947169, 474.1240560008542, 476.4725052332882, 469.6517408354365, 74.85126742758803, 469.21465223676313, 473.44062155871313, 475.23526000522, 476.7754120561341, 477.8794857579432, 474.5922870427063, 146.823863266538, 474.5307786989713, 51.92782273521137, 467.0446443103415, 469.3942673139697, 470.9250016359874, 470.60265662386416, 459.7549974986997, 469.0560161870684, 475.43428461506187, 468.51239396849707, 476.9680802014899, 55.077573867695016, 87.41101743350367, 447.3279324083805, 102.97343961394289, 468.3986944792195, 57.121293534545565, 200.17751823942817, 469.88491781917503, 143.8513128874522, 473.473737260909, 440.23765397532526, 470.2133943294467, 473.8272216756184, 72.92717917805263, 470.76829418312485, 469.3814049747449, 81.22987949920976, 482.3537279760648, 468.46995268177346, 471.342204536068, 468.3412683365142, 470.95170790095045, 481.34194879599414, 469.4329501502794, 468.5376983940718, 475.08194191714244, 471.3509914182769, 476.4770797814117, 471.5569170901002, 472.62023313785045, 471.61513909314795, 471.3657974218768, 68.82235614795121, 467.0044669731596, 469.4202492776038, 116.04607292494633, 0.7750408806170728, 176.37541875457262, 51.39012814480577, 471.61076667699695, 42.26997216102932, 477.90413019691897, 467.47377045527304, 474.6461101825013, 48.95301475056655, 475.0917454520376, 465.438820082558, 78.13058926896741, 470.8361167524952, 468.7716388613837, 439.755084128508, 474.06330988947957, 469.4139970674371, 473.76677776034506, 471.6682281131259, 469.41536726125724, 34.30841493769916, 32.71930209889591, 474.0331865707941, 466.8472315966046, 473.3627734493782, 469.75083649972214, 470.68764449468335, 127.61418378060169], "episode_lengths": [63, 562, 600, 600, 600, 600, 5, 600, 600, 600, 600, 564, 600, 600, 600, 600, 600, 88, 600, 600, 600, 600, 600, 600, 175, 600, 64, 600, 600, 600, 600, 582, 600, 600, 600, 600, 62, 102, 565, 120, 600, 68, 249, 600, 171, 600, 565, 600, 600, 88, 600, 600, 98, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 85, 600, 600, 146, 2, 224, 60, 600, 51, 600, 600, 600, 58, 600, 600, 87, 600, 600, 560, 600, 600, 600, 600, 600, 41, 39, 600, 600, 600, 600, 600, 150]}, "sampler_perf": {"mean_raw_obs_processing_ms": 177.40538643767076, "mean_inference_ms": 687.1468957496398, "mean_action_processing_ms": 32.5946365758191, "mean_env_wait_ms": 4006.74677565797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.3137402534484863, "StateBufferConnector_ms": 0.8271245956420898, "ViewRequirementAgentConnector_ms": 33.09878182411194}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190000, "num_agent_steps_trained": 190000, "num_env_steps_sampled": 190000, "num_env_steps_trained": 190000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.58883199023549, "num_env_steps_trained_throughput_per_sec": 8.58883199023549, "timesteps_total": 190000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 190000, "timers": {"training_iteration_time_ms": 1143328.588, "sample_time_ms": 1036066.9, "load_time_ms": 2461.275, "load_throughput": 4062.936, "learn_time_ms": 103691.327, "learn_throughput": 96.44, "synch_weights_time_ms": 1079.45}, "counters": {"num_env_steps_sampled": 190000, "num_env_steps_trained": 190000, "num_agent_steps_sampled": 190000, "num_agent_steps_trained": 190000}, "done": false, "episodes_total": 2283, "training_iteration": 19, "trial_id": "ef367_00000", "date": "2024-01-23_16-11-58", "timestamp": 1705997518, "time_this_iter_s": 1164.4461674690247, "time_total_s": 21187.477012634277, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 21187.477012634277, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 0.8572229140722293, "ram_util_percent": 21.02646326276463}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 8.232376759480207, "policy_loss": -0.021685705630060954, "vf_loss": 8.250778315006158, "vf_explained_var": -0.05552288721769284, "kl": 0.010947225524623563, "entropy": 2.384813146917229, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 45630.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": 482.3537279760648, "episode_reward_min": 0.7750408806170728, "episode_reward_mean": 369.6474274310705, "episode_len_mean": 469.12, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [477.8794857579432, 474.5922870427063, 146.823863266538, 474.5307786989713, 51.92782273521137, 467.0446443103415, 469.3942673139697, 470.9250016359874, 470.60265662386416, 459.7549974986997, 469.0560161870684, 475.43428461506187, 468.51239396849707, 476.9680802014899, 55.077573867695016, 87.41101743350367, 447.3279324083805, 102.97343961394289, 468.3986944792195, 57.121293534545565, 200.17751823942817, 469.88491781917503, 143.8513128874522, 473.473737260909, 440.23765397532526, 470.2133943294467, 473.8272216756184, 72.92717917805263, 470.76829418312485, 469.3814049747449, 81.22987949920976, 482.3537279760648, 468.46995268177346, 471.342204536068, 468.3412683365142, 470.95170790095045, 481.34194879599414, 469.4329501502794, 468.5376983940718, 475.08194191714244, 471.3509914182769, 476.4770797814117, 471.5569170901002, 472.62023313785045, 471.61513909314795, 471.3657974218768, 68.82235614795121, 467.0044669731596, 469.4202492776038, 116.04607292494633, 0.7750408806170728, 176.37541875457262, 51.39012814480577, 471.61076667699695, 42.26997216102932, 477.90413019691897, 467.47377045527304, 474.6461101825013, 48.95301475056655, 475.0917454520376, 465.438820082558, 78.13058926896741, 470.8361167524952, 468.7716388613837, 439.755084128508, 474.06330988947957, 469.4139970674371, 473.76677776034506, 471.6682281131259, 469.41536726125724, 34.30841493769916, 32.71930209889591, 474.0331865707941, 466.8472315966046, 473.3627734493782, 469.75083649972214, 470.68764449468335, 127.61418378060169, 468.3620807483493, 473.0704524955299, 89.12706154162932, 469.75939173832444, 467.19818161402156, 473.01915985566063, 469.24048843801, 469.84089347590924, 62.65876570755802, 469.1365697629621, 467.5005819778756, 5.931658854651541, 470.7405255514244, 472.72399914749803, 468.7107400962412, 172.52891064787673, 444.9015753565586, 467.957261585945, 470.53387834823474, 471.1851336636741, 470.92344322423, 102.75663983432662], "episode_lengths": [600, 600, 175, 600, 64, 600, 600, 600, 600, 582, 600, 600, 600, 600, 62, 102, 565, 120, 600, 68, 249, 600, 171, 600, 565, 600, 600, 88, 600, 600, 98, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 85, 600, 600, 146, 2, 224, 60, 600, 51, 600, 600, 600, 58, 600, 600, 87, 600, 600, 560, 600, 600, 600, 600, 600, 41, 39, 600, 600, 600, 600, 600, 150, 600, 600, 109, 600, 600, 600, 600, 600, 76, 600, 600, 7, 600, 600, 600, 210, 573, 600, 600, 600, 600, 125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 175.92741913671267, "mean_inference_ms": 688.9229537059913, "mean_action_processing_ms": 32.818506630841675, "mean_env_wait_ms": 4009.324254183392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.3133766651153564, "StateBufferConnector_ms": 0.8264086246490479, "ViewRequirementAgentConnector_ms": 34.68004560470581}}, "episode_reward_max": 482.3537279760648, "episode_reward_min": 0.7750408806170728, "episode_reward_mean": 369.6474274310705, "episode_len_mean": 469.12, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [477.8794857579432, 474.5922870427063, 146.823863266538, 474.5307786989713, 51.92782273521137, 467.0446443103415, 469.3942673139697, 470.9250016359874, 470.60265662386416, 459.7549974986997, 469.0560161870684, 475.43428461506187, 468.51239396849707, 476.9680802014899, 55.077573867695016, 87.41101743350367, 447.3279324083805, 102.97343961394289, 468.3986944792195, 57.121293534545565, 200.17751823942817, 469.88491781917503, 143.8513128874522, 473.473737260909, 440.23765397532526, 470.2133943294467, 473.8272216756184, 72.92717917805263, 470.76829418312485, 469.3814049747449, 81.22987949920976, 482.3537279760648, 468.46995268177346, 471.342204536068, 468.3412683365142, 470.95170790095045, 481.34194879599414, 469.4329501502794, 468.5376983940718, 475.08194191714244, 471.3509914182769, 476.4770797814117, 471.5569170901002, 472.62023313785045, 471.61513909314795, 471.3657974218768, 68.82235614795121, 467.0044669731596, 469.4202492776038, 116.04607292494633, 0.7750408806170728, 176.37541875457262, 51.39012814480577, 471.61076667699695, 42.26997216102932, 477.90413019691897, 467.47377045527304, 474.6461101825013, 48.95301475056655, 475.0917454520376, 465.438820082558, 78.13058926896741, 470.8361167524952, 468.7716388613837, 439.755084128508, 474.06330988947957, 469.4139970674371, 473.76677776034506, 471.6682281131259, 469.41536726125724, 34.30841493769916, 32.71930209889591, 474.0331865707941, 466.8472315966046, 473.3627734493782, 469.75083649972214, 470.68764449468335, 127.61418378060169, 468.3620807483493, 473.0704524955299, 89.12706154162932, 469.75939173832444, 467.19818161402156, 473.01915985566063, 469.24048843801, 469.84089347590924, 62.65876570755802, 469.1365697629621, 467.5005819778756, 5.931658854651541, 470.7405255514244, 472.72399914749803, 468.7107400962412, 172.52891064787673, 444.9015753565586, 467.957261585945, 470.53387834823474, 471.1851336636741, 470.92344322423, 102.75663983432662], "episode_lengths": [600, 600, 175, 600, 64, 600, 600, 600, 600, 582, 600, 600, 600, 600, 62, 102, 565, 120, 600, 68, 249, 600, 171, 600, 565, 600, 600, 88, 600, 600, 98, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 85, 600, 600, 146, 2, 224, 60, 600, 51, 600, 600, 600, 58, 600, 600, 87, 600, 600, 560, 600, 600, 600, 600, 600, 41, 39, 600, 600, 600, 600, 600, 150, 600, 600, 109, 600, 600, 600, 600, 600, 76, 600, 600, 7, 600, 600, 600, 210, 573, 600, 600, 600, 600, 125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 175.92741913671267, "mean_inference_ms": 688.9229537059913, "mean_action_processing_ms": 32.818506630841675, "mean_env_wait_ms": 4009.324254183392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.3133766651153564, "StateBufferConnector_ms": 0.8264086246490479, "ViewRequirementAgentConnector_ms": 34.68004560470581}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.617285758387798, "num_env_steps_trained_throughput_per_sec": 8.617285758387798, "timesteps_total": 200000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 1147728.994, "sample_time_ms": 1039196.446, "load_time_ms": 2459.61, "load_throughput": 4065.685, "learn_time_ms": 104980.339, "learn_throughput": 95.256, "synch_weights_time_ms": 1064.399}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 2305, "training_iteration": 20, "trial_id": "ef367_00000", "date": "2024-01-23_16-31-19", "timestamp": 1705998679, "time_this_iter_s": 1160.5723617076874, "time_total_s": 22348.049374341965, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 22348.049374341965, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 0.9285447761194031, "ram_util_percent": 20.96324626865672}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 2.4541576189402905, "policy_loss": -0.01991284644493881, "vf_loss": 2.470508040761591, "vf_explained_var": -0.3299808392412642, "kl": 0.01187473775770308, "entropy": 2.4237007988823787, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 47970.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 210000, "num_env_steps_trained": 210000, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000}, "sampler_results": {"episode_reward_max": 482.3537279760648, "episode_reward_min": 0.7750408806170728, "episode_reward_mean": 375.169422497582, "episode_len_mean": 477.12, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [447.3279324083805, 102.97343961394289, 468.3986944792195, 57.121293534545565, 200.17751823942817, 469.88491781917503, 143.8513128874522, 473.473737260909, 440.23765397532526, 470.2133943294467, 473.8272216756184, 72.92717917805263, 470.76829418312485, 469.3814049747449, 81.22987949920976, 482.3537279760648, 468.46995268177346, 471.342204536068, 468.3412683365142, 470.95170790095045, 481.34194879599414, 469.4329501502794, 468.5376983940718, 475.08194191714244, 471.3509914182769, 476.4770797814117, 471.5569170901002, 472.62023313785045, 471.61513909314795, 471.3657974218768, 68.82235614795121, 467.0044669731596, 469.4202492776038, 116.04607292494633, 0.7750408806170728, 176.37541875457262, 51.39012814480577, 471.61076667699695, 42.26997216102932, 477.90413019691897, 467.47377045527304, 474.6461101825013, 48.95301475056655, 475.0917454520376, 465.438820082558, 78.13058926896741, 470.8361167524952, 468.7716388613837, 439.755084128508, 474.06330988947957, 469.4139970674371, 473.76677776034506, 471.6682281131259, 469.41536726125724, 34.30841493769916, 32.71930209889591, 474.0331865707941, 466.8472315966046, 473.3627734493782, 469.75083649972214, 470.68764449468335, 127.61418378060169, 468.3620807483493, 473.0704524955299, 89.12706154162932, 469.75939173832444, 467.19818161402156, 473.01915985566063, 469.24048843801, 469.84089347590924, 62.65876570755802, 469.1365697629621, 467.5005819778756, 5.931658854651541, 470.7405255514244, 472.72399914749803, 468.7107400962412, 172.52891064787673, 444.9015753565586, 467.957261585945, 470.53387834823474, 471.1851336636741, 470.92344322423, 102.75663983432662, 454.9558799513768, 468.93745029322184, 470.541815626277, 366.6537111239768, 65.80295729229069, 469.399068804023, 472.4909379538887, 471.24835966847616, 466.2816261163271, 463.2477998806557, 474.0605227361834, 30.107477465288873, 471.1473324822263, 466.8758386002129, 470.30228362322583, 466.081616191032], "episode_lengths": [565, 120, 600, 68, 249, 600, 171, 600, 565, 600, 600, 88, 600, 600, 98, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 85, 600, 600, 146, 2, 224, 60, 600, 51, 600, 600, 600, 58, 600, 600, 87, 600, 600, 560, 600, 600, 600, 600, 600, 41, 39, 600, 600, 600, 600, 600, 150, 600, 600, 109, 600, 600, 600, 600, 600, 76, 600, 600, 7, 600, 600, 600, 210, 573, 600, 600, 600, 600, 125, 600, 600, 600, 471, 81, 600, 600, 600, 600, 596, 600, 37, 600, 600, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 175.03076651293017, "mean_inference_ms": 689.3871948335722, "mean_action_processing_ms": 32.89012977654643, "mean_env_wait_ms": 4021.1936767940183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8486275672912598, "StateBufferConnector_ms": 0.3795480728149414, "ViewRequirementAgentConnector_ms": 36.34777569770813}}, "episode_reward_max": 482.3537279760648, "episode_reward_min": 0.7750408806170728, "episode_reward_mean": 375.169422497582, "episode_len_mean": 477.12, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [447.3279324083805, 102.97343961394289, 468.3986944792195, 57.121293534545565, 200.17751823942817, 469.88491781917503, 143.8513128874522, 473.473737260909, 440.23765397532526, 470.2133943294467, 473.8272216756184, 72.92717917805263, 470.76829418312485, 469.3814049747449, 81.22987949920976, 482.3537279760648, 468.46995268177346, 471.342204536068, 468.3412683365142, 470.95170790095045, 481.34194879599414, 469.4329501502794, 468.5376983940718, 475.08194191714244, 471.3509914182769, 476.4770797814117, 471.5569170901002, 472.62023313785045, 471.61513909314795, 471.3657974218768, 68.82235614795121, 467.0044669731596, 469.4202492776038, 116.04607292494633, 0.7750408806170728, 176.37541875457262, 51.39012814480577, 471.61076667699695, 42.26997216102932, 477.90413019691897, 467.47377045527304, 474.6461101825013, 48.95301475056655, 475.0917454520376, 465.438820082558, 78.13058926896741, 470.8361167524952, 468.7716388613837, 439.755084128508, 474.06330988947957, 469.4139970674371, 473.76677776034506, 471.6682281131259, 469.41536726125724, 34.30841493769916, 32.71930209889591, 474.0331865707941, 466.8472315966046, 473.3627734493782, 469.75083649972214, 470.68764449468335, 127.61418378060169, 468.3620807483493, 473.0704524955299, 89.12706154162932, 469.75939173832444, 467.19818161402156, 473.01915985566063, 469.24048843801, 469.84089347590924, 62.65876570755802, 469.1365697629621, 467.5005819778756, 5.931658854651541, 470.7405255514244, 472.72399914749803, 468.7107400962412, 172.52891064787673, 444.9015753565586, 467.957261585945, 470.53387834823474, 471.1851336636741, 470.92344322423, 102.75663983432662, 454.9558799513768, 468.93745029322184, 470.541815626277, 366.6537111239768, 65.80295729229069, 469.399068804023, 472.4909379538887, 471.24835966847616, 466.2816261163271, 463.2477998806557, 474.0605227361834, 30.107477465288873, 471.1473324822263, 466.8758386002129, 470.30228362322583, 466.081616191032], "episode_lengths": [565, 120, 600, 68, 249, 600, 171, 600, 565, 600, 600, 88, 600, 600, 98, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 85, 600, 600, 146, 2, 224, 60, 600, 51, 600, 600, 600, 58, 600, 600, 87, 600, 600, 560, 600, 600, 600, 600, 600, 41, 39, 600, 600, 600, 600, 600, 150, 600, 600, 109, 600, 600, 600, 600, 600, 76, 600, 600, 7, 600, 600, 600, 210, 573, 600, 600, 600, 600, 125, 600, 600, 600, 471, 81, 600, 600, 600, 600, 596, 600, 37, 600, 600, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 175.03076651293017, "mean_inference_ms": 689.3871948335722, "mean_action_processing_ms": 32.89012977654643, "mean_env_wait_ms": 4021.1936767940183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8486275672912598, "StateBufferConnector_ms": 0.3795480728149414, "ViewRequirementAgentConnector_ms": 36.34777569770813}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000, "num_env_steps_sampled": 210000, "num_env_steps_trained": 210000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.502362793582703, "num_env_steps_trained_throughput_per_sec": 8.502362793582703, "timesteps_total": 210000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 210000, "timers": {"training_iteration_time_ms": 1152955.888, "sample_time_ms": 1042887.422, "load_time_ms": 2769.549, "load_throughput": 3610.696, "learn_time_ms": 106217.295, "learn_throughput": 94.147, "synch_weights_time_ms": 1053.145}, "counters": {"num_env_steps_sampled": 210000, "num_env_steps_trained": 210000, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000}, "done": false, "episodes_total": 2321, "training_iteration": 21, "trial_id": "ef367_00000", "date": "2024-01-23_16-50-56", "timestamp": 1705999856, "time_this_iter_s": 1176.2791376113892, "time_total_s": 23524.328511953354, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 23524.328511953354, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 2.2256441717791415, "ram_util_percent": 20.94754601226994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 1.843597504368816, "policy_loss": -0.02060269967167296, "vf_loss": 1.8607439275162343, "vf_explained_var": -0.5465428329176373, "kl": 0.011520928130760843, "entropy": 2.427905105525612, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 50310.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": 481.34194879599414, "episode_reward_min": 0.7750408806170728, "episode_reward_mean": 393.19042964273694, "episode_len_mean": 500.96, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [468.46995268177346, 471.342204536068, 468.3412683365142, 470.95170790095045, 481.34194879599414, 469.4329501502794, 468.5376983940718, 475.08194191714244, 471.3509914182769, 476.4770797814117, 471.5569170901002, 472.62023313785045, 471.61513909314795, 471.3657974218768, 68.82235614795121, 467.0044669731596, 469.4202492776038, 116.04607292494633, 0.7750408806170728, 176.37541875457262, 51.39012814480577, 471.61076667699695, 42.26997216102932, 477.90413019691897, 467.47377045527304, 474.6461101825013, 48.95301475056655, 475.0917454520376, 465.438820082558, 78.13058926896741, 470.8361167524952, 468.7716388613837, 439.755084128508, 474.06330988947957, 469.4139970674371, 473.76677776034506, 471.6682281131259, 469.41536726125724, 34.30841493769916, 32.71930209889591, 474.0331865707941, 466.8472315966046, 473.3627734493782, 469.75083649972214, 470.68764449468335, 127.61418378060169, 468.3620807483493, 473.0704524955299, 89.12706154162932, 469.75939173832444, 467.19818161402156, 473.01915985566063, 469.24048843801, 469.84089347590924, 62.65876570755802, 469.1365697629621, 467.5005819778756, 5.931658854651541, 470.7405255514244, 472.72399914749803, 468.7107400962412, 172.52891064787673, 444.9015753565586, 467.957261585945, 470.53387834823474, 471.1851336636741, 470.92344322423, 102.75663983432662, 454.9558799513768, 468.93745029322184, 470.541815626277, 366.6537111239768, 65.80295729229069, 469.399068804023, 472.4909379538887, 471.24835966847616, 466.2816261163271, 463.2477998806557, 474.0605227361834, 30.107477465288873, 471.1473324822263, 466.8758386002129, 470.30228362322583, 466.081616191032, 467.1237388033617, 249.08776860612912, 477.8871520123848, 472.6626623042222, 468.3187842635503, 469.3122302623839, 451.5323859973665, 462.17721297979847, 466.19469348447035, 472.06485384876623, 415.17763967159453, 471.9752629088132, 376.346050207035, 467.191190212295, 467.7556008366512, 471.44109015131755], "episode_lengths": [600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 85, 600, 600, 146, 2, 224, 60, 600, 51, 600, 600, 600, 58, 600, 600, 87, 600, 600, 560, 600, 600, 600, 600, 600, 41, 39, 600, 600, 600, 600, 600, 150, 600, 600, 109, 600, 600, 600, 600, 600, 76, 600, 600, 7, 600, 600, 600, 210, 573, 600, 600, 600, 600, 125, 600, 600, 600, 471, 81, 600, 600, 600, 600, 596, 600, 37, 600, 600, 600, 600, 600, 316, 600, 600, 600, 600, 575, 600, 600, 600, 532, 600, 485, 600, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 174.16753681556983, "mean_inference_ms": 690.7294236143895, "mean_action_processing_ms": 32.86311017430044, "mean_env_wait_ms": 4031.0522031032574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.152495861053467, "StateBufferConnector_ms": 0.379410982131958, "ViewRequirementAgentConnector_ms": 33.946943521499634}}, "episode_reward_max": 481.34194879599414, "episode_reward_min": 0.7750408806170728, "episode_reward_mean": 393.19042964273694, "episode_len_mean": 500.96, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [468.46995268177346, 471.342204536068, 468.3412683365142, 470.95170790095045, 481.34194879599414, 469.4329501502794, 468.5376983940718, 475.08194191714244, 471.3509914182769, 476.4770797814117, 471.5569170901002, 472.62023313785045, 471.61513909314795, 471.3657974218768, 68.82235614795121, 467.0044669731596, 469.4202492776038, 116.04607292494633, 0.7750408806170728, 176.37541875457262, 51.39012814480577, 471.61076667699695, 42.26997216102932, 477.90413019691897, 467.47377045527304, 474.6461101825013, 48.95301475056655, 475.0917454520376, 465.438820082558, 78.13058926896741, 470.8361167524952, 468.7716388613837, 439.755084128508, 474.06330988947957, 469.4139970674371, 473.76677776034506, 471.6682281131259, 469.41536726125724, 34.30841493769916, 32.71930209889591, 474.0331865707941, 466.8472315966046, 473.3627734493782, 469.75083649972214, 470.68764449468335, 127.61418378060169, 468.3620807483493, 473.0704524955299, 89.12706154162932, 469.75939173832444, 467.19818161402156, 473.01915985566063, 469.24048843801, 469.84089347590924, 62.65876570755802, 469.1365697629621, 467.5005819778756, 5.931658854651541, 470.7405255514244, 472.72399914749803, 468.7107400962412, 172.52891064787673, 444.9015753565586, 467.957261585945, 470.53387834823474, 471.1851336636741, 470.92344322423, 102.75663983432662, 454.9558799513768, 468.93745029322184, 470.541815626277, 366.6537111239768, 65.80295729229069, 469.399068804023, 472.4909379538887, 471.24835966847616, 466.2816261163271, 463.2477998806557, 474.0605227361834, 30.107477465288873, 471.1473324822263, 466.8758386002129, 470.30228362322583, 466.081616191032, 467.1237388033617, 249.08776860612912, 477.8871520123848, 472.6626623042222, 468.3187842635503, 469.3122302623839, 451.5323859973665, 462.17721297979847, 466.19469348447035, 472.06485384876623, 415.17763967159453, 471.9752629088132, 376.346050207035, 467.191190212295, 467.7556008366512, 471.44109015131755], "episode_lengths": [600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 85, 600, 600, 146, 2, 224, 60, 600, 51, 600, 600, 600, 58, 600, 600, 87, 600, 600, 560, 600, 600, 600, 600, 600, 41, 39, 600, 600, 600, 600, 600, 150, 600, 600, 109, 600, 600, 600, 600, 600, 76, 600, 600, 7, 600, 600, 600, 210, 573, 600, 600, 600, 600, 125, 600, 600, 600, 471, 81, 600, 600, 600, 600, 596, 600, 37, 600, 600, 600, 600, 600, 316, 600, 600, 600, 600, 575, 600, 600, 600, 532, 600, 485, 600, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 174.16753681556983, "mean_inference_ms": 690.7294236143895, "mean_action_processing_ms": 32.86311017430044, "mean_env_wait_ms": 4031.0522031032574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.152495861053467, "StateBufferConnector_ms": 0.379410982131958, "ViewRequirementAgentConnector_ms": 33.946943521499634}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.30793510219751, "num_env_steps_trained_throughput_per_sec": 8.30793510219751, "timesteps_total": 220000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 1159482.888, "sample_time_ms": 1046874.327, "load_time_ms": 3008.867, "load_throughput": 3323.51, "learn_time_ms": 108428.237, "learn_throughput": 92.227, "synch_weights_time_ms": 1059.878}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 2337, "training_iteration": 22, "trial_id": "ef367_00000", "date": "2024-01-23_17-11-01", "timestamp": 1706001061, "time_this_iter_s": 1204.6008450984955, "time_total_s": 24728.92935705185, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 24728.92935705185, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 8.467327327327329, "ram_util_percent": 21.356156156156157}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 1.897858703880756, "policy_loss": -0.019734784204544675, "vf_loss": 1.913959618861604, "vf_explained_var": -0.36436665636351984, "kl": 0.01211291450020707, "entropy": 2.4342713016730086, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 52650.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 230000, "num_env_steps_trained": 230000, "num_agent_steps_sampled": 230000, "num_agent_steps_trained": 230000}, "sampler_results": {"episode_reward_max": 477.8871520123848, "episode_reward_min": 5.931658854651541, "episode_reward_mean": 400.0288058419467, "episode_len_mean": 510.08, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [474.6461101825013, 48.95301475056655, 475.0917454520376, 465.438820082558, 78.13058926896741, 470.8361167524952, 468.7716388613837, 439.755084128508, 474.06330988947957, 469.4139970674371, 473.76677776034506, 471.6682281131259, 469.41536726125724, 34.30841493769916, 32.71930209889591, 474.0331865707941, 466.8472315966046, 473.3627734493782, 469.75083649972214, 470.68764449468335, 127.61418378060169, 468.3620807483493, 473.0704524955299, 89.12706154162932, 469.75939173832444, 467.19818161402156, 473.01915985566063, 469.24048843801, 469.84089347590924, 62.65876570755802, 469.1365697629621, 467.5005819778756, 5.931658854651541, 470.7405255514244, 472.72399914749803, 468.7107400962412, 172.52891064787673, 444.9015753565586, 467.957261585945, 470.53387834823474, 471.1851336636741, 470.92344322423, 102.75663983432662, 454.9558799513768, 468.93745029322184, 470.541815626277, 366.6537111239768, 65.80295729229069, 469.399068804023, 472.4909379538887, 471.24835966847616, 466.2816261163271, 463.2477998806557, 474.0605227361834, 30.107477465288873, 471.1473324822263, 466.8758386002129, 470.30228362322583, 466.081616191032, 467.1237388033617, 249.08776860612912, 477.8871520123848, 472.6626623042222, 468.3187842635503, 469.3122302623839, 451.5323859973665, 462.17721297979847, 466.19469348447035, 472.06485384876623, 415.17763967159453, 471.9752629088132, 376.346050207035, 467.191190212295, 467.7556008366512, 471.44109015131755, 54.53743703145129, 469.351717155791, 469.1608604164367, 467.98375474633195, 123.17521971927815, 463.38661345706777, 416.6370820998341, 473.61618768540313, 474.3455405717031, 467.08920844931794, 468.9158175332758, 470.9655585924538, 470.88461386354703, 469.1611341409106, 62.298220629653954, 471.06116817568284, 468.9204522524345, 469.14849970179245, 51.06126756873316, 473.70685073908646, 468.13930315635355, 469.1165758536489, 469.4026414379432, 471.3162640252199, 468.03383416695436], "episode_lengths": [600, 58, 600, 600, 87, 600, 600, 560, 600, 600, 600, 600, 600, 41, 39, 600, 600, 600, 600, 600, 150, 600, 600, 109, 600, 600, 600, 600, 600, 76, 600, 600, 7, 600, 600, 600, 210, 573, 600, 600, 600, 600, 125, 600, 600, 600, 471, 81, 600, 600, 600, 600, 596, 600, 37, 600, 600, 600, 600, 600, 316, 600, 600, 600, 600, 575, 600, 600, 600, 532, 600, 485, 600, 600, 600, 63, 600, 600, 600, 147, 600, 536, 600, 600, 600, 600, 600, 600, 600, 75, 600, 600, 600, 59, 600, 600, 600, 600, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 173.59327923745383, "mean_inference_ms": 693.0314770191925, "mean_action_processing_ms": 32.96723435817466, "mean_env_wait_ms": 4038.277486864131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.6855878829956055, "StateBufferConnector_ms": 0.3793790340423584, "ViewRequirementAgentConnector_ms": 30.614625930786133}}, "episode_reward_max": 477.8871520123848, "episode_reward_min": 5.931658854651541, "episode_reward_mean": 400.0288058419467, "episode_len_mean": 510.08, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [474.6461101825013, 48.95301475056655, 475.0917454520376, 465.438820082558, 78.13058926896741, 470.8361167524952, 468.7716388613837, 439.755084128508, 474.06330988947957, 469.4139970674371, 473.76677776034506, 471.6682281131259, 469.41536726125724, 34.30841493769916, 32.71930209889591, 474.0331865707941, 466.8472315966046, 473.3627734493782, 469.75083649972214, 470.68764449468335, 127.61418378060169, 468.3620807483493, 473.0704524955299, 89.12706154162932, 469.75939173832444, 467.19818161402156, 473.01915985566063, 469.24048843801, 469.84089347590924, 62.65876570755802, 469.1365697629621, 467.5005819778756, 5.931658854651541, 470.7405255514244, 472.72399914749803, 468.7107400962412, 172.52891064787673, 444.9015753565586, 467.957261585945, 470.53387834823474, 471.1851336636741, 470.92344322423, 102.75663983432662, 454.9558799513768, 468.93745029322184, 470.541815626277, 366.6537111239768, 65.80295729229069, 469.399068804023, 472.4909379538887, 471.24835966847616, 466.2816261163271, 463.2477998806557, 474.0605227361834, 30.107477465288873, 471.1473324822263, 466.8758386002129, 470.30228362322583, 466.081616191032, 467.1237388033617, 249.08776860612912, 477.8871520123848, 472.6626623042222, 468.3187842635503, 469.3122302623839, 451.5323859973665, 462.17721297979847, 466.19469348447035, 472.06485384876623, 415.17763967159453, 471.9752629088132, 376.346050207035, 467.191190212295, 467.7556008366512, 471.44109015131755, 54.53743703145129, 469.351717155791, 469.1608604164367, 467.98375474633195, 123.17521971927815, 463.38661345706777, 416.6370820998341, 473.61618768540313, 474.3455405717031, 467.08920844931794, 468.9158175332758, 470.9655585924538, 470.88461386354703, 469.1611341409106, 62.298220629653954, 471.06116817568284, 468.9204522524345, 469.14849970179245, 51.06126756873316, 473.70685073908646, 468.13930315635355, 469.1165758536489, 469.4026414379432, 471.3162640252199, 468.03383416695436], "episode_lengths": [600, 58, 600, 600, 87, 600, 600, 560, 600, 600, 600, 600, 600, 41, 39, 600, 600, 600, 600, 600, 150, 600, 600, 109, 600, 600, 600, 600, 600, 76, 600, 600, 7, 600, 600, 600, 210, 573, 600, 600, 600, 600, 125, 600, 600, 600, 471, 81, 600, 600, 600, 600, 596, 600, 37, 600, 600, 600, 600, 600, 316, 600, 600, 600, 600, 575, 600, 600, 600, 532, 600, 485, 600, 600, 600, 63, 600, 600, 600, 147, 600, 536, 600, 600, 600, 600, 600, 600, 600, 75, 600, 600, 600, 59, 600, 600, 600, 600, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 173.59327923745383, "mean_inference_ms": 693.0314770191925, "mean_action_processing_ms": 32.96723435817466, "mean_env_wait_ms": 4038.277486864131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.6855878829956055, "StateBufferConnector_ms": 0.3793790340423584, "ViewRequirementAgentConnector_ms": 30.614625930786133}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230000, "num_agent_steps_trained": 230000, "num_env_steps_sampled": 230000, "num_env_steps_trained": 230000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.441463652327815, "num_env_steps_trained_throughput_per_sec": 8.441463652327815, "timesteps_total": 230000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 230000, "timers": {"training_iteration_time_ms": 1163653.714, "sample_time_ms": 1049315.091, "load_time_ms": 2756.965, "load_throughput": 3627.178, "learn_time_ms": 110392.792, "learn_throughput": 90.586, "synch_weights_time_ms": 1076.878}, "counters": {"num_env_steps_sampled": 230000, "num_env_steps_trained": 230000, "num_agent_steps_sampled": 230000, "num_agent_steps_trained": 230000}, "done": false, "episodes_total": 2362, "training_iteration": 23, "trial_id": "ef367_00000", "date": "2024-01-23_17-30-46", "timestamp": 1706002246, "time_this_iter_s": 1184.762936592102, "time_total_s": 25913.69229364395, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 25913.69229364395, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 0.9221130221130223, "ram_util_percent": 20.991523341523344}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 1.2059966257776822, "policy_loss": -0.020059352245134037, "vf_loss": 1.2225718750355719, "vf_explained_var": -0.5197097323134414, "kl": 0.011613673057277044, "entropy": 2.484023399026985, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 54990.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 477.8871520123848, "episode_reward_min": 5.931658854651541, "episode_reward_mean": 401.0310809194551, "episode_len_mean": 511.7, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [473.3627734493782, 469.75083649972214, 470.68764449468335, 127.61418378060169, 468.3620807483493, 473.0704524955299, 89.12706154162932, 469.75939173832444, 467.19818161402156, 473.01915985566063, 469.24048843801, 469.84089347590924, 62.65876570755802, 469.1365697629621, 467.5005819778756, 5.931658854651541, 470.7405255514244, 472.72399914749803, 468.7107400962412, 172.52891064787673, 444.9015753565586, 467.957261585945, 470.53387834823474, 471.1851336636741, 470.92344322423, 102.75663983432662, 454.9558799513768, 468.93745029322184, 470.541815626277, 366.6537111239768, 65.80295729229069, 469.399068804023, 472.4909379538887, 471.24835966847616, 466.2816261163271, 463.2477998806557, 474.0605227361834, 30.107477465288873, 471.1473324822263, 466.8758386002129, 470.30228362322583, 466.081616191032, 467.1237388033617, 249.08776860612912, 477.8871520123848, 472.6626623042222, 468.3187842635503, 469.3122302623839, 451.5323859973665, 462.17721297979847, 466.19469348447035, 472.06485384876623, 415.17763967159453, 471.9752629088132, 376.346050207035, 467.191190212295, 467.7556008366512, 471.44109015131755, 54.53743703145129, 469.351717155791, 469.1608604164367, 467.98375474633195, 123.17521971927815, 463.38661345706777, 416.6370820998341, 473.61618768540313, 474.3455405717031, 467.08920844931794, 468.9158175332758, 470.9655585924538, 470.88461386354703, 469.1611341409106, 62.298220629653954, 471.06116817568284, 468.9204522524345, 469.14849970179245, 51.06126756873316, 473.70685073908646, 468.13930315635355, 469.1165758536489, 469.4026414379432, 471.3162640252199, 468.03383416695436, 470.9647119616046, 469.2553739128628, 48.956615695896296, 468.9304037022279, 470.5784196316545, 70.75289042895301, 471.1034320227786, 423.9422026648778, 472.621453886998, 122.533867370494, 466.78906875139285, 464.5269338557018, 469.51813469057777, 94.01734068303051, 468.89694629407603, 465.5651933659373, 469.13345360644695], "episode_lengths": [600, 600, 600, 150, 600, 600, 109, 600, 600, 600, 600, 600, 76, 600, 600, 7, 600, 600, 600, 210, 573, 600, 600, 600, 600, 125, 600, 600, 600, 471, 81, 600, 600, 600, 600, 596, 600, 37, 600, 600, 600, 600, 600, 316, 600, 600, 600, 600, 575, 600, 600, 600, 532, 600, 485, 600, 600, 600, 63, 600, 600, 600, 147, 600, 536, 600, 600, 600, 600, 600, 600, 600, 75, 600, 600, 600, 59, 600, 600, 600, 600, 600, 600, 600, 600, 60, 600, 600, 84, 600, 547, 600, 146, 600, 600, 600, 110, 600, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 172.36078438313714, "mean_inference_ms": 693.0405755265618, "mean_action_processing_ms": 32.8485553964048, "mean_env_wait_ms": 4046.6058792315366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.738055467605591, "StateBufferConnector_ms": 0.009905576705932617, "ViewRequirementAgentConnector_ms": 33.89730668067932}}, "episode_reward_max": 477.8871520123848, "episode_reward_min": 5.931658854651541, "episode_reward_mean": 401.0310809194551, "episode_len_mean": 511.7, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [473.3627734493782, 469.75083649972214, 470.68764449468335, 127.61418378060169, 468.3620807483493, 473.0704524955299, 89.12706154162932, 469.75939173832444, 467.19818161402156, 473.01915985566063, 469.24048843801, 469.84089347590924, 62.65876570755802, 469.1365697629621, 467.5005819778756, 5.931658854651541, 470.7405255514244, 472.72399914749803, 468.7107400962412, 172.52891064787673, 444.9015753565586, 467.957261585945, 470.53387834823474, 471.1851336636741, 470.92344322423, 102.75663983432662, 454.9558799513768, 468.93745029322184, 470.541815626277, 366.6537111239768, 65.80295729229069, 469.399068804023, 472.4909379538887, 471.24835966847616, 466.2816261163271, 463.2477998806557, 474.0605227361834, 30.107477465288873, 471.1473324822263, 466.8758386002129, 470.30228362322583, 466.081616191032, 467.1237388033617, 249.08776860612912, 477.8871520123848, 472.6626623042222, 468.3187842635503, 469.3122302623839, 451.5323859973665, 462.17721297979847, 466.19469348447035, 472.06485384876623, 415.17763967159453, 471.9752629088132, 376.346050207035, 467.191190212295, 467.7556008366512, 471.44109015131755, 54.53743703145129, 469.351717155791, 469.1608604164367, 467.98375474633195, 123.17521971927815, 463.38661345706777, 416.6370820998341, 473.61618768540313, 474.3455405717031, 467.08920844931794, 468.9158175332758, 470.9655585924538, 470.88461386354703, 469.1611341409106, 62.298220629653954, 471.06116817568284, 468.9204522524345, 469.14849970179245, 51.06126756873316, 473.70685073908646, 468.13930315635355, 469.1165758536489, 469.4026414379432, 471.3162640252199, 468.03383416695436, 470.9647119616046, 469.2553739128628, 48.956615695896296, 468.9304037022279, 470.5784196316545, 70.75289042895301, 471.1034320227786, 423.9422026648778, 472.621453886998, 122.533867370494, 466.78906875139285, 464.5269338557018, 469.51813469057777, 94.01734068303051, 468.89694629407603, 465.5651933659373, 469.13345360644695], "episode_lengths": [600, 600, 600, 150, 600, 600, 109, 600, 600, 600, 600, 600, 76, 600, 600, 7, 600, 600, 600, 210, 573, 600, 600, 600, 600, 125, 600, 600, 600, 471, 81, 600, 600, 600, 600, 596, 600, 37, 600, 600, 600, 600, 600, 316, 600, 600, 600, 600, 575, 600, 600, 600, 532, 600, 485, 600, 600, 600, 63, 600, 600, 600, 147, 600, 536, 600, 600, 600, 600, 600, 600, 600, 75, 600, 600, 600, 59, 600, 600, 600, 600, 600, 600, 600, 600, 60, 600, 600, 84, 600, 547, 600, 146, 600, 600, 600, 110, 600, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 172.36078438313714, "mean_inference_ms": 693.0405755265618, "mean_action_processing_ms": 32.8485553964048, "mean_env_wait_ms": 4046.6058792315366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.738055467605591, "StateBufferConnector_ms": 0.009905576705932617, "ViewRequirementAgentConnector_ms": 33.89730668067932}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.427878776556698, "num_env_steps_trained_throughput_per_sec": 8.427878776556698, "timesteps_total": 240000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 1167398.074, "sample_time_ms": 1051706.734, "load_time_ms": 3037.286, "load_throughput": 3292.413, "learn_time_ms": 111467.864, "learn_throughput": 89.712, "synch_weights_time_ms": 1073.567}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 2379, "training_iteration": 24, "trial_id": "ef367_00000", "date": "2024-01-23_17-50-33", "timestamp": 1706003433, "time_this_iter_s": 1186.672527551651, "time_total_s": 27100.364821195602, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 27100.364821195602, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 1.0523809523809524, "ram_util_percent": 20.97893772893773}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 1.2624062617670577, "policy_loss": -0.018346033977647114, "vf_loss": 1.2773379248805725, "vf_explained_var": -0.48704692107489983, "kl": 0.011381244255595165, "entropy": 2.4966465066640806, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 57330.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 250000, "num_env_steps_trained": 250000, "num_agent_steps_sampled": 250000, "num_agent_steps_trained": 250000}, "sampler_results": {"episode_reward_max": 477.8871520123848, "episode_reward_min": 30.107477465288873, "episode_reward_mean": 414.53196857663033, "episode_len_mean": 529.21, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [472.72399914749803, 468.7107400962412, 172.52891064787673, 444.9015753565586, 467.957261585945, 470.53387834823474, 471.1851336636741, 470.92344322423, 102.75663983432662, 454.9558799513768, 468.93745029322184, 470.541815626277, 366.6537111239768, 65.80295729229069, 469.399068804023, 472.4909379538887, 471.24835966847616, 466.2816261163271, 463.2477998806557, 474.0605227361834, 30.107477465288873, 471.1473324822263, 466.8758386002129, 470.30228362322583, 466.081616191032, 467.1237388033617, 249.08776860612912, 477.8871520123848, 472.6626623042222, 468.3187842635503, 469.3122302623839, 451.5323859973665, 462.17721297979847, 466.19469348447035, 472.06485384876623, 415.17763967159453, 471.9752629088132, 376.346050207035, 467.191190212295, 467.7556008366512, 471.44109015131755, 54.53743703145129, 469.351717155791, 469.1608604164367, 467.98375474633195, 123.17521971927815, 463.38661345706777, 416.6370820998341, 473.61618768540313, 474.3455405717031, 467.08920844931794, 468.9158175332758, 470.9655585924538, 470.88461386354703, 469.1611341409106, 62.298220629653954, 471.06116817568284, 468.9204522524345, 469.14849970179245, 51.06126756873316, 473.70685073908646, 468.13930315635355, 469.1165758536489, 469.4026414379432, 471.3162640252199, 468.03383416695436, 470.9647119616046, 469.2553739128628, 48.956615695896296, 468.9304037022279, 470.5784196316545, 70.75289042895301, 471.1034320227786, 423.9422026648778, 472.621453886998, 122.533867370494, 466.78906875139285, 464.5269338557018, 469.51813469057777, 94.01734068303051, 468.89694629407603, 465.5651933659373, 469.13345360644695, 474.65101732020094, 477.2926112019699, 468.1375273455975, 470.52720935582386, 469.4122735853754, 470.50369468595574, 462.33341072494267, 473.02408766580993, 415.55925648595, 467.34275762988744, 466.87113085164066, 468.81716616588966, 352.11536353607886, 469.1963754715069, 473.79420169467573, 470.81583915594206, 396.696092826571], "episode_lengths": [600, 600, 210, 573, 600, 600, 600, 600, 125, 600, 600, 600, 471, 81, 600, 600, 600, 600, 596, 600, 37, 600, 600, 600, 600, 600, 316, 600, 600, 600, 600, 575, 600, 600, 600, 532, 600, 485, 600, 600, 600, 63, 600, 600, 600, 147, 600, 536, 600, 600, 600, 600, 600, 600, 600, 75, 600, 600, 600, 59, 600, 600, 600, 600, 600, 600, 600, 600, 60, 600, 600, 84, 600, 547, 600, 146, 600, 600, 600, 110, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 531, 600, 600, 600, 454, 600, 600, 600, 508]}, "sampler_perf": {"mean_raw_obs_processing_ms": 172.206693875652, "mean_inference_ms": 694.787207863135, "mean_action_processing_ms": 32.8407998549787, "mean_env_wait_ms": 4053.432500944622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.7376222610473633, "StateBufferConnector_ms": 0.5443716049194336, "ViewRequirementAgentConnector_ms": 35.45275664329529}}, "episode_reward_max": 477.8871520123848, "episode_reward_min": 30.107477465288873, "episode_reward_mean": 414.53196857663033, "episode_len_mean": 529.21, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [472.72399914749803, 468.7107400962412, 172.52891064787673, 444.9015753565586, 467.957261585945, 470.53387834823474, 471.1851336636741, 470.92344322423, 102.75663983432662, 454.9558799513768, 468.93745029322184, 470.541815626277, 366.6537111239768, 65.80295729229069, 469.399068804023, 472.4909379538887, 471.24835966847616, 466.2816261163271, 463.2477998806557, 474.0605227361834, 30.107477465288873, 471.1473324822263, 466.8758386002129, 470.30228362322583, 466.081616191032, 467.1237388033617, 249.08776860612912, 477.8871520123848, 472.6626623042222, 468.3187842635503, 469.3122302623839, 451.5323859973665, 462.17721297979847, 466.19469348447035, 472.06485384876623, 415.17763967159453, 471.9752629088132, 376.346050207035, 467.191190212295, 467.7556008366512, 471.44109015131755, 54.53743703145129, 469.351717155791, 469.1608604164367, 467.98375474633195, 123.17521971927815, 463.38661345706777, 416.6370820998341, 473.61618768540313, 474.3455405717031, 467.08920844931794, 468.9158175332758, 470.9655585924538, 470.88461386354703, 469.1611341409106, 62.298220629653954, 471.06116817568284, 468.9204522524345, 469.14849970179245, 51.06126756873316, 473.70685073908646, 468.13930315635355, 469.1165758536489, 469.4026414379432, 471.3162640252199, 468.03383416695436, 470.9647119616046, 469.2553739128628, 48.956615695896296, 468.9304037022279, 470.5784196316545, 70.75289042895301, 471.1034320227786, 423.9422026648778, 472.621453886998, 122.533867370494, 466.78906875139285, 464.5269338557018, 469.51813469057777, 94.01734068303051, 468.89694629407603, 465.5651933659373, 469.13345360644695, 474.65101732020094, 477.2926112019699, 468.1375273455975, 470.52720935582386, 469.4122735853754, 470.50369468595574, 462.33341072494267, 473.02408766580993, 415.55925648595, 467.34275762988744, 466.87113085164066, 468.81716616588966, 352.11536353607886, 469.1963754715069, 473.79420169467573, 470.81583915594206, 396.696092826571], "episode_lengths": [600, 600, 210, 573, 600, 600, 600, 600, 125, 600, 600, 600, 471, 81, 600, 600, 600, 600, 596, 600, 37, 600, 600, 600, 600, 600, 316, 600, 600, 600, 600, 575, 600, 600, 600, 532, 600, 485, 600, 600, 600, 63, 600, 600, 600, 147, 600, 536, 600, 600, 600, 600, 600, 600, 600, 75, 600, 600, 600, 59, 600, 600, 600, 600, 600, 600, 600, 600, 60, 600, 600, 84, 600, 547, 600, 146, 600, 600, 600, 110, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 531, 600, 600, 600, 454, 600, 600, 600, 508]}, "sampler_perf": {"mean_raw_obs_processing_ms": 172.206693875652, "mean_inference_ms": 694.787207863135, "mean_action_processing_ms": 32.8407998549787, "mean_env_wait_ms": 4053.432500944622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.7376222610473633, "StateBufferConnector_ms": 0.5443716049194336, "ViewRequirementAgentConnector_ms": 35.45275664329529}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 250000, "num_agent_steps_trained": 250000, "num_env_steps_sampled": 250000, "num_env_steps_trained": 250000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.385948778744085, "num_env_steps_trained_throughput_per_sec": 8.385948778744085, "timesteps_total": 250000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 250000, "timers": {"training_iteration_time_ms": 1171644.12, "sample_time_ms": 1053903.697, "load_time_ms": 3134.533, "load_throughput": 3190.268, "learn_time_ms": 113095.224, "learn_throughput": 88.421, "synch_weights_time_ms": 1399.222}, "counters": {"num_env_steps_sampled": 250000, "num_env_steps_trained": 250000, "num_agent_steps_sampled": 250000, "num_agent_steps_trained": 250000}, "done": false, "episodes_total": 2396, "training_iteration": 25, "trial_id": "ef367_00000", "date": "2024-01-23_18-10-25", "timestamp": 1706004625, "time_this_iter_s": 1192.623769044876, "time_total_s": 28292.98859024048, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 28292.98859024048, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 0.8019370460048426, "ram_util_percent": 21.073607748184017}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 1.3216641923379846, "policy_loss": -0.01868702903565051, "vf_loss": 1.3365373700634282, "vf_explained_var": -0.4494066881827819, "kl": 0.01271281866986847, "entropy": 2.552724990579817, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 59670.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "sampler_results": {"episode_reward_max": 477.8871520123848, "episode_reward_min": 0.7961377576202611, "episode_reward_mean": 414.8636033924528, "episode_len_mean": 529.84, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [466.8758386002129, 470.30228362322583, 466.081616191032, 467.1237388033617, 249.08776860612912, 477.8871520123848, 472.6626623042222, 468.3187842635503, 469.3122302623839, 451.5323859973665, 462.17721297979847, 466.19469348447035, 472.06485384876623, 415.17763967159453, 471.9752629088132, 376.346050207035, 467.191190212295, 467.7556008366512, 471.44109015131755, 54.53743703145129, 469.351717155791, 469.1608604164367, 467.98375474633195, 123.17521971927815, 463.38661345706777, 416.6370820998341, 473.61618768540313, 474.3455405717031, 467.08920844931794, 468.9158175332758, 470.9655585924538, 470.88461386354703, 469.1611341409106, 62.298220629653954, 471.06116817568284, 468.9204522524345, 469.14849970179245, 51.06126756873316, 473.70685073908646, 468.13930315635355, 469.1165758536489, 469.4026414379432, 471.3162640252199, 468.03383416695436, 470.9647119616046, 469.2553739128628, 48.956615695896296, 468.9304037022279, 470.5784196316545, 70.75289042895301, 471.1034320227786, 423.9422026648778, 472.621453886998, 122.533867370494, 466.78906875139285, 464.5269338557018, 469.51813469057777, 94.01734068303051, 468.89694629407603, 465.5651933659373, 469.13345360644695, 474.65101732020094, 477.2926112019699, 468.1375273455975, 470.52720935582386, 469.4122735853754, 470.50369468595574, 462.33341072494267, 473.02408766580993, 415.55925648595, 467.34275762988744, 466.87113085164066, 468.81716616588966, 352.11536353607886, 469.1963754715069, 473.79420169467573, 470.81583915594206, 396.696092826571, 466.71459783808695, 472.4532766475036, 472.6489853441923, 469.3928654805275, 466.523436554995, 339.34343719361885, 470.8685799522938, 469.1896954976989, 344.40613707839844, 468.5761325671204, 468.7277648597415, 472.5519802480273, 5.5017392783888655, 466.3914434692637, 473.62879012104474, 467.32705128898806, 472.2460971421439, 468.320823097162, 48.02037738612204, 0.7961377576202611, 470.18957186242096, 466.4410822156715], "episode_lengths": [600, 600, 600, 600, 316, 600, 600, 600, 600, 575, 600, 600, 600, 532, 600, 485, 600, 600, 600, 63, 600, 600, 600, 147, 600, 536, 600, 600, 600, 600, 600, 600, 600, 75, 600, 600, 600, 59, 600, 600, 600, 600, 600, 600, 600, 600, 60, 600, 600, 84, 600, 547, 600, 146, 600, 600, 600, 110, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 531, 600, 600, 600, 454, 600, 600, 600, 508, 600, 600, 600, 600, 600, 438, 600, 600, 450, 600, 600, 600, 7, 600, 600, 600, 600, 600, 59, 2, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 171.594594104557, "mean_inference_ms": 696.7369874662107, "mean_action_processing_ms": 33.13242445191272, "mean_env_wait_ms": 4063.1466438927264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.7381410598754883, "StateBufferConnector_ms": 0.5445492267608643, "ViewRequirementAgentConnector_ms": 29.793059825897217}}, "episode_reward_max": 477.8871520123848, "episode_reward_min": 0.7961377576202611, "episode_reward_mean": 414.8636033924528, "episode_len_mean": 529.84, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [466.8758386002129, 470.30228362322583, 466.081616191032, 467.1237388033617, 249.08776860612912, 477.8871520123848, 472.6626623042222, 468.3187842635503, 469.3122302623839, 451.5323859973665, 462.17721297979847, 466.19469348447035, 472.06485384876623, 415.17763967159453, 471.9752629088132, 376.346050207035, 467.191190212295, 467.7556008366512, 471.44109015131755, 54.53743703145129, 469.351717155791, 469.1608604164367, 467.98375474633195, 123.17521971927815, 463.38661345706777, 416.6370820998341, 473.61618768540313, 474.3455405717031, 467.08920844931794, 468.9158175332758, 470.9655585924538, 470.88461386354703, 469.1611341409106, 62.298220629653954, 471.06116817568284, 468.9204522524345, 469.14849970179245, 51.06126756873316, 473.70685073908646, 468.13930315635355, 469.1165758536489, 469.4026414379432, 471.3162640252199, 468.03383416695436, 470.9647119616046, 469.2553739128628, 48.956615695896296, 468.9304037022279, 470.5784196316545, 70.75289042895301, 471.1034320227786, 423.9422026648778, 472.621453886998, 122.533867370494, 466.78906875139285, 464.5269338557018, 469.51813469057777, 94.01734068303051, 468.89694629407603, 465.5651933659373, 469.13345360644695, 474.65101732020094, 477.2926112019699, 468.1375273455975, 470.52720935582386, 469.4122735853754, 470.50369468595574, 462.33341072494267, 473.02408766580993, 415.55925648595, 467.34275762988744, 466.87113085164066, 468.81716616588966, 352.11536353607886, 469.1963754715069, 473.79420169467573, 470.81583915594206, 396.696092826571, 466.71459783808695, 472.4532766475036, 472.6489853441923, 469.3928654805275, 466.523436554995, 339.34343719361885, 470.8685799522938, 469.1896954976989, 344.40613707839844, 468.5761325671204, 468.7277648597415, 472.5519802480273, 5.5017392783888655, 466.3914434692637, 473.62879012104474, 467.32705128898806, 472.2460971421439, 468.320823097162, 48.02037738612204, 0.7961377576202611, 470.18957186242096, 466.4410822156715], "episode_lengths": [600, 600, 600, 600, 316, 600, 600, 600, 600, 575, 600, 600, 600, 532, 600, 485, 600, 600, 600, 63, 600, 600, 600, 147, 600, 536, 600, 600, 600, 600, 600, 600, 600, 75, 600, 600, 600, 59, 600, 600, 600, 600, 600, 600, 600, 600, 60, 600, 600, 84, 600, 547, 600, 146, 600, 600, 600, 110, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 531, 600, 600, 600, 454, 600, 600, 600, 508, 600, 600, 600, 600, 600, 438, 600, 600, 450, 600, 600, 600, 7, 600, 600, 600, 600, 600, 59, 2, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 171.594594104557, "mean_inference_ms": 696.7369874662107, "mean_action_processing_ms": 33.13242445191272, "mean_env_wait_ms": 4063.1466438927264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.7381410598754883, "StateBufferConnector_ms": 0.5445492267608643, "ViewRequirementAgentConnector_ms": 29.793059825897217}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.396679832441755, "num_env_steps_trained_throughput_per_sec": 8.396679832441755, "timesteps_total": 260000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 1175809.511, "sample_time_ms": 1056461.827, "load_time_ms": 3232.172, "load_throughput": 3093.895, "learn_time_ms": 114371.837, "learn_throughput": 87.434, "synch_weights_time_ms": 1609.731}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "episodes_total": 2418, "training_iteration": 26, "trial_id": "ef367_00000", "date": "2024-01-23_18-30-16", "timestamp": 1706005816, "time_this_iter_s": 1191.140864610672, "time_total_s": 29484.12945485115, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 29484.12945485115, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 0.8026187576126675, "ram_util_percent": 21.081242387332523}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 1.20975731593297, "policy_loss": -0.018576501451958067, "vf_loss": 1.22473555460023, "vf_explained_var": -0.4492028809256024, "kl": 0.01199420284659533, "entropy": 2.565257870641529, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 62010.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "sampler_results": {"episode_reward_max": 477.2926112019699, "episode_reward_min": 0.7961377576202611, "episode_reward_mean": 406.4097521027615, "episode_len_mean": 518.97, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [467.7556008366512, 471.44109015131755, 54.53743703145129, 469.351717155791, 469.1608604164367, 467.98375474633195, 123.17521971927815, 463.38661345706777, 416.6370820998341, 473.61618768540313, 474.3455405717031, 467.08920844931794, 468.9158175332758, 470.9655585924538, 470.88461386354703, 469.1611341409106, 62.298220629653954, 471.06116817568284, 468.9204522524345, 469.14849970179245, 51.06126756873316, 473.70685073908646, 468.13930315635355, 469.1165758536489, 469.4026414379432, 471.3162640252199, 468.03383416695436, 470.9647119616046, 469.2553739128628, 48.956615695896296, 468.9304037022279, 470.5784196316545, 70.75289042895301, 471.1034320227786, 423.9422026648778, 472.621453886998, 122.533867370494, 466.78906875139285, 464.5269338557018, 469.51813469057777, 94.01734068303051, 468.89694629407603, 465.5651933659373, 469.13345360644695, 474.65101732020094, 477.2926112019699, 468.1375273455975, 470.52720935582386, 469.4122735853754, 470.50369468595574, 462.33341072494267, 473.02408766580993, 415.55925648595, 467.34275762988744, 466.87113085164066, 468.81716616588966, 352.11536353607886, 469.1963754715069, 473.79420169467573, 470.81583915594206, 396.696092826571, 466.71459783808695, 472.4532766475036, 472.6489853441923, 469.3928654805275, 466.523436554995, 339.34343719361885, 470.8685799522938, 469.1896954976989, 344.40613707839844, 468.5761325671204, 468.7277648597415, 472.5519802480273, 5.5017392783888655, 466.3914434692637, 473.62879012104474, 467.32705128898806, 472.2460971421439, 468.320823097162, 48.02037738612204, 0.7961377576202611, 470.18957186242096, 466.4410822156715, 475.3883011118929, 466.7400988055924, 468.46383516855394, 52.12392055929688, 468.3747322127405, 467.67194589360514, 467.8169780273097, 109.26056741730359, 472.0198891636737, 466.33767044008175, 467.38139987211093, 472.2818654062085, 468.3574681418347, 59.569302026389416, 427.25015172757793, 470.8108217692706, 465.0772872640738], "episode_lengths": [600, 600, 63, 600, 600, 600, 147, 600, 536, 600, 600, 600, 600, 600, 600, 600, 75, 600, 600, 600, 59, 600, 600, 600, 600, 600, 600, 600, 600, 60, 600, 600, 84, 600, 547, 600, 146, 600, 600, 600, 110, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 531, 600, 600, 600, 454, 600, 600, 600, 508, 600, 600, 600, 600, 600, 438, 600, 600, 450, 600, 600, 600, 7, 600, 600, 600, 600, 600, 59, 2, 600, 600, 600, 600, 600, 65, 600, 600, 600, 132, 600, 600, 600, 600, 600, 76, 548, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 170.75762466863915, "mean_inference_ms": 696.7196286421145, "mean_action_processing_ms": 33.00256550326613, "mean_env_wait_ms": 4070.1577711031305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.0722665786743164, "StateBufferConnector_ms": 1.7129952907562256, "ViewRequirementAgentConnector_ms": 31.99243712425232}}, "episode_reward_max": 477.2926112019699, "episode_reward_min": 0.7961377576202611, "episode_reward_mean": 406.4097521027615, "episode_len_mean": 518.97, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [467.7556008366512, 471.44109015131755, 54.53743703145129, 469.351717155791, 469.1608604164367, 467.98375474633195, 123.17521971927815, 463.38661345706777, 416.6370820998341, 473.61618768540313, 474.3455405717031, 467.08920844931794, 468.9158175332758, 470.9655585924538, 470.88461386354703, 469.1611341409106, 62.298220629653954, 471.06116817568284, 468.9204522524345, 469.14849970179245, 51.06126756873316, 473.70685073908646, 468.13930315635355, 469.1165758536489, 469.4026414379432, 471.3162640252199, 468.03383416695436, 470.9647119616046, 469.2553739128628, 48.956615695896296, 468.9304037022279, 470.5784196316545, 70.75289042895301, 471.1034320227786, 423.9422026648778, 472.621453886998, 122.533867370494, 466.78906875139285, 464.5269338557018, 469.51813469057777, 94.01734068303051, 468.89694629407603, 465.5651933659373, 469.13345360644695, 474.65101732020094, 477.2926112019699, 468.1375273455975, 470.52720935582386, 469.4122735853754, 470.50369468595574, 462.33341072494267, 473.02408766580993, 415.55925648595, 467.34275762988744, 466.87113085164066, 468.81716616588966, 352.11536353607886, 469.1963754715069, 473.79420169467573, 470.81583915594206, 396.696092826571, 466.71459783808695, 472.4532766475036, 472.6489853441923, 469.3928654805275, 466.523436554995, 339.34343719361885, 470.8685799522938, 469.1896954976989, 344.40613707839844, 468.5761325671204, 468.7277648597415, 472.5519802480273, 5.5017392783888655, 466.3914434692637, 473.62879012104474, 467.32705128898806, 472.2460971421439, 468.320823097162, 48.02037738612204, 0.7961377576202611, 470.18957186242096, 466.4410822156715, 475.3883011118929, 466.7400988055924, 468.46383516855394, 52.12392055929688, 468.3747322127405, 467.67194589360514, 467.8169780273097, 109.26056741730359, 472.0198891636737, 466.33767044008175, 467.38139987211093, 472.2818654062085, 468.3574681418347, 59.569302026389416, 427.25015172757793, 470.8108217692706, 465.0772872640738], "episode_lengths": [600, 600, 63, 600, 600, 600, 147, 600, 536, 600, 600, 600, 600, 600, 600, 600, 75, 600, 600, 600, 59, 600, 600, 600, 600, 600, 600, 600, 600, 60, 600, 600, 84, 600, 547, 600, 146, 600, 600, 600, 110, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 531, 600, 600, 600, 454, 600, 600, 600, 508, 600, 600, 600, 600, 600, 438, 600, 600, 450, 600, 600, 600, 7, 600, 600, 600, 600, 600, 59, 2, 600, 600, 600, 600, 600, 65, 600, 600, 600, 132, 600, 600, 600, 600, 600, 76, 548, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 170.75762466863915, "mean_inference_ms": 696.7196286421145, "mean_action_processing_ms": 33.00256550326613, "mean_env_wait_ms": 4070.1577711031305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.0722665786743164, "StateBufferConnector_ms": 1.7129952907562256, "ViewRequirementAgentConnector_ms": 31.99243712425232}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.292239981818495, "num_env_steps_trained_throughput_per_sec": 8.292239981818495, "timesteps_total": 270000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 270000, "timers": {"training_iteration_time_ms": 1181142.353, "sample_time_ms": 1060554.727, "load_time_ms": 3429.08, "load_throughput": 2916.234, "learn_time_ms": 115398.933, "learn_throughput": 86.656, "synch_weights_time_ms": 1626.785}, "counters": {"num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "done": false, "episodes_total": 2435, "training_iteration": 27, "trial_id": "ef367_00000", "date": "2024-01-23_18-50-23", "timestamp": 1706007023, "time_this_iter_s": 1206.111631155014, "time_total_s": 30690.241086006165, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 30690.241086006165, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 0.8016265060240965, "ram_util_percent": 21.037771084337347}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 1.300577229348063, "policy_loss": -0.02244691581934945, "vf_loss": 1.3191376778352846, "vf_explained_var": -0.4328058457527405, "kl": 0.012954901564256877, "entropy": 2.5350613514582316, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 64350.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "sampler_results": {"episode_reward_max": 477.2926112019699, "episode_reward_min": 0.7961377576202611, "episode_reward_mean": 409.31048864101484, "episode_len_mean": 522.98, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.06126756873316, 473.70685073908646, 468.13930315635355, 469.1165758536489, 469.4026414379432, 471.3162640252199, 468.03383416695436, 470.9647119616046, 469.2553739128628, 48.956615695896296, 468.9304037022279, 470.5784196316545, 70.75289042895301, 471.1034320227786, 423.9422026648778, 472.621453886998, 122.533867370494, 466.78906875139285, 464.5269338557018, 469.51813469057777, 94.01734068303051, 468.89694629407603, 465.5651933659373, 469.13345360644695, 474.65101732020094, 477.2926112019699, 468.1375273455975, 470.52720935582386, 469.4122735853754, 470.50369468595574, 462.33341072494267, 473.02408766580993, 415.55925648595, 467.34275762988744, 466.87113085164066, 468.81716616588966, 352.11536353607886, 469.1963754715069, 473.79420169467573, 470.81583915594206, 396.696092826571, 466.71459783808695, 472.4532766475036, 472.6489853441923, 469.3928654805275, 466.523436554995, 339.34343719361885, 470.8685799522938, 469.1896954976989, 344.40613707839844, 468.5761325671204, 468.7277648597415, 472.5519802480273, 5.5017392783888655, 466.3914434692637, 473.62879012104474, 467.32705128898806, 472.2460971421439, 468.320823097162, 48.02037738612204, 0.7961377576202611, 470.18957186242096, 466.4410822156715, 475.3883011118929, 466.7400988055924, 468.46383516855394, 52.12392055929688, 468.3747322127405, 467.67194589360514, 467.8169780273097, 109.26056741730359, 472.0198891636737, 466.33767044008175, 467.38139987211093, 472.2818654062085, 468.3574681418347, 59.569302026389416, 427.25015172757793, 470.8108217692706, 465.0772872640738, 469.150254269277, 463.89531454023944, 467.1283509460322, 469.4644890233937, 470.0551215923714, 100.91013070837585, 96.26346310995035, 473.3913105522579, 466.5182900077165, 443.02946653073167, 467.2996912429077, 473.09399780704956, 467.28714558980016, 449.30300348083654, 343.85395927477254, 468.8881554137824, 467.23564796560044, 469.9233147906365, 467.0570066480096, 466.1613175419307], "episode_lengths": [59, 600, 600, 600, 600, 600, 600, 600, 600, 60, 600, 600, 84, 600, 547, 600, 146, 600, 600, 600, 110, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 531, 600, 600, 600, 454, 600, 600, 600, 508, 600, 600, 600, 600, 600, 438, 600, 600, 450, 600, 600, 600, 7, 600, 600, 600, 600, 600, 59, 2, 600, 600, 600, 600, 600, 65, 600, 600, 600, 132, 600, 600, 600, 600, 600, 76, 548, 600, 600, 600, 600, 600, 600, 600, 125, 111, 600, 600, 564, 600, 600, 600, 579, 443, 600, 600, 600, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 170.2044362556691, "mean_inference_ms": 697.9229575300805, "mean_action_processing_ms": 32.81535234298185, "mean_env_wait_ms": 4076.9129296942247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.041123867034912, "StateBufferConnector_ms": 1.7130210399627686, "ViewRequirementAgentConnector_ms": 32.01875710487366}}, "episode_reward_max": 477.2926112019699, "episode_reward_min": 0.7961377576202611, "episode_reward_mean": 409.31048864101484, "episode_len_mean": 522.98, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [51.06126756873316, 473.70685073908646, 468.13930315635355, 469.1165758536489, 469.4026414379432, 471.3162640252199, 468.03383416695436, 470.9647119616046, 469.2553739128628, 48.956615695896296, 468.9304037022279, 470.5784196316545, 70.75289042895301, 471.1034320227786, 423.9422026648778, 472.621453886998, 122.533867370494, 466.78906875139285, 464.5269338557018, 469.51813469057777, 94.01734068303051, 468.89694629407603, 465.5651933659373, 469.13345360644695, 474.65101732020094, 477.2926112019699, 468.1375273455975, 470.52720935582386, 469.4122735853754, 470.50369468595574, 462.33341072494267, 473.02408766580993, 415.55925648595, 467.34275762988744, 466.87113085164066, 468.81716616588966, 352.11536353607886, 469.1963754715069, 473.79420169467573, 470.81583915594206, 396.696092826571, 466.71459783808695, 472.4532766475036, 472.6489853441923, 469.3928654805275, 466.523436554995, 339.34343719361885, 470.8685799522938, 469.1896954976989, 344.40613707839844, 468.5761325671204, 468.7277648597415, 472.5519802480273, 5.5017392783888655, 466.3914434692637, 473.62879012104474, 467.32705128898806, 472.2460971421439, 468.320823097162, 48.02037738612204, 0.7961377576202611, 470.18957186242096, 466.4410822156715, 475.3883011118929, 466.7400988055924, 468.46383516855394, 52.12392055929688, 468.3747322127405, 467.67194589360514, 467.8169780273097, 109.26056741730359, 472.0198891636737, 466.33767044008175, 467.38139987211093, 472.2818654062085, 468.3574681418347, 59.569302026389416, 427.25015172757793, 470.8108217692706, 465.0772872640738, 469.150254269277, 463.89531454023944, 467.1283509460322, 469.4644890233937, 470.0551215923714, 100.91013070837585, 96.26346310995035, 473.3913105522579, 466.5182900077165, 443.02946653073167, 467.2996912429077, 473.09399780704956, 467.28714558980016, 449.30300348083654, 343.85395927477254, 468.8881554137824, 467.23564796560044, 469.9233147906365, 467.0570066480096, 466.1613175419307], "episode_lengths": [59, 600, 600, 600, 600, 600, 600, 600, 600, 60, 600, 600, 84, 600, 547, 600, 146, 600, 600, 600, 110, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 531, 600, 600, 600, 454, 600, 600, 600, 508, 600, 600, 600, 600, 600, 438, 600, 600, 450, 600, 600, 600, 7, 600, 600, 600, 600, 600, 59, 2, 600, 600, 600, 600, 600, 65, 600, 600, 600, 132, 600, 600, 600, 600, 600, 76, 548, 600, 600, 600, 600, 600, 600, 600, 125, 111, 600, 600, 564, 600, 600, 600, 579, 443, 600, 600, 600, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 170.2044362556691, "mean_inference_ms": 697.9229575300805, "mean_action_processing_ms": 32.81535234298185, "mean_env_wait_ms": 4076.9129296942247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.041123867034912, "StateBufferConnector_ms": 1.7130210399627686, "ViewRequirementAgentConnector_ms": 32.01875710487366}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.428682836727429, "num_env_steps_trained_throughput_per_sec": 8.428682836727429, "timesteps_total": 280000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 1185152.895, "sample_time_ms": 1063095.143, "load_time_ms": 3156.202, "load_throughput": 3168.365, "learn_time_ms": 117000.533, "learn_throughput": 85.47, "synch_weights_time_ms": 1768.338}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "episodes_total": 2455, "training_iteration": 28, "trial_id": "ef367_00000", "date": "2024-01-23_19-10-10", "timestamp": 1706008210, "time_this_iter_s": 1186.8755049705505, "time_total_s": 31877.116590976715, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 31877.116590976715, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 0.8026299694189603, "ram_util_percent": 20.99480122324159}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 1.1247609514893335, "policy_loss": -0.01960672049377209, "vf_loss": 1.1406411935965348, "vf_explained_var": -0.3827473112915316, "kl": 0.012421604145819129, "entropy": 2.5776464072048153, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 66690.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 290000, "num_env_steps_trained": 290000, "num_agent_steps_sampled": 290000, "num_agent_steps_trained": 290000}, "sampler_results": {"episode_reward_max": 477.2926112019699, "episode_reward_min": 0.7961377576202611, "episode_reward_mean": 408.67657768332424, "episode_len_mean": 522.39, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [468.89694629407603, 465.5651933659373, 469.13345360644695, 474.65101732020094, 477.2926112019699, 468.1375273455975, 470.52720935582386, 469.4122735853754, 470.50369468595574, 462.33341072494267, 473.02408766580993, 415.55925648595, 467.34275762988744, 466.87113085164066, 468.81716616588966, 352.11536353607886, 469.1963754715069, 473.79420169467573, 470.81583915594206, 396.696092826571, 466.71459783808695, 472.4532766475036, 472.6489853441923, 469.3928654805275, 466.523436554995, 339.34343719361885, 470.8685799522938, 469.1896954976989, 344.40613707839844, 468.5761325671204, 468.7277648597415, 472.5519802480273, 5.5017392783888655, 466.3914434692637, 473.62879012104474, 467.32705128898806, 472.2460971421439, 468.320823097162, 48.02037738612204, 0.7961377576202611, 470.18957186242096, 466.4410822156715, 475.3883011118929, 466.7400988055924, 468.46383516855394, 52.12392055929688, 468.3747322127405, 467.67194589360514, 467.8169780273097, 109.26056741730359, 472.0198891636737, 466.33767044008175, 467.38139987211093, 472.2818654062085, 468.3574681418347, 59.569302026389416, 427.25015172757793, 470.8108217692706, 465.0772872640738, 469.150254269277, 463.89531454023944, 467.1283509460322, 469.4644890233937, 470.0551215923714, 100.91013070837585, 96.26346310995035, 473.3913105522579, 466.5182900077165, 443.02946653073167, 467.2996912429077, 473.09399780704956, 467.28714558980016, 449.30300348083654, 343.85395927477254, 468.8881554137824, 467.23564796560044, 469.9233147906365, 467.0570066480096, 466.1613175419307, 52.37880253328871, 467.63381934037676, 468.4665832052167, 466.01122409502113, 97.28503654326707, 471.2636127512777, 466.55877459716316, 470.4002666551855, 464.11233624045735, 471.07827758677143, 469.4662584372139, 472.1079657424671, 470.56140111255326, 468.7604301067168, 465.3109882583439, 43.39540961195144, 471.20973632281243, 472.1947276120732, 54.54015204829117, 469.4406917751899, 39.699995862291054], "episode_lengths": [600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 531, 600, 600, 600, 454, 600, 600, 600, 508, 600, 600, 600, 600, 600, 438, 600, 600, 450, 600, 600, 600, 7, 600, 600, 600, 600, 600, 59, 2, 600, 600, 600, 600, 600, 65, 600, 600, 600, 132, 600, 600, 600, 600, 600, 76, 548, 600, 600, 600, 600, 600, 600, 600, 125, 111, 600, 600, 564, 600, 600, 600, 579, 443, 600, 600, 600, 600, 600, 64, 600, 600, 600, 118, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 50, 600, 600, 66, 600, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 170.0141177396121, "mean_inference_ms": 699.7120219092969, "mean_action_processing_ms": 33.09312612892118, "mean_env_wait_ms": 4082.9052306036647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9927642345428467, "StateBufferConnector_ms": 2.2324440479278564, "ViewRequirementAgentConnector_ms": 32.38117599487305}}, "episode_reward_max": 477.2926112019699, "episode_reward_min": 0.7961377576202611, "episode_reward_mean": 408.67657768332424, "episode_len_mean": 522.39, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [468.89694629407603, 465.5651933659373, 469.13345360644695, 474.65101732020094, 477.2926112019699, 468.1375273455975, 470.52720935582386, 469.4122735853754, 470.50369468595574, 462.33341072494267, 473.02408766580993, 415.55925648595, 467.34275762988744, 466.87113085164066, 468.81716616588966, 352.11536353607886, 469.1963754715069, 473.79420169467573, 470.81583915594206, 396.696092826571, 466.71459783808695, 472.4532766475036, 472.6489853441923, 469.3928654805275, 466.523436554995, 339.34343719361885, 470.8685799522938, 469.1896954976989, 344.40613707839844, 468.5761325671204, 468.7277648597415, 472.5519802480273, 5.5017392783888655, 466.3914434692637, 473.62879012104474, 467.32705128898806, 472.2460971421439, 468.320823097162, 48.02037738612204, 0.7961377576202611, 470.18957186242096, 466.4410822156715, 475.3883011118929, 466.7400988055924, 468.46383516855394, 52.12392055929688, 468.3747322127405, 467.67194589360514, 467.8169780273097, 109.26056741730359, 472.0198891636737, 466.33767044008175, 467.38139987211093, 472.2818654062085, 468.3574681418347, 59.569302026389416, 427.25015172757793, 470.8108217692706, 465.0772872640738, 469.150254269277, 463.89531454023944, 467.1283509460322, 469.4644890233937, 470.0551215923714, 100.91013070837585, 96.26346310995035, 473.3913105522579, 466.5182900077165, 443.02946653073167, 467.2996912429077, 473.09399780704956, 467.28714558980016, 449.30300348083654, 343.85395927477254, 468.8881554137824, 467.23564796560044, 469.9233147906365, 467.0570066480096, 466.1613175419307, 52.37880253328871, 467.63381934037676, 468.4665832052167, 466.01122409502113, 97.28503654326707, 471.2636127512777, 466.55877459716316, 470.4002666551855, 464.11233624045735, 471.07827758677143, 469.4662584372139, 472.1079657424671, 470.56140111255326, 468.7604301067168, 465.3109882583439, 43.39540961195144, 471.20973632281243, 472.1947276120732, 54.54015204829117, 469.4406917751899, 39.699995862291054], "episode_lengths": [600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 531, 600, 600, 600, 454, 600, 600, 600, 508, 600, 600, 600, 600, 600, 438, 600, 600, 450, 600, 600, 600, 7, 600, 600, 600, 600, 600, 59, 2, 600, 600, 600, 600, 600, 65, 600, 600, 600, 132, 600, 600, 600, 600, 600, 76, 548, 600, 600, 600, 600, 600, 600, 600, 125, 111, 600, 600, 564, 600, 600, 600, 579, 443, 600, 600, 600, 600, 600, 64, 600, 600, 600, 118, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 50, 600, 600, 66, 600, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 170.0141177396121, "mean_inference_ms": 699.7120219092969, "mean_action_processing_ms": 33.09312612892118, "mean_env_wait_ms": 4082.9052306036647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9927642345428467, "StateBufferConnector_ms": 2.2324440479278564, "ViewRequirementAgentConnector_ms": 32.38117599487305}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 290000, "num_agent_steps_trained": 290000, "num_env_steps_sampled": 290000, "num_env_steps_trained": 290000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.408728853745618, "num_env_steps_trained_throughput_per_sec": 8.408728853745618, "timesteps_total": 290000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 290000, "timers": {"training_iteration_time_ms": 1187646.668, "sample_time_ms": 1064575.432, "load_time_ms": 3143.296, "load_throughput": 3181.374, "learn_time_ms": 118024.306, "learn_throughput": 84.728, "synch_weights_time_ms": 1771.783}, "counters": {"num_env_steps_sampled": 290000, "num_env_steps_trained": 290000, "num_agent_steps_sampled": 290000, "num_agent_steps_trained": 290000}, "done": false, "episodes_total": 2476, "training_iteration": 29, "trial_id": "ef367_00000", "date": "2024-01-23_19-29-59", "timestamp": 1706009399, "time_this_iter_s": 1189.3896992206573, "time_total_s": 33066.50629019737, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 33066.50629019737, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 0.804305639781686, "ram_util_percent": 21.100303214069132}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 1.29437652029909, "policy_loss": -0.022566946101191844, "vf_loss": 1.3137581979808135, "vf_explained_var": -0.46989358694125444, "kl": 0.010617547919770893, "entropy": 2.584340288088872, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 69030.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 476.0895482359186, "episode_reward_min": 0.7961377576202611, "episode_reward_mean": 393.0901039163248, "episode_len_mean": 502.36, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [396.696092826571, 466.71459783808695, 472.4532766475036, 472.6489853441923, 469.3928654805275, 466.523436554995, 339.34343719361885, 470.8685799522938, 469.1896954976989, 344.40613707839844, 468.5761325671204, 468.7277648597415, 472.5519802480273, 5.5017392783888655, 466.3914434692637, 473.62879012104474, 467.32705128898806, 472.2460971421439, 468.320823097162, 48.02037738612204, 0.7961377576202611, 470.18957186242096, 466.4410822156715, 475.3883011118929, 466.7400988055924, 468.46383516855394, 52.12392055929688, 468.3747322127405, 467.67194589360514, 467.8169780273097, 109.26056741730359, 472.0198891636737, 466.33767044008175, 467.38139987211093, 472.2818654062085, 468.3574681418347, 59.569302026389416, 427.25015172757793, 470.8108217692706, 465.0772872640738, 469.150254269277, 463.89531454023944, 467.1283509460322, 469.4644890233937, 470.0551215923714, 100.91013070837585, 96.26346310995035, 473.3913105522579, 466.5182900077165, 443.02946653073167, 467.2996912429077, 473.09399780704956, 467.28714558980016, 449.30300348083654, 343.85395927477254, 468.8881554137824, 467.23564796560044, 469.9233147906365, 467.0570066480096, 466.1613175419307, 52.37880253328871, 467.63381934037676, 468.4665832052167, 466.01122409502113, 97.28503654326707, 471.2636127512777, 466.55877459716316, 470.4002666551855, 464.11233624045735, 471.07827758677143, 469.4662584372139, 472.1079657424671, 470.56140111255326, 468.7604301067168, 465.3109882583439, 43.39540961195144, 471.20973632281243, 472.1947276120732, 54.54015204829117, 469.4406917751899, 39.699995862291054, 465.1974520766219, 469.34037719614975, 470.0411772861592, 64.80448842525804, 467.94316433960074, 476.0895482359186, 473.53281668233825, 439.8372223241682, 470.55660619170146, 470.87085539939227, 471.13692302188235, 468.85570256519435, 14.36119015144171, 466.7736289515067, 3.7930512095012974, 467.23999579031437, 467.4745783716695, 470.1363666122422, 97.35699461269976], "episode_lengths": [508, 600, 600, 600, 600, 600, 438, 600, 600, 450, 600, 600, 600, 7, 600, 600, 600, 600, 600, 59, 2, 600, 600, 600, 600, 600, 65, 600, 600, 600, 132, 600, 600, 600, 600, 600, 76, 548, 600, 600, 600, 600, 600, 600, 600, 125, 111, 600, 600, 564, 600, 600, 600, 579, 443, 600, 600, 600, 600, 600, 64, 600, 600, 600, 118, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 50, 600, 600, 66, 600, 49, 600, 600, 600, 77, 600, 600, 600, 566, 600, 600, 600, 600, 17, 600, 5, 600, 600, 600, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 169.2146185856031, "mean_inference_ms": 699.2683524487961, "mean_action_processing_ms": 33.03700994980061, "mean_env_wait_ms": 4090.9984208798614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.546187400817871, "StateBufferConnector_ms": 2.5666136741638184, "ViewRequirementAgentConnector_ms": 26.26179790496826}}, "episode_reward_max": 476.0895482359186, "episode_reward_min": 0.7961377576202611, "episode_reward_mean": 393.0901039163248, "episode_len_mean": 502.36, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [396.696092826571, 466.71459783808695, 472.4532766475036, 472.6489853441923, 469.3928654805275, 466.523436554995, 339.34343719361885, 470.8685799522938, 469.1896954976989, 344.40613707839844, 468.5761325671204, 468.7277648597415, 472.5519802480273, 5.5017392783888655, 466.3914434692637, 473.62879012104474, 467.32705128898806, 472.2460971421439, 468.320823097162, 48.02037738612204, 0.7961377576202611, 470.18957186242096, 466.4410822156715, 475.3883011118929, 466.7400988055924, 468.46383516855394, 52.12392055929688, 468.3747322127405, 467.67194589360514, 467.8169780273097, 109.26056741730359, 472.0198891636737, 466.33767044008175, 467.38139987211093, 472.2818654062085, 468.3574681418347, 59.569302026389416, 427.25015172757793, 470.8108217692706, 465.0772872640738, 469.150254269277, 463.89531454023944, 467.1283509460322, 469.4644890233937, 470.0551215923714, 100.91013070837585, 96.26346310995035, 473.3913105522579, 466.5182900077165, 443.02946653073167, 467.2996912429077, 473.09399780704956, 467.28714558980016, 449.30300348083654, 343.85395927477254, 468.8881554137824, 467.23564796560044, 469.9233147906365, 467.0570066480096, 466.1613175419307, 52.37880253328871, 467.63381934037676, 468.4665832052167, 466.01122409502113, 97.28503654326707, 471.2636127512777, 466.55877459716316, 470.4002666551855, 464.11233624045735, 471.07827758677143, 469.4662584372139, 472.1079657424671, 470.56140111255326, 468.7604301067168, 465.3109882583439, 43.39540961195144, 471.20973632281243, 472.1947276120732, 54.54015204829117, 469.4406917751899, 39.699995862291054, 465.1974520766219, 469.34037719614975, 470.0411772861592, 64.80448842525804, 467.94316433960074, 476.0895482359186, 473.53281668233825, 439.8372223241682, 470.55660619170146, 470.87085539939227, 471.13692302188235, 468.85570256519435, 14.36119015144171, 466.7736289515067, 3.7930512095012974, 467.23999579031437, 467.4745783716695, 470.1363666122422, 97.35699461269976], "episode_lengths": [508, 600, 600, 600, 600, 600, 438, 600, 600, 450, 600, 600, 600, 7, 600, 600, 600, 600, 600, 59, 2, 600, 600, 600, 600, 600, 65, 600, 600, 600, 132, 600, 600, 600, 600, 600, 76, 548, 600, 600, 600, 600, 600, 600, 600, 125, 111, 600, 600, 564, 600, 600, 600, 579, 443, 600, 600, 600, 600, 600, 64, 600, 600, 600, 118, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 50, 600, 600, 66, 600, 49, 600, 600, 600, 77, 600, 600, 600, 566, 600, 600, 600, 600, 17, 600, 5, 600, 600, 600, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 169.2146185856031, "mean_inference_ms": 699.2683524487961, "mean_action_processing_ms": 33.03700994980061, "mean_env_wait_ms": 4090.9984208798614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.546187400817871, "StateBufferConnector_ms": 2.5666136741638184, "ViewRequirementAgentConnector_ms": 26.26179790496826}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.329764736011818, "num_env_steps_trained_throughput_per_sec": 8.329764736011818, "timesteps_total": 300000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 1191652.269, "sample_time_ms": 1066743.351, "load_time_ms": 3517.908, "load_throughput": 2842.599, "learn_time_ms": 119494.746, "learn_throughput": 83.686, "synch_weights_time_ms": 1764.15}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 2495, "training_iteration": 30, "trial_id": "ef367_00000", "date": "2024-01-23_19-50-00", "timestamp": 1706010600, "time_this_iter_s": 1200.655924320221, "time_total_s": 34267.16221451759, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 34267.16221451759, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 0.8023437499999999, "ram_util_percent": 21.014543269230767}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 1.951259356958923, "policy_loss": -0.025235371022588677, "vf_loss": 1.9725370755176355, "vf_explained_var": -0.40292887448245646, "kl": 0.013192165643419945, "entropy": 2.591749926000579, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 71370.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 310000, "num_env_steps_trained": 310000, "num_agent_steps_sampled": 310000, "num_agent_steps_trained": 310000}, "sampler_results": {"episode_reward_max": 479.2362780686855, "episode_reward_min": 3.7930512095012974, "episode_reward_mean": 389.1302087073625, "episode_len_mean": 496.48, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [466.7400988055924, 468.46383516855394, 52.12392055929688, 468.3747322127405, 467.67194589360514, 467.8169780273097, 109.26056741730359, 472.0198891636737, 466.33767044008175, 467.38139987211093, 472.2818654062085, 468.3574681418347, 59.569302026389416, 427.25015172757793, 470.8108217692706, 465.0772872640738, 469.150254269277, 463.89531454023944, 467.1283509460322, 469.4644890233937, 470.0551215923714, 100.91013070837585, 96.26346310995035, 473.3913105522579, 466.5182900077165, 443.02946653073167, 467.2996912429077, 473.09399780704956, 467.28714558980016, 449.30300348083654, 343.85395927477254, 468.8881554137824, 467.23564796560044, 469.9233147906365, 467.0570066480096, 466.1613175419307, 52.37880253328871, 467.63381934037676, 468.4665832052167, 466.01122409502113, 97.28503654326707, 471.2636127512777, 466.55877459716316, 470.4002666551855, 464.11233624045735, 471.07827758677143, 469.4662584372139, 472.1079657424671, 470.56140111255326, 468.7604301067168, 465.3109882583439, 43.39540961195144, 471.20973632281243, 472.1947276120732, 54.54015204829117, 469.4406917751899, 39.699995862291054, 465.1974520766219, 469.34037719614975, 470.0411772861592, 64.80448842525804, 467.94316433960074, 476.0895482359186, 473.53281668233825, 439.8372223241682, 470.55660619170146, 470.87085539939227, 471.13692302188235, 468.85570256519435, 14.36119015144171, 466.7736289515067, 3.7930512095012974, 467.23999579031437, 467.4745783716695, 470.1363666122422, 97.35699461269976, 468.5664155561138, 469.8091381818295, 382.41271008679627, 469.1181768982324, 377.04452616719897, 396.2459636630872, 432.30822219310295, 471.5575838472241, 246.3803971684927, 138.18249978840637, 464.44111899197026, 4.580004146453346, 391.5272850171373, 469.21896575308, 471.71762799256635, 473.54984211083655, 126.67033683725555, 106.75825533928149, 479.2362780686855, 474.4740002998551, 473.1065500707097, 471.33777058976403, 469.8097211935486, 468.3014859616298], "episode_lengths": [600, 600, 65, 600, 600, 600, 132, 600, 600, 600, 600, 600, 76, 548, 600, 600, 600, 600, 600, 600, 600, 125, 111, 600, 600, 564, 600, 600, 600, 579, 443, 600, 600, 600, 600, 600, 64, 600, 600, 600, 118, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 50, 600, 600, 66, 600, 49, 600, 600, 600, 77, 600, 600, 600, 566, 600, 600, 600, 600, 17, 600, 5, 600, 600, 600, 117, 600, 600, 489, 600, 477, 504, 551, 600, 308, 158, 600, 6, 498, 600, 600, 600, 151, 134, 600, 600, 600, 600, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 168.91059106438715, "mean_inference_ms": 700.1433191306934, "mean_action_processing_ms": 32.75078320410432, "mean_env_wait_ms": 4095.5360708431176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.9462530612945557, "StateBufferConnector_ms": 1.4862017631530762, "ViewRequirementAgentConnector_ms": 31.653064727783203}}, "episode_reward_max": 479.2362780686855, "episode_reward_min": 3.7930512095012974, "episode_reward_mean": 389.1302087073625, "episode_len_mean": 496.48, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [466.7400988055924, 468.46383516855394, 52.12392055929688, 468.3747322127405, 467.67194589360514, 467.8169780273097, 109.26056741730359, 472.0198891636737, 466.33767044008175, 467.38139987211093, 472.2818654062085, 468.3574681418347, 59.569302026389416, 427.25015172757793, 470.8108217692706, 465.0772872640738, 469.150254269277, 463.89531454023944, 467.1283509460322, 469.4644890233937, 470.0551215923714, 100.91013070837585, 96.26346310995035, 473.3913105522579, 466.5182900077165, 443.02946653073167, 467.2996912429077, 473.09399780704956, 467.28714558980016, 449.30300348083654, 343.85395927477254, 468.8881554137824, 467.23564796560044, 469.9233147906365, 467.0570066480096, 466.1613175419307, 52.37880253328871, 467.63381934037676, 468.4665832052167, 466.01122409502113, 97.28503654326707, 471.2636127512777, 466.55877459716316, 470.4002666551855, 464.11233624045735, 471.07827758677143, 469.4662584372139, 472.1079657424671, 470.56140111255326, 468.7604301067168, 465.3109882583439, 43.39540961195144, 471.20973632281243, 472.1947276120732, 54.54015204829117, 469.4406917751899, 39.699995862291054, 465.1974520766219, 469.34037719614975, 470.0411772861592, 64.80448842525804, 467.94316433960074, 476.0895482359186, 473.53281668233825, 439.8372223241682, 470.55660619170146, 470.87085539939227, 471.13692302188235, 468.85570256519435, 14.36119015144171, 466.7736289515067, 3.7930512095012974, 467.23999579031437, 467.4745783716695, 470.1363666122422, 97.35699461269976, 468.5664155561138, 469.8091381818295, 382.41271008679627, 469.1181768982324, 377.04452616719897, 396.2459636630872, 432.30822219310295, 471.5575838472241, 246.3803971684927, 138.18249978840637, 464.44111899197026, 4.580004146453346, 391.5272850171373, 469.21896575308, 471.71762799256635, 473.54984211083655, 126.67033683725555, 106.75825533928149, 479.2362780686855, 474.4740002998551, 473.1065500707097, 471.33777058976403, 469.8097211935486, 468.3014859616298], "episode_lengths": [600, 600, 65, 600, 600, 600, 132, 600, 600, 600, 600, 600, 76, 548, 600, 600, 600, 600, 600, 600, 600, 125, 111, 600, 600, 564, 600, 600, 600, 579, 443, 600, 600, 600, 600, 600, 64, 600, 600, 600, 118, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 50, 600, 600, 66, 600, 49, 600, 600, 600, 77, 600, 600, 600, 566, 600, 600, 600, 600, 17, 600, 5, 600, 600, 600, 117, 600, 600, 489, 600, 477, 504, 551, 600, 308, 158, 600, 6, 498, 600, 600, 600, 151, 134, 600, 600, 600, 600, 600, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 168.91059106438715, "mean_inference_ms": 700.1433191306934, "mean_action_processing_ms": 32.75078320410432, "mean_env_wait_ms": 4095.5360708431176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.9462530612945557, "StateBufferConnector_ms": 1.4862017631530762, "ViewRequirementAgentConnector_ms": 31.653064727783203}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 310000, "num_agent_steps_trained": 310000, "num_env_steps_sampled": 310000, "num_env_steps_trained": 310000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.202183529896793, "num_env_steps_trained_throughput_per_sec": 8.202183529896793, "timesteps_total": 310000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 310000, "timers": {"training_iteration_time_ms": 1195956.659, "sample_time_ms": 1068913.679, "load_time_ms": 3597.747, "load_throughput": 2779.518, "learn_time_ms": 121521.964, "learn_throughput": 82.29, "synch_weights_time_ms": 1789.421}, "counters": {"num_env_steps_sampled": 310000, "num_env_steps_trained": 310000, "num_agent_steps_sampled": 310000, "num_agent_steps_trained": 310000}, "done": false, "episodes_total": 2519, "training_iteration": 31, "trial_id": "ef367_00000", "date": "2024-01-23_20-10-19", "timestamp": 1706011819, "time_this_iter_s": 1219.4152989387512, "time_total_s": 35486.577513456345, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 35486.577513456345, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 0.8036417910447761, "ram_util_percent": 21.013850746268655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3, "cur_lr": 5.000000000000001e-05, "total_loss": 1.2110281822748252, "policy_loss": -0.026220165807594602, "vf_loss": 1.2329104545546106, "vf_explained_var": -0.3957866854137845, "kl": 0.014459621950115053, "entropy": 2.5777725271689587, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 73710.5, "diff_num_grad_updates_vs_sampler_policy": 1169.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "sampler_results": {"episode_reward_max": 479.2362780686855, "episode_reward_min": 3.7930512095012974, "episode_reward_mean": 378.7771498014614, "episode_len_mean": 482.22, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.26346310995035, 473.3913105522579, 466.5182900077165, 443.02946653073167, 467.2996912429077, 473.09399780704956, 467.28714558980016, 449.30300348083654, 343.85395927477254, 468.8881554137824, 467.23564796560044, 469.9233147906365, 467.0570066480096, 466.1613175419307, 52.37880253328871, 467.63381934037676, 468.4665832052167, 466.01122409502113, 97.28503654326707, 471.2636127512777, 466.55877459716316, 470.4002666551855, 464.11233624045735, 471.07827758677143, 469.4662584372139, 472.1079657424671, 470.56140111255326, 468.7604301067168, 465.3109882583439, 43.39540961195144, 471.20973632281243, 472.1947276120732, 54.54015204829117, 469.4406917751899, 39.699995862291054, 465.1974520766219, 469.34037719614975, 470.0411772861592, 64.80448842525804, 467.94316433960074, 476.0895482359186, 473.53281668233825, 439.8372223241682, 470.55660619170146, 470.87085539939227, 471.13692302188235, 468.85570256519435, 14.36119015144171, 466.7736289515067, 3.7930512095012974, 467.23999579031437, 467.4745783716695, 470.1363666122422, 97.35699461269976, 468.5664155561138, 469.8091381818295, 382.41271008679627, 469.1181768982324, 377.04452616719897, 396.2459636630872, 432.30822219310295, 471.5575838472241, 246.3803971684927, 138.18249978840637, 464.44111899197026, 4.580004146453346, 391.5272850171373, 469.21896575308, 471.71762799256635, 473.54984211083655, 126.67033683725555, 106.75825533928149, 479.2362780686855, 474.4740002998551, 473.1065500707097, 471.33777058976403, 469.8097211935486, 468.3014859616298, 472.2499987321171, 470.90266866272236, 475.1105863146298, 472.73510103990395, 178.5458499825797, 474.882421849466, 467.90328018865307, 467.5069589492327, 9.23422376889384, 470.6089343520886, 471.9228471936292, 6.9414945691683965, 467.98628689170454, 302.7617261967561, 467.9366210718609, 18.419641930701825, 174.54539137869818, 469.8325720007989, 468.2585649782065, 468.7632191802663, 107.32318718957721, 290.4641279635588], "episode_lengths": [111, 600, 600, 564, 600, 600, 600, 579, 443, 600, 600, 600, 600, 600, 64, 600, 600, 600, 118, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 50, 600, 600, 66, 600, 49, 600, 600, 600, 77, 600, 600, 600, 566, 600, 600, 600, 600, 17, 600, 5, 600, 600, 600, 117, 600, 600, 489, 600, 477, 504, 551, 600, 308, 158, 600, 6, 498, 600, 600, 600, 151, 134, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 210, 600, 600, 600, 12, 600, 600, 9, 600, 386, 600, 23, 199, 600, 600, 600, 121, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 169.08402635931103, "mean_inference_ms": 702.9842758116389, "mean_action_processing_ms": 33.03927597530414, "mean_env_wait_ms": 4096.358989712338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.5003209114074707, "StateBufferConnector_ms": 1.346308946609497, "ViewRequirementAgentConnector_ms": 31.51369857788086}}, "episode_reward_max": 479.2362780686855, "episode_reward_min": 3.7930512095012974, "episode_reward_mean": 378.7771498014614, "episode_len_mean": 482.22, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [96.26346310995035, 473.3913105522579, 466.5182900077165, 443.02946653073167, 467.2996912429077, 473.09399780704956, 467.28714558980016, 449.30300348083654, 343.85395927477254, 468.8881554137824, 467.23564796560044, 469.9233147906365, 467.0570066480096, 466.1613175419307, 52.37880253328871, 467.63381934037676, 468.4665832052167, 466.01122409502113, 97.28503654326707, 471.2636127512777, 466.55877459716316, 470.4002666551855, 464.11233624045735, 471.07827758677143, 469.4662584372139, 472.1079657424671, 470.56140111255326, 468.7604301067168, 465.3109882583439, 43.39540961195144, 471.20973632281243, 472.1947276120732, 54.54015204829117, 469.4406917751899, 39.699995862291054, 465.1974520766219, 469.34037719614975, 470.0411772861592, 64.80448842525804, 467.94316433960074, 476.0895482359186, 473.53281668233825, 439.8372223241682, 470.55660619170146, 470.87085539939227, 471.13692302188235, 468.85570256519435, 14.36119015144171, 466.7736289515067, 3.7930512095012974, 467.23999579031437, 467.4745783716695, 470.1363666122422, 97.35699461269976, 468.5664155561138, 469.8091381818295, 382.41271008679627, 469.1181768982324, 377.04452616719897, 396.2459636630872, 432.30822219310295, 471.5575838472241, 246.3803971684927, 138.18249978840637, 464.44111899197026, 4.580004146453346, 391.5272850171373, 469.21896575308, 471.71762799256635, 473.54984211083655, 126.67033683725555, 106.75825533928149, 479.2362780686855, 474.4740002998551, 473.1065500707097, 471.33777058976403, 469.8097211935486, 468.3014859616298, 472.2499987321171, 470.90266866272236, 475.1105863146298, 472.73510103990395, 178.5458499825797, 474.882421849466, 467.90328018865307, 467.5069589492327, 9.23422376889384, 470.6089343520886, 471.9228471936292, 6.9414945691683965, 467.98628689170454, 302.7617261967561, 467.9366210718609, 18.419641930701825, 174.54539137869818, 469.8325720007989, 468.2585649782065, 468.7632191802663, 107.32318718957721, 290.4641279635588], "episode_lengths": [111, 600, 600, 564, 600, 600, 600, 579, 443, 600, 600, 600, 600, 600, 64, 600, 600, 600, 118, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 50, 600, 600, 66, 600, 49, 600, 600, 600, 77, 600, 600, 600, 566, 600, 600, 600, 600, 17, 600, 5, 600, 600, 600, 117, 600, 600, 489, 600, 477, 504, 551, 600, 308, 158, 600, 6, 498, 600, 600, 600, 151, 134, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 210, 600, 600, 600, 12, 600, 600, 9, 600, 386, 600, 23, 199, 600, 600, 600, 121, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 169.08402635931103, "mean_inference_ms": 702.9842758116389, "mean_action_processing_ms": 33.03927597530414, "mean_env_wait_ms": 4096.358989712338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 2.5003209114074707, "StateBufferConnector_ms": 1.346308946609497, "ViewRequirementAgentConnector_ms": 31.51369857788086}, "num_healthy_workers": 50, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 10000, "num_env_steps_trained_this_iter": 10000, "num_env_steps_sampled_throughput_per_sec": 8.291963810201995, "num_env_steps_trained_throughput_per_sec": 8.291963810201995, "timesteps_total": 320000, "num_steps_trained_this_iter": 10000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 1196188.499, "sample_time_ms": 1068419.086, "load_time_ms": 3285.25, "load_throughput": 3043.908, "learn_time_ms": 122646.279, "learn_throughput": 81.535, "synch_weights_time_ms": 1787.125}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "episodes_total": 2541, "training_iteration": 32, "trial_id": "ef367_00000", "date": "2024-01-23_20-30-25", "timestamp": 1706013025, "time_this_iter_s": 1206.1375846862793, "time_total_s": 36692.715098142624, "pid": 1662135, "hostname": "CTAlab", "node_ip": "192.168.4.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "HighwayEnv", "env_config": {"render_mode": "rgb_array", "observation": {"type": "GrayscaleObservation", "observation_shape": [240, 320], "stack_size": 1, "weights": [0.2989, 0.587, 0.114], "scaling": 1.75}, "action": {"type": "ContinuousAction", "longitudinal": true, "lateral": true, "steering_range": [-1.0471975511965976, 1.0471975511965976]}, "offroad_terminal": true, "collision_reward": -3, "right_lane_reward": 0.5, "high_speed_reward": 1, "on_road_reward": 0.2, "forward_reward": 2, "simulation_frequency": 15, "policy_frequency": 15}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 10000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f31c88f1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 50}, "time_since_restore": 36692.715098142624, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 0.8044391121775645, "ram_util_percent": 21.128914217156566}}
