{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.845202275382148, "policy_loss": -0.026315896277212435, "vf_loss": 5.867673923704359, "vf_explained_var": 0.016688296794891356, "kl": 0.01922132553194166, "entropy": 1.5907644989755418, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 2000}, "sampler_results": {"episode_reward_max": 10.875, "episode_reward_min": 1.0416666666666667, "episode_reward_mean": 7.514619883040934, "episode_len_mean": 8.767543859649123, "episode_media": {}, "episodes_this_iter": 228, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.125, 4.500000000000001, 4.833333333333334, 2.958333333333333, 10.000000000000002, 9.208333333333334, 8.958333333333334, 10.166666666666666, 6.458333333333333, 9.083333333333334, 4.75, 9.333333333333332, 9.124999999999998, 1.1666666666666665, 9.125000000000002, 9.666666666666668, 9.041666666666666, 1.1666666666666665, 9.166666666666666, 9.208333333333334, 1.8333333333333335, 9.833333333333334, 9.458333333333332, 10.166666666666668, 1.916666666666667, 9.666666666666668, 9.416666666666668, 5.583333333333334, 4.833333333333334, 9.250000000000002, 9.750000000000002, 3.8750000000000004, 1.0416666666666667, 1.1666666666666665, 10.125000000000002, 1.7916666666666667, 9.500000000000002, 9.416666666666668, 9.041666666666668, 10.499999999999998, 9.333333333333334, 10.333333333333332, 1.125, 10.125, 10.208333333333334, 9.583333333333334, 6.500000000000001, 1.8333333333333335, 9.166666666666664, 8.208333333333334, 1.125, 10.375, 9.083333333333334, 10.791666666666666, 7.0, 5.625, 9.541666666666666, 10.208333333333334, 4.875000000000001, 8.333333333333332, 9.375, 1.916666666666667, 10.208333333333332, 9.416666666666668, 9.208333333333332, 9.625, 9.375, 2.9999999999999996, 3.791666666666667, 10.25, 9.291666666666668, 10.083333333333334, 9.458333333333334, 6.375, 4.750000000000001, 2.0, 10.125, 9.416666666666666, 1.125, 1.0416666666666667, 5.666666666666667, 9.750000000000002, 9.166666666666668, 9.083333333333334, 9.375, 9.958333333333334, 9.291666666666668, 10.708333333333334, 10.375, 9.91666666666667, 10.375, 9.166666666666668, 8.916666666666666, 9.833333333333334, 1.8333333333333335, 10.875, 9.208333333333334, 10.458333333333334, 9.25, 5.625000000000001, 9.041666666666666, 9.125, 10.041666666666666, 10.5, 2.9583333333333335, 1.8750000000000002, 9.291666666666668, 9.375, 9.375, 9.958333333333334, 10.0, 1.0416666666666667, 10.416666666666668, 10.708333333333334, 9.458333333333334, 1.1666666666666665, 9.666666666666668, 4.75, 9.291666666666666, 3.9166666666666665, 9.708333333333334, 9.166666666666664, 4.791666666666667, 9.416666666666668, 10.208333333333334, 10.166666666666666, 9.291666666666666, 10.875, 10.25, 10.0, 10.833333333333334, 8.958333333333334, 9.541666666666666, 10.708333333333334, 9.625, 9.875, 10.875, 1.0833333333333333, 4.708333333333334, 10.75, 9.458333333333334, 9.333333333333334, 1.0416666666666667, 9.166666666666666, 9.041666666666666, 9.541666666666666, 4.875000000000001, 9.375000000000002, 1.0833333333333333, 9.041666666666664, 9.708333333333334, 9.625, 6.541666666666667, 1.1666666666666665, 6.583333333333333, 9.583333333333334, 4.708333333333334, 5.625, 9.166666666666666, 9.124999999999998, 10.375000000000002, 9.541666666666668, 1.8750000000000002, 10.583333333333332, 1.125, 9.291666666666666, 9.125000000000002, 9.583333333333332, 1.0416666666666667, 9.166666666666668, 3.833333333333333, 9.458333333333332, 5.625000000000001, 5.791666666666667, 10.75, 9.625, 10.125, 9.666666666666668, 9.916666666666668, 9.25, 9.625, 1.0833333333333333, 2.9583333333333335, 9.791666666666668, 4.833333333333333, 10.583333333333334, 9.791666666666668, 9.208333333333334, 1.1666666666666665, 9.958333333333334, 5.166666666666667, 10.458333333333334, 2.875, 2.0, 9.124999999999998, 1.9583333333333333, 9.666666666666666, 10.375000000000002, 1.0833333333333333, 9.708333333333334, 10.5, 9.750000000000002, 8.916666666666668, 3.8333333333333335, 5.625000000000001, 4.041666666666667, 5.583333333333334, 9.875, 10.333333333333332, 9.708333333333334, 2.9999999999999996, 9.500000000000002, 1.0833333333333335, 9.125, 1.916666666666667, 9.416666666666666, 9.208333333333332, 9.250000000000002, 9.291666666666666, 3.7916666666666674, 8.416666666666666, 10.666666666666666, 9.625, 4.833333333333333, 9.166666666666666, 2.916666666666667, 1.7916666666666667, 9.166666666666668], "episode_lengths": [2, 6, 6, 4, 11, 11, 11, 11, 8, 11, 6, 11, 11, 2, 11, 11, 11, 2, 11, 11, 3, 11, 11, 11, 3, 11, 11, 7, 6, 11, 11, 5, 2, 2, 11, 3, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 8, 3, 11, 11, 2, 11, 11, 11, 9, 7, 11, 11, 6, 10, 11, 3, 11, 11, 11, 11, 11, 4, 5, 11, 11, 11, 11, 8, 6, 3, 11, 11, 2, 2, 7, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 7, 11, 11, 11, 11, 4, 3, 11, 11, 11, 11, 11, 2, 11, 11, 11, 2, 11, 6, 11, 5, 11, 11, 6, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 6, 11, 11, 11, 2, 11, 11, 11, 6, 11, 2, 11, 11, 11, 8, 2, 8, 11, 6, 7, 11, 11, 11, 11, 3, 11, 2, 11, 11, 11, 2, 11, 5, 11, 7, 7, 11, 11, 11, 11, 11, 11, 11, 2, 4, 11, 6, 11, 11, 11, 2, 11, 6, 11, 4, 3, 11, 3, 11, 11, 2, 11, 11, 11, 11, 5, 7, 5, 7, 11, 11, 11, 4, 11, 2, 11, 3, 11, 11, 11, 11, 5, 10, 11, 11, 6, 11, 4, 3, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4944554328441861, "mean_inference_ms": 1.2393909237016623, "mean_action_processing_ms": 0.10876951069905717, "mean_env_wait_ms": 36.58882050082899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008048997287861785, "StateBufferConnector_ms": 0.00695425864548711, "ViewRequirementAgentConnector_ms": 0.11482193456058615}}, "episode_reward_max": 10.875, "episode_reward_min": 1.0416666666666667, "episode_reward_mean": 7.514619883040934, "episode_len_mean": 8.767543859649123, "episodes_this_iter": 228, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.125, 4.500000000000001, 4.833333333333334, 2.958333333333333, 10.000000000000002, 9.208333333333334, 8.958333333333334, 10.166666666666666, 6.458333333333333, 9.083333333333334, 4.75, 9.333333333333332, 9.124999999999998, 1.1666666666666665, 9.125000000000002, 9.666666666666668, 9.041666666666666, 1.1666666666666665, 9.166666666666666, 9.208333333333334, 1.8333333333333335, 9.833333333333334, 9.458333333333332, 10.166666666666668, 1.916666666666667, 9.666666666666668, 9.416666666666668, 5.583333333333334, 4.833333333333334, 9.250000000000002, 9.750000000000002, 3.8750000000000004, 1.0416666666666667, 1.1666666666666665, 10.125000000000002, 1.7916666666666667, 9.500000000000002, 9.416666666666668, 9.041666666666668, 10.499999999999998, 9.333333333333334, 10.333333333333332, 1.125, 10.125, 10.208333333333334, 9.583333333333334, 6.500000000000001, 1.8333333333333335, 9.166666666666664, 8.208333333333334, 1.125, 10.375, 9.083333333333334, 10.791666666666666, 7.0, 5.625, 9.541666666666666, 10.208333333333334, 4.875000000000001, 8.333333333333332, 9.375, 1.916666666666667, 10.208333333333332, 9.416666666666668, 9.208333333333332, 9.625, 9.375, 2.9999999999999996, 3.791666666666667, 10.25, 9.291666666666668, 10.083333333333334, 9.458333333333334, 6.375, 4.750000000000001, 2.0, 10.125, 9.416666666666666, 1.125, 1.0416666666666667, 5.666666666666667, 9.750000000000002, 9.166666666666668, 9.083333333333334, 9.375, 9.958333333333334, 9.291666666666668, 10.708333333333334, 10.375, 9.91666666666667, 10.375, 9.166666666666668, 8.916666666666666, 9.833333333333334, 1.8333333333333335, 10.875, 9.208333333333334, 10.458333333333334, 9.25, 5.625000000000001, 9.041666666666666, 9.125, 10.041666666666666, 10.5, 2.9583333333333335, 1.8750000000000002, 9.291666666666668, 9.375, 9.375, 9.958333333333334, 10.0, 1.0416666666666667, 10.416666666666668, 10.708333333333334, 9.458333333333334, 1.1666666666666665, 9.666666666666668, 4.75, 9.291666666666666, 3.9166666666666665, 9.708333333333334, 9.166666666666664, 4.791666666666667, 9.416666666666668, 10.208333333333334, 10.166666666666666, 9.291666666666666, 10.875, 10.25, 10.0, 10.833333333333334, 8.958333333333334, 9.541666666666666, 10.708333333333334, 9.625, 9.875, 10.875, 1.0833333333333333, 4.708333333333334, 10.75, 9.458333333333334, 9.333333333333334, 1.0416666666666667, 9.166666666666666, 9.041666666666666, 9.541666666666666, 4.875000000000001, 9.375000000000002, 1.0833333333333333, 9.041666666666664, 9.708333333333334, 9.625, 6.541666666666667, 1.1666666666666665, 6.583333333333333, 9.583333333333334, 4.708333333333334, 5.625, 9.166666666666666, 9.124999999999998, 10.375000000000002, 9.541666666666668, 1.8750000000000002, 10.583333333333332, 1.125, 9.291666666666666, 9.125000000000002, 9.583333333333332, 1.0416666666666667, 9.166666666666668, 3.833333333333333, 9.458333333333332, 5.625000000000001, 5.791666666666667, 10.75, 9.625, 10.125, 9.666666666666668, 9.916666666666668, 9.25, 9.625, 1.0833333333333333, 2.9583333333333335, 9.791666666666668, 4.833333333333333, 10.583333333333334, 9.791666666666668, 9.208333333333334, 1.1666666666666665, 9.958333333333334, 5.166666666666667, 10.458333333333334, 2.875, 2.0, 9.124999999999998, 1.9583333333333333, 9.666666666666666, 10.375000000000002, 1.0833333333333333, 9.708333333333334, 10.5, 9.750000000000002, 8.916666666666668, 3.8333333333333335, 5.625000000000001, 4.041666666666667, 5.583333333333334, 9.875, 10.333333333333332, 9.708333333333334, 2.9999999999999996, 9.500000000000002, 1.0833333333333335, 9.125, 1.916666666666667, 9.416666666666666, 9.208333333333332, 9.250000000000002, 9.291666666666666, 3.7916666666666674, 8.416666666666666, 10.666666666666666, 9.625, 4.833333333333333, 9.166666666666666, 2.916666666666667, 1.7916666666666667, 9.166666666666668], "episode_lengths": [2, 6, 6, 4, 11, 11, 11, 11, 8, 11, 6, 11, 11, 2, 11, 11, 11, 2, 11, 11, 3, 11, 11, 11, 3, 11, 11, 7, 6, 11, 11, 5, 2, 2, 11, 3, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 8, 3, 11, 11, 2, 11, 11, 11, 9, 7, 11, 11, 6, 10, 11, 3, 11, 11, 11, 11, 11, 4, 5, 11, 11, 11, 11, 8, 6, 3, 11, 11, 2, 2, 7, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 7, 11, 11, 11, 11, 4, 3, 11, 11, 11, 11, 11, 2, 11, 11, 11, 2, 11, 6, 11, 5, 11, 11, 6, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 6, 11, 11, 11, 2, 11, 11, 11, 6, 11, 2, 11, 11, 11, 8, 2, 8, 11, 6, 7, 11, 11, 11, 11, 3, 11, 2, 11, 11, 11, 2, 11, 5, 11, 7, 7, 11, 11, 11, 11, 11, 11, 11, 2, 4, 11, 6, 11, 11, 11, 2, 11, 6, 11, 4, 3, 11, 3, 11, 11, 2, 11, 11, 11, 11, 5, 7, 5, 7, 11, 11, 11, 4, 11, 2, 11, 3, 11, 11, 11, 11, 5, 10, 11, 11, 6, 11, 4, 3, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4944554328441861, "mean_inference_ms": 1.2393909237016623, "mean_action_processing_ms": 0.10876951069905717, "mean_env_wait_ms": 36.58882050082899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008048997287861785, "StateBufferConnector_ms": 0.00695425864548711, "ViewRequirementAgentConnector_ms": 0.11482193456058615}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 2000, "num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.299289045876694, "num_env_steps_trained_throughput_per_sec": 24.299289045876694, "timesteps_total": 2000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 2000, "timers": {"training_iteration_time_ms": 82306.893, "sample_time_ms": 78950.373, "load_time_ms": 5.498, "load_throughput": 363788.889, "learn_time_ms": 3347.483, "learn_throughput": 597.464, "synch_weights_time_ms": 2.905}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 2000}, "done": false, "episodes_total": 228, "training_iteration": 1, "trial_id": "13850_00003", "date": "2023-12-28_17-48-51", "timestamp": 1703756931, "time_this_iter_s": 82.31542754173279, "time_total_s": 82.31542754173279, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 82.31542754173279, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 55.667796610169496, "ram_util_percent": 91.27457627118643}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.006356863445705, "policy_loss": -0.028442740349306002, "vf_loss": 5.030577739079793, "vf_explained_var": 0.022417896853552926, "kl": 0.021109265898123668, "entropy": 1.5571763412157695, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 675.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 10.708333333333334, "episode_reward_min": 1.0, "episode_reward_mean": 7.926356589147286, "episode_len_mean": 9.269767441860465, "episode_media": {}, "episodes_this_iter": 215, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.708333333333334, 1.1666666666666665, 9.041666666666668, 9.66666666666667, 9.541666666666666, 7.458333333333334, 10.333333333333332, 10.583333333333336, 9.458333333333334, 3.7500000000000004, 10.666666666666666, 9.083333333333334, 9.458333333333334, 10.708333333333332, 1.0, 10.625, 9.166666666666666, 9.375000000000002, 9.25, 8.958333333333334, 10.416666666666668, 4.958333333333333, 9.166666666666666, 9.541666666666666, 10.041666666666668, 9.625, 9.916666666666666, 10.583333333333334, 10.625000000000002, 9.0, 9.291666666666666, 9.375, 9.666666666666666, 10.208333333333334, 4.916666666666666, 9.083333333333334, 9.458333333333332, 9.833333333333334, 9.333333333333334, 1.125, 2.0, 10.083333333333334, 10.416666666666668, 10.624999999999998, 3.6666666666666674, 9.416666666666668, 8.958333333333334, 9.333333333333334, 1.1666666666666665, 9.125, 5.833333333333333, 5.958333333333333, 9.125, 1.125, 9.125, 9.875000000000002, 1.125, 9.625, 9.291666666666668, 1.1666666666666665, 9.291666666666666, 9.208333333333334, 1.1666666666666665, 1.1666666666666665, 9.375, 9.583333333333332, 9.916666666666668, 8.874999999999998, 1.0416666666666667, 9.750000000000002, 7.166666666666666, 9.291666666666668, 9.041666666666666, 9.458333333333334, 9.166666666666666, 10.708333333333334, 8.916666666666666, 1.0, 9.458333333333336, 10.083333333333334, 9.208333333333334, 9.250000000000002, 1.0416666666666667, 1.125, 8.916666666666668, 9.708333333333332, 9.958333333333334, 9.291666666666668, 10.625, 10.041666666666668, 9.333333333333334, 4.75, 9.666666666666668, 9.875, 5.833333333333332, 9.458333333333334, 1.125, 9.416666666666668, 9.916666666666668, 2.0416666666666665, 9.375, 9.375, 9.541666666666668, 9.291666666666666, 3.7916666666666674, 6.416666666666667, 9.875, 9.083333333333334, 9.25, 9.25, 10.541666666666668, 3.041666666666667, 9.041666666666666, 9.833333333333334, 9.541666666666668, 2.9583333333333335, 1.1666666666666665, 9.416666666666666, 4.958333333333333, 1.0833333333333335, 10.083333333333332, 8.208333333333334, 9.375, 9.083333333333334, 8.875, 9.958333333333332, 1.0833333333333335, 1.0, 8.875, 9.624999999999998, 9.125, 9.458333333333332, 9.458333333333334, 9.416666666666666, 9.124999999999998, 3.7083333333333335, 9.083333333333336, 3.541666666666667, 9.083333333333332, 10.291666666666668, 10.041666666666668, 9.25, 9.458333333333332, 1.0833333333333335, 9.291666666666668, 10.416666666666666, 5.666666666666666, 7.833333333333333, 9.583333333333334, 9.166666666666666, 9.333333333333332, 9.416666666666666, 9.249999999999998, 9.916666666666668, 10.666666666666668, 10.000000000000002, 9.083333333333332, 2.9166666666666665, 9.125000000000002, 10.541666666666664, 9.583333333333334, 10.416666666666668, 9.041666666666668, 7.333333333333334, 10.291666666666666, 9.0, 9.791666666666666, 9.458333333333334, 9.208333333333332, 9.625, 9.583333333333334, 9.125, 5.375000000000001, 10.416666666666666, 9.208333333333334, 9.875, 9.041666666666666, 9.875000000000002, 9.750000000000002, 9.25, 9.208333333333334, 9.916666666666668, 9.499999999999998, 1.0833333333333335, 9.125000000000002, 9.958333333333336, 9.041666666666666, 1.125, 1.125, 9.625000000000002, 9.291666666666668, 9.333333333333334, 3.541666666666667, 1.0416666666666667, 9.666666666666668, 9.041666666666666, 9.5, 10.583333333333334, 10.166666666666668, 9.583333333333332, 1.8750000000000002, 8.875, 9.291666666666666, 9.625, 9.916666666666666, 9.375, 5.041666666666667, 9.166666666666666, 9.041666666666668, 1.1666666666666665, 1.125, 9.416666666666666, 9.333333333333334, 1.0416666666666667, 9.375], "episode_lengths": [11, 2, 11, 11, 11, 9, 11, 11, 11, 5, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 6, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 6, 11, 11, 11, 11, 2, 3, 11, 11, 11, 5, 11, 11, 11, 2, 11, 7, 7, 11, 2, 11, 11, 2, 11, 11, 2, 11, 11, 2, 2, 11, 11, 11, 11, 2, 11, 9, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 2, 2, 11, 11, 11, 11, 11, 11, 11, 6, 11, 11, 7, 11, 2, 11, 11, 3, 11, 11, 11, 11, 5, 8, 11, 11, 11, 11, 11, 4, 11, 11, 11, 4, 2, 11, 6, 2, 11, 10, 11, 11, 11, 11, 2, 2, 11, 11, 11, 11, 11, 11, 11, 5, 11, 5, 11, 11, 11, 11, 11, 2, 11, 11, 7, 9, 11, 11, 11, 11, 11, 11, 11, 11, 11, 4, 11, 11, 11, 11, 11, 9, 11, 11, 11, 11, 11, 11, 11, 11, 7, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 2, 2, 11, 11, 11, 5, 2, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 6, 11, 11, 2, 2, 11, 11, 2, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.44604330389418, "mean_inference_ms": 1.2103461885535691, "mean_action_processing_ms": 0.10702455678423538, "mean_env_wait_ms": 36.13159442597464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007474477901015171, "StateBufferConnector_ms": 0.005936844404353652, "ViewRequirementAgentConnector_ms": 0.10990497677825219}}, "episode_reward_max": 10.708333333333334, "episode_reward_min": 1.0, "episode_reward_mean": 7.926356589147286, "episode_len_mean": 9.269767441860465, "episodes_this_iter": 215, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.708333333333334, 1.1666666666666665, 9.041666666666668, 9.66666666666667, 9.541666666666666, 7.458333333333334, 10.333333333333332, 10.583333333333336, 9.458333333333334, 3.7500000000000004, 10.666666666666666, 9.083333333333334, 9.458333333333334, 10.708333333333332, 1.0, 10.625, 9.166666666666666, 9.375000000000002, 9.25, 8.958333333333334, 10.416666666666668, 4.958333333333333, 9.166666666666666, 9.541666666666666, 10.041666666666668, 9.625, 9.916666666666666, 10.583333333333334, 10.625000000000002, 9.0, 9.291666666666666, 9.375, 9.666666666666666, 10.208333333333334, 4.916666666666666, 9.083333333333334, 9.458333333333332, 9.833333333333334, 9.333333333333334, 1.125, 2.0, 10.083333333333334, 10.416666666666668, 10.624999999999998, 3.6666666666666674, 9.416666666666668, 8.958333333333334, 9.333333333333334, 1.1666666666666665, 9.125, 5.833333333333333, 5.958333333333333, 9.125, 1.125, 9.125, 9.875000000000002, 1.125, 9.625, 9.291666666666668, 1.1666666666666665, 9.291666666666666, 9.208333333333334, 1.1666666666666665, 1.1666666666666665, 9.375, 9.583333333333332, 9.916666666666668, 8.874999999999998, 1.0416666666666667, 9.750000000000002, 7.166666666666666, 9.291666666666668, 9.041666666666666, 9.458333333333334, 9.166666666666666, 10.708333333333334, 8.916666666666666, 1.0, 9.458333333333336, 10.083333333333334, 9.208333333333334, 9.250000000000002, 1.0416666666666667, 1.125, 8.916666666666668, 9.708333333333332, 9.958333333333334, 9.291666666666668, 10.625, 10.041666666666668, 9.333333333333334, 4.75, 9.666666666666668, 9.875, 5.833333333333332, 9.458333333333334, 1.125, 9.416666666666668, 9.916666666666668, 2.0416666666666665, 9.375, 9.375, 9.541666666666668, 9.291666666666666, 3.7916666666666674, 6.416666666666667, 9.875, 9.083333333333334, 9.25, 9.25, 10.541666666666668, 3.041666666666667, 9.041666666666666, 9.833333333333334, 9.541666666666668, 2.9583333333333335, 1.1666666666666665, 9.416666666666666, 4.958333333333333, 1.0833333333333335, 10.083333333333332, 8.208333333333334, 9.375, 9.083333333333334, 8.875, 9.958333333333332, 1.0833333333333335, 1.0, 8.875, 9.624999999999998, 9.125, 9.458333333333332, 9.458333333333334, 9.416666666666666, 9.124999999999998, 3.7083333333333335, 9.083333333333336, 3.541666666666667, 9.083333333333332, 10.291666666666668, 10.041666666666668, 9.25, 9.458333333333332, 1.0833333333333335, 9.291666666666668, 10.416666666666666, 5.666666666666666, 7.833333333333333, 9.583333333333334, 9.166666666666666, 9.333333333333332, 9.416666666666666, 9.249999999999998, 9.916666666666668, 10.666666666666668, 10.000000000000002, 9.083333333333332, 2.9166666666666665, 9.125000000000002, 10.541666666666664, 9.583333333333334, 10.416666666666668, 9.041666666666668, 7.333333333333334, 10.291666666666666, 9.0, 9.791666666666666, 9.458333333333334, 9.208333333333332, 9.625, 9.583333333333334, 9.125, 5.375000000000001, 10.416666666666666, 9.208333333333334, 9.875, 9.041666666666666, 9.875000000000002, 9.750000000000002, 9.25, 9.208333333333334, 9.916666666666668, 9.499999999999998, 1.0833333333333335, 9.125000000000002, 9.958333333333336, 9.041666666666666, 1.125, 1.125, 9.625000000000002, 9.291666666666668, 9.333333333333334, 3.541666666666667, 1.0416666666666667, 9.666666666666668, 9.041666666666666, 9.5, 10.583333333333334, 10.166666666666668, 9.583333333333332, 1.8750000000000002, 8.875, 9.291666666666666, 9.625, 9.916666666666666, 9.375, 5.041666666666667, 9.166666666666666, 9.041666666666668, 1.1666666666666665, 1.125, 9.416666666666666, 9.333333333333334, 1.0416666666666667, 9.375], "episode_lengths": [11, 2, 11, 11, 11, 9, 11, 11, 11, 5, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 6, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 6, 11, 11, 11, 11, 2, 3, 11, 11, 11, 5, 11, 11, 11, 2, 11, 7, 7, 11, 2, 11, 11, 2, 11, 11, 2, 11, 11, 2, 2, 11, 11, 11, 11, 2, 11, 9, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 2, 2, 11, 11, 11, 11, 11, 11, 11, 6, 11, 11, 7, 11, 2, 11, 11, 3, 11, 11, 11, 11, 5, 8, 11, 11, 11, 11, 11, 4, 11, 11, 11, 4, 2, 11, 6, 2, 11, 10, 11, 11, 11, 11, 2, 2, 11, 11, 11, 11, 11, 11, 11, 5, 11, 5, 11, 11, 11, 11, 11, 2, 11, 11, 7, 9, 11, 11, 11, 11, 11, 11, 11, 11, 11, 4, 11, 11, 11, 11, 11, 9, 11, 11, 11, 11, 11, 11, 11, 11, 7, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 2, 2, 11, 11, 11, 5, 2, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 6, 11, 11, 2, 2, 11, 11, 2, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.44604330389418, "mean_inference_ms": 1.2103461885535691, "mean_action_processing_ms": 0.10702455678423538, "mean_env_wait_ms": 36.13159442597464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007474477901015171, "StateBufferConnector_ms": 0.005936844404353652, "ViewRequirementAgentConnector_ms": 0.10990497677825219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 25.00575190469402, "num_env_steps_trained_throughput_per_sec": 25.00575190469402, "timesteps_total": 4000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 81144.234, "sample_time_ms": 77856.253, "load_time_ms": 7.805, "load_throughput": 256254.158, "learn_time_ms": 3277.099, "learn_throughput": 610.296, "synch_weights_time_ms": 2.565}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 443, "training_iteration": 2, "trial_id": "13850_00003", "date": "2023-12-28_17-50-11", "timestamp": 1703757011, "time_this_iter_s": 79.98948931694031, "time_total_s": 162.3049168586731, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 162.3049168586731, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 56.02105263157895, "ram_util_percent": 92.23596491228068}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6173363904158276, "policy_loss": -0.017574952791134517, "vf_loss": 2.631270746919844, "vf_explained_var": 0.2798353564739227, "kl": 0.01213529353225774, "entropy": 1.5390358622868856, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1125.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 6000}, "sampler_results": {"episode_reward_max": 10.791666666666666, "episode_reward_min": 1.0, "episode_reward_mean": 8.303921568627452, "episode_len_mean": 9.803921568627452, "episode_media": {}, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.41666666666667, 9.666666666666668, 1.0833333333333333, 9.708333333333332, 9.458333333333334, 9.208333333333332, 9.125, 9.083333333333334, 9.291666666666666, 9.375, 9.166666666666668, 1.0416666666666667, 9.791666666666666, 9.708333333333332, 9.125, 9.166666666666668, 10.0, 3.7083333333333335, 8.958333333333332, 9.125000000000002, 9.791666666666668, 9.125, 9.125, 10.208333333333332, 9.583333333333334, 9.541666666666668, 8.958333333333332, 9.374999999999998, 9.291666666666668, 4.875000000000001, 9.25, 9.458333333333334, 9.291666666666668, 9.333333333333334, 10.125, 9.333333333333332, 9.541666666666668, 9.375, 10.25, 9.5, 9.041666666666668, 3.833333333333334, 9.958333333333334, 8.958333333333332, 9.0, 9.375, 9.208333333333332, 9.25, 9.0, 7.875, 9.041666666666666, 9.458333333333334, 9.208333333333332, 5.583333333333333, 9.374999999999998, 9.625, 9.666666666666668, 3.7916666666666665, 1.1666666666666665, 9.125000000000002, 1.8333333333333335, 9.166666666666666, 9.208333333333334, 9.458333333333334, 9.958333333333334, 9.625, 8.958333333333334, 9.458333333333334, 1.125, 3.791666666666667, 8.958333333333332, 8.833333333333334, 9.833333333333334, 9.79166666666667, 9.833333333333334, 10.791666666666666, 1.0833333333333333, 9.5, 9.041666666666666, 1.0, 9.416666666666668, 9.208333333333334, 9.458333333333334, 9.75, 9.25, 9.541666666666668, 9.0, 9.416666666666668, 10.041666666666666, 9.25, 9.791666666666668, 9.416666666666668, 10.416666666666668, 3.7083333333333335, 10.666666666666666, 9.375, 9.375, 9.500000000000002, 9.166666666666666, 1.0416666666666667, 4.833333333333334, 9.333333333333334, 9.5, 9.083333333333332, 9.166666666666668, 9.0, 3.5833333333333335, 8.958333333333332, 9.041666666666666, 9.208333333333334, 10.375, 9.25, 4.583333333333334, 9.041666666666666, 6.541666666666667, 9.166666666666666, 9.125, 10.416666666666668, 9.916666666666666, 1.0833333333333335, 9.083333333333334, 9.458333333333332, 10.374999999999998, 9.0, 9.708333333333334, 1.125, 8.999999999999998, 9.291666666666666, 4.666666666666667, 9.333333333333332, 9.333333333333334, 9.0, 9.208333333333332, 9.333333333333332, 9.458333333333334, 2.9583333333333335, 9.625, 9.083333333333332, 9.041666666666668, 1.0833333333333333, 9.291666666666668, 9.125, 9.25, 9.291666666666668, 7.208333333333333, 9.333333333333334, 9.208333333333334, 1.1666666666666665, 9.083333333333334, 9.583333333333334, 9.416666666666668, 8.916666666666666, 9.416666666666668, 4.708333333333333, 9.0, 9.5, 9.25, 1.0, 9.124999999999998, 10.500000000000002, 6.374999999999999, 9.041666666666666, 3.75, 9.208333333333332, 10.583333333333332, 9.791666666666666, 9.249999999999998, 9.208333333333332, 9.125, 9.333333333333336, 9.25, 9.083333333333332, 9.125, 9.041666666666664, 9.041666666666666, 10.0, 9.25, 1.0, 9.458333333333334, 9.083333333333332, 1.1666666666666665, 9.25, 9.041666666666668, 9.666666666666666, 1.0416666666666667, 10.041666666666668, 9.541666666666666, 9.208333333333332, 9.041666666666666, 1.8750000000000002, 9.375, 9.208333333333334, 9.291666666666666, 9.625, 8.958333333333334, 9.458333333333334, 9.083333333333332, 10.541666666666666, 10.25, 9.625, 4.666666666666667, 10.791666666666666, 9.333333333333334, 10.04166666666667], "episode_lengths": [11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 5, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 6, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 5, 11, 11, 11, 11, 11, 11, 11, 9, 11, 11, 11, 7, 11, 11, 11, 5, 2, 11, 3, 11, 11, 11, 11, 11, 11, 11, 2, 5, 11, 11, 11, 11, 11, 11, 2, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 5, 11, 11, 11, 11, 11, 2, 6, 11, 11, 11, 11, 11, 5, 11, 11, 11, 11, 11, 6, 11, 8, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 2, 11, 11, 6, 11, 11, 11, 11, 11, 11, 4, 11, 11, 11, 2, 11, 11, 11, 11, 9, 11, 11, 2, 11, 11, 11, 11, 11, 6, 11, 11, 11, 2, 11, 11, 8, 11, 5, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 2, 11, 11, 11, 2, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 6, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4175737804024442, "mean_inference_ms": 1.2054626513790871, "mean_action_processing_ms": 0.10673178571241136, "mean_env_wait_ms": 36.085038001567916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007544078078924441, "StateBufferConnector_ms": 0.005705216351677389, "ViewRequirementAgentConnector_ms": 0.1109153616662119}}, "episode_reward_max": 10.791666666666666, "episode_reward_min": 1.0, "episode_reward_mean": 8.303921568627452, "episode_len_mean": 9.803921568627452, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.41666666666667, 9.666666666666668, 1.0833333333333333, 9.708333333333332, 9.458333333333334, 9.208333333333332, 9.125, 9.083333333333334, 9.291666666666666, 9.375, 9.166666666666668, 1.0416666666666667, 9.791666666666666, 9.708333333333332, 9.125, 9.166666666666668, 10.0, 3.7083333333333335, 8.958333333333332, 9.125000000000002, 9.791666666666668, 9.125, 9.125, 10.208333333333332, 9.583333333333334, 9.541666666666668, 8.958333333333332, 9.374999999999998, 9.291666666666668, 4.875000000000001, 9.25, 9.458333333333334, 9.291666666666668, 9.333333333333334, 10.125, 9.333333333333332, 9.541666666666668, 9.375, 10.25, 9.5, 9.041666666666668, 3.833333333333334, 9.958333333333334, 8.958333333333332, 9.0, 9.375, 9.208333333333332, 9.25, 9.0, 7.875, 9.041666666666666, 9.458333333333334, 9.208333333333332, 5.583333333333333, 9.374999999999998, 9.625, 9.666666666666668, 3.7916666666666665, 1.1666666666666665, 9.125000000000002, 1.8333333333333335, 9.166666666666666, 9.208333333333334, 9.458333333333334, 9.958333333333334, 9.625, 8.958333333333334, 9.458333333333334, 1.125, 3.791666666666667, 8.958333333333332, 8.833333333333334, 9.833333333333334, 9.79166666666667, 9.833333333333334, 10.791666666666666, 1.0833333333333333, 9.5, 9.041666666666666, 1.0, 9.416666666666668, 9.208333333333334, 9.458333333333334, 9.75, 9.25, 9.541666666666668, 9.0, 9.416666666666668, 10.041666666666666, 9.25, 9.791666666666668, 9.416666666666668, 10.416666666666668, 3.7083333333333335, 10.666666666666666, 9.375, 9.375, 9.500000000000002, 9.166666666666666, 1.0416666666666667, 4.833333333333334, 9.333333333333334, 9.5, 9.083333333333332, 9.166666666666668, 9.0, 3.5833333333333335, 8.958333333333332, 9.041666666666666, 9.208333333333334, 10.375, 9.25, 4.583333333333334, 9.041666666666666, 6.541666666666667, 9.166666666666666, 9.125, 10.416666666666668, 9.916666666666666, 1.0833333333333335, 9.083333333333334, 9.458333333333332, 10.374999999999998, 9.0, 9.708333333333334, 1.125, 8.999999999999998, 9.291666666666666, 4.666666666666667, 9.333333333333332, 9.333333333333334, 9.0, 9.208333333333332, 9.333333333333332, 9.458333333333334, 2.9583333333333335, 9.625, 9.083333333333332, 9.041666666666668, 1.0833333333333333, 9.291666666666668, 9.125, 9.25, 9.291666666666668, 7.208333333333333, 9.333333333333334, 9.208333333333334, 1.1666666666666665, 9.083333333333334, 9.583333333333334, 9.416666666666668, 8.916666666666666, 9.416666666666668, 4.708333333333333, 9.0, 9.5, 9.25, 1.0, 9.124999999999998, 10.500000000000002, 6.374999999999999, 9.041666666666666, 3.75, 9.208333333333332, 10.583333333333332, 9.791666666666666, 9.249999999999998, 9.208333333333332, 9.125, 9.333333333333336, 9.25, 9.083333333333332, 9.125, 9.041666666666664, 9.041666666666666, 10.0, 9.25, 1.0, 9.458333333333334, 9.083333333333332, 1.1666666666666665, 9.25, 9.041666666666668, 9.666666666666666, 1.0416666666666667, 10.041666666666668, 9.541666666666666, 9.208333333333332, 9.041666666666666, 1.8750000000000002, 9.375, 9.208333333333334, 9.291666666666666, 9.625, 8.958333333333334, 9.458333333333334, 9.083333333333332, 10.541666666666666, 10.25, 9.625, 4.666666666666667, 10.791666666666666, 9.333333333333334, 10.04166666666667], "episode_lengths": [11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 5, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 6, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 5, 11, 11, 11, 11, 11, 11, 11, 9, 11, 11, 11, 7, 11, 11, 11, 5, 2, 11, 3, 11, 11, 11, 11, 11, 11, 11, 2, 5, 11, 11, 11, 11, 11, 11, 2, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 5, 11, 11, 11, 11, 11, 2, 6, 11, 11, 11, 11, 11, 5, 11, 11, 11, 11, 11, 6, 11, 8, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 2, 11, 11, 6, 11, 11, 11, 11, 11, 11, 4, 11, 11, 11, 2, 11, 11, 11, 11, 9, 11, 11, 2, 11, 11, 11, 11, 11, 6, 11, 11, 11, 2, 11, 11, 8, 11, 5, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 2, 11, 11, 11, 2, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 6, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4175737804024442, "mean_inference_ms": 1.2054626513790871, "mean_action_processing_ms": 0.10673178571241136, "mean_env_wait_ms": 36.085038001567916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007544078078924441, "StateBufferConnector_ms": 0.005705216351677389, "ViewRequirementAgentConnector_ms": 0.1109153616662119}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 6000, "num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.83079702866286, "num_env_steps_trained_throughput_per_sec": 24.83079702866286, "timesteps_total": 6000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 6000, "timers": {"training_iteration_time_ms": 80944.523, "sample_time_ms": 77688.958, "load_time_ms": 9.897, "load_throughput": 202088.06, "learn_time_ms": 3242.775, "learn_throughput": 616.756, "synch_weights_time_ms": 2.419}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 6000}, "done": false, "episodes_total": 647, "training_iteration": 3, "trial_id": "13850_00003", "date": "2023-12-28_17-51-32", "timestamp": 1703757092, "time_this_iter_s": 80.55280637741089, "time_total_s": 242.85772323608398, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 242.85772323608398, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 56.06666666666667, "ram_util_percent": 92.2026315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9076956666840448, "policy_loss": -0.025068082304464445, "vf_loss": 1.927835655477312, "vf_explained_var": 0.4381654114193386, "kl": 0.016427003968553202, "entropy": 1.4864733958244323, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 10.541666666666666, "episode_reward_min": 1.0, "episode_reward_mean": 8.63371598639456, "episode_len_mean": 10.229591836734693, "episode_media": {}, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.541666666666668, 9.666666666666668, 9.250000000000002, 9.041666666666666, 9.416666666666668, 9.458333333333334, 9.791666666666668, 9.75, 9.541666666666666, 9.041666666666668, 9.041666666666668, 9.583333333333334, 9.166666666666668, 9.833333333333334, 9.791666666666668, 5.708333333333334, 8.791666666666668, 1.125, 9.458333333333332, 9.208333333333334, 10.166666666666666, 9.291666666666668, 9.083333333333332, 9.958333333333334, 1.125, 3.5833333333333335, 10.041666666666668, 1.0, 8.875000000000002, 9.708333333333334, 9.125, 8.958333333333334, 9.791666666666668, 9.125000000000002, 9.000000000000002, 9.75, 1.0416666666666667, 9.125, 10.541666666666666, 10.375000000000002, 9.125, 9.208333333333332, 9.166666666666666, 1.125, 3.8750000000000004, 9.625, 9.000000000000002, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.208333333333332, 9.041666666666666, 9.291666666666666, 9.416666666666668, 8.958333333333334, 9.541666666666666, 8.958333333333334, 9.083333333333332, 8.916666666666668, 10.125000000000002, 8.958333333333332, 1.0, 9.166666666666668, 9.625, 9.000000000000002, 8.916666666666668, 9.416666666666666, 9.083333333333334, 9.0, 9.708333333333334, 1.0833333333333335, 9.416666666666666, 9.291666666666666, 9.541666666666668, 9.0, 9.583333333333334, 9.083333333333334, 9.25, 7.125, 9.625000000000002, 9.166666666666666, 9.458333333333334, 10.458333333333334, 9.208333333333334, 9.083333333333334, 9.000000000000002, 10.166666666666666, 9.291666666666666, 9.375, 9.875, 9.833333333333334, 9.249999999999998, 9.333333333333332, 9.208333333333334, 9.75, 9.333333333333332, 9.374999999999998, 9.583333333333334, 9.041666666666668, 9.041666666666666, 10.000000000000002, 8.958333333333332, 8.875, 9.041666666666666, 9.208333333333334, 9.041666666666666, 9.166666666666666, 1.125, 9.083333333333334, 8.958333333333332, 9.083333333333334, 1.1666666666666665, 9.875, 9.083333333333334, 8.833333333333332, 1.125, 9.166666666666666, 3.5833333333333335, 6.625, 9.375, 9.666666666666666, 9.0, 8.958333333333334, 9.208333333333334, 10.083333333333334, 9.750000000000002, 1.125, 8.833333333333336, 5.791666666666667, 9.458333333333336, 9.833333333333334, 9.291666666666668, 5.666666666666667, 9.291666666666666, 9.166666666666666, 9.125, 9.208333333333332, 9.166666666666666, 9.041666666666668, 9.250000000000002, 9.583333333333334, 9.333333333333332, 9.333333333333336, 9.625, 9.375000000000002, 9.291666666666668, 9.791666666666666, 9.416666666666668, 9.166666666666668, 9.208333333333334, 10.083333333333334, 9.25, 10.416666666666668, 9.333333333333334, 9.333333333333334, 9.083333333333334, 9.333333333333332, 9.083333333333332, 9.125000000000002, 9.25, 3.916666666666667, 10.166666666666666, 9.166666666666668, 9.666666666666668, 9.875, 9.500000000000002, 1.0833333333333335, 8.958333333333332, 9.083333333333336, 9.25, 9.041666666666666, 9.416666666666666, 9.458333333333332, 9.375, 9.5, 8.958333333333334, 9.416666666666666, 9.25, 9.249999999999998, 9.416666666666668, 8.916666666666668, 8.958333333333332, 9.125, 9.416666666666668, 9.041666666666668, 7.458333333333334, 9.166666666666668, 8.916666666666666, 9.541666666666668, 9.041666666666666, 9.166666666666668, 9.375000000000002, 9.166666666666666, 9.416666666666668, 9.208333333333334, 9.25], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 7, 11, 2, 11, 11, 11, 11, 11, 11, 2, 5, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 2, 5, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 9, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 2, 11, 11, 11, 2, 11, 5, 8, 11, 11, 11, 11, 11, 11, 11, 2, 11, 7, 11, 11, 11, 7, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 5, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 9, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3965287963653588, "mean_inference_ms": 1.2041350451577773, "mean_action_processing_ms": 0.10687594800543121, "mean_env_wait_ms": 36.16101577004525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007521254675728934, "StateBufferConnector_ms": 0.005494453469101264, "ViewRequirementAgentConnector_ms": 0.11130498380077128}}, "episode_reward_max": 10.541666666666666, "episode_reward_min": 1.0, "episode_reward_mean": 8.63371598639456, "episode_len_mean": 10.229591836734693, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.541666666666668, 9.666666666666668, 9.250000000000002, 9.041666666666666, 9.416666666666668, 9.458333333333334, 9.791666666666668, 9.75, 9.541666666666666, 9.041666666666668, 9.041666666666668, 9.583333333333334, 9.166666666666668, 9.833333333333334, 9.791666666666668, 5.708333333333334, 8.791666666666668, 1.125, 9.458333333333332, 9.208333333333334, 10.166666666666666, 9.291666666666668, 9.083333333333332, 9.958333333333334, 1.125, 3.5833333333333335, 10.041666666666668, 1.0, 8.875000000000002, 9.708333333333334, 9.125, 8.958333333333334, 9.791666666666668, 9.125000000000002, 9.000000000000002, 9.75, 1.0416666666666667, 9.125, 10.541666666666666, 10.375000000000002, 9.125, 9.208333333333332, 9.166666666666666, 1.125, 3.8750000000000004, 9.625, 9.000000000000002, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.208333333333332, 9.041666666666666, 9.291666666666666, 9.416666666666668, 8.958333333333334, 9.541666666666666, 8.958333333333334, 9.083333333333332, 8.916666666666668, 10.125000000000002, 8.958333333333332, 1.0, 9.166666666666668, 9.625, 9.000000000000002, 8.916666666666668, 9.416666666666666, 9.083333333333334, 9.0, 9.708333333333334, 1.0833333333333335, 9.416666666666666, 9.291666666666666, 9.541666666666668, 9.0, 9.583333333333334, 9.083333333333334, 9.25, 7.125, 9.625000000000002, 9.166666666666666, 9.458333333333334, 10.458333333333334, 9.208333333333334, 9.083333333333334, 9.000000000000002, 10.166666666666666, 9.291666666666666, 9.375, 9.875, 9.833333333333334, 9.249999999999998, 9.333333333333332, 9.208333333333334, 9.75, 9.333333333333332, 9.374999999999998, 9.583333333333334, 9.041666666666668, 9.041666666666666, 10.000000000000002, 8.958333333333332, 8.875, 9.041666666666666, 9.208333333333334, 9.041666666666666, 9.166666666666666, 1.125, 9.083333333333334, 8.958333333333332, 9.083333333333334, 1.1666666666666665, 9.875, 9.083333333333334, 8.833333333333332, 1.125, 9.166666666666666, 3.5833333333333335, 6.625, 9.375, 9.666666666666666, 9.0, 8.958333333333334, 9.208333333333334, 10.083333333333334, 9.750000000000002, 1.125, 8.833333333333336, 5.791666666666667, 9.458333333333336, 9.833333333333334, 9.291666666666668, 5.666666666666667, 9.291666666666666, 9.166666666666666, 9.125, 9.208333333333332, 9.166666666666666, 9.041666666666668, 9.250000000000002, 9.583333333333334, 9.333333333333332, 9.333333333333336, 9.625, 9.375000000000002, 9.291666666666668, 9.791666666666666, 9.416666666666668, 9.166666666666668, 9.208333333333334, 10.083333333333334, 9.25, 10.416666666666668, 9.333333333333334, 9.333333333333334, 9.083333333333334, 9.333333333333332, 9.083333333333332, 9.125000000000002, 9.25, 3.916666666666667, 10.166666666666666, 9.166666666666668, 9.666666666666668, 9.875, 9.500000000000002, 1.0833333333333335, 8.958333333333332, 9.083333333333336, 9.25, 9.041666666666666, 9.416666666666666, 9.458333333333332, 9.375, 9.5, 8.958333333333334, 9.416666666666666, 9.25, 9.249999999999998, 9.416666666666668, 8.916666666666668, 8.958333333333332, 9.125, 9.416666666666668, 9.041666666666668, 7.458333333333334, 9.166666666666668, 8.916666666666666, 9.541666666666668, 9.041666666666666, 9.166666666666668, 9.375000000000002, 9.166666666666666, 9.416666666666668, 9.208333333333334, 9.25], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 7, 11, 2, 11, 11, 11, 11, 11, 11, 2, 5, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 2, 5, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 9, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 2, 11, 11, 11, 2, 11, 5, 8, 11, 11, 11, 11, 11, 11, 11, 2, 11, 7, 11, 11, 11, 7, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 5, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 9, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3965287963653588, "mean_inference_ms": 1.2041350451577773, "mean_action_processing_ms": 0.10687594800543121, "mean_env_wait_ms": 36.16101577004525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007521254675728934, "StateBufferConnector_ms": 0.005494453469101264, "ViewRequirementAgentConnector_ms": 0.11130498380077128}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.603621938535372, "num_env_steps_trained_throughput_per_sec": 24.603621938535372, "timesteps_total": 8000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 81030.597, "sample_time_ms": 77793.088, "load_time_ms": 8.715, "load_throughput": 229490.073, "learn_time_ms": 3225.958, "learn_throughput": 619.971, "synch_weights_time_ms": 2.377}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 843, "training_iteration": 4, "trial_id": "13850_00003", "date": "2023-12-28_17-52-53", "timestamp": 1703757173, "time_this_iter_s": 81.29645252227783, "time_total_s": 324.1541757583618, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 324.1541757583618, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 55.91120689655172, "ram_util_percent": 92.22931034482757}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.975199235810174, "policy_loss": -0.027171420657800302, "vf_loss": 1.9965108168125152, "vf_explained_var": 0.41503046804004246, "kl": 0.019532772426147656, "entropy": 1.3883869867854648, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2025.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 10000}, "sampler_results": {"episode_reward_max": 10.166666666666668, "episode_reward_min": 1.0416666666666667, "episode_reward_mean": 8.615764604810998, "episode_len_mean": 10.288659793814434, "episode_media": {}, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.208333333333332, 9.333333333333334, 9.0, 8.999999999999998, 9.166666666666666, 9.25, 9.250000000000002, 9.875, 9.0, 9.125000000000002, 9.0, 1.8750000000000002, 9.083333333333334, 9.458333333333334, 9.166666666666666, 9.208333333333334, 9.625, 9.41666666666667, 1.0833333333333335, 9.416666666666668, 4.791666666666667, 9.083333333333334, 9.333333333333334, 9.583333333333332, 9.041666666666668, 9.125000000000002, 9.25, 9.25, 9.458333333333334, 9.25, 8.875, 8.916666666666666, 9.5, 9.583333333333334, 1.0416666666666667, 9.750000000000002, 9.125, 9.333333333333334, 3.0833333333333335, 9.333333333333334, 9.458333333333334, 9.25, 9.291666666666666, 9.333333333333334, 9.041666666666668, 8.875, 9.208333333333334, 9.041666666666668, 9.375000000000002, 9.749999999999998, 9.041666666666668, 9.291666666666668, 9.125000000000002, 9.291666666666668, 8.916666666666668, 8.958333333333334, 9.666666666666668, 9.0, 9.583333333333334, 1.1666666666666665, 9.125, 9.291666666666666, 9.5, 9.375, 9.583333333333334, 9.25, 9.500000000000002, 9.375, 9.166666666666668, 9.291666666666666, 9.166666666666666, 9.291666666666666, 9.791666666666668, 1.0833333333333333, 8.958333333333334, 1.7500000000000002, 9.208333333333334, 9.083333333333332, 9.291666666666666, 4.958333333333333, 9.249999999999998, 9.291666666666668, 9.416666666666666, 9.0, 1.8333333333333335, 9.083333333333334, 9.083333333333334, 9.458333333333334, 9.416666666666666, 9.291666666666666, 9.249999999999998, 9.250000000000002, 9.75, 9.291666666666666, 9.625, 9.249999999999998, 9.041666666666668, 3.75, 9.166666666666666, 9.041666666666666, 9.166666666666668, 9.166666666666666, 3.791666666666667, 9.416666666666668, 9.166666666666668, 9.083333333333332, 9.208333333333334, 8.958333333333332, 9.458333333333332, 9.291666666666668, 4.750000000000001, 9.208333333333334, 9.083333333333334, 9.416666666666668, 9.291666666666666, 9.166666666666666, 9.458333333333334, 9.0, 9.041666666666668, 9.083333333333332, 9.25, 9.375, 4.625000000000001, 9.416666666666668, 9.333333333333336, 1.1666666666666665, 9.333333333333334, 7.166666666666667, 9.875000000000002, 9.208333333333334, 9.500000000000002, 9.541666666666668, 9.333333333333334, 9.125, 9.041666666666666, 1.0833333333333333, 9.125, 9.541666666666668, 9.375000000000002, 8.916666666666666, 9.0, 9.166666666666666, 9.291666666666666, 9.875, 8.875, 9.291666666666666, 9.333333333333332, 9.249999999999998, 9.5, 9.416666666666668, 9.041666666666666, 9.208333333333334, 9.583333333333332, 9.458333333333334, 9.291666666666668, 9.166666666666666, 9.291666666666668, 9.291666666666666, 8.916666666666668, 9.500000000000002, 9.041666666666666, 8.916666666666666, 9.041666666666666, 9.499999999999998, 9.208333333333334, 9.125, 9.416666666666668, 9.375, 9.041666666666666, 8.875, 1.0416666666666667, 3.7500000000000004, 9.000000000000002, 8.875, 9.083333333333332, 9.25, 10.166666666666668, 9.166666666666668, 9.083333333333332, 9.583333333333334, 9.041666666666666, 9.333333333333334, 9.250000000000002, 9.5, 9.333333333333336, 9.416666666666666, 9.0, 9.208333333333334, 9.124999999999998, 9.083333333333332, 9.708333333333332, 5.833333333333334, 9.208333333333334, 9.083333333333334], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 2, 11, 6, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 4, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 3, 11, 11, 11, 6, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 5, 11, 11, 11, 11, 5, 11, 11, 11, 11, 11, 11, 11, 6, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 6, 11, 11, 2, 11, 9, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 5, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 7, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3772923521322793, "mean_inference_ms": 1.2008207653203187, "mean_action_processing_ms": 0.10658166322955108, "mean_env_wait_ms": 36.081721169771455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007580850542206126, "StateBufferConnector_ms": 0.005423162401336985, "ViewRequirementAgentConnector_ms": 0.10963788966542666}}, "episode_reward_max": 10.166666666666668, "episode_reward_min": 1.0416666666666667, "episode_reward_mean": 8.615764604810998, "episode_len_mean": 10.288659793814434, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.208333333333332, 9.333333333333334, 9.0, 8.999999999999998, 9.166666666666666, 9.25, 9.250000000000002, 9.875, 9.0, 9.125000000000002, 9.0, 1.8750000000000002, 9.083333333333334, 9.458333333333334, 9.166666666666666, 9.208333333333334, 9.625, 9.41666666666667, 1.0833333333333335, 9.416666666666668, 4.791666666666667, 9.083333333333334, 9.333333333333334, 9.583333333333332, 9.041666666666668, 9.125000000000002, 9.25, 9.25, 9.458333333333334, 9.25, 8.875, 8.916666666666666, 9.5, 9.583333333333334, 1.0416666666666667, 9.750000000000002, 9.125, 9.333333333333334, 3.0833333333333335, 9.333333333333334, 9.458333333333334, 9.25, 9.291666666666666, 9.333333333333334, 9.041666666666668, 8.875, 9.208333333333334, 9.041666666666668, 9.375000000000002, 9.749999999999998, 9.041666666666668, 9.291666666666668, 9.125000000000002, 9.291666666666668, 8.916666666666668, 8.958333333333334, 9.666666666666668, 9.0, 9.583333333333334, 1.1666666666666665, 9.125, 9.291666666666666, 9.5, 9.375, 9.583333333333334, 9.25, 9.500000000000002, 9.375, 9.166666666666668, 9.291666666666666, 9.166666666666666, 9.291666666666666, 9.791666666666668, 1.0833333333333333, 8.958333333333334, 1.7500000000000002, 9.208333333333334, 9.083333333333332, 9.291666666666666, 4.958333333333333, 9.249999999999998, 9.291666666666668, 9.416666666666666, 9.0, 1.8333333333333335, 9.083333333333334, 9.083333333333334, 9.458333333333334, 9.416666666666666, 9.291666666666666, 9.249999999999998, 9.250000000000002, 9.75, 9.291666666666666, 9.625, 9.249999999999998, 9.041666666666668, 3.75, 9.166666666666666, 9.041666666666666, 9.166666666666668, 9.166666666666666, 3.791666666666667, 9.416666666666668, 9.166666666666668, 9.083333333333332, 9.208333333333334, 8.958333333333332, 9.458333333333332, 9.291666666666668, 4.750000000000001, 9.208333333333334, 9.083333333333334, 9.416666666666668, 9.291666666666666, 9.166666666666666, 9.458333333333334, 9.0, 9.041666666666668, 9.083333333333332, 9.25, 9.375, 4.625000000000001, 9.416666666666668, 9.333333333333336, 1.1666666666666665, 9.333333333333334, 7.166666666666667, 9.875000000000002, 9.208333333333334, 9.500000000000002, 9.541666666666668, 9.333333333333334, 9.125, 9.041666666666666, 1.0833333333333333, 9.125, 9.541666666666668, 9.375000000000002, 8.916666666666666, 9.0, 9.166666666666666, 9.291666666666666, 9.875, 8.875, 9.291666666666666, 9.333333333333332, 9.249999999999998, 9.5, 9.416666666666668, 9.041666666666666, 9.208333333333334, 9.583333333333332, 9.458333333333334, 9.291666666666668, 9.166666666666666, 9.291666666666668, 9.291666666666666, 8.916666666666668, 9.500000000000002, 9.041666666666666, 8.916666666666666, 9.041666666666666, 9.499999999999998, 9.208333333333334, 9.125, 9.416666666666668, 9.375, 9.041666666666666, 8.875, 1.0416666666666667, 3.7500000000000004, 9.000000000000002, 8.875, 9.083333333333332, 9.25, 10.166666666666668, 9.166666666666668, 9.083333333333332, 9.583333333333334, 9.041666666666666, 9.333333333333334, 9.250000000000002, 9.5, 9.333333333333336, 9.416666666666666, 9.0, 9.208333333333334, 9.124999999999998, 9.083333333333332, 9.708333333333332, 5.833333333333334, 9.208333333333334, 9.083333333333334], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 2, 11, 6, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 4, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 3, 11, 11, 11, 6, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 5, 11, 11, 11, 11, 5, 11, 11, 11, 11, 11, 11, 11, 6, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 6, 11, 11, 2, 11, 9, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 5, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 7, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3772923521322793, "mean_inference_ms": 1.2008207653203187, "mean_action_processing_ms": 0.10658166322955108, "mean_env_wait_ms": 36.081721169771455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007580850542206126, "StateBufferConnector_ms": 0.005423162401336985, "ViewRequirementAgentConnector_ms": 0.10963788966542666}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 10000, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.99897953563124, "num_env_steps_trained_throughput_per_sec": 24.99897953563124, "timesteps_total": 10000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 10000, "timers": {"training_iteration_time_ms": 80825.125, "sample_time_ms": 77586.617, "load_time_ms": 9.612, "load_throughput": 208070.403, "learn_time_ms": 3226.111, "learn_throughput": 619.942, "synch_weights_time_ms": 2.335}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 10000}, "done": false, "episodes_total": 1037, "training_iteration": 5, "trial_id": "13850_00003", "date": "2023-12-28_17-54-13", "timestamp": 1703757253, "time_this_iter_s": 80.0131163597107, "time_total_s": 404.1672921180725, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 404.1672921180725, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 55.92719298245615, "ram_util_percent": 92.01842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4329678155316248, "policy_loss": -0.0012726535172098213, "vf_loss": 1.429813035329183, "vf_explained_var": 0.6907663272486793, "kl": 0.014758094522260711, "entropy": 1.294072728951772, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2475.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 10.25, "episode_reward_min": 1.0, "episode_reward_mean": 9.062724014336917, "episode_len_mean": 10.78494623655914, "episode_media": {}, "episodes_this_iter": 186, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.125, 9.333333333333334, 9.166666666666668, 9.25, 9.708333333333334, 9.958333333333334, 9.791666666666666, 9.333333333333332, 9.625000000000002, 9.625, 2.875, 8.958333333333334, 8.999999999999998, 10.125000000000002, 9.208333333333336, 9.041666666666666, 9.166666666666666, 9.208333333333332, 9.041666666666666, 9.208333333333334, 9.125, 9.041666666666666, 1.0416666666666667, 9.083333333333334, 9.25, 9.041666666666668, 9.166666666666668, 9.833333333333334, 9.25, 9.541666666666666, 9.041666666666666, 9.125, 9.25, 9.166666666666668, 9.416666666666668, 9.041666666666668, 9.458333333333334, 9.041666666666666, 9.083333333333334, 9.208333333333332, 9.125, 8.958333333333332, 9.500000000000002, 9.041666666666666, 9.0, 9.916666666666666, 9.625000000000002, 8.958333333333332, 9.333333333333334, 9.0, 8.958333333333332, 9.083333333333332, 9.666666666666666, 1.0416666666666667, 9.041666666666666, 9.375, 9.791666666666668, 9.25, 9.166666666666666, 9.083333333333332, 9.541666666666668, 9.083333333333334, 9.375, 9.125, 9.791666666666668, 9.208333333333334, 9.083333333333334, 9.124999999999998, 9.083333333333332, 9.125, 8.916666666666666, 9.416666666666668, 9.083333333333332, 9.375000000000002, 9.0, 8.916666666666666, 9.250000000000002, 9.041666666666668, 9.333333333333334, 9.249999999999998, 9.458333333333334, 9.083333333333332, 9.291666666666668, 9.0, 9.208333333333332, 9.708333333333334, 9.083333333333334, 9.625, 9.125, 9.125, 8.999999999999998, 9.041666666666666, 9.041666666666666, 9.708333333333334, 9.5, 9.291666666666666, 9.041666666666668, 8.916666666666666, 8.999999999999998, 10.25, 9.375, 9.541666666666666, 9.374999999999998, 10.041666666666668, 9.041666666666666, 9.375, 9.041666666666668, 9.0, 9.166666666666666, 9.541666666666666, 8.916666666666668, 8.958333333333334, 9.541666666666666, 9.125, 9.0, 9.083333333333334, 9.166666666666666, 9.333333333333334, 9.208333333333334, 9.041666666666666, 10.083333333333336, 9.125, 9.0, 9.041666666666666, 9.458333333333334, 9.0, 8.833333333333334, 9.041666666666666, 9.083333333333334, 9.166666666666666, 1.0, 9.333333333333334, 9.000000000000002, 9.333333333333334, 9.416666666666668, 9.541666666666668, 9.083333333333334, 8.958333333333332, 10.208333333333334, 8.999999999999998, 9.166666666666668, 9.333333333333332, 9.041666666666668, 9.666666666666668, 9.333333333333334, 9.166666666666666, 9.0, 9.666666666666668, 9.041666666666666, 9.25, 9.166666666666666, 9.125, 10.166666666666666, 8.999999999999998, 9.083333333333332, 9.208333333333332, 9.0, 9.208333333333334, 9.166666666666666, 9.041666666666668, 9.166666666666668, 9.166666666666666, 9.625, 9.999999999999998, 9.625, 9.416666666666666, 9.291666666666666, 9.083333333333334, 9.083333333333332, 9.041666666666666, 9.291666666666668, 8.958333333333334, 9.458333333333336, 3.7500000000000004, 9.166666666666666, 9.166666666666666, 9.166666666666668, 9.125000000000002, 9.333333333333334, 9.041666666666668, 9.708333333333334, 9.083333333333334, 9.125, 9.833333333333334, 9.041666666666666, 9.0], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 4, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 5, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3593377376454998, "mean_inference_ms": 1.1991245648670412, "mean_action_processing_ms": 0.10650659161759914, "mean_env_wait_ms": 36.04701645880299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007601194484259492, "StateBufferConnector_ms": 0.00514881585233955, "ViewRequirementAgentConnector_ms": 0.10978021929340978}}, "episode_reward_max": 10.25, "episode_reward_min": 1.0, "episode_reward_mean": 9.062724014336917, "episode_len_mean": 10.78494623655914, "episodes_this_iter": 186, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.125, 9.333333333333334, 9.166666666666668, 9.25, 9.708333333333334, 9.958333333333334, 9.791666666666666, 9.333333333333332, 9.625000000000002, 9.625, 2.875, 8.958333333333334, 8.999999999999998, 10.125000000000002, 9.208333333333336, 9.041666666666666, 9.166666666666666, 9.208333333333332, 9.041666666666666, 9.208333333333334, 9.125, 9.041666666666666, 1.0416666666666667, 9.083333333333334, 9.25, 9.041666666666668, 9.166666666666668, 9.833333333333334, 9.25, 9.541666666666666, 9.041666666666666, 9.125, 9.25, 9.166666666666668, 9.416666666666668, 9.041666666666668, 9.458333333333334, 9.041666666666666, 9.083333333333334, 9.208333333333332, 9.125, 8.958333333333332, 9.500000000000002, 9.041666666666666, 9.0, 9.916666666666666, 9.625000000000002, 8.958333333333332, 9.333333333333334, 9.0, 8.958333333333332, 9.083333333333332, 9.666666666666666, 1.0416666666666667, 9.041666666666666, 9.375, 9.791666666666668, 9.25, 9.166666666666666, 9.083333333333332, 9.541666666666668, 9.083333333333334, 9.375, 9.125, 9.791666666666668, 9.208333333333334, 9.083333333333334, 9.124999999999998, 9.083333333333332, 9.125, 8.916666666666666, 9.416666666666668, 9.083333333333332, 9.375000000000002, 9.0, 8.916666666666666, 9.250000000000002, 9.041666666666668, 9.333333333333334, 9.249999999999998, 9.458333333333334, 9.083333333333332, 9.291666666666668, 9.0, 9.208333333333332, 9.708333333333334, 9.083333333333334, 9.625, 9.125, 9.125, 8.999999999999998, 9.041666666666666, 9.041666666666666, 9.708333333333334, 9.5, 9.291666666666666, 9.041666666666668, 8.916666666666666, 8.999999999999998, 10.25, 9.375, 9.541666666666666, 9.374999999999998, 10.041666666666668, 9.041666666666666, 9.375, 9.041666666666668, 9.0, 9.166666666666666, 9.541666666666666, 8.916666666666668, 8.958333333333334, 9.541666666666666, 9.125, 9.0, 9.083333333333334, 9.166666666666666, 9.333333333333334, 9.208333333333334, 9.041666666666666, 10.083333333333336, 9.125, 9.0, 9.041666666666666, 9.458333333333334, 9.0, 8.833333333333334, 9.041666666666666, 9.083333333333334, 9.166666666666666, 1.0, 9.333333333333334, 9.000000000000002, 9.333333333333334, 9.416666666666668, 9.541666666666668, 9.083333333333334, 8.958333333333332, 10.208333333333334, 8.999999999999998, 9.166666666666668, 9.333333333333332, 9.041666666666668, 9.666666666666668, 9.333333333333334, 9.166666666666666, 9.0, 9.666666666666668, 9.041666666666666, 9.25, 9.166666666666666, 9.125, 10.166666666666666, 8.999999999999998, 9.083333333333332, 9.208333333333332, 9.0, 9.208333333333334, 9.166666666666666, 9.041666666666668, 9.166666666666668, 9.166666666666666, 9.625, 9.999999999999998, 9.625, 9.416666666666666, 9.291666666666666, 9.083333333333334, 9.083333333333332, 9.041666666666666, 9.291666666666668, 8.958333333333334, 9.458333333333336, 3.7500000000000004, 9.166666666666666, 9.166666666666666, 9.166666666666668, 9.125000000000002, 9.333333333333334, 9.041666666666668, 9.708333333333334, 9.083333333333334, 9.125, 9.833333333333334, 9.041666666666666, 9.0], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 4, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 5, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3593377376454998, "mean_inference_ms": 1.1991245648670412, "mean_action_processing_ms": 0.10650659161759914, "mean_env_wait_ms": 36.04701645880299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007601194484259492, "StateBufferConnector_ms": 0.00514881585233955, "ViewRequirementAgentConnector_ms": 0.10978021929340978}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.96080763272359, "num_env_steps_trained_throughput_per_sec": 24.96080763272359, "timesteps_total": 12000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 80708.535, "sample_time_ms": 77476.45, "load_time_ms": 8.976, "load_throughput": 222828.667, "learn_time_ms": 3220.296, "learn_throughput": 621.061, "synch_weights_time_ms": 2.356}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 1223, "training_iteration": 6, "trial_id": "13850_00003", "date": "2023-12-28_17-55-33", "timestamp": 1703757333, "time_this_iter_s": 80.13308262825012, "time_total_s": 484.30037474632263, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 484.30037474632263, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 56.13333333333333, "ram_util_percent": 92.19210526315793}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5900161401430766, "policy_loss": 0.01773866142663691, "vf_loss": 1.5688158309459685, "vf_explained_var": 0.7741006924046411, "kl": 0.011538845905520494, "entropy": 1.2174920704629686, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2925.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000}, "sampler_results": {"episode_reward_max": 9.875, "episode_reward_min": 1.7916666666666667, "episode_reward_mean": 9.130036630036631, "episode_len_mean": 10.956043956043956, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.125, 9.291666666666666, 9.083333333333332, 9.125, 9.125, 9.833333333333334, 9.083333333333332, 8.958333333333334, 9.083333333333332, 9.041666666666666, 9.666666666666666, 9.416666666666666, 9.125, 9.416666666666666, 8.916666666666668, 9.249999999999998, 9.208333333333334, 9.083333333333332, 9.250000000000002, 8.999999999999998, 8.958333333333332, 9.083333333333334, 9.5, 9.041666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.041666666666666, 9.458333333333334, 9.208333333333334, 9.375, 9.041666666666666, 9.083333333333334, 9.291666666666666, 9.125, 9.0, 9.0, 9.208333333333334, 9.291666666666668, 9.083333333333334, 9.083333333333332, 9.375, 8.958333333333332, 9.041666666666666, 9.041666666666666, 8.958333333333334, 9.000000000000002, 9.125, 9.583333333333334, 9.333333333333332, 9.333333333333332, 9.416666666666666, 9.083333333333334, 9.0, 9.25, 9.041666666666668, 9.041666666666666, 9.041666666666666, 9.125, 9.333333333333334, 9.083333333333332, 9.291666666666666, 9.125000000000002, 8.833333333333332, 9.0, 9.291666666666666, 9.0, 9.375, 9.291666666666668, 9.125, 9.416666666666666, 8.875, 9.249999999999998, 9.375000000000002, 9.25, 9.291666666666666, 8.958333333333336, 9.166666666666666, 9.499999999999998, 9.291666666666666, 9.875, 9.541666666666668, 9.333333333333332, 8.958333333333332, 9.083333333333334, 9.208333333333334, 1.7916666666666667, 9.041666666666666, 9.0, 8.958333333333332, 9.083333333333334, 8.916666666666666, 8.875, 9.083333333333334, 9.249999999999998, 9.458333333333334, 9.125000000000002, 8.958333333333334, 9.208333333333334, 9.250000000000002, 9.166666666666666, 9.041666666666668, 9.208333333333334, 9.25, 9.000000000000002, 9.416666666666668, 9.041666666666666, 9.124999999999998, 9.083333333333332, 9.375, 9.208333333333334, 9.041666666666666, 9.625, 9.291666666666666, 9.083333333333334, 9.25, 8.916666666666666, 9.166666666666666, 9.041666666666668, 9.083333333333334, 8.875, 9.208333333333332, 9.083333333333334, 9.291666666666668, 9.75, 9.125, 9.0, 9.75, 9.208333333333332, 9.541666666666666, 8.916666666666668, 9.125, 9.333333333333332, 9.041666666666666, 9.0, 9.083333333333332, 9.291666666666666, 9.125, 9.374999999999998, 9.291666666666668, 9.125, 9.0, 9.083333333333334, 9.041666666666668, 9.041666666666666, 9.083333333333334, 9.083333333333334, 9.0, 9.166666666666666, 9.083333333333334, 8.958333333333334, 9.583333333333334, 9.083333333333334, 9.291666666666666, 9.208333333333334, 9.000000000000002, 9.208333333333334, 9.0, 9.208333333333332, 8.958333333333334, 9.333333333333334, 8.958333333333332, 9.833333333333334, 9.0, 9.250000000000002, 8.958333333333334, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.083333333333334, 8.916666666666666, 9.041666666666666, 9.416666666666666, 8.916666666666666, 9.041666666666668, 9.333333333333334, 9.333333333333332, 9.083333333333334, 9.291666666666666, 9.041666666666668, 9.083333333333334], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3421741300596095, "mean_inference_ms": 1.197097250567395, "mean_action_processing_ms": 0.10632329409092327, "mean_env_wait_ms": 35.99411843036058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075167352026635475, "StateBufferConnector_ms": 0.005274290566915994, "ViewRequirementAgentConnector_ms": 0.10967136739374517}}, "episode_reward_max": 9.875, "episode_reward_min": 1.7916666666666667, "episode_reward_mean": 9.130036630036631, "episode_len_mean": 10.956043956043956, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.125, 9.291666666666666, 9.083333333333332, 9.125, 9.125, 9.833333333333334, 9.083333333333332, 8.958333333333334, 9.083333333333332, 9.041666666666666, 9.666666666666666, 9.416666666666666, 9.125, 9.416666666666666, 8.916666666666668, 9.249999999999998, 9.208333333333334, 9.083333333333332, 9.250000000000002, 8.999999999999998, 8.958333333333332, 9.083333333333334, 9.5, 9.041666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.041666666666666, 9.458333333333334, 9.208333333333334, 9.375, 9.041666666666666, 9.083333333333334, 9.291666666666666, 9.125, 9.0, 9.0, 9.208333333333334, 9.291666666666668, 9.083333333333334, 9.083333333333332, 9.375, 8.958333333333332, 9.041666666666666, 9.041666666666666, 8.958333333333334, 9.000000000000002, 9.125, 9.583333333333334, 9.333333333333332, 9.333333333333332, 9.416666666666666, 9.083333333333334, 9.0, 9.25, 9.041666666666668, 9.041666666666666, 9.041666666666666, 9.125, 9.333333333333334, 9.083333333333332, 9.291666666666666, 9.125000000000002, 8.833333333333332, 9.0, 9.291666666666666, 9.0, 9.375, 9.291666666666668, 9.125, 9.416666666666666, 8.875, 9.249999999999998, 9.375000000000002, 9.25, 9.291666666666666, 8.958333333333336, 9.166666666666666, 9.499999999999998, 9.291666666666666, 9.875, 9.541666666666668, 9.333333333333332, 8.958333333333332, 9.083333333333334, 9.208333333333334, 1.7916666666666667, 9.041666666666666, 9.0, 8.958333333333332, 9.083333333333334, 8.916666666666666, 8.875, 9.083333333333334, 9.249999999999998, 9.458333333333334, 9.125000000000002, 8.958333333333334, 9.208333333333334, 9.250000000000002, 9.166666666666666, 9.041666666666668, 9.208333333333334, 9.25, 9.000000000000002, 9.416666666666668, 9.041666666666666, 9.124999999999998, 9.083333333333332, 9.375, 9.208333333333334, 9.041666666666666, 9.625, 9.291666666666666, 9.083333333333334, 9.25, 8.916666666666666, 9.166666666666666, 9.041666666666668, 9.083333333333334, 8.875, 9.208333333333332, 9.083333333333334, 9.291666666666668, 9.75, 9.125, 9.0, 9.75, 9.208333333333332, 9.541666666666666, 8.916666666666668, 9.125, 9.333333333333332, 9.041666666666666, 9.0, 9.083333333333332, 9.291666666666666, 9.125, 9.374999999999998, 9.291666666666668, 9.125, 9.0, 9.083333333333334, 9.041666666666668, 9.041666666666666, 9.083333333333334, 9.083333333333334, 9.0, 9.166666666666666, 9.083333333333334, 8.958333333333334, 9.583333333333334, 9.083333333333334, 9.291666666666666, 9.208333333333334, 9.000000000000002, 9.208333333333334, 9.0, 9.208333333333332, 8.958333333333334, 9.333333333333334, 8.958333333333332, 9.833333333333334, 9.0, 9.250000000000002, 8.958333333333334, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.083333333333334, 8.916666666666666, 9.041666666666666, 9.416666666666666, 8.916666666666666, 9.041666666666668, 9.333333333333334, 9.333333333333332, 9.083333333333334, 9.291666666666666, 9.041666666666668, 9.083333333333334], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3421741300596095, "mean_inference_ms": 1.197097250567395, "mean_action_processing_ms": 0.10632329409092327, "mean_env_wait_ms": 35.99411843036058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075167352026635475, "StateBufferConnector_ms": 0.005274290566915994, "ViewRequirementAgentConnector_ms": 0.10967136739374517}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000, "num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 25.097428137475756, "num_env_steps_trained_throughput_per_sec": 25.097428137475756, "timesteps_total": 14000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 14000, "timers": {"training_iteration_time_ms": 80562.947, "sample_time_ms": 77331.794, "load_time_ms": 10.509, "load_throughput": 190315.893, "learn_time_ms": 3217.872, "learn_throughput": 621.529, "synch_weights_time_ms": 2.315}, "counters": {"num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000}, "done": false, "episodes_total": 1405, "training_iteration": 7, "trial_id": "13850_00003", "date": "2023-12-28_17-56-53", "timestamp": 1703757413, "time_this_iter_s": 79.69696474075317, "time_total_s": 563.9973394870758, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 563.9973394870758, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 55.900884955752204, "ram_util_percent": 92.229203539823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5365663788053725, "policy_loss": -0.013615823114911715, "vf_loss": 1.5464759633276197, "vf_explained_var": 0.7327357795503404, "kl": 0.012354140311343428, "entropy": 1.1256848523351881, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3375.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 10.083333333333334, "episode_reward_min": 1.8333333333333335, "episode_reward_mean": 9.09403460837887, "episode_len_mean": 10.912568306010929, "episode_media": {}, "episodes_this_iter": 183, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.291666666666668, 9.125, 8.916666666666668, 9.333333333333334, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.041666666666666, 9.208333333333332, 9.916666666666668, 9.125, 9.041666666666666, 9.000000000000002, 9.5, 9.250000000000002, 9.208333333333332, 9.208333333333334, 8.958333333333334, 9.25, 9.125, 9.125, 9.25, 9.208333333333334, 1.916666666666667, 9.208333333333336, 9.125, 8.958333333333332, 9.083333333333334, 9.0, 9.374999999999998, 9.208333333333332, 9.166666666666668, 8.999999999999998, 8.999999999999998, 9.041666666666666, 9.124999999999998, 9.041666666666668, 9.208333333333332, 8.999999999999998, 9.958333333333336, 9.041666666666666, 9.541666666666668, 9.375, 9.083333333333332, 9.208333333333334, 9.041666666666664, 9.125, 9.083333333333334, 9.083333333333334, 9.75, 8.958333333333334, 9.166666666666666, 9.124999999999998, 9.208333333333332, 9.125, 9.125, 9.041666666666668, 9.124999999999998, 9.208333333333332, 8.999999999999998, 9.125, 9.041666666666668, 9.083333333333334, 9.083333333333334, 9.208333333333334, 9.208333333333334, 9.083333333333332, 8.958333333333336, 9.000000000000002, 9.291666666666668, 9.416666666666666, 9.166666666666664, 8.958333333333332, 9.249999999999998, 9.083333333333334, 9.083333333333332, 8.916666666666666, 9.041666666666666, 9.041666666666666, 9.083333333333334, 9.083333333333332, 9.708333333333334, 9.166666666666666, 9.25, 9.041666666666666, 9.041666666666664, 9.375, 9.041666666666668, 9.125, 8.916666666666666, 8.958333333333334, 9.083333333333334, 9.458333333333332, 9.083333333333332, 9.125, 9.083333333333332, 9.208333333333332, 9.166666666666666, 10.083333333333334, 9.041666666666666, 9.166666666666666, 9.875000000000002, 9.708333333333334, 9.083333333333334, 9.208333333333334, 9.083333333333332, 8.958333333333332, 9.375000000000002, 9.333333333333332, 9.166666666666664, 9.291666666666666, 9.0, 9.125, 9.25, 9.041666666666666, 9.25, 9.375, 9.041666666666666, 8.958333333333334, 9.25, 9.083333333333334, 9.249999999999998, 8.999999999999998, 8.916666666666666, 9.041666666666666, 9.125, 9.166666666666668, 9.624999999999998, 9.083333333333334, 8.916666666666666, 9.041666666666666, 9.25, 9.083333333333334, 9.0, 9.333333333333332, 9.416666666666668, 9.041666666666666, 9.208333333333332, 9.208333333333334, 9.541666666666668, 9.208333333333334, 9.124999999999998, 8.91666666666667, 9.708333333333334, 9.0, 9.125, 9.958333333333332, 9.000000000000002, 9.0, 9.0, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.083333333333332, 9.041666666666666, 9.5, 9.125, 9.041666666666668, 9.083333333333334, 9.0, 9.500000000000002, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 8.958333333333334, 8.958333333333334, 9.125, 9.166666666666668, 9.0, 9.083333333333332, 9.041666666666664, 1.8333333333333335, 9.125, 9.125, 9.666666666666668, 9.458333333333334, 9.291666666666666, 8.958333333333334, 9.083333333333332], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3339040756344789, "mean_inference_ms": 1.1991079833595302, "mean_action_processing_ms": 0.10646773043233716, "mean_env_wait_ms": 36.086724092197315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007823907612451438, "StateBufferConnector_ms": 0.005196482757401597, "ViewRequirementAgentConnector_ms": 0.11185414152718633}}, "episode_reward_max": 10.083333333333334, "episode_reward_min": 1.8333333333333335, "episode_reward_mean": 9.09403460837887, "episode_len_mean": 10.912568306010929, "episodes_this_iter": 183, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.291666666666668, 9.125, 8.916666666666668, 9.333333333333334, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.041666666666666, 9.208333333333332, 9.916666666666668, 9.125, 9.041666666666666, 9.000000000000002, 9.5, 9.250000000000002, 9.208333333333332, 9.208333333333334, 8.958333333333334, 9.25, 9.125, 9.125, 9.25, 9.208333333333334, 1.916666666666667, 9.208333333333336, 9.125, 8.958333333333332, 9.083333333333334, 9.0, 9.374999999999998, 9.208333333333332, 9.166666666666668, 8.999999999999998, 8.999999999999998, 9.041666666666666, 9.124999999999998, 9.041666666666668, 9.208333333333332, 8.999999999999998, 9.958333333333336, 9.041666666666666, 9.541666666666668, 9.375, 9.083333333333332, 9.208333333333334, 9.041666666666664, 9.125, 9.083333333333334, 9.083333333333334, 9.75, 8.958333333333334, 9.166666666666666, 9.124999999999998, 9.208333333333332, 9.125, 9.125, 9.041666666666668, 9.124999999999998, 9.208333333333332, 8.999999999999998, 9.125, 9.041666666666668, 9.083333333333334, 9.083333333333334, 9.208333333333334, 9.208333333333334, 9.083333333333332, 8.958333333333336, 9.000000000000002, 9.291666666666668, 9.416666666666666, 9.166666666666664, 8.958333333333332, 9.249999999999998, 9.083333333333334, 9.083333333333332, 8.916666666666666, 9.041666666666666, 9.041666666666666, 9.083333333333334, 9.083333333333332, 9.708333333333334, 9.166666666666666, 9.25, 9.041666666666666, 9.041666666666664, 9.375, 9.041666666666668, 9.125, 8.916666666666666, 8.958333333333334, 9.083333333333334, 9.458333333333332, 9.083333333333332, 9.125, 9.083333333333332, 9.208333333333332, 9.166666666666666, 10.083333333333334, 9.041666666666666, 9.166666666666666, 9.875000000000002, 9.708333333333334, 9.083333333333334, 9.208333333333334, 9.083333333333332, 8.958333333333332, 9.375000000000002, 9.333333333333332, 9.166666666666664, 9.291666666666666, 9.0, 9.125, 9.25, 9.041666666666666, 9.25, 9.375, 9.041666666666666, 8.958333333333334, 9.25, 9.083333333333334, 9.249999999999998, 8.999999999999998, 8.916666666666666, 9.041666666666666, 9.125, 9.166666666666668, 9.624999999999998, 9.083333333333334, 8.916666666666666, 9.041666666666666, 9.25, 9.083333333333334, 9.0, 9.333333333333332, 9.416666666666668, 9.041666666666666, 9.208333333333332, 9.208333333333334, 9.541666666666668, 9.208333333333334, 9.124999999999998, 8.91666666666667, 9.708333333333334, 9.0, 9.125, 9.958333333333332, 9.000000000000002, 9.0, 9.0, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.083333333333332, 9.041666666666666, 9.5, 9.125, 9.041666666666668, 9.083333333333334, 9.0, 9.500000000000002, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 8.958333333333334, 8.958333333333334, 9.125, 9.166666666666668, 9.0, 9.083333333333332, 9.041666666666664, 1.8333333333333335, 9.125, 9.125, 9.666666666666668, 9.458333333333334, 9.291666666666666, 8.958333333333334, 9.083333333333332], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3339040756344789, "mean_inference_ms": 1.1991079833595302, "mean_action_processing_ms": 0.10646773043233716, "mean_env_wait_ms": 36.086724092197315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007823907612451438, "StateBufferConnector_ms": 0.005196482757401597, "ViewRequirementAgentConnector_ms": 0.11185414152718633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.41898561250494, "num_env_steps_trained_throughput_per_sec": 24.41898561250494, "timesteps_total": 16000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 80730.511, "sample_time_ms": 77503.892, "load_time_ms": 10.545, "load_throughput": 189666.288, "learn_time_ms": 3213.304, "learn_throughput": 622.412, "synch_weights_time_ms": 2.317}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 1588, "training_iteration": 8, "trial_id": "13850_00003", "date": "2023-12-28_17-58-15", "timestamp": 1703757495, "time_this_iter_s": 81.91152739524841, "time_total_s": 645.9088668823242, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 645.9088668823242, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 55.998290598290595, "ram_util_percent": 92.30940170940173}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5431952030128904, "policy_loss": -0.009401940546101994, "vf_loss": 1.5504120592276256, "vf_explained_var": 0.7897252243094974, "kl": 0.00728359156901206, "entropy": 1.0352092225021785, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3825.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "sampler_results": {"episode_reward_max": 9.875000000000002, "episode_reward_min": 8.875, "episode_reward_mean": 9.133241758241759, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.291666666666666, 9.166666666666666, 8.958333333333332, 9.166666666666668, 9.208333333333332, 9.208333333333334, 9.083333333333334, 8.916666666666668, 9.041666666666666, 9.166666666666666, 9.125, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.208333333333334, 9.041666666666666, 9.166666666666666, 9.083333333333334, 9.250000000000002, 8.916666666666668, 9.125, 9.041666666666666, 9.125, 9.083333333333332, 9.083333333333332, 9.208333333333334, 9.041666666666668, 9.083333333333332, 9.083333333333334, 8.916666666666668, 9.208333333333336, 9.125000000000002, 9.125, 9.041666666666668, 9.041666666666666, 9.291666666666666, 9.125, 9.083333333333334, 9.25, 9.083333333333332, 9.0, 9.041666666666668, 9.208333333333334, 9.125, 9.25, 9.166666666666668, 9.041666666666668, 9.0, 9.208333333333334, 9.041666666666668, 9.166666666666666, 9.124999999999998, 9.875000000000002, 9.25, 9.000000000000002, 9.208333333333334, 9.291666666666668, 9.125, 9.041666666666668, 9.083333333333332, 9.25, 9.208333333333334, 8.999999999999998, 9.208333333333334, 9.083333333333334, 9.083333333333334, 9.25, 9.125, 9.166666666666666, 9.291666666666668, 9.083333333333332, 9.291666666666666, 9.041666666666668, 9.249999999999998, 9.375, 9.083333333333334, 9.249999999999998, 9.041666666666666, 9.25, 9.125, 9.75, 9.458333333333334, 9.124999999999998, 8.958333333333334, 9.125000000000002, 9.208333333333334, 8.958333333333332, 9.249999999999998, 9.083333333333332, 9.041666666666666, 8.999999999999998, 9.083333333333334, 9.124999999999998, 9.0, 9.041666666666666, 9.291666666666668, 9.083333333333332, 9.125, 9.125000000000002, 8.958333333333334, 9.291666666666666, 9.25, 9.041666666666668, 9.083333333333332, 9.0, 9.25, 9.208333333333334, 9.125, 9.333333333333334, 9.125, 9.000000000000002, 8.916666666666668, 9.0, 9.083333333333332, 8.916666666666666, 9.208333333333332, 9.041666666666668, 9.083333333333334, 9.125, 9.083333333333332, 9.125, 9.125, 9.083333333333332, 8.958333333333334, 9.166666666666666, 9.083333333333334, 9.166666666666668, 9.291666666666668, 9.083333333333332, 9.208333333333332, 9.208333333333332, 9.124999999999998, 9.041666666666666, 9.041666666666666, 9.166666666666668, 9.25, 9.041666666666668, 9.25, 9.208333333333332, 9.125000000000002, 9.125, 9.166666666666666, 9.083333333333334, 9.125000000000002, 9.125, 9.416666666666666, 9.166666666666666, 9.0, 9.125, 9.125, 9.125, 9.0, 9.125, 9.166666666666668, 8.875, 9.166666666666668, 9.083333333333332, 9.249999999999998, 9.041666666666666, 9.208333333333332, 9.708333333333334, 9.083333333333334, 9.083333333333334, 9.041666666666666, 8.958333333333332, 9.125000000000002, 9.125, 9.25, 9.25, 9.041666666666664, 8.958333333333334, 9.291666666666668, 9.124999999999998, 9.0, 9.083333333333332, 9.083333333333332, 9.125, 8.999999999999998, 8.958333333333334, 9.0, 9.249999999999998], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3273766382383871, "mean_inference_ms": 1.2007881737995076, "mean_action_processing_ms": 0.10671066473632458, "mean_env_wait_ms": 36.14918571479797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077472938286079155, "StateBufferConnector_ms": 0.00534476814689217, "ViewRequirementAgentConnector_ms": 0.1119921495626261}}, "episode_reward_max": 9.875000000000002, "episode_reward_min": 8.875, "episode_reward_mean": 9.133241758241759, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.291666666666666, 9.166666666666666, 8.958333333333332, 9.166666666666668, 9.208333333333332, 9.208333333333334, 9.083333333333334, 8.916666666666668, 9.041666666666666, 9.166666666666666, 9.125, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.208333333333334, 9.041666666666666, 9.166666666666666, 9.083333333333334, 9.250000000000002, 8.916666666666668, 9.125, 9.041666666666666, 9.125, 9.083333333333332, 9.083333333333332, 9.208333333333334, 9.041666666666668, 9.083333333333332, 9.083333333333334, 8.916666666666668, 9.208333333333336, 9.125000000000002, 9.125, 9.041666666666668, 9.041666666666666, 9.291666666666666, 9.125, 9.083333333333334, 9.25, 9.083333333333332, 9.0, 9.041666666666668, 9.208333333333334, 9.125, 9.25, 9.166666666666668, 9.041666666666668, 9.0, 9.208333333333334, 9.041666666666668, 9.166666666666666, 9.124999999999998, 9.875000000000002, 9.25, 9.000000000000002, 9.208333333333334, 9.291666666666668, 9.125, 9.041666666666668, 9.083333333333332, 9.25, 9.208333333333334, 8.999999999999998, 9.208333333333334, 9.083333333333334, 9.083333333333334, 9.25, 9.125, 9.166666666666666, 9.291666666666668, 9.083333333333332, 9.291666666666666, 9.041666666666668, 9.249999999999998, 9.375, 9.083333333333334, 9.249999999999998, 9.041666666666666, 9.25, 9.125, 9.75, 9.458333333333334, 9.124999999999998, 8.958333333333334, 9.125000000000002, 9.208333333333334, 8.958333333333332, 9.249999999999998, 9.083333333333332, 9.041666666666666, 8.999999999999998, 9.083333333333334, 9.124999999999998, 9.0, 9.041666666666666, 9.291666666666668, 9.083333333333332, 9.125, 9.125000000000002, 8.958333333333334, 9.291666666666666, 9.25, 9.041666666666668, 9.083333333333332, 9.0, 9.25, 9.208333333333334, 9.125, 9.333333333333334, 9.125, 9.000000000000002, 8.916666666666668, 9.0, 9.083333333333332, 8.916666666666666, 9.208333333333332, 9.041666666666668, 9.083333333333334, 9.125, 9.083333333333332, 9.125, 9.125, 9.083333333333332, 8.958333333333334, 9.166666666666666, 9.083333333333334, 9.166666666666668, 9.291666666666668, 9.083333333333332, 9.208333333333332, 9.208333333333332, 9.124999999999998, 9.041666666666666, 9.041666666666666, 9.166666666666668, 9.25, 9.041666666666668, 9.25, 9.208333333333332, 9.125000000000002, 9.125, 9.166666666666666, 9.083333333333334, 9.125000000000002, 9.125, 9.416666666666666, 9.166666666666666, 9.0, 9.125, 9.125, 9.125, 9.0, 9.125, 9.166666666666668, 8.875, 9.166666666666668, 9.083333333333332, 9.249999999999998, 9.041666666666666, 9.208333333333332, 9.708333333333334, 9.083333333333334, 9.083333333333334, 9.041666666666666, 8.958333333333332, 9.125000000000002, 9.125, 9.25, 9.25, 9.041666666666664, 8.958333333333334, 9.291666666666668, 9.124999999999998, 9.0, 9.083333333333332, 9.083333333333332, 9.125, 8.999999999999998, 8.958333333333334, 9.0, 9.249999999999998], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3273766382383871, "mean_inference_ms": 1.2007881737995076, "mean_action_processing_ms": 0.10671066473632458, "mean_env_wait_ms": 36.14918571479797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077472938286079155, "StateBufferConnector_ms": 0.00534476814689217, "ViewRequirementAgentConnector_ms": 0.1119921495626261}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.46605723222653, "num_env_steps_trained_throughput_per_sec": 24.46605723222653, "timesteps_total": 18000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 80843.33, "sample_time_ms": 77618.905, "load_time_ms": 10.492, "load_throughput": 190615.524, "learn_time_ms": 3211.185, "learn_throughput": 622.823, "synch_weights_time_ms": 2.299}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "done": false, "episodes_total": 1770, "training_iteration": 9, "trial_id": "13850_00003", "date": "2023-12-28_17-59-37", "timestamp": 1703757577, "time_this_iter_s": 81.7530267238617, "time_total_s": 727.6618936061859, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 727.6618936061859, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 55.80689655172414, "ram_util_percent": 92.69051724137934}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8351269812054105, "policy_loss": -0.012220666147768497, "vf_loss": 1.8449348256323073, "vf_explained_var": 0.7392096285025279, "kl": 0.008042728045850253, "entropy": 0.9070845275455051, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 4275.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 9.708333333333334, "episode_reward_min": 1.0833333333333333, "episode_reward_mean": 9.08219489981785, "episode_len_mean": 10.950819672131148, "episode_media": {}, "episodes_this_iter": 183, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.708333333333334, 9.208333333333334, 9.125, 9.083333333333334, 9.041666666666668, 9.125, 8.958333333333334, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.083333333333332, 9.166666666666668, 9.083333333333332, 9.249999999999998, 9.041666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666668, 9.166666666666666, 9.166666666666666, 9.125, 9.000000000000002, 9.125, 9.125, 9.125000000000002, 9.041666666666668, 9.083333333333332, 9.083333333333332, 9.250000000000002, 9.125, 9.125, 9.166666666666666, 9.291666666666668, 9.291666666666666, 9.208333333333334, 9.083333333333334, 9.083333333333334, 9.083333333333332, 9.291666666666668, 9.125, 9.125, 9.333333333333332, 9.041666666666668, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.083333333333334, 9.083333333333334, 9.208333333333334, 9.083333333333332, 9.083333333333334, 9.041666666666668, 9.166666666666666, 8.999999999999998, 9.166666666666666, 9.125, 9.0, 9.125, 9.083333333333332, 9.083333333333334, 9.125000000000002, 9.083333333333334, 9.083333333333334, 9.083333333333332, 9.0, 9.0, 9.041666666666664, 9.083333333333332, 9.208333333333332, 9.083333333333334, 9.25, 9.041666666666666, 9.125, 9.208333333333332, 9.083333333333332, 9.041666666666666, 9.041666666666668, 9.125, 9.083333333333334, 9.083333333333334, 9.125, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.166666666666666, 1.0833333333333333, 9.125, 9.125, 9.041666666666666, 9.000000000000002, 9.041666666666664, 9.166666666666666, 9.25, 9.125, 9.0, 9.083333333333332, 9.125, 9.166666666666666, 9.041666666666668, 9.083333333333334, 9.041666666666666, 9.124999999999998, 9.166666666666668, 8.999999999999998, 8.999999999999998, 9.041666666666666, 9.375, 9.125, 9.000000000000002, 9.083333333333332, 9.124999999999998, 9.166666666666666, 9.208333333333332, 9.166666666666668, 9.125, 9.083333333333332, 8.958333333333332, 9.083333333333332, 9.083333333333334, 9.124999999999998, 9.5, 9.125, 9.166666666666666, 9.208333333333332, 9.041666666666668, 9.166666666666668, 9.125, 8.958333333333332, 9.041666666666666, 9.166666666666666, 9.249999999999998, 9.125, 9.250000000000002, 9.125, 9.375, 9.166666666666666, 9.125, 9.041666666666666, 9.125, 9.166666666666666, 9.333333333333334, 9.041666666666668, 9.125, 9.208333333333334, 9.124999999999998, 9.249999999999998, 9.166666666666666, 9.375, 9.125, 9.083333333333332, 9.125, 9.374999999999998, 9.208333333333334, 9.0, 9.125, 9.125, 9.124999999999998, 9.083333333333332, 9.041666666666666, 9.0, 9.166666666666666, 8.958333333333334, 9.083333333333334, 9.166666666666668, 8.999999999999998, 9.083333333333334, 9.083333333333332, 9.124999999999998, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.208333333333334, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.321840164667487, "mean_inference_ms": 1.2021643490464946, "mean_action_processing_ms": 0.10684337456711146, "mean_env_wait_ms": 36.17665002503507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077521214719678535, "StateBufferConnector_ms": 0.005235698053745624, "ViewRequirementAgentConnector_ms": 0.11170522762778026}}, "episode_reward_max": 9.708333333333334, "episode_reward_min": 1.0833333333333333, "episode_reward_mean": 9.08219489981785, "episode_len_mean": 10.950819672131148, "episodes_this_iter": 183, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.708333333333334, 9.208333333333334, 9.125, 9.083333333333334, 9.041666666666668, 9.125, 8.958333333333334, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.083333333333332, 9.166666666666668, 9.083333333333332, 9.249999999999998, 9.041666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666668, 9.166666666666666, 9.166666666666666, 9.125, 9.000000000000002, 9.125, 9.125, 9.125000000000002, 9.041666666666668, 9.083333333333332, 9.083333333333332, 9.250000000000002, 9.125, 9.125, 9.166666666666666, 9.291666666666668, 9.291666666666666, 9.208333333333334, 9.083333333333334, 9.083333333333334, 9.083333333333332, 9.291666666666668, 9.125, 9.125, 9.333333333333332, 9.041666666666668, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.083333333333334, 9.083333333333334, 9.208333333333334, 9.083333333333332, 9.083333333333334, 9.041666666666668, 9.166666666666666, 8.999999999999998, 9.166666666666666, 9.125, 9.0, 9.125, 9.083333333333332, 9.083333333333334, 9.125000000000002, 9.083333333333334, 9.083333333333334, 9.083333333333332, 9.0, 9.0, 9.041666666666664, 9.083333333333332, 9.208333333333332, 9.083333333333334, 9.25, 9.041666666666666, 9.125, 9.208333333333332, 9.083333333333332, 9.041666666666666, 9.041666666666668, 9.125, 9.083333333333334, 9.083333333333334, 9.125, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.166666666666666, 1.0833333333333333, 9.125, 9.125, 9.041666666666666, 9.000000000000002, 9.041666666666664, 9.166666666666666, 9.25, 9.125, 9.0, 9.083333333333332, 9.125, 9.166666666666666, 9.041666666666668, 9.083333333333334, 9.041666666666666, 9.124999999999998, 9.166666666666668, 8.999999999999998, 8.999999999999998, 9.041666666666666, 9.375, 9.125, 9.000000000000002, 9.083333333333332, 9.124999999999998, 9.166666666666666, 9.208333333333332, 9.166666666666668, 9.125, 9.083333333333332, 8.958333333333332, 9.083333333333332, 9.083333333333334, 9.124999999999998, 9.5, 9.125, 9.166666666666666, 9.208333333333332, 9.041666666666668, 9.166666666666668, 9.125, 8.958333333333332, 9.041666666666666, 9.166666666666666, 9.249999999999998, 9.125, 9.250000000000002, 9.125, 9.375, 9.166666666666666, 9.125, 9.041666666666666, 9.125, 9.166666666666666, 9.333333333333334, 9.041666666666668, 9.125, 9.208333333333334, 9.124999999999998, 9.249999999999998, 9.166666666666666, 9.375, 9.125, 9.083333333333332, 9.125, 9.374999999999998, 9.208333333333334, 9.0, 9.125, 9.125, 9.124999999999998, 9.083333333333332, 9.041666666666666, 9.0, 9.166666666666666, 8.958333333333334, 9.083333333333334, 9.166666666666668, 8.999999999999998, 9.083333333333334, 9.083333333333332, 9.124999999999998, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.208333333333334, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.321840164667487, "mean_inference_ms": 1.2021643490464946, "mean_action_processing_ms": 0.10684337456711146, "mean_env_wait_ms": 36.17665002503507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077521214719678535, "StateBufferConnector_ms": 0.005235698053745624, "ViewRequirementAgentConnector_ms": 0.11170522762778026}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.6049520992906, "num_env_steps_trained_throughput_per_sec": 24.6049520992906, "timesteps_total": 20000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 80887.439, "sample_time_ms": 77665.18, "load_time_ms": 9.973, "load_throughput": 200547.185, "learn_time_ms": 3209.559, "learn_throughput": 623.139, "synch_weights_time_ms": 2.282}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 1953, "training_iteration": 10, "trial_id": "13850_00003", "date": "2023-12-28_18-00-58", "timestamp": 1703757658, "time_this_iter_s": 81.29178237915039, "time_total_s": 808.9536759853363, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 808.9536759853363, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 56.03706896551725, "ram_util_percent": 92.75862068965516}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7442657497194078, "policy_loss": 0.008201785973376698, "vf_loss": 1.7347581566704644, "vf_explained_var": 0.7793254248301188, "kl": 0.004352679711813871, "entropy": 0.9306803482108646, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 22000, "num_env_steps_trained": 22000, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 22000}, "sampler_results": {"episode_reward_max": 9.666666666666668, "episode_reward_min": 8.916666666666666, "episode_reward_mean": 9.130952380952381, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.083333333333332, 9.041666666666666, 9.208333333333332, 9.166666666666666, 9.083333333333334, 9.0, 9.166666666666666, 9.125, 9.083333333333334, 9.083333333333334, 9.083333333333334, 9.125, 9.083333333333334, 9.083333333333334, 9.249999999999998, 9.125, 8.958333333333332, 9.166666666666666, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.291666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.083333333333334, 9.083333333333334, 9.083333333333334, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.125, 9.166666666666668, 9.041666666666668, 9.208333333333334, 9.083333333333334, 9.125, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.666666666666668, 9.166666666666666, 9.625000000000002, 9.541666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.125, 8.999999999999998, 9.208333333333334, 9.041666666666668, 9.041666666666664, 9.25, 9.208333333333334, 9.125, 9.125, 9.083333333333334, 9.041666666666664, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.083333333333334, 9.083333333333332, 9.124999999999998, 9.083333333333332, 9.25, 9.125, 9.083333333333332, 9.041666666666666, 9.666666666666666, 9.041666666666666, 9.166666666666666, 9.124999999999998, 9.041666666666666, 9.124999999999998, 9.166666666666666, 8.999999999999998, 9.250000000000002, 9.083333333333332, 9.125, 9.083333333333332, 9.041666666666668, 9.083333333333334, 9.125, 9.083333333333332, 9.125, 9.208333333333332, 9.125, 9.125, 9.125, 9.375000000000002, 9.125, 9.083333333333332, 9.166666666666668, 9.125, 9.083333333333334, 9.083333333333332, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.083333333333332, 9.0, 9.166666666666666, 9.125, 9.083333333333334, 9.124999999999998, 9.083333333333332, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.083333333333334, 9.125, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 8.999999999999998, 9.0, 9.083333333333332, 9.208333333333334, 9.083333333333332, 9.166666666666664, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.249999999999998, 9.125, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.041666666666666, 8.916666666666666, 9.000000000000002, 9.166666666666666, 9.041666666666668, 9.083333333333332, 9.166666666666666, 9.208333333333332, 9.041666666666668, 9.041666666666668, 8.999999999999998, 9.041666666666666, 9.416666666666668, 9.166666666666666, 9.0, 9.083333333333332, 9.083333333333332, 9.083333333333334, 9.083333333333334, 9.083333333333334, 9.208333333333334, 9.125, 9.249999999999998, 9.083333333333334, 9.125, 9.125, 9.333333333333334, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.041666666666668, 9.083333333333334, 9.125, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3144098841641731, "mean_inference_ms": 1.2006254435875139, "mean_action_processing_ms": 0.1066798139965473, "mean_env_wait_ms": 36.14328165584453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007544769035590874, "StateBufferConnector_ms": 0.005071896773118239, "ViewRequirementAgentConnector_ms": 0.10963652160141495}}, "episode_reward_max": 9.666666666666668, "episode_reward_min": 8.916666666666666, "episode_reward_mean": 9.130952380952381, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.083333333333332, 9.041666666666666, 9.208333333333332, 9.166666666666666, 9.083333333333334, 9.0, 9.166666666666666, 9.125, 9.083333333333334, 9.083333333333334, 9.083333333333334, 9.125, 9.083333333333334, 9.083333333333334, 9.249999999999998, 9.125, 8.958333333333332, 9.166666666666666, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.291666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.083333333333334, 9.083333333333334, 9.083333333333334, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.125, 9.166666666666668, 9.041666666666668, 9.208333333333334, 9.083333333333334, 9.125, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.666666666666668, 9.166666666666666, 9.625000000000002, 9.541666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.125, 8.999999999999998, 9.208333333333334, 9.041666666666668, 9.041666666666664, 9.25, 9.208333333333334, 9.125, 9.125, 9.083333333333334, 9.041666666666664, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.083333333333334, 9.083333333333332, 9.124999999999998, 9.083333333333332, 9.25, 9.125, 9.083333333333332, 9.041666666666666, 9.666666666666666, 9.041666666666666, 9.166666666666666, 9.124999999999998, 9.041666666666666, 9.124999999999998, 9.166666666666666, 8.999999999999998, 9.250000000000002, 9.083333333333332, 9.125, 9.083333333333332, 9.041666666666668, 9.083333333333334, 9.125, 9.083333333333332, 9.125, 9.208333333333332, 9.125, 9.125, 9.125, 9.375000000000002, 9.125, 9.083333333333332, 9.166666666666668, 9.125, 9.083333333333334, 9.083333333333332, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.083333333333332, 9.0, 9.166666666666666, 9.125, 9.083333333333334, 9.124999999999998, 9.083333333333332, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.083333333333334, 9.125, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 8.999999999999998, 9.0, 9.083333333333332, 9.208333333333334, 9.083333333333332, 9.166666666666664, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.249999999999998, 9.125, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.041666666666666, 8.916666666666666, 9.000000000000002, 9.166666666666666, 9.041666666666668, 9.083333333333332, 9.166666666666666, 9.208333333333332, 9.041666666666668, 9.041666666666668, 8.999999999999998, 9.041666666666666, 9.416666666666668, 9.166666666666666, 9.0, 9.083333333333332, 9.083333333333332, 9.083333333333334, 9.083333333333334, 9.083333333333334, 9.208333333333334, 9.125, 9.249999999999998, 9.083333333333334, 9.125, 9.125, 9.333333333333334, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.041666666666668, 9.083333333333334, 9.125, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3144098841641731, "mean_inference_ms": 1.2006254435875139, "mean_action_processing_ms": 0.1066798139965473, "mean_env_wait_ms": 36.14328165584453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007544769035590874, "StateBufferConnector_ms": 0.005071896773118239, "ViewRequirementAgentConnector_ms": 0.10963652160141495}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 22000, "num_env_steps_sampled": 22000, "num_env_steps_trained": 22000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 25.00918770601905, "num_env_steps_trained_throughput_per_sec": 25.00918770601905, "timesteps_total": 22000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 22000, "timers": {"training_iteration_time_ms": 80653.809, "sample_time_ms": 77442.609, "load_time_ms": 10.035, "load_throughput": 199300.266, "learn_time_ms": 3198.535, "learn_throughput": 625.286, "synch_weights_time_ms": 2.206}, "counters": {"num_env_steps_sampled": 22000, "num_env_steps_trained": 22000, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 22000}, "done": false, "episodes_total": 2135, "training_iteration": 11, "trial_id": "13850_00003", "date": "2023-12-28_18-02-18", "timestamp": 1703757738, "time_this_iter_s": 79.97785258293152, "time_total_s": 888.9315285682678, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 888.9315285682678, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 55.850877192982466, "ram_util_percent": 92.90789473684211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0258638699849447, "policy_loss": 0.006674279562301106, "vf_loss": 2.0182603821489544, "vf_explained_var": 0.7508425630463494, "kl": 0.006194700379088292, "entropy": 0.9331636895073785, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 5175.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 9.375, "episode_reward_min": 8.916666666666666, "episode_reward_mean": 9.10805860805861, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.083333333333334, 9.041666666666668, 9.041666666666668, 9.166666666666666, 9.041666666666666, 9.0, 9.124999999999998, 9.041666666666666, 9.208333333333332, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666668, 9.125, 9.083333333333334, 9.083333333333334, 9.083333333333334, 9.166666666666666, 8.958333333333334, 9.125, 9.124999999999998, 9.333333333333334, 9.083333333333332, 9.208333333333332, 9.124999999999998, 9.125, 9.041666666666666, 9.000000000000002, 9.166666666666666, 9.041666666666668, 9.124999999999998, 9.083333333333334, 9.083333333333332, 9.0, 9.125, 9.041666666666668, 9.041666666666664, 9.166666666666666, 9.166666666666666, 9.291666666666666, 9.083333333333332, 9.125, 9.083333333333332, 9.083333333333332, 9.125, 9.041666666666664, 9.083333333333334, 9.083333333333332, 9.041666666666668, 9.125, 9.041666666666668, 9.124999999999998, 9.041666666666666, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.041666666666668, 9.166666666666668, 9.125, 9.083333333333334, 9.041666666666668, 9.124999999999998, 9.041666666666666, 9.125, 9.125, 9.083333333333334, 9.041666666666666, 9.208333333333332, 9.125, 9.125, 9.166666666666664, 9.083333333333334, 9.125, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.125000000000002, 9.083333333333334, 9.125, 9.124999999999998, 9.041666666666664, 9.125, 9.083333333333334, 9.208333333333334, 9.041666666666666, 9.208333333333334, 9.0, 9.208333333333334, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.125, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.083333333333334, 8.999999999999998, 9.041666666666668, 9.25, 9.083333333333332, 9.041666666666666, 9.125, 9.041666666666666, 9.166666666666666, 9.083333333333332, 9.25, 9.125, 9.125000000000002, 9.041666666666668, 9.249999999999998, 9.375, 9.083333333333332, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.041666666666666, 9.083333333333334, 9.041666666666668, 9.125, 9.208333333333334, 9.083333333333332, 9.166666666666666, 9.25, 9.166666666666666, 8.958333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.124999999999998, 8.958333333333332, 9.083333333333334, 9.041666666666666, 9.291666666666668, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.0, 9.166666666666666, 9.125, 9.125, 8.916666666666666, 9.041666666666666, 9.041666666666666, 9.083333333333334, 9.291666666666668, 9.041666666666664, 8.958333333333334, 9.041666666666666, 9.25, 9.083333333333332, 9.083333333333332, 9.041666666666666, 9.0, 9.083333333333332, 9.125, 9.041666666666668, 9.083333333333334, 9.083333333333334, 9.083333333333332, 9.083333333333332, 9.124999999999998], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3084074570871302, "mean_inference_ms": 1.199789819287874, "mean_action_processing_ms": 0.10655904868201288, "mean_env_wait_ms": 36.1243129536478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007568348895062457, "StateBufferConnector_ms": 0.005115126515482809, "ViewRequirementAgentConnector_ms": 0.10984481036008059}}, "episode_reward_max": 9.375, "episode_reward_min": 8.916666666666666, "episode_reward_mean": 9.10805860805861, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.083333333333334, 9.041666666666668, 9.041666666666668, 9.166666666666666, 9.041666666666666, 9.0, 9.124999999999998, 9.041666666666666, 9.208333333333332, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666668, 9.125, 9.083333333333334, 9.083333333333334, 9.083333333333334, 9.166666666666666, 8.958333333333334, 9.125, 9.124999999999998, 9.333333333333334, 9.083333333333332, 9.208333333333332, 9.124999999999998, 9.125, 9.041666666666666, 9.000000000000002, 9.166666666666666, 9.041666666666668, 9.124999999999998, 9.083333333333334, 9.083333333333332, 9.0, 9.125, 9.041666666666668, 9.041666666666664, 9.166666666666666, 9.166666666666666, 9.291666666666666, 9.083333333333332, 9.125, 9.083333333333332, 9.083333333333332, 9.125, 9.041666666666664, 9.083333333333334, 9.083333333333332, 9.041666666666668, 9.125, 9.041666666666668, 9.124999999999998, 9.041666666666666, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.041666666666668, 9.166666666666668, 9.125, 9.083333333333334, 9.041666666666668, 9.124999999999998, 9.041666666666666, 9.125, 9.125, 9.083333333333334, 9.041666666666666, 9.208333333333332, 9.125, 9.125, 9.166666666666664, 9.083333333333334, 9.125, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.125000000000002, 9.083333333333334, 9.125, 9.124999999999998, 9.041666666666664, 9.125, 9.083333333333334, 9.208333333333334, 9.041666666666666, 9.208333333333334, 9.0, 9.208333333333334, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.125, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.083333333333334, 8.999999999999998, 9.041666666666668, 9.25, 9.083333333333332, 9.041666666666666, 9.125, 9.041666666666666, 9.166666666666666, 9.083333333333332, 9.25, 9.125, 9.125000000000002, 9.041666666666668, 9.249999999999998, 9.375, 9.083333333333332, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.041666666666666, 9.083333333333334, 9.041666666666668, 9.125, 9.208333333333334, 9.083333333333332, 9.166666666666666, 9.25, 9.166666666666666, 8.958333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.124999999999998, 8.958333333333332, 9.083333333333334, 9.041666666666666, 9.291666666666668, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.0, 9.166666666666666, 9.125, 9.125, 8.916666666666666, 9.041666666666666, 9.041666666666666, 9.083333333333334, 9.291666666666668, 9.041666666666664, 8.958333333333334, 9.041666666666666, 9.25, 9.083333333333332, 9.083333333333332, 9.041666666666666, 9.0, 9.083333333333332, 9.125, 9.041666666666668, 9.083333333333334, 9.083333333333334, 9.083333333333332, 9.083333333333332, 9.124999999999998], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3084074570871302, "mean_inference_ms": 1.199789819287874, "mean_action_processing_ms": 0.10655904868201288, "mean_env_wait_ms": 36.1243129536478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007568348895062457, "StateBufferConnector_ms": 0.005115126515482809, "ViewRequirementAgentConnector_ms": 0.10984481036008059}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.955627243738892, "num_env_steps_trained_throughput_per_sec": 24.955627243738892, "timesteps_total": 24000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 80669.871, "sample_time_ms": 77461.705, "load_time_ms": 10.03, "load_throughput": 199395.961, "learn_time_ms": 3195.478, "learn_throughput": 625.884, "synch_weights_time_ms": 2.219}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 2317, "training_iteration": 12, "trial_id": "13850_00003", "date": "2023-12-28_18-03-38", "timestamp": 1703757818, "time_this_iter_s": 80.15001368522644, "time_total_s": 969.0815422534943, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 969.0815422534943, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 55.97017543859649, "ram_util_percent": 92.75438596491232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7185711699061923, "policy_loss": -0.022766046159797243, "vf_loss": 1.7407695293426513, "vf_explained_var": 0.7496572219000922, "kl": 0.0037845872099021953, "entropy": 0.8942252816094293, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 5625.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 26000, "num_env_steps_trained": 26000, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 26000}, "sampler_results": {"episode_reward_max": 9.708333333333334, "episode_reward_min": 8.916666666666666, "episode_reward_mean": 9.112799263351748, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.125, 9.166666666666666, 9.083333333333332, 9.125, 9.333333333333334, 9.000000000000002, 9.250000000000002, 9.083333333333332, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.041666666666668, 9.083333333333332, 9.041666666666668, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.208333333333334, 9.125, 9.166666666666666, 9.125, 9.125, 9.0, 9.041666666666666, 9.0, 9.208333333333334, 9.083333333333332, 9.083333333333332, 9.25, 9.333333333333334, 9.25, 9.041666666666666, 9.208333333333334, 9.166666666666666, 9.208333333333332, 9.125, 9.125, 9.083333333333332, 9.708333333333334, 9.083333333333334, 9.125, 9.083333333333334, 9.458333333333332, 9.166666666666666, 9.0, 9.041666666666666, 9.208333333333334, 9.083333333333332, 9.083333333333334, 9.291666666666668, 9.125, 9.166666666666668, 9.041666666666668, 9.166666666666666, 9.083333333333332, 9.125, 9.125, 9.041666666666666, 9.125, 9.125, 9.083333333333334, 8.958333333333334, 9.208333333333332, 9.25, 9.166666666666666, 9.0, 9.125, 9.208333333333334, 9.166666666666666, 9.125, 9.041666666666666, 9.166666666666664, 9.166666666666666, 9.083333333333332, 9.125, 9.083333333333334, 9.166666666666668, 9.125, 9.125, 9.291666666666668, 8.999999999999998, 9.208333333333334, 9.041666666666666, 9.083333333333332, 9.166666666666668, 9.291666666666668, 9.125, 9.0, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666668, 9.083333333333334, 9.000000000000002, 9.166666666666666, 8.999999999999998, 9.166666666666666, 9.0, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.125, 9.125, 9.125, 9.041666666666666, 9.125, 9.208333333333334, 9.125, 9.000000000000002, 9.041666666666666, 9.083333333333332, 9.125, 9.083333333333332, 9.0, 9.083333333333334, 9.041666666666666, 9.0, 9.041666666666668, 9.166666666666666, 9.125, 9.125, 9.125, 9.083333333333334, 9.125, 9.333333333333332, 9.083333333333332, 9.125, 9.041666666666668, 9.166666666666666, 8.916666666666666, 9.125, 9.041666666666666, 9.083333333333332, 9.083333333333332, 9.083333333333334, 9.0, 9.083333333333334, 9.208333333333332, 9.041666666666666, 9.125, 9.166666666666664, 8.999999999999998, 9.125, 9.208333333333334, 8.958333333333334, 9.041666666666666, 9.0, 9.083333333333332, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.083333333333334, 8.958333333333334, 9.041666666666666, 9.041666666666668, 9.041666666666668, 9.083333333333334, 9.083333333333332, 9.208333333333332, 9.0, 9.083333333333334, 9.041666666666666, 9.041666666666668, 9.125, 9.041666666666664, 9.083333333333332, 9.166666666666666, 9.125, 9.083333333333334, 9.0, 9.041666666666668, 9.041666666666666, 9.041666666666668, 9.041666666666666, 9.124999999999998, 9.041666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3038642516223649, "mean_inference_ms": 1.1993059905316892, "mean_action_processing_ms": 0.10651594161767235, "mean_env_wait_ms": 36.1286147796788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007530470579368634, "StateBufferConnector_ms": 0.0050704123565505224, "ViewRequirementAgentConnector_ms": 0.11041625428594937}}, "episode_reward_max": 9.708333333333334, "episode_reward_min": 8.916666666666666, "episode_reward_mean": 9.112799263351748, "episode_len_mean": 11.0, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.125, 9.166666666666666, 9.083333333333332, 9.125, 9.333333333333334, 9.000000000000002, 9.250000000000002, 9.083333333333332, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.041666666666668, 9.083333333333332, 9.041666666666668, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.208333333333334, 9.125, 9.166666666666666, 9.125, 9.125, 9.0, 9.041666666666666, 9.0, 9.208333333333334, 9.083333333333332, 9.083333333333332, 9.25, 9.333333333333334, 9.25, 9.041666666666666, 9.208333333333334, 9.166666666666666, 9.208333333333332, 9.125, 9.125, 9.083333333333332, 9.708333333333334, 9.083333333333334, 9.125, 9.083333333333334, 9.458333333333332, 9.166666666666666, 9.0, 9.041666666666666, 9.208333333333334, 9.083333333333332, 9.083333333333334, 9.291666666666668, 9.125, 9.166666666666668, 9.041666666666668, 9.166666666666666, 9.083333333333332, 9.125, 9.125, 9.041666666666666, 9.125, 9.125, 9.083333333333334, 8.958333333333334, 9.208333333333332, 9.25, 9.166666666666666, 9.0, 9.125, 9.208333333333334, 9.166666666666666, 9.125, 9.041666666666666, 9.166666666666664, 9.166666666666666, 9.083333333333332, 9.125, 9.083333333333334, 9.166666666666668, 9.125, 9.125, 9.291666666666668, 8.999999999999998, 9.208333333333334, 9.041666666666666, 9.083333333333332, 9.166666666666668, 9.291666666666668, 9.125, 9.0, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666668, 9.083333333333334, 9.000000000000002, 9.166666666666666, 8.999999999999998, 9.166666666666666, 9.0, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.125, 9.125, 9.125, 9.041666666666666, 9.125, 9.208333333333334, 9.125, 9.000000000000002, 9.041666666666666, 9.083333333333332, 9.125, 9.083333333333332, 9.0, 9.083333333333334, 9.041666666666666, 9.0, 9.041666666666668, 9.166666666666666, 9.125, 9.125, 9.125, 9.083333333333334, 9.125, 9.333333333333332, 9.083333333333332, 9.125, 9.041666666666668, 9.166666666666666, 8.916666666666666, 9.125, 9.041666666666666, 9.083333333333332, 9.083333333333332, 9.083333333333334, 9.0, 9.083333333333334, 9.208333333333332, 9.041666666666666, 9.125, 9.166666666666664, 8.999999999999998, 9.125, 9.208333333333334, 8.958333333333334, 9.041666666666666, 9.0, 9.083333333333332, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.083333333333334, 8.958333333333334, 9.041666666666666, 9.041666666666668, 9.041666666666668, 9.083333333333334, 9.083333333333332, 9.208333333333332, 9.0, 9.083333333333334, 9.041666666666666, 9.041666666666668, 9.125, 9.041666666666664, 9.083333333333332, 9.166666666666666, 9.125, 9.083333333333334, 9.0, 9.041666666666668, 9.041666666666666, 9.041666666666668, 9.041666666666666, 9.124999999999998, 9.041666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3038642516223649, "mean_inference_ms": 1.1993059905316892, "mean_action_processing_ms": 0.10651594161767235, "mean_env_wait_ms": 36.1286147796788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007530470579368634, "StateBufferConnector_ms": 0.0050704123565505224, "ViewRequirementAgentConnector_ms": 0.11041625428594937}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 26000, "num_env_steps_sampled": 26000, "num_env_steps_trained": 26000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.76662374480176, "num_env_steps_trained_throughput_per_sec": 24.76662374480176, "timesteps_total": 26000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 26000, "timers": {"training_iteration_time_ms": 80690.743, "sample_time_ms": 77476.547, "load_time_ms": 9.567, "load_throughput": 209045.731, "learn_time_ms": 3201.851, "learn_throughput": 624.639, "synch_weights_time_ms": 2.333}, "counters": {"num_env_steps_sampled": 26000, "num_env_steps_trained": 26000, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 26000}, "done": false, "episodes_total": 2498, "training_iteration": 13, "trial_id": "13850_00003", "date": "2023-12-28_18-04-59", "timestamp": 1703757899, "time_this_iter_s": 80.76519179344177, "time_total_s": 1049.846734046936, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1049.846734046936, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 56.10521739130434, "ram_util_percent": 92.66434782608698}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2414031516181097, "policy_loss": -0.003098871074616909, "vf_loss": 2.2435006602605183, "vf_explained_var": 0.6906171409289042, "kl": 0.013351600232940113, "entropy": 0.7569191148546007, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6075.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 9.625, "episode_reward_min": 1.8333333333333335, "episode_reward_mean": 9.069899817850636, "episode_len_mean": 10.956284153005464, "episode_media": {}, "episodes_this_iter": 183, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.083333333333334, 9.041666666666666, 9.166666666666666, 8.958333333333334, 8.999999999999998, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.083333333333334, 9.041666666666666, 9.083333333333334, 9.125, 9.083333333333334, 9.041666666666668, 9.125, 9.041666666666666, 9.125, 9.125, 9.0, 9.125, 9.125, 9.083333333333334, 9.125, 9.0, 9.125, 9.083333333333334, 1.8333333333333335, 9.083333333333334, 9.125, 9.125, 9.083333333333334, 9.125, 9.125, 9.083333333333334, 9.083333333333334, 9.166666666666668, 9.0, 9.083333333333334, 9.083333333333332, 9.083333333333332, 9.208333333333332, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.041666666666668, 9.25, 9.000000000000002, 9.041666666666668, 9.041666666666668, 9.125, 9.083333333333334, 9.125, 9.125, 9.083333333333332, 9.166666666666666, 9.125, 9.125, 9.083333333333332, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.333333333333334, 9.124999999999998, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.0, 9.124999999999998, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.208333333333332, 9.041666666666668, 9.166666666666666, 9.083333333333334, 9.125, 9.125, 9.041666666666664, 9.083333333333334, 9.083333333333332, 9.125, 9.083333333333334, 9.125, 9.083333333333332, 9.125, 9.083333333333334, 9.125, 9.041666666666666, 9.0, 9.041666666666666, 9.041666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.124999999999998, 9.25, 9.041666666666666, 9.041666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.625, 9.083333333333334, 9.041666666666668, 9.125, 9.083333333333332, 9.083333333333334, 9.083333333333332, 8.999999999999998, 9.083333333333334, 9.083333333333334, 9.125, 9.083333333333334, 9.041666666666666, 8.958333333333332, 9.083333333333332, 9.125, 9.166666666666666, 9.041666666666668, 9.208333333333334, 9.083333333333334, 9.083333333333334, 8.999999999999998, 9.125000000000002, 9.083333333333334, 9.083333333333334, 9.208333333333334, 9.125, 9.250000000000002, 9.125, 9.166666666666666, 9.291666666666668, 9.125, 9.041666666666668, 9.208333333333332, 9.000000000000002, 9.166666666666666, 9.0, 9.166666666666666, 9.083333333333332, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.0, 9.125, 9.083333333333332, 8.958333333333332, 9.083333333333332, 9.124999999999998, 9.166666666666668, 9.125, 8.999999999999998, 9.25, 9.208333333333332, 9.125, 9.166666666666666, 9.083333333333334, 9.125, 9.208333333333332, 9.083333333333334, 9.083333333333334, 9.124999999999998, 9.291666666666666, 9.249999999999998, 9.166666666666666, 8.999999999999998, 9.083333333333334], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3013876981766903, "mean_inference_ms": 1.1994245073539112, "mean_action_processing_ms": 0.10653223456163446, "mean_env_wait_ms": 36.154059068521704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007637341817220052, "StateBufferConnector_ms": 0.005123914916658662, "ViewRequirementAgentConnector_ms": 0.11094854177673007}}, "episode_reward_max": 9.625, "episode_reward_min": 1.8333333333333335, "episode_reward_mean": 9.069899817850636, "episode_len_mean": 10.956284153005464, "episodes_this_iter": 183, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.083333333333334, 9.041666666666666, 9.166666666666666, 8.958333333333334, 8.999999999999998, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.083333333333334, 9.041666666666666, 9.083333333333334, 9.125, 9.083333333333334, 9.041666666666668, 9.125, 9.041666666666666, 9.125, 9.125, 9.0, 9.125, 9.125, 9.083333333333334, 9.125, 9.0, 9.125, 9.083333333333334, 1.8333333333333335, 9.083333333333334, 9.125, 9.125, 9.083333333333334, 9.125, 9.125, 9.083333333333334, 9.083333333333334, 9.166666666666668, 9.0, 9.083333333333334, 9.083333333333332, 9.083333333333332, 9.208333333333332, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.041666666666668, 9.25, 9.000000000000002, 9.041666666666668, 9.041666666666668, 9.125, 9.083333333333334, 9.125, 9.125, 9.083333333333332, 9.166666666666666, 9.125, 9.125, 9.083333333333332, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.333333333333334, 9.124999999999998, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.0, 9.124999999999998, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.208333333333332, 9.041666666666668, 9.166666666666666, 9.083333333333334, 9.125, 9.125, 9.041666666666664, 9.083333333333334, 9.083333333333332, 9.125, 9.083333333333334, 9.125, 9.083333333333332, 9.125, 9.083333333333334, 9.125, 9.041666666666666, 9.0, 9.041666666666666, 9.041666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.124999999999998, 9.25, 9.041666666666666, 9.041666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.625, 9.083333333333334, 9.041666666666668, 9.125, 9.083333333333332, 9.083333333333334, 9.083333333333332, 8.999999999999998, 9.083333333333334, 9.083333333333334, 9.125, 9.083333333333334, 9.041666666666666, 8.958333333333332, 9.083333333333332, 9.125, 9.166666666666666, 9.041666666666668, 9.208333333333334, 9.083333333333334, 9.083333333333334, 8.999999999999998, 9.125000000000002, 9.083333333333334, 9.083333333333334, 9.208333333333334, 9.125, 9.250000000000002, 9.125, 9.166666666666666, 9.291666666666668, 9.125, 9.041666666666668, 9.208333333333332, 9.000000000000002, 9.166666666666666, 9.0, 9.166666666666666, 9.083333333333332, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.0, 9.125, 9.083333333333332, 8.958333333333332, 9.083333333333332, 9.124999999999998, 9.166666666666668, 9.125, 8.999999999999998, 9.25, 9.208333333333332, 9.125, 9.166666666666666, 9.083333333333334, 9.125, 9.208333333333332, 9.083333333333334, 9.083333333333334, 9.124999999999998, 9.291666666666666, 9.249999999999998, 9.166666666666666, 8.999999999999998, 9.083333333333334], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3013876981766903, "mean_inference_ms": 1.1994245073539112, "mean_action_processing_ms": 0.10653223456163446, "mean_env_wait_ms": 36.154059068521704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007637341817220052, "StateBufferConnector_ms": 0.005123914916658662, "ViewRequirementAgentConnector_ms": 0.11094854177673007}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.579459318865347, "num_env_steps_trained_throughput_per_sec": 24.579459318865347, "timesteps_total": 28000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 80698.734, "sample_time_ms": 77482.97, "load_time_ms": 9.852, "load_throughput": 203012.735, "learn_time_ms": 3203.128, "learn_throughput": 624.39, "synch_weights_time_ms": 2.339}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 2681, "training_iteration": 14, "trial_id": "13850_00003", "date": "2023-12-28_18-06-20", "timestamp": 1703757980, "time_this_iter_s": 81.37670731544495, "time_total_s": 1131.223441362381, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1131.223441362381, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 56.03103448275861, "ram_util_percent": 92.59568965517242}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4581079241964554, "policy_loss": -0.01877354312274191, "vf_loss": 2.476515179740058, "vf_explained_var": 0.7003064249621497, "kl": 0.004883931435654262, "entropy": 0.7231743570168813, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6525.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000}, "sampler_results": {"episode_reward_max": 9.291666666666668, "episode_reward_min": 8.916666666666668, "episode_reward_mean": 9.116300366300367, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.124999999999998, 9.25, 9.125, 9.166666666666668, 9.124999999999998, 9.124999999999998, 9.125000000000002, 9.166666666666666, 9.041666666666668, 9.208333333333334, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.125, 9.125, 9.083333333333334, 9.125, 9.083333333333334, 9.125, 9.166666666666666, 9.208333333333334, 9.041666666666668, 9.083333333333334, 8.916666666666668, 9.166666666666666, 9.125, 9.249999999999998, 9.041666666666668, 9.125, 9.124999999999998, 9.124999999999998, 9.083333333333334, 9.125, 9.125, 9.041666666666668, 9.166666666666666, 9.083333333333334, 9.041666666666668, 9.166666666666666, 9.125, 9.125, 9.125, 9.083333333333334, 9.083333333333334, 9.083333333333334, 9.083333333333334, 9.083333333333332, 9.0, 9.125, 9.125, 9.166666666666666, 9.208333333333334, 9.125, 9.124999999999998, 9.0, 8.999999999999998, 9.125, 9.041666666666666, 9.041666666666666, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.125, 9.125, 9.125, 9.083333333333334, 9.125, 9.125, 9.125, 9.125, 9.125, 9.125, 9.041666666666668, 9.249999999999998, 9.125, 9.083333333333332, 9.0, 8.999999999999998, 9.125, 9.125, 9.041666666666664, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.125, 9.125, 9.083333333333334, 9.125, 9.166666666666666, 9.125, 9.124999999999998, 9.124999999999998, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.041666666666668, 9.125, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.124999999999998, 9.041666666666666, 9.124999999999998, 9.041666666666668, 9.041666666666668, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.000000000000002, 9.125, 9.291666666666668, 9.041666666666666, 9.083333333333334, 9.125, 9.125, 9.083333333333332, 9.125, 9.083333333333334, 9.166666666666666, 9.125000000000002, 9.125, 9.125, 9.125, 9.083333333333332, 9.125, 9.124999999999998, 9.25, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.083333333333334, 9.166666666666666, 9.208333333333334, 9.083333333333334, 9.125, 9.166666666666666, 9.125, 9.125, 9.041666666666668, 9.041666666666668, 9.083333333333334, 9.083333333333334, 9.166666666666666, 9.041666666666668, 9.083333333333332, 9.166666666666668, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.041666666666666, 9.208333333333334, 9.125, 9.125, 9.125, 9.125, 9.208333333333332, 9.125, 9.208333333333334, 9.166666666666666, 9.041666666666666, 9.041666666666666, 9.083333333333334, 9.083333333333332, 9.125, 9.083333333333334, 9.125, 9.083333333333332, 9.208333333333334, 9.125, 9.208333333333332, 9.083333333333332], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.298993179223636, "mean_inference_ms": 1.1996974476512001, "mean_action_processing_ms": 0.1065662465792156, "mean_env_wait_ms": 36.18394695541502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007642232454740084, "StateBufferConnector_ms": 0.005130977421016484, "ViewRequirementAgentConnector_ms": 0.11079717468429398}}, "episode_reward_max": 9.291666666666668, "episode_reward_min": 8.916666666666668, "episode_reward_mean": 9.116300366300367, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.124999999999998, 9.25, 9.125, 9.166666666666668, 9.124999999999998, 9.124999999999998, 9.125000000000002, 9.166666666666666, 9.041666666666668, 9.208333333333334, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.125, 9.125, 9.083333333333334, 9.125, 9.083333333333334, 9.125, 9.166666666666666, 9.208333333333334, 9.041666666666668, 9.083333333333334, 8.916666666666668, 9.166666666666666, 9.125, 9.249999999999998, 9.041666666666668, 9.125, 9.124999999999998, 9.124999999999998, 9.083333333333334, 9.125, 9.125, 9.041666666666668, 9.166666666666666, 9.083333333333334, 9.041666666666668, 9.166666666666666, 9.125, 9.125, 9.125, 9.083333333333334, 9.083333333333334, 9.083333333333334, 9.083333333333334, 9.083333333333332, 9.0, 9.125, 9.125, 9.166666666666666, 9.208333333333334, 9.125, 9.124999999999998, 9.0, 8.999999999999998, 9.125, 9.041666666666666, 9.041666666666666, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.125, 9.125, 9.125, 9.083333333333334, 9.125, 9.125, 9.125, 9.125, 9.125, 9.125, 9.041666666666668, 9.249999999999998, 9.125, 9.083333333333332, 9.0, 8.999999999999998, 9.125, 9.125, 9.041666666666664, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.125, 9.125, 9.083333333333334, 9.125, 9.166666666666666, 9.125, 9.124999999999998, 9.124999999999998, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.041666666666668, 9.125, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.124999999999998, 9.041666666666666, 9.124999999999998, 9.041666666666668, 9.041666666666668, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.000000000000002, 9.125, 9.291666666666668, 9.041666666666666, 9.083333333333334, 9.125, 9.125, 9.083333333333332, 9.125, 9.083333333333334, 9.166666666666666, 9.125000000000002, 9.125, 9.125, 9.125, 9.083333333333332, 9.125, 9.124999999999998, 9.25, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.083333333333334, 9.166666666666666, 9.208333333333334, 9.083333333333334, 9.125, 9.166666666666666, 9.125, 9.125, 9.041666666666668, 9.041666666666668, 9.083333333333334, 9.083333333333334, 9.166666666666666, 9.041666666666668, 9.083333333333332, 9.166666666666668, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.041666666666666, 9.208333333333334, 9.125, 9.125, 9.125, 9.125, 9.208333333333332, 9.125, 9.208333333333334, 9.166666666666666, 9.041666666666666, 9.041666666666666, 9.083333333333334, 9.083333333333332, 9.125, 9.083333333333334, 9.125, 9.083333333333332, 9.208333333333334, 9.125, 9.208333333333332, 9.083333333333332], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.298993179223636, "mean_inference_ms": 1.1996974476512001, "mean_action_processing_ms": 0.1065662465792156, "mean_env_wait_ms": 36.18394695541502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007642232454740084, "StateBufferConnector_ms": 0.005130977421016484, "ViewRequirementAgentConnector_ms": 0.11079717468429398}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000, "num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.514081332697412, "num_env_steps_trained_throughput_per_sec": 24.514081332697412, "timesteps_total": 30000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 30000, "timers": {"training_iteration_time_ms": 80856.984, "sample_time_ms": 77647.021, "load_time_ms": 9.497, "load_throughput": 210602.891, "learn_time_ms": 3197.686, "learn_throughput": 625.452, "synch_weights_time_ms": 2.334}, "counters": {"num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000}, "done": false, "episodes_total": 2863, "training_iteration": 15, "trial_id": "13850_00003", "date": "2023-12-28_18-07-42", "timestamp": 1703758062, "time_this_iter_s": 81.59301424026489, "time_total_s": 1212.8164556026459, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1212.8164556026459, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 56.133620689655174, "ram_util_percent": 92.67155172413794}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0165433258480494, "policy_loss": -0.017696467190980912, "vf_loss": 3.034023830095927, "vf_explained_var": 0.6385243169466654, "kl": 0.0057588635929599445, "entropy": 0.636984617975023, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 9.500000000000002, "episode_reward_min": 1.0833333333333333, "episode_reward_mean": 9.07967032967033, "episode_len_mean": 10.95054945054945, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.083333333333334, 9.083333333333334, 9.083333333333332, 9.041666666666668, 9.166666666666666, 9.25, 9.458333333333336, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.125, 9.124999999999998, 1.0833333333333333, 9.208333333333334, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666668, 9.125000000000002, 9.125, 9.125, 9.166666666666666, 9.333333333333334, 9.125, 9.041666666666664, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.125, 9.0, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.125, 9.291666666666668, 9.125, 9.208333333333334, 9.041666666666666, 9.291666666666666, 9.083333333333334, 9.083333333333332, 9.083333333333334, 9.125, 9.25, 9.166666666666666, 9.083333333333332, 9.125, 9.291666666666668, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.041666666666668, 9.125, 9.083333333333332, 9.125000000000002, 8.999999999999998, 9.166666666666666, 9.208333333333334, 9.25, 9.041666666666666, 9.125, 9.083333333333334, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.125, 9.125, 9.041666666666668, 9.083333333333334, 9.083333333333336, 9.125, 9.083333333333334, 9.083333333333334, 8.958333333333334, 9.083333333333334, 9.083333333333332, 9.500000000000002, 9.041666666666668, 9.125, 9.124999999999998, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.041666666666668, 9.124999999999998, 9.166666666666666, 9.125, 9.125, 9.208333333333332, 9.083333333333334, 9.041666666666668, 9.125, 9.166666666666668, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.125, 9.208333333333334, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.0, 9.0, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.041666666666668, 9.125, 9.125, 9.041666666666666, 9.166666666666666, 9.0, 9.041666666666668, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.124999999999998, 9.166666666666666, 9.291666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.125, 9.208333333333334, 9.125, 9.125, 9.041666666666668, 9.125, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 8.416666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.125, 9.125, 9.124999999999998, 9.125, 9.083333333333334, 9.166666666666666, 9.041666666666666, 9.166666666666668, 9.083333333333332], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.294974882019106, "mean_inference_ms": 1.1985552750141601, "mean_action_processing_ms": 0.1064686360819176, "mean_env_wait_ms": 36.153705197346774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007474946451711131, "StateBufferConnector_ms": 0.00516857419695173, "ViewRequirementAgentConnector_ms": 0.10918496729253413}}, "episode_reward_max": 9.500000000000002, "episode_reward_min": 1.0833333333333333, "episode_reward_mean": 9.07967032967033, "episode_len_mean": 10.95054945054945, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.083333333333334, 9.083333333333334, 9.083333333333332, 9.041666666666668, 9.166666666666666, 9.25, 9.458333333333336, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.125, 9.124999999999998, 1.0833333333333333, 9.208333333333334, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666668, 9.125000000000002, 9.125, 9.125, 9.166666666666666, 9.333333333333334, 9.125, 9.041666666666664, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.125, 9.0, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.125, 9.291666666666668, 9.125, 9.208333333333334, 9.041666666666666, 9.291666666666666, 9.083333333333334, 9.083333333333332, 9.083333333333334, 9.125, 9.25, 9.166666666666666, 9.083333333333332, 9.125, 9.291666666666668, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.041666666666668, 9.125, 9.083333333333332, 9.125000000000002, 8.999999999999998, 9.166666666666666, 9.208333333333334, 9.25, 9.041666666666666, 9.125, 9.083333333333334, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.125, 9.125, 9.041666666666668, 9.083333333333334, 9.083333333333336, 9.125, 9.083333333333334, 9.083333333333334, 8.958333333333334, 9.083333333333334, 9.083333333333332, 9.500000000000002, 9.041666666666668, 9.125, 9.124999999999998, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.041666666666668, 9.124999999999998, 9.166666666666666, 9.125, 9.125, 9.208333333333332, 9.083333333333334, 9.041666666666668, 9.125, 9.166666666666668, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.125, 9.208333333333334, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.0, 9.0, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.041666666666668, 9.125, 9.125, 9.041666666666666, 9.166666666666666, 9.0, 9.041666666666668, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.124999999999998, 9.166666666666666, 9.291666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.125, 9.208333333333334, 9.125, 9.125, 9.041666666666668, 9.125, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 8.416666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.125, 9.125, 9.124999999999998, 9.125, 9.083333333333334, 9.166666666666666, 9.041666666666666, 9.166666666666668, 9.083333333333332], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 2, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.294974882019106, "mean_inference_ms": 1.1985552750141601, "mean_action_processing_ms": 0.1064686360819176, "mean_env_wait_ms": 36.153705197346774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007474946451711131, "StateBufferConnector_ms": 0.00516857419695173, "ViewRequirementAgentConnector_ms": 0.10918496729253413}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 25.099110138566818, "num_env_steps_trained_throughput_per_sec": 25.099110138566818, "timesteps_total": 32000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 80812.833, "sample_time_ms": 77603.06, "load_time_ms": 9.549, "load_throughput": 209437.695, "learn_time_ms": 3197.48, "learn_throughput": 625.493, "synch_weights_time_ms": 2.306}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 3045, "training_iteration": 16, "trial_id": "13850_00003", "date": "2023-12-28_18-09-02", "timestamp": 1703758142, "time_this_iter_s": 79.69121837615967, "time_total_s": 1292.5076739788055, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1292.5076739788055, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 55.931858407079645, "ram_util_percent": 92.70530973451329}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9211955414878, "policy_loss": 0.007761001073651843, "vf_loss": 2.913247276677026, "vf_explained_var": 0.6728382929166158, "kl": 0.0049937444067909, "entropy": 0.6352860442797343, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 7425.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 34000, "num_env_steps_trained": 34000, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 34000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.0, "episode_reward_mean": 9.138278388278387, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.083333333333334, 9.25, 9.166666666666666, 9.041666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666666, 9.125, 9.041666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666668, 9.083333333333334, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666668, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666668, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.208333333333334, 9.125, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.041666666666668, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.0, 9.125, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.125, 9.125, 9.166666666666666, 9.083333333333334, 9.0, 9.166666666666666, 9.25, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.25, 9.083333333333332, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.208333333333334, 9.125, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.083333333333332, 9.125, 9.125, 9.125, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.208333333333332, 9.25, 9.166666666666664, 9.083333333333332, 9.083333333333334, 9.166666666666668, 9.166666666666666, 9.125, 9.166666666666666, 9.041666666666668, 9.125, 9.125, 9.125, 9.041666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.083333333333332, 9.124999999999998, 9.166666666666666, 9.208333333333332, 9.125, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666668, 9.25, 9.166666666666666, 9.125, 9.124999999999998, 9.083333333333332, 9.125, 9.0, 9.125, 9.124999999999998, 9.083333333333332, 9.041666666666668, 9.166666666666666, 9.124999999999998, 9.125, 9.125, 9.166666666666666, 9.249999999999998, 9.125, 9.166666666666666, 9.166666666666668, 9.208333333333332, 9.083333333333334, 9.208333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.125, 9.125, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.293855745481542, "mean_inference_ms": 1.1999540050458684, "mean_action_processing_ms": 0.10656501990143526, "mean_env_wait_ms": 36.19553422174755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007570706881009615, "StateBufferConnector_ms": 0.0051556052742423595, "ViewRequirementAgentConnector_ms": 0.11235947137350565}}, "episode_reward_max": 9.25, "episode_reward_min": 9.0, "episode_reward_mean": 9.138278388278387, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.083333333333334, 9.25, 9.166666666666666, 9.041666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666666, 9.125, 9.041666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666668, 9.083333333333334, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666668, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666668, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.208333333333334, 9.125, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.041666666666668, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.0, 9.125, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.125, 9.125, 9.166666666666666, 9.083333333333334, 9.0, 9.166666666666666, 9.25, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.25, 9.083333333333332, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.208333333333334, 9.125, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.083333333333332, 9.125, 9.125, 9.125, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.208333333333332, 9.25, 9.166666666666664, 9.083333333333332, 9.083333333333334, 9.166666666666668, 9.166666666666666, 9.125, 9.166666666666666, 9.041666666666668, 9.125, 9.125, 9.125, 9.041666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.083333333333332, 9.124999999999998, 9.166666666666666, 9.208333333333332, 9.125, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666668, 9.25, 9.166666666666666, 9.125, 9.124999999999998, 9.083333333333332, 9.125, 9.0, 9.125, 9.124999999999998, 9.083333333333332, 9.041666666666668, 9.166666666666666, 9.124999999999998, 9.125, 9.125, 9.166666666666666, 9.249999999999998, 9.125, 9.166666666666666, 9.166666666666668, 9.208333333333332, 9.083333333333334, 9.208333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.125, 9.125, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.293855745481542, "mean_inference_ms": 1.1999540050458684, "mean_action_processing_ms": 0.10656501990143526, "mean_env_wait_ms": 36.19553422174755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007570706881009615, "StateBufferConnector_ms": 0.0051556052742423595, "ViewRequirementAgentConnector_ms": 0.11235947137350565}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 34000, "num_env_steps_sampled": 34000, "num_env_steps_trained": 34000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.332051014834768, "num_env_steps_trained_throughput_per_sec": 24.332051014834768, "timesteps_total": 34000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 34000, "timers": {"training_iteration_time_ms": 81063.501, "sample_time_ms": 77855.418, "load_time_ms": 9.465, "load_throughput": 211308.466, "learn_time_ms": 3195.876, "learn_throughput": 625.807, "synch_weights_time_ms": 2.305}, "counters": {"num_env_steps_sampled": 34000, "num_env_steps_trained": 34000, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 34000}, "done": false, "episodes_total": 3227, "training_iteration": 17, "trial_id": "13850_00003", "date": "2023-12-28_18-10-24", "timestamp": 1703758224, "time_this_iter_s": 82.2035596370697, "time_total_s": 1374.7112336158752, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1374.7112336158752, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 56.0991452991453, "ram_util_percent": 92.6880341880342}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7491926278008356, "policy_loss": 0.002867935159140163, "vf_loss": 2.7462082685364617, "vf_explained_var": 0.6408584149678548, "kl": 0.006209247945820326, "entropy": 0.6449664171536763, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 7875.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 9.333333333333332, "episode_reward_min": 1.625, "episode_reward_mean": 9.100409836065573, "episode_len_mean": 10.956284153005464, "episode_media": {}, "episodes_this_iter": 183, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.083333333333334, 9.125, 9.125, 9.125, 9.083333333333334, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.208333333333334, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.125, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.208333333333334, 9.125, 9.166666666666666, 9.041666666666668, 9.083333333333334, 9.125, 9.083333333333334, 9.083333333333334, 9.083333333333334, 9.166666666666668, 9.083333333333334, 9.125, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.25, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.125, 9.208333333333334, 9.125, 9.166666666666666, 9.124999999999998, 9.125, 9.124999999999998, 9.125, 9.166666666666668, 9.124999999999998, 9.166666666666666, 9.125, 9.0, 9.125, 9.125, 9.041666666666666, 9.125, 9.166666666666666, 9.125, 9.083333333333332, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.25, 9.166666666666666, 1.625, 9.166666666666666, 9.124999999999998, 9.333333333333332, 9.208333333333334, 9.208333333333334, 9.166666666666666, 9.124999999999998, 9.125, 9.125, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.083333333333332, 9.124999999999998, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.208333333333334, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.125, 9.166666666666666, 9.25, 9.208333333333332, 9.083333333333334, 9.125, 9.125, 9.125, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.125, 9.041666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666668, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666666, 9.125, 9.125, 9.083333333333334, 9.083333333333334, 9.166666666666668, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.208333333333334, 9.041666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.083333333333334, 9.083333333333334, 9.25, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.125, 9.083333333333334, 9.125, 9.25, 9.041666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2923213880011308, "mean_inference_ms": 1.200334134590215, "mean_action_processing_ms": 0.10658056185459487, "mean_env_wait_ms": 36.20276625681373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00748504055002348, "StateBufferConnector_ms": 0.005107238644459208, "ViewRequirementAgentConnector_ms": 0.11084796301002711}}, "episode_reward_max": 9.333333333333332, "episode_reward_min": 1.625, "episode_reward_mean": 9.100409836065573, "episode_len_mean": 10.956284153005464, "episodes_this_iter": 183, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.083333333333334, 9.125, 9.125, 9.125, 9.083333333333334, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.208333333333334, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.125, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.208333333333334, 9.125, 9.166666666666666, 9.041666666666668, 9.083333333333334, 9.125, 9.083333333333334, 9.083333333333334, 9.083333333333334, 9.166666666666668, 9.083333333333334, 9.125, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.25, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.125, 9.208333333333334, 9.125, 9.166666666666666, 9.124999999999998, 9.125, 9.124999999999998, 9.125, 9.166666666666668, 9.124999999999998, 9.166666666666666, 9.125, 9.0, 9.125, 9.125, 9.041666666666666, 9.125, 9.166666666666666, 9.125, 9.083333333333332, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.25, 9.166666666666666, 1.625, 9.166666666666666, 9.124999999999998, 9.333333333333332, 9.208333333333334, 9.208333333333334, 9.166666666666666, 9.124999999999998, 9.125, 9.125, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.083333333333332, 9.124999999999998, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.208333333333334, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.125, 9.166666666666666, 9.25, 9.208333333333332, 9.083333333333334, 9.125, 9.125, 9.125, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.125, 9.041666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666668, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666666, 9.125, 9.125, 9.083333333333334, 9.083333333333334, 9.166666666666668, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.208333333333334, 9.041666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.083333333333334, 9.083333333333334, 9.25, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.125, 9.083333333333334, 9.125, 9.25, 9.041666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2923213880011308, "mean_inference_ms": 1.200334134590215, "mean_action_processing_ms": 0.10658056185459487, "mean_env_wait_ms": 36.20276625681373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00748504055002348, "StateBufferConnector_ms": 0.005107238644459208, "ViewRequirementAgentConnector_ms": 0.11084796301002711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.671129417558323, "num_env_steps_trained_throughput_per_sec": 24.671129417558323, "timesteps_total": 36000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 80979.794, "sample_time_ms": 77770.377, "load_time_ms": 8.915, "load_throughput": 224332.72, "learn_time_ms": 3197.78, "learn_throughput": 625.434, "synch_weights_time_ms": 2.272}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 3410, "training_iteration": 18, "trial_id": "13850_00003", "date": "2023-12-28_18-11-45", "timestamp": 1703758305, "time_this_iter_s": 81.07396531105042, "time_total_s": 1455.7851989269257, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1455.7851989269257, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 55.85344827586207, "ram_util_percent": 92.72758620689656}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9400872733857897, "policy_loss": 0.0009268354127804438, "vf_loss": 2.939041128953298, "vf_explained_var": 0.6417109802034167, "kl": 0.006363968300404666, "entropy": 0.6443901043468051, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 8325.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 38000, "num_env_steps_trained": 38000, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 38000}, "sampler_results": {"episode_reward_max": 9.291666666666666, "episode_reward_min": 9.000000000000002, "episode_reward_mean": 9.150869963369964, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.041666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.125, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.166666666666668, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.25, 9.166666666666666, 9.166666666666666, 9.000000000000002, 9.208333333333332, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.124999999999998, 9.208333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.125, 9.083333333333332, 9.124999999999998, 9.083333333333334, 9.125, 9.083333333333332, 9.291666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125000000000002, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.291666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.124999999999998, 9.25, 9.125, 9.25, 9.125, 9.166666666666666, 9.208333333333332, 9.25, 9.125, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.124999999999998, 9.125, 9.125, 9.124999999999998, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.25, 9.25, 9.208333333333334, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2898617852835563, "mean_inference_ms": 1.1994264956565375, "mean_action_processing_ms": 0.10653213558597052, "mean_env_wait_ms": 36.18522019879554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007510971237014938, "StateBufferConnector_ms": 0.005101371597457718, "ViewRequirementAgentConnector_ms": 0.10963363961859064}}, "episode_reward_max": 9.291666666666666, "episode_reward_min": 9.000000000000002, "episode_reward_mean": 9.150869963369964, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.041666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.125, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.166666666666668, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.25, 9.166666666666666, 9.166666666666666, 9.000000000000002, 9.208333333333332, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.124999999999998, 9.208333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.125, 9.083333333333332, 9.124999999999998, 9.083333333333334, 9.125, 9.083333333333332, 9.291666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125000000000002, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.291666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.124999999999998, 9.25, 9.125, 9.25, 9.125, 9.166666666666666, 9.208333333333332, 9.25, 9.125, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.124999999999998, 9.125, 9.125, 9.124999999999998, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.25, 9.25, 9.208333333333334, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2898617852835563, "mean_inference_ms": 1.1994264956565375, "mean_action_processing_ms": 0.10653213558597052, "mean_env_wait_ms": 36.18522019879554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007510971237014938, "StateBufferConnector_ms": 0.005101371597457718, "ViewRequirementAgentConnector_ms": 0.10963363961859064}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 38000, "num_env_steps_sampled": 38000, "num_env_steps_trained": 38000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.98577287275608, "num_env_steps_trained_throughput_per_sec": 24.98577287275608, "timesteps_total": 38000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 38000, "timers": {"training_iteration_time_ms": 80809.759, "sample_time_ms": 77601.734, "load_time_ms": 8.449, "load_throughput": 236716.906, "learn_time_ms": 3196.831, "learn_throughput": 625.62, "synch_weights_time_ms": 2.291}, "counters": {"num_env_steps_sampled": 38000, "num_env_steps_trained": 38000, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 38000}, "done": false, "episodes_total": 3592, "training_iteration": 19, "trial_id": "13850_00003", "date": "2023-12-28_18-13-05", "timestamp": 1703758385, "time_this_iter_s": 80.05387783050537, "time_total_s": 1535.839076757431, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1535.839076757431, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 55.89298245614035, "ram_util_percent": 92.81666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4857170724868776, "policy_loss": -0.015270733816756142, "vf_loss": 3.5008771498998006, "vf_explained_var": 0.5976243807209862, "kl": 0.005901705646185245, "entropy": 0.6736203837394714, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 8775.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.041666666666666, "episode_reward_mean": 9.148710865561696, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.083333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666668, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.25, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.25, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.125, 9.166666666666666, 9.124999999999998, 9.25, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.125, 9.25, 9.166666666666666, 9.083333333333334, 9.125, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.125, 9.125, 9.208333333333334, 9.083333333333334, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.041666666666668, 9.124999999999998, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.124999999999998, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.208333333333334, 9.208333333333334], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2881376037555696, "mean_inference_ms": 1.1996792207994786, "mean_action_processing_ms": 0.10655593318953038, "mean_env_wait_ms": 36.198253956548214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007580130139767135, "StateBufferConnector_ms": 0.005094254214460679, "ViewRequirementAgentConnector_ms": 0.11103706465241658}}, "episode_reward_max": 9.25, "episode_reward_min": 9.041666666666666, "episode_reward_mean": 9.148710865561696, "episode_len_mean": 11.0, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.083333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666668, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.25, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.25, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.125, 9.166666666666666, 9.124999999999998, 9.25, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.125, 9.25, 9.166666666666666, 9.083333333333334, 9.125, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.125, 9.125, 9.208333333333334, 9.083333333333334, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.041666666666668, 9.124999999999998, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.124999999999998, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.208333333333334, 9.208333333333334], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2881376037555696, "mean_inference_ms": 1.1996792207994786, "mean_action_processing_ms": 0.10655593318953038, "mean_env_wait_ms": 36.198253956548214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007580130139767135, "StateBufferConnector_ms": 0.005094254214460679, "ViewRequirementAgentConnector_ms": 0.11103706465241658}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.613604756686815, "num_env_steps_trained_throughput_per_sec": 24.613604756686815, "timesteps_total": 40000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 80806.901, "sample_time_ms": 77600.77, "load_time_ms": 8.959, "load_throughput": 223247.337, "learn_time_ms": 3194.392, "learn_throughput": 626.097, "synch_weights_time_ms": 2.323}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 3773, "training_iteration": 20, "trial_id": "13850_00003", "date": "2023-12-28_18-14-26", "timestamp": 1703758466, "time_this_iter_s": 81.2649347782135, "time_total_s": 1617.1040115356445, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1617.1040115356445, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 56.01206896551724, "ram_util_percent": 92.84568965517238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9220366107092963, "policy_loss": -0.01388860543568929, "vf_loss": 2.9357557320594787, "vf_explained_var": 0.5994027358955807, "kl": 0.009038755929866768, "entropy": 0.6086281079716153, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 9225.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "sampler_results": {"episode_reward_max": 9.333333333333334, "episode_reward_min": 1.8750000000000002, "episode_reward_mean": 9.075407608695652, "episode_len_mean": 10.91304347826087, "episode_media": {}, "episodes_this_iter": 184, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.125, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666668, 9.166666666666664, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.166666666666666, 9.125, 9.125, 9.083333333333332, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.25, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.125, 9.125, 9.125, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.208333333333332, 9.125, 9.166666666666666, 1.9166666666666667, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.25, 9.291666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.0, 9.166666666666666, 9.041666666666666, 9.208333333333332, 9.166666666666666, 9.125, 9.083333333333332, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.124999999999998, 9.125, 9.166666666666666, 9.208333333333334, 9.125, 9.166666666666666, 9.333333333333334, 9.166666666666666, 9.125, 9.125, 9.083333333333332, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 1.8750000000000002, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.25], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2866371214547327, "mean_inference_ms": 1.198923884963726, "mean_action_processing_ms": 0.10648786089272219, "mean_env_wait_ms": 36.18066384847334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007394863211590311, "StateBufferConnector_ms": 0.005063803299613621, "ViewRequirementAgentConnector_ms": 0.10929107666015625}}, "episode_reward_max": 9.333333333333334, "episode_reward_min": 1.8750000000000002, "episode_reward_mean": 9.075407608695652, "episode_len_mean": 10.91304347826087, "episodes_this_iter": 184, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.125, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666668, 9.166666666666664, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.166666666666666, 9.125, 9.125, 9.083333333333332, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.25, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.125, 9.125, 9.125, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.208333333333332, 9.125, 9.166666666666666, 1.9166666666666667, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.25, 9.291666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.0, 9.166666666666666, 9.041666666666666, 9.208333333333332, 9.166666666666666, 9.125, 9.083333333333332, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.124999999999998, 9.125, 9.166666666666666, 9.208333333333334, 9.125, 9.166666666666666, 9.333333333333334, 9.166666666666666, 9.125, 9.125, 9.083333333333332, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 1.8750000000000002, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.25], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2866371214547327, "mean_inference_ms": 1.198923884963726, "mean_action_processing_ms": 0.10648786089272219, "mean_env_wait_ms": 36.18066384847334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007394863211590311, "StateBufferConnector_ms": 0.005063803299613621, "ViewRequirementAgentConnector_ms": 0.10929107666015625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.99979771837352, "num_env_steps_trained_throughput_per_sec": 24.99979771837352, "timesteps_total": 42000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 42000, "timers": {"training_iteration_time_ms": 80809.904, "sample_time_ms": 77607.754, "load_time_ms": 8.926, "load_throughput": 224069.663, "learn_time_ms": 3190.423, "learn_throughput": 626.876, "synch_weights_time_ms": 2.334}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "done": false, "episodes_total": 3957, "training_iteration": 21, "trial_id": "13850_00003", "date": "2023-12-28_18-15-46", "timestamp": 1703758546, "time_this_iter_s": 80.0079619884491, "time_total_s": 1697.1119735240936, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1697.1119735240936, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 55.90353982300884, "ram_util_percent": 92.84778761061946}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2418564165963066, "policy_loss": -0.004903371690048112, "vf_loss": 3.2465951744715373, "vf_explained_var": 0.6043044835991329, "kl": 0.008779615540805325, "entropy": 0.541868670185407, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 9675.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 9.541666666666666, "episode_reward_min": 8.999999999999998, "episode_reward_mean": 9.157228360957642, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.25, 8.999999999999998, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.208333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.541666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125000000000002, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.208333333333334, 9.124999999999998, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.125, 9.125, 9.208333333333332, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.333333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666668, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.208333333333334, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.285844156843476, "mean_inference_ms": 1.199301832174865, "mean_action_processing_ms": 0.10654406721913105, "mean_env_wait_ms": 36.20004274095152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074358934855592845, "StateBufferConnector_ms": 0.00512665806554299, "ViewRequirementAgentConnector_ms": 0.11136821620372118}}, "episode_reward_max": 9.541666666666666, "episode_reward_min": 8.999999999999998, "episode_reward_mean": 9.157228360957642, "episode_len_mean": 11.0, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.25, 8.999999999999998, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.208333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.541666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125000000000002, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.208333333333334, 9.124999999999998, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.125, 9.125, 9.208333333333332, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.333333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666668, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.208333333333334, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.285844156843476, "mean_inference_ms": 1.199301832174865, "mean_action_processing_ms": 0.10654406721913105, "mean_env_wait_ms": 36.20004274095152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074358934855592845, "StateBufferConnector_ms": 0.00512665806554299, "ViewRequirementAgentConnector_ms": 0.11136821620372118}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.492641328319642, "num_env_steps_trained_throughput_per_sec": 24.492641328319642, "timesteps_total": 44000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 80961.4, "sample_time_ms": 77755.389, "load_time_ms": 9.495, "load_throughput": 210644.141, "learn_time_ms": 3193.762, "learn_throughput": 626.221, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 4138, "training_iteration": 22, "trial_id": "13850_00003", "date": "2023-12-28_18-17-08", "timestamp": 1703758628, "time_this_iter_s": 81.66436553001404, "time_total_s": 1778.7763390541077, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1778.7763390541077, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 56.04957264957265, "ram_util_percent": 92.84102564102565}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5718051783243814, "policy_loss": -0.015109167281124327, "vf_loss": 3.5868837377760143, "vf_explained_var": 0.5430299519168006, "kl": 0.0016334587691685571, "entropy": 0.49039363470342423, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 10125.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 46000, "num_env_steps_trained": 46000, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 46000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.155448717948717, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.125, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.083333333333334, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.25, 9.125, 9.166666666666666, 9.083333333333332, 9.208333333333332, 9.166666666666666, 9.208333333333332, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.125, 9.124999999999998, 9.125, 9.25, 9.124999999999998, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2849455530111022, "mean_inference_ms": 1.1996157088851604, "mean_action_processing_ms": 0.10659114135011111, "mean_env_wait_ms": 36.224500508062846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00752158217377715, "StateBufferConnector_ms": 0.005127047444437887, "ViewRequirementAgentConnector_ms": 0.11069499529325046}}, "episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.155448717948717, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.125, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.083333333333334, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.25, 9.125, 9.166666666666666, 9.083333333333332, 9.208333333333332, 9.166666666666666, 9.208333333333332, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.125, 9.124999999999998, 9.125, 9.25, 9.124999999999998, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2849455530111022, "mean_inference_ms": 1.1996157088851604, "mean_action_processing_ms": 0.10659114135011111, "mean_env_wait_ms": 36.224500508062846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00752158217377715, "StateBufferConnector_ms": 0.005127047444437887, "ViewRequirementAgentConnector_ms": 0.11069499529325046}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 46000, "num_env_steps_sampled": 46000, "num_env_steps_trained": 46000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.405136919448804, "num_env_steps_trained_throughput_per_sec": 24.405136919448804, "timesteps_total": 46000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 46000, "timers": {"training_iteration_time_ms": 81081.012, "sample_time_ms": 77877.879, "load_time_ms": 9.096, "load_throughput": 219877.959, "learn_time_ms": 3191.395, "learn_throughput": 626.685, "synch_weights_time_ms": 2.187}, "counters": {"num_env_steps_sampled": 46000, "num_env_steps_trained": 46000, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 46000}, "done": false, "episodes_total": 4320, "training_iteration": 23, "trial_id": "13850_00003", "date": "2023-12-28_18-18-30", "timestamp": 1703758710, "time_this_iter_s": 81.95696783065796, "time_total_s": 1860.7333068847656, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1860.7333068847656, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 56.29568965517242, "ram_util_percent": 92.48189655172413}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4845875114864775, "policy_loss": -0.007484299399786525, "vf_loss": 3.492027957174513, "vf_explained_var": 0.5336677157878875, "kl": 0.004677082167480151, "entropy": 0.5578885821501414, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 10575.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.158882783882785, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.25, 9.125, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666668, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.25, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2829243790365528, "mean_inference_ms": 1.1988689083821682, "mean_action_processing_ms": 0.10651284085097698, "mean_env_wait_ms": 36.20367193119727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007360191135616093, "StateBufferConnector_ms": 0.00502906002841153, "ViewRequirementAgentConnector_ms": 0.10925885085221175}}, "episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.158882783882785, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.25, 9.125, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666668, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.25, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2829243790365528, "mean_inference_ms": 1.1988689083821682, "mean_action_processing_ms": 0.10651284085097698, "mean_env_wait_ms": 36.20367193119727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007360191135616093, "StateBufferConnector_ms": 0.00502906002841153, "ViewRequirementAgentConnector_ms": 0.10925885085221175}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 25.08364976270817, "num_env_steps_trained_throughput_per_sec": 25.08364976270817, "timesteps_total": 48000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 80917.458, "sample_time_ms": 77714.879, "load_time_ms": 8.82, "load_throughput": 226756.519, "learn_time_ms": 3191.135, "learn_throughput": 626.736, "synch_weights_time_ms": 2.17}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 4502, "training_iteration": 24, "trial_id": "13850_00003", "date": "2023-12-28_18-19-50", "timestamp": 1703758790, "time_this_iter_s": 79.74050498008728, "time_total_s": 1940.473811864853, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1940.473811864853, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 55.902631578947364, "ram_util_percent": 92.45263157894736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.004687499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4289817208713957, "policy_loss": -0.010472250115126371, "vf_loss": 3.439411397775014, "vf_explained_var": 0.527352098359002, "kl": 0.009080589719399717, "entropy": 0.47698496851656175, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11025.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 50000}, "sampler_results": {"episode_reward_max": 9.333333333333334, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.161401098901097, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.291666666666668, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666668, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.333333333333334, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2814659936049329, "mean_inference_ms": 1.1985697356899419, "mean_action_processing_ms": 0.10647933670660083, "mean_env_wait_ms": 36.19055918117936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007419664781172197, "StateBufferConnector_ms": 0.005051722893348107, "ViewRequirementAgentConnector_ms": 0.10995065772926414}}, "episode_reward_max": 9.333333333333334, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.161401098901097, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.291666666666668, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666668, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.333333333333334, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2814659936049329, "mean_inference_ms": 1.1985697356899419, "mean_action_processing_ms": 0.10647933670660083, "mean_env_wait_ms": 36.19055918117936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007419664781172197, "StateBufferConnector_ms": 0.005051722893348107, "ViewRequirementAgentConnector_ms": 0.10995065772926414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 50000, "num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.966284268533272, "num_env_steps_trained_throughput_per_sec": 24.966284268533272, "timesteps_total": 50000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 50000, "timers": {"training_iteration_time_ms": 80769.686, "sample_time_ms": 77563.068, "load_time_ms": 8.377, "load_throughput": 238748.171, "learn_time_ms": 3195.612, "learn_throughput": 625.858, "synch_weights_time_ms": 2.175}, "counters": {"num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 50000}, "done": false, "episodes_total": 4684, "training_iteration": 25, "trial_id": "13850_00003", "date": "2023-12-28_18-21-10", "timestamp": 1703758870, "time_this_iter_s": 80.11513614654541, "time_total_s": 2020.5889480113983, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2020.5889480113983, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 56.04298245614035, "ram_util_percent": 92.41666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.004687499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5941452990637885, "policy_loss": 0.0071245125722554, "vf_loss": 3.587013223965963, "vf_explained_var": 0.5462593597835964, "kl": 0.0016125168363714613, "entropy": 0.4636727829111947, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11475.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.165750915750914, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.208333333333332, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.280865296315983, "mean_inference_ms": 1.1989461470355425, "mean_action_processing_ms": 0.10651604138585948, "mean_env_wait_ms": 36.19823082876042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007485819386911916, "StateBufferConnector_ms": 0.005078315734863281, "ViewRequirementAgentConnector_ms": 0.11197171368441738}}, "episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.165750915750914, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.208333333333332, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.280865296315983, "mean_inference_ms": 1.1989461470355425, "mean_action_processing_ms": 0.10651604138585948, "mean_env_wait_ms": 36.19823082876042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007485819386911916, "StateBufferConnector_ms": 0.005078315734863281, "ViewRequirementAgentConnector_ms": 0.11197171368441738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.621134386382487, "num_env_steps_trained_throughput_per_sec": 24.621134386382487, "timesteps_total": 52000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 80924.378, "sample_time_ms": 77713.348, "load_time_ms": 9.312, "load_throughput": 214770.907, "learn_time_ms": 3199.05, "learn_throughput": 625.186, "synch_weights_time_ms": 2.21}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 4866, "training_iteration": 26, "trial_id": "13850_00003", "date": "2023-12-28_18-22-31", "timestamp": 1703758951, "time_this_iter_s": 81.23842716217041, "time_total_s": 2101.8273751735687, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2101.8273751735687, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 55.95913043478261, "ram_util_percent": 92.2930434782609}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0023437499999999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.499165474043952, "policy_loss": 0.02038565124074618, "vf_loss": 3.47877082268397, "vf_explained_var": 0.5367730908923679, "kl": 0.003848140536257726, "entropy": 0.4158424508571625, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11925.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "sampler_results": {"episode_reward_max": 9.333333333333334, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.161858974358974, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.25, 9.124999999999998, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.333333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.280622123265734, "mean_inference_ms": 1.1996215644698396, "mean_action_processing_ms": 0.10657351987564694, "mean_env_wait_ms": 36.21492076190749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007579483828701816, "StateBufferConnector_ms": 0.0051744691618196255, "ViewRequirementAgentConnector_ms": 0.11315280264550513}}, "episode_reward_max": 9.333333333333334, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.161858974358974, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.25, 9.124999999999998, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.333333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.280622123265734, "mean_inference_ms": 1.1996215644698396, "mean_action_processing_ms": 0.10657351987564694, "mean_env_wait_ms": 36.21492076190749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007579483828701816, "StateBufferConnector_ms": 0.0051744691618196255, "ViewRequirementAgentConnector_ms": 0.11315280264550513}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.45685411225213, "num_env_steps_trained_throughput_per_sec": 24.45685411225213, "timesteps_total": 54000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 80882.433, "sample_time_ms": 77668.927, "load_time_ms": 9.371, "load_throughput": 213417.459, "learn_time_ms": 3201.465, "learn_throughput": 624.714, "synch_weights_time_ms": 2.217}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "done": false, "episodes_total": 5048, "training_iteration": 27, "trial_id": "13850_00003", "date": "2023-12-28_18-23-53", "timestamp": 1703759033, "time_this_iter_s": 81.78394317626953, "time_total_s": 2183.6113183498383, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2183.6113183498383, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 55.89401709401709, "ram_util_percent": 92.28717948717944}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0011718749999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.552108353508843, "policy_loss": -0.009708080552518367, "vf_loss": 3.5618144210179645, "vf_explained_var": 0.5318676473034752, "kl": 0.0017265607485197954, "entropy": 0.4169692171282238, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 12375.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.083333333333334, "episode_reward_mean": 9.162292817679559, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.25], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2804833023197444, "mean_inference_ms": 1.2003872871858727, "mean_action_processing_ms": 0.10664364995323092, "mean_env_wait_ms": 36.237060456413815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007626233179924897, "StateBufferConnector_ms": 0.00516722874088182, "ViewRequirementAgentConnector_ms": 0.1131156531486722}}, "episode_reward_max": 9.25, "episode_reward_min": 9.083333333333334, "episode_reward_mean": 9.162292817679559, "episode_len_mean": 11.0, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.25], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2804833023197444, "mean_inference_ms": 1.2003872871858727, "mean_action_processing_ms": 0.10664364995323092, "mean_env_wait_ms": 36.237060456413815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007626233179924897, "StateBufferConnector_ms": 0.00516722874088182, "ViewRequirementAgentConnector_ms": 0.1131156531486722}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.341844718214443, "num_env_steps_trained_throughput_per_sec": 24.341844718214443, "timesteps_total": 56000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 80992.096, "sample_time_ms": 77775.953, "load_time_ms": 9.842, "load_throughput": 203217.326, "learn_time_ms": 3203.638, "learn_throughput": 624.29, "synch_weights_time_ms": 2.223}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 5229, "training_iteration": 28, "trial_id": "13850_00003", "date": "2023-12-28_18-25-15", "timestamp": 1703759115, "time_this_iter_s": 82.17016768455505, "time_total_s": 2265.7814860343933, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2265.7814860343933, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 55.95555555555556, "ram_util_percent": 92.34957264957262}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0005859374999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9140621185302735, "policy_loss": 0.009937807913455698, "vf_loss": 3.9041218328475953, "vf_explained_var": 0.49119631343417697, "kl": 0.004211083710021894, "entropy": 0.38362864547305636, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 12825.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 58000, "num_env_steps_trained": 58000, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 58000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.154761904761903, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666668, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333334, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125000000000002, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.25, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2792892385023613, "mean_inference_ms": 1.1999425850079632, "mean_action_processing_ms": 0.10660154606025367, "mean_env_wait_ms": 36.22288046716642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007392285944341303, "StateBufferConnector_ms": 0.005065215812934624, "ViewRequirementAgentConnector_ms": 0.10944316675374796}}, "episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.154761904761903, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666668, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333334, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125000000000002, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.25, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2792892385023613, "mean_inference_ms": 1.1999425850079632, "mean_action_processing_ms": 0.10660154606025367, "mean_env_wait_ms": 36.22288046716642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007392285944341303, "StateBufferConnector_ms": 0.005065215812934624, "ViewRequirementAgentConnector_ms": 0.10944316675374796}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 58000, "num_env_steps_sampled": 58000, "num_env_steps_trained": 58000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 25.009478048284446, "num_env_steps_trained_throughput_per_sec": 25.009478048284446, "timesteps_total": 58000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 58000, "timers": {"training_iteration_time_ms": 80984.509, "sample_time_ms": 77768.062, "load_time_ms": 9.865, "load_throughput": 202730.623, "learn_time_ms": 3203.942, "learn_throughput": 624.231, "synch_weights_time_ms": 2.204}, "counters": {"num_env_steps_sampled": 58000, "num_env_steps_trained": 58000, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 58000}, "done": false, "episodes_total": 5411, "training_iteration": 29, "trial_id": "13850_00003", "date": "2023-12-28_18-26-35", "timestamp": 1703759195, "time_this_iter_s": 79.97716212272644, "time_total_s": 2345.7586481571198, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2345.7586481571198, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 55.98771929824561, "ram_util_percent": 92.31842105263154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00029296874999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7468055947621663, "policy_loss": 0.013782791197299957, "vf_loss": 3.733022180133396, "vf_explained_var": 0.4274933519628313, "kl": 0.002110659123159786, "entropy": 0.38476233257187736, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 13275.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.041666666666666, "episode_reward_mean": 9.159340659340659, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.124999999999998, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.249999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.25, 9.125, 9.125, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.166666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2786084815952425, "mean_inference_ms": 1.2056988157138606, "mean_action_processing_ms": 0.10659416481521981, "mean_env_wait_ms": 36.21978919582882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074932863424112504, "StateBufferConnector_ms": 0.005209314954149854, "ViewRequirementAgentConnector_ms": 0.11077608380998884}}, "episode_reward_max": 9.25, "episode_reward_min": 9.041666666666666, "episode_reward_mean": 9.159340659340659, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.124999999999998, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.249999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.25, 9.125, 9.125, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.166666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2786084815952425, "mean_inference_ms": 1.2056988157138606, "mean_action_processing_ms": 0.10659416481521981, "mean_env_wait_ms": 36.21978919582882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074932863424112504, "StateBufferConnector_ms": 0.005209314954149854, "ViewRequirementAgentConnector_ms": 0.11077608380998884}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.693298230650893, "num_env_steps_trained_throughput_per_sec": 24.693298230650893, "timesteps_total": 60000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 80958.285, "sample_time_ms": 77738.978, "load_time_ms": 9.366, "load_throughput": 213536.978, "learn_time_ms": 3207.337, "learn_throughput": 623.57, "synch_weights_time_ms": 2.163}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 5593, "training_iteration": 30, "trial_id": "13850_00003", "date": "2023-12-28_18-27-56", "timestamp": 1703759276, "time_this_iter_s": 81.00102949142456, "time_total_s": 2426.7596776485443, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2426.7596776485443, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 56.049565217391304, "ram_util_percent": 92.35130434782607}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00014648437499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3616244864463805, "policy_loss": -0.012385791109667884, "vf_loss": 3.374010065396627, "vf_explained_var": 0.4882449233531952, "kl": 0.001497277037976548, "entropy": 0.3762054483758079, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 13725.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 62000, "num_env_steps_trained": 62000, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 62000}, "sampler_results": {"episode_reward_max": 9.333333333333334, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.161858974358974, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.333333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.278523397000381, "mean_inference_ms": 1.2059651567686718, "mean_action_processing_ms": 0.10662376029851238, "mean_env_wait_ms": 36.23204393076594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007524595155820742, "StateBufferConnector_ms": 0.00506115483713674, "ViewRequirementAgentConnector_ms": 0.11145596975808615}}, "episode_reward_max": 9.333333333333334, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.161858974358974, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.333333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.278523397000381, "mean_inference_ms": 1.2059651567686718, "mean_action_processing_ms": 0.10662376029851238, "mean_env_wait_ms": 36.23204393076594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007524595155820742, "StateBufferConnector_ms": 0.00506115483713674, "ViewRequirementAgentConnector_ms": 0.11145596975808615}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 62000, "num_env_steps_sampled": 62000, "num_env_steps_trained": 62000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.495452302696176, "num_env_steps_trained_throughput_per_sec": 24.495452302696176, "timesteps_total": 62000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 62000, "timers": {"training_iteration_time_ms": 81123.002, "sample_time_ms": 77903.479, "load_time_ms": 10.294, "load_throughput": 194284.179, "learn_time_ms": 3206.645, "learn_throughput": 623.705, "synch_weights_time_ms": 2.152}, "counters": {"num_env_steps_sampled": 62000, "num_env_steps_trained": 62000, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 62000}, "done": false, "episodes_total": 5775, "training_iteration": 31, "trial_id": "13850_00003", "date": "2023-12-28_18-29-18", "timestamp": 1703759358, "time_this_iter_s": 81.65823340415955, "time_total_s": 2508.417911052704, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2508.417911052704, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 55.86810344827585, "ram_util_percent": 92.39827586206897}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.324218749999998e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2099711995654636, "policy_loss": -0.006151178288790915, "vf_loss": 3.216122010813819, "vf_explained_var": 0.47354846941100226, "kl": 0.004960994273255387, "entropy": 0.296181641916434, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 9.333333333333334, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.163003663003662, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.333333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.277571042920144, "mean_inference_ms": 1.20545596611209, "mean_action_processing_ms": 0.10659867857670803, "mean_env_wait_ms": 36.22213153678479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519355187049279, "StateBufferConnector_ms": 0.005080411722371866, "ViewRequirementAgentConnector_ms": 0.11018200235052424}}, "episode_reward_max": 9.333333333333334, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.163003663003662, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.333333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.277571042920144, "mean_inference_ms": 1.20545596611209, "mean_action_processing_ms": 0.10659867857670803, "mean_env_wait_ms": 36.22213153678479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519355187049279, "StateBufferConnector_ms": 0.005080411722371866, "ViewRequirementAgentConnector_ms": 0.11018200235052424}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.955102218483447, "num_env_steps_trained_throughput_per_sec": 24.955102218483447, "timesteps_total": 64000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 80971.677, "sample_time_ms": 77756.646, "load_time_ms": 10.849, "load_throughput": 184349.21, "learn_time_ms": 3201.586, "learn_throughput": 624.69, "synch_weights_time_ms": 2.158}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 5957, "training_iteration": 32, "trial_id": "13850_00003", "date": "2023-12-28_18-30-38", "timestamp": 1703759438, "time_this_iter_s": 80.15101146697998, "time_total_s": 2588.568922519684, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2588.568922519684, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 55.87105263157894, "ram_util_percent": 92.38859649122806}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.662109374999999e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.761116664674547, "policy_loss": 0.026686588890022702, "vf_loss": 3.7344299533632066, "vf_explained_var": 0.4824197412861718, "kl": 0.004670155082919013, "entropy": 0.24305820415417353, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 14625.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 66000, "num_env_steps_trained": 66000, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 66000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.124999999999998, "episode_reward_mean": 9.166436464088397, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.124999999999998, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2765286288509436, "mean_inference_ms": 1.2048442526908774, "mean_action_processing_ms": 0.10656447134672357, "mean_env_wait_ms": 36.21110588353241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007419823282990008, "StateBufferConnector_ms": 0.005125077389880438, "ViewRequirementAgentConnector_ms": 0.1095379255094581}}, "episode_reward_max": 9.25, "episode_reward_min": 9.124999999999998, "episode_reward_mean": 9.166436464088397, "episode_len_mean": 11.0, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.124999999999998, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2765286288509436, "mean_inference_ms": 1.2048442526908774, "mean_action_processing_ms": 0.10656447134672357, "mean_env_wait_ms": 36.21110588353241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007419823282990008, "StateBufferConnector_ms": 0.005125077389880438, "ViewRequirementAgentConnector_ms": 0.1095379255094581}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 66000, "num_env_steps_sampled": 66000, "num_env_steps_trained": 66000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.98658974468481, "num_env_steps_trained_throughput_per_sec": 24.98658974468481, "timesteps_total": 66000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 66000, "timers": {"training_iteration_time_ms": 80780.968, "sample_time_ms": 77566.762, "load_time_ms": 10.92, "load_throughput": 183144.984, "learn_time_ms": 3200.696, "learn_throughput": 624.864, "synch_weights_time_ms": 2.157}, "counters": {"num_env_steps_sampled": 66000, "num_env_steps_trained": 66000, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 66000}, "done": false, "episodes_total": 6138, "training_iteration": 33, "trial_id": "13850_00003", "date": "2023-12-28_18-31-58", "timestamp": 1703759518, "time_this_iter_s": 80.04985237121582, "time_total_s": 2668.6187748908997, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2668.6187748908997, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 55.891228070175444, "ram_util_percent": 92.44999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8310546874999996e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.24427461359236, "policy_loss": -0.0008198478817939758, "vf_loss": 3.2450944662094114, "vf_explained_var": 0.5081679099135928, "kl": 0.002247285531335764, "entropy": 0.2030783842669593, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15075.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.124999999999998, "episode_reward_mean": 9.16735347985348, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2755438965248103, "mean_inference_ms": 1.2043496391054158, "mean_action_processing_ms": 0.10652901209430994, "mean_env_wait_ms": 36.2003695461512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00742988272027655, "StateBufferConnector_ms": 0.005086568685678335, "ViewRequirementAgentConnector_ms": 0.10985240831479921}}, "episode_reward_max": 9.25, "episode_reward_min": 9.124999999999998, "episode_reward_mean": 9.16735347985348, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2755438965248103, "mean_inference_ms": 1.2043496391054158, "mean_action_processing_ms": 0.10652901209430994, "mean_env_wait_ms": 36.2003695461512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00742988272027655, "StateBufferConnector_ms": 0.005086568685678335, "ViewRequirementAgentConnector_ms": 0.10985240831479921}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.997908350006238, "num_env_steps_trained_throughput_per_sec": 24.997908350006238, "timesteps_total": 68000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 80808.309, "sample_time_ms": 77593.761, "load_time_ms": 11.499, "load_throughput": 173931.78, "learn_time_ms": 3200.451, "learn_throughput": 624.912, "synch_weights_time_ms": 2.147}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 6320, "training_iteration": 34, "trial_id": "13850_00003", "date": "2023-12-28_18-33-18", "timestamp": 1703759598, "time_this_iter_s": 80.01428174972534, "time_total_s": 2748.633056640625, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2748.633056640625, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 55.965789473684204, "ram_util_percent": 92.44473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.155273437499998e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.627856256696913, "policy_loss": 0.005987914813061555, "vf_loss": 3.6218683322270713, "vf_explained_var": 0.461405170361201, "kl": 0.0008126187783299166, "entropy": 0.16725864574313165, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15525.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.163232600732602, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2744842407555272, "mean_inference_ms": 1.2036864089055757, "mean_action_processing_ms": 0.10647734029519794, "mean_env_wait_ms": 36.18738041988631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007384425991184109, "StateBufferConnector_ms": 0.005190058068914728, "ViewRequirementAgentConnector_ms": 0.10910492676955003}}, "episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.163232600732602, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2744842407555272, "mean_inference_ms": 1.2036864089055757, "mean_action_processing_ms": 0.10647734029519794, "mean_env_wait_ms": 36.18738041988631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007384425991184109, "StateBufferConnector_ms": 0.005190058068914728, "ViewRequirementAgentConnector_ms": 0.10910492676955003}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000, "num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 25.060269643058046, "num_env_steps_trained_throughput_per_sec": 25.060269643058046, "timesteps_total": 70000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 70000, "timers": {"training_iteration_time_ms": 80778.264, "sample_time_ms": 77564.173, "load_time_ms": 11.603, "load_throughput": 172372.436, "learn_time_ms": 3199.239, "learn_throughput": 625.149, "synch_weights_time_ms": 2.798}, "counters": {"num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000}, "done": false, "episodes_total": 6502, "training_iteration": 35, "trial_id": "13850_00003", "date": "2023-12-28_18-34-38", "timestamp": 1703759678, "time_this_iter_s": 79.81459736824036, "time_total_s": 2828.4476540088654, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2828.4476540088654, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 55.8219298245614, "ram_util_percent": 92.35350877192982}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.577636718749999e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3840889928076003, "policy_loss": 0.011866540494892332, "vf_loss": 3.3722224617004395, "vf_explained_var": 0.46952686429023743, "kl": 0.0011920130913126077, "entropy": 0.16077748093340133, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15975.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.124999999999998, "episode_reward_mean": 9.166895604395604, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2737377668638676, "mean_inference_ms": 1.2032755450956294, "mean_action_processing_ms": 0.10644597985082507, "mean_env_wait_ms": 36.17916836860906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007555772970010946, "StateBufferConnector_ms": 0.005173290168846046, "ViewRequirementAgentConnector_ms": 0.11028706372439206}}, "episode_reward_max": 9.25, "episode_reward_min": 9.124999999999998, "episode_reward_mean": 9.166895604395604, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2737377668638676, "mean_inference_ms": 1.2032755450956294, "mean_action_processing_ms": 0.10644597985082507, "mean_env_wait_ms": 36.17916836860906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007555772970010946, "StateBufferConnector_ms": 0.005173290168846046, "ViewRequirementAgentConnector_ms": 0.11028706372439206}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.96052532658352, "num_env_steps_trained_throughput_per_sec": 24.96052532658352, "timesteps_total": 72000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 80667.813, "sample_time_ms": 77456.492, "load_time_ms": 11.322, "load_throughput": 176640.205, "learn_time_ms": 3196.783, "learn_throughput": 625.629, "synch_weights_time_ms": 2.761}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 6684, "training_iteration": 36, "trial_id": "13850_00003", "date": "2023-12-28_18-35-58", "timestamp": 1703759758, "time_this_iter_s": 80.13382315635681, "time_total_s": 2908.581477165222, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2908.581477165222, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 56.013157894736835, "ram_util_percent": 92.39035087719299}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2888183593749995e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5904472896787856, "policy_loss": -0.004635716949899991, "vf_loss": 3.5950830014546713, "vf_explained_var": 0.4579734679063161, "kl": 0.0021925003978378243, "entropy": 0.1156515681081348, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 16425.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 74000, "num_env_steps_trained": 74000, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 74000}, "sampler_results": {"episode_reward_max": 9.416666666666668, "episode_reward_min": 9.125, "episode_reward_mean": 9.168956043956044, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.416666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2729588837992885, "mean_inference_ms": 1.2028980921401222, "mean_action_processing_ms": 0.1064275748355877, "mean_env_wait_ms": 36.17767341020851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007622975569504958, "StateBufferConnector_ms": 0.005101633595896291, "ViewRequirementAgentConnector_ms": 0.11019877025059291}}, "episode_reward_max": 9.416666666666668, "episode_reward_min": 9.125, "episode_reward_mean": 9.168956043956044, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.416666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2729588837992885, "mean_inference_ms": 1.2028980921401222, "mean_action_processing_ms": 0.1064275748355877, "mean_env_wait_ms": 36.17767341020851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007622975569504958, "StateBufferConnector_ms": 0.005101633595896291, "ViewRequirementAgentConnector_ms": 0.11019877025059291}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 74000, "num_env_steps_sampled": 74000, "num_env_steps_trained": 74000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.82158382929357, "num_env_steps_trained_throughput_per_sec": 24.82158382929357, "timesteps_total": 74000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 74000, "timers": {"training_iteration_time_ms": 80547.65, "sample_time_ms": 77339.392, "load_time_ms": 10.421, "load_throughput": 191924.737, "learn_time_ms": 3194.558, "learn_throughput": 626.065, "synch_weights_time_ms": 2.821}, "counters": {"num_env_steps_sampled": 74000, "num_env_steps_trained": 74000, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 74000}, "done": false, "episodes_total": 6866, "training_iteration": 37, "trial_id": "13850_00003", "date": "2023-12-28_18-37-19", "timestamp": 1703759839, "time_this_iter_s": 80.5824785232544, "time_total_s": 2989.1639556884766, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2989.1639556884766, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 56.178260869565214, "ram_util_percent": 92.3669565217391}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.516057453685337, "policy_loss": -0.006164846643805504, "vf_loss": 3.5222222905688816, "vf_explained_var": 0.4830514833662245, "kl": 0.00028196871605576834, "entropy": 0.11321971360180114, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 16875.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 9.166666666666666, "episode_reward_min": 9.124999999999998, "episode_reward_mean": 9.164835164835164, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2719392371810414, "mean_inference_ms": 1.2024286441072924, "mean_action_processing_ms": 0.10639808910165742, "mean_env_wait_ms": 36.1677623780451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007381413009140518, "StateBufferConnector_ms": 0.005031418014358688, "ViewRequirementAgentConnector_ms": 0.10972547007131052}}, "episode_reward_max": 9.166666666666666, "episode_reward_min": 9.124999999999998, "episode_reward_mean": 9.164835164835164, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2719392371810414, "mean_inference_ms": 1.2024286441072924, "mean_action_processing_ms": 0.10639808910165742, "mean_env_wait_ms": 36.1677623780451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007381413009140518, "StateBufferConnector_ms": 0.005031418014358688, "ViewRequirementAgentConnector_ms": 0.10972547007131052}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 25.022552745085754, "num_env_steps_trained_throughput_per_sec": 25.022552745085754, "timesteps_total": 76000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 80324.135, "sample_time_ms": 77116.681, "load_time_ms": 9.942, "load_throughput": 201164.695, "learn_time_ms": 3194.216, "learn_throughput": 626.132, "synch_weights_time_ms": 2.831}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 7048, "training_iteration": 38, "trial_id": "13850_00003", "date": "2023-12-28_18-38-39", "timestamp": 1703759919, "time_this_iter_s": 79.93473434448242, "time_total_s": 3069.098690032959, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3069.098690032959, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 55.94070796460178, "ram_util_percent": 92.329203539823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.722045898437499e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.416704719596439, "policy_loss": -0.008222034060292774, "vf_loss": 3.424926750659943, "vf_explained_var": 0.4038653061125014, "kl": 0.0011293907262381235, "entropy": 0.11519750740793017, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 17325.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 78000, "num_env_steps_trained": 78000, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 78000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.083333333333334, "episode_reward_mean": 9.164364640883978, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2715352583988495, "mean_inference_ms": 1.2023850093491435, "mean_action_processing_ms": 0.10640646157800412, "mean_env_wait_ms": 36.173400337152835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007413105411424163, "StateBufferConnector_ms": 0.005075154383538178, "ViewRequirementAgentConnector_ms": 0.11089836036302766}}, "episode_reward_max": 9.25, "episode_reward_min": 9.083333333333334, "episode_reward_mean": 9.164364640883978, "episode_len_mean": 11.0, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2715352583988495, "mean_inference_ms": 1.2023850093491435, "mean_action_processing_ms": 0.10640646157800412, "mean_env_wait_ms": 36.173400337152835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007413105411424163, "StateBufferConnector_ms": 0.005075154383538178, "ViewRequirementAgentConnector_ms": 0.11089836036302766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 78000, "num_env_steps_sampled": 78000, "num_env_steps_trained": 78000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.640706422876907, "num_env_steps_trained_throughput_per_sec": 24.640706422876907, "timesteps_total": 78000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 78000, "timers": {"training_iteration_time_ms": 80443.817, "sample_time_ms": 77234.001, "load_time_ms": 11.245, "load_throughput": 177856.631, "learn_time_ms": 3195.267, "learn_throughput": 625.926, "synch_weights_time_ms": 2.835}, "counters": {"num_env_steps_sampled": 78000, "num_env_steps_trained": 78000, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 78000}, "done": false, "episodes_total": 7229, "training_iteration": 39, "trial_id": "13850_00003", "date": "2023-12-28_18-40-00", "timestamp": 1703760000, "time_this_iter_s": 81.17336535453796, "time_total_s": 3150.272055387497, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3150.272055387497, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 56.02413793103447, "ram_util_percent": 92.3905172413793}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8610229492187494e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.263279741605123, "policy_loss": -0.01115633358558019, "vf_loss": 3.274436091317071, "vf_explained_var": 0.4734554571575589, "kl": 0.0009111621592386494, "entropy": 0.1311562920278973, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 17775.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.124999999999998, "episode_reward_mean": 9.165979853479852, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2711242989250078, "mean_inference_ms": 1.2020902874109125, "mean_action_processing_ms": 0.10639856973902395, "mean_env_wait_ms": 36.17109637089314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074496636023888224, "StateBufferConnector_ms": 0.005101764595115577, "ViewRequirementAgentConnector_ms": 0.10950106840867263}}, "episode_reward_max": 9.25, "episode_reward_min": 9.124999999999998, "episode_reward_mean": 9.165979853479852, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2711242989250078, "mean_inference_ms": 1.2020902874109125, "mean_action_processing_ms": 0.10639856973902395, "mean_env_wait_ms": 36.17109637089314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074496636023888224, "StateBufferConnector_ms": 0.005101764595115577, "ViewRequirementAgentConnector_ms": 0.10950106840867263}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.843581629224573, "num_env_steps_trained_throughput_per_sec": 24.843581629224573, "timesteps_total": 80000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 80394.822, "sample_time_ms": 77186.932, "load_time_ms": 11.739, "load_throughput": 170375.498, "learn_time_ms": 3192.851, "learn_throughput": 626.399, "synch_weights_time_ms": 2.843}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 7411, "training_iteration": 40, "trial_id": "13850_00003", "date": "2023-12-28_18-41-20", "timestamp": 1703760080, "time_this_iter_s": 80.51140761375427, "time_total_s": 3230.783463001251, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3230.783463001251, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 56.13859649122807, "ram_util_percent": 92.41929824561403}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4305114746093747e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.348204850620694, "policy_loss": -0.012391164923707645, "vf_loss": 3.3605960114796956, "vf_explained_var": 0.5133755397796631, "kl": 0.0015225277148719035, "entropy": 0.12816785850458676, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 18225.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 82000, "num_env_steps_trained": 82000, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 82000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.164835164835164, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2711949878255848, "mean_inference_ms": 1.2024650762602203, "mean_action_processing_ms": 0.10643778651972005, "mean_env_wait_ms": 36.184189475191374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007499312306498434, "StateBufferConnector_ms": 0.005125737452245021, "ViewRequirementAgentConnector_ms": 0.11286499736073254}}, "episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.164835164835164, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2711949878255848, "mean_inference_ms": 1.2024650762602203, "mean_action_processing_ms": 0.10643778651972005, "mean_env_wait_ms": 36.184189475191374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007499312306498434, "StateBufferConnector_ms": 0.005125737452245021, "ViewRequirementAgentConnector_ms": 0.11286499736073254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 82000, "num_env_steps_sampled": 82000, "num_env_steps_trained": 82000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.425891779327003, "num_env_steps_trained_throughput_per_sec": 24.425891779327003, "timesteps_total": 82000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 82000, "timers": {"training_iteration_time_ms": 80418.074, "sample_time_ms": 77209.008, "load_time_ms": 12.582, "load_throughput": 158954.629, "learn_time_ms": 3193.183, "learn_throughput": 626.334, "synch_weights_time_ms": 2.847}, "counters": {"num_env_steps_sampled": 82000, "num_env_steps_trained": 82000, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 82000}, "done": false, "episodes_total": 7593, "training_iteration": 41, "trial_id": "13850_00003", "date": "2023-12-28_18-42-42", "timestamp": 1703760162, "time_this_iter_s": 81.88707542419434, "time_total_s": 3312.6705384254456, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3312.6705384254456, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 55.905128205128214, "ram_util_percent": 92.44188034188033}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.152557373046873e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.349130480554369, "policy_loss": -0.009024798613455561, "vf_loss": 3.35815528233846, "vf_explained_var": 0.4620210705863105, "kl": 0.0008777960326063671, "entropy": 0.16462082548273935, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 18675.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.161401098901099, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.271240782254372, "mean_inference_ms": 1.2026434306526421, "mean_action_processing_ms": 0.10646282906342175, "mean_env_wait_ms": 36.19212476192867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007534682095705808, "StateBufferConnector_ms": 0.005246387733207954, "ViewRequirementAgentConnector_ms": 0.11255859018682124}}, "episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.161401098901099, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.271240782254372, "mean_inference_ms": 1.2026434306526421, "mean_action_processing_ms": 0.10646282906342175, "mean_env_wait_ms": 36.19212476192867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007534682095705808, "StateBufferConnector_ms": 0.005246387733207954, "ViewRequirementAgentConnector_ms": 0.11255859018682124}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.546541297865986, "num_env_steps_trained_throughput_per_sec": 24.546541297865986, "timesteps_total": 84000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 80551.466, "sample_time_ms": 77339.177, "load_time_ms": 11.067, "load_throughput": 180725.089, "learn_time_ms": 3197.87, "learn_throughput": 625.416, "synch_weights_time_ms": 2.894}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 7775, "training_iteration": 42, "trial_id": "13850_00003", "date": "2023-12-28_18-44-04", "timestamp": 1703760244, "time_this_iter_s": 81.48561596870422, "time_total_s": 3394.15615439415, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3394.15615439415, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 55.94741379310344, "ram_util_percent": 92.53103448275861}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.576278686523437e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.39384863058726, "policy_loss": -0.0014923853054642677, "vf_loss": 3.3953410138024225, "vf_explained_var": 0.45146261758274503, "kl": 0.0007449320692068185, "entropy": 0.18584513316551846, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19125.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 86000, "num_env_steps_trained": 86000, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 86000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.162316849816849, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2705359680317367, "mean_inference_ms": 1.2023038120389316, "mean_action_processing_ms": 0.1064285389388811, "mean_env_wait_ms": 36.18299422298088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00750822025340992, "StateBufferConnector_ms": 0.005118401495964973, "ViewRequirementAgentConnector_ms": 0.10981625253027612}}, "episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.162316849816849, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2705359680317367, "mean_inference_ms": 1.2023038120389316, "mean_action_processing_ms": 0.1064285389388811, "mean_env_wait_ms": 36.18299422298088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00750822025340992, "StateBufferConnector_ms": 0.005118401495964973, "ViewRequirementAgentConnector_ms": 0.10981625253027612}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 86000, "num_env_steps_sampled": 86000, "num_env_steps_trained": 86000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 25.034433952771987, "num_env_steps_trained_throughput_per_sec": 25.034433952771987, "timesteps_total": 86000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 86000, "timers": {"training_iteration_time_ms": 80536.175, "sample_time_ms": 77327.472, "load_time_ms": 10.995, "load_throughput": 181897.206, "learn_time_ms": 3194.364, "learn_throughput": 626.103, "synch_weights_time_ms": 2.885}, "counters": {"num_env_steps_sampled": 86000, "num_env_steps_trained": 86000, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 86000}, "done": false, "episodes_total": 7957, "training_iteration": 43, "trial_id": "13850_00003", "date": "2023-12-28_18-45-24", "timestamp": 1703760324, "time_this_iter_s": 79.89717125892639, "time_total_s": 3474.053325653076, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3474.053325653076, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 55.90263157894737, "ram_util_percent": 92.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7881393432617184e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.976563728650411, "policy_loss": 0.001769563779234886, "vf_loss": 2.9747941682073806, "vf_explained_var": 0.43055608365270825, "kl": 0.0007497725784556926, "entropy": 0.18068723095787895, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19575.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.160911602209945, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2698279265806034, "mean_inference_ms": 1.2019638625008504, "mean_action_processing_ms": 0.10640411677357123, "mean_env_wait_ms": 36.17504787134043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007522830646999633, "StateBufferConnector_ms": 0.005173156274616389, "ViewRequirementAgentConnector_ms": 0.11026661698989447}}, "episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.160911602209945, "episode_len_mean": 11.0, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2698279265806034, "mean_inference_ms": 1.2019638625008504, "mean_action_processing_ms": 0.10640411677357123, "mean_env_wait_ms": 36.17504787134043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007522830646999633, "StateBufferConnector_ms": 0.005173156274616389, "ViewRequirementAgentConnector_ms": 0.11026661698989447}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 25.000639052632913, "num_env_steps_trained_throughput_per_sec": 25.000639052632913, "timesteps_total": 88000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 80535.308, "sample_time_ms": 77324.181, "load_time_ms": 10.399, "load_throughput": 192323.395, "learn_time_ms": 3197.407, "learn_throughput": 625.507, "synch_weights_time_ms": 2.877}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 8138, "training_iteration": 44, "trial_id": "13850_00003", "date": "2023-12-28_18-46-44", "timestamp": 1703760404, "time_this_iter_s": 80.00519227981567, "time_total_s": 3554.058517932892, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3554.058517932892, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 55.906140350877195, "ram_util_percent": 92.41315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.940696716308592e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.286583500703176, "policy_loss": 0.0017424235658513175, "vf_loss": 3.284841081566281, "vf_explained_var": 0.4207532894611359, "kl": 0.0007770654748793632, "entropy": 0.20042969395716986, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20025.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.164835164835164, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2699066178681928, "mean_inference_ms": 1.202041131321787, "mean_action_processing_ms": 0.10643616139725183, "mean_env_wait_ms": 36.19134413533881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007469051486843235, "StateBufferConnector_ms": 0.005180626125126094, "ViewRequirementAgentConnector_ms": 0.11125187297443767}}, "episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.164835164835164, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2699066178681928, "mean_inference_ms": 1.202041131321787, "mean_action_processing_ms": 0.10643616139725183, "mean_env_wait_ms": 36.19134413533881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007469051486843235, "StateBufferConnector_ms": 0.005180626125126094, "ViewRequirementAgentConnector_ms": 0.11125187297443767}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.30052335819749, "num_env_steps_trained_throughput_per_sec": 24.30052335819749, "timesteps_total": 90000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 80784.825, "sample_time_ms": 77568.899, "load_time_ms": 10.543, "load_throughput": 189701.673, "learn_time_ms": 3202.706, "learn_throughput": 624.472, "synch_weights_time_ms": 2.236}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "episodes_total": 8320, "training_iteration": 45, "trial_id": "13850_00003", "date": "2023-12-28_18-48-06", "timestamp": 1703760486, "time_this_iter_s": 82.31049633026123, "time_total_s": 3636.369014263153, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3636.369014263153, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 56.2025641025641, "ram_util_percent": 92.48119658119657}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.470348358154296e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.771896301375495, "policy_loss": -0.016451986266507044, "vf_loss": 3.7883482784695097, "vf_explained_var": 0.33388203064600624, "kl": 0.0007799921984001735, "entropy": 0.21468402975135378, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20475.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.158424908424907, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2699305065958304, "mean_inference_ms": 1.202288534942888, "mean_action_processing_ms": 0.10645724764580405, "mean_env_wait_ms": 36.20102102319241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075974307217440765, "StateBufferConnector_ms": 0.00519110606266902, "ViewRequirementAgentConnector_ms": 0.11196267473828661}}, "episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.158424908424907, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2699305065958304, "mean_inference_ms": 1.202288534942888, "mean_action_processing_ms": 0.10645724764580405, "mean_env_wait_ms": 36.20102102319241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075974307217440765, "StateBufferConnector_ms": 0.00519110606266902, "ViewRequirementAgentConnector_ms": 0.11196267473828661}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.473655570016177, "num_env_steps_trained_throughput_per_sec": 24.473655570016177, "timesteps_total": 92000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 80944.226, "sample_time_ms": 77728.029, "load_time_ms": 11.942, "load_throughput": 167479.406, "learn_time_ms": 3201.587, "learn_throughput": 624.69, "synch_weights_time_ms": 2.23}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 8502, "training_iteration": 46, "trial_id": "13850_00003", "date": "2023-12-28_18-49-28", "timestamp": 1703760568, "time_this_iter_s": 81.72762870788574, "time_total_s": 3718.096642971039, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3718.096642971039, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 55.751724137931035, "ram_util_percent": 92.52327586206897}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.235174179077148e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2233872403038872, "policy_loss": -0.008512316395839055, "vf_loss": 3.231899556583828, "vf_explained_var": 0.3346862982379066, "kl": 0.00193220923728326, "entropy": 0.24026122361421584, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 94000, "num_env_steps_trained": 94000, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 94000}, "sampler_results": {"episode_reward_max": 9.333333333333334, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.165521978021978, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.333333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.249999999999998, 9.083333333333332, 9.25, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2696196191598832, "mean_inference_ms": 1.2021512422466178, "mean_action_processing_ms": 0.10645706726311863, "mean_env_wait_ms": 36.203435111013626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007412590823330722, "StateBufferConnector_ms": 0.005100716601361285, "ViewRequirementAgentConnector_ms": 0.11056845004741962}}, "episode_reward_max": 9.333333333333334, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.165521978021978, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.333333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.249999999999998, 9.083333333333332, 9.25, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2696196191598832, "mean_inference_ms": 1.2021512422466178, "mean_action_processing_ms": 0.10645706726311863, "mean_env_wait_ms": 36.203435111013626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007412590823330722, "StateBufferConnector_ms": 0.005100716601361285, "ViewRequirementAgentConnector_ms": 0.11056845004741962}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 94000, "num_env_steps_sampled": 94000, "num_env_steps_trained": 94000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.70140614429857, "num_env_steps_trained_throughput_per_sec": 24.70140614429857, "timesteps_total": 94000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 94000, "timers": {"training_iteration_time_ms": 80983.428, "sample_time_ms": 77769.657, "load_time_ms": 11.418, "load_throughput": 175169.205, "learn_time_ms": 3199.747, "learn_throughput": 625.049, "synch_weights_time_ms": 2.171}, "counters": {"num_env_steps_sampled": 94000, "num_env_steps_trained": 94000, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 94000}, "done": false, "episodes_total": 8684, "training_iteration": 47, "trial_id": "13850_00003", "date": "2023-12-28_18-50-49", "timestamp": 1703760649, "time_this_iter_s": 80.97544264793396, "time_total_s": 3799.072085618973, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3799.072085618973, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 56.07565217391305, "ram_util_percent": 92.46260869565216}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.117587089538574e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0927770672904122, "policy_loss": -0.027518888086908392, "vf_loss": 3.1202959579891627, "vf_explained_var": 0.47901459283298914, "kl": 0.0011967092470315105, "entropy": 0.2717719371451272, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 21375.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 9.583333333333334, "episode_reward_min": 9.083333333333334, "episode_reward_mean": 9.169871794871794, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.125, 9.375, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.583333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2693955619362918, "mean_inference_ms": 1.2019967944920982, "mean_action_processing_ms": 0.10645061610578262, "mean_env_wait_ms": 36.20338902120941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007449401603950249, "StateBufferConnector_ms": 0.005061416835575313, "ViewRequirementAgentConnector_ms": 0.10999637645679516}}, "episode_reward_max": 9.583333333333334, "episode_reward_min": 9.083333333333334, "episode_reward_mean": 9.169871794871794, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.125, 9.375, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.583333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2693955619362918, "mean_inference_ms": 1.2019967944920982, "mean_action_processing_ms": 0.10645061610578262, "mean_env_wait_ms": 36.20338902120941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007449401603950249, "StateBufferConnector_ms": 0.005061416835575313, "ViewRequirementAgentConnector_ms": 0.10999637645679516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.75553402270059, "num_env_steps_trained_throughput_per_sec": 24.75553402270059, "timesteps_total": 96000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 81069.64, "sample_time_ms": 77856.241, "load_time_ms": 12.804, "load_throughput": 156202.259, "learn_time_ms": 3198.001, "learn_throughput": 625.391, "synch_weights_time_ms": 2.168}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 8866, "training_iteration": 48, "trial_id": "13850_00003", "date": "2023-12-28_18-52-10", "timestamp": 1703760730, "time_this_iter_s": 80.79734754562378, "time_total_s": 3879.8694331645966, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3879.8694331645966, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 55.92695652173913, "ram_util_percent": 92.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.58793544769287e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4903996660974292, "policy_loss": 0.005167039790087276, "vf_loss": 3.485232632690006, "vf_explained_var": 0.3412140222390493, "kl": 0.0023676365759422043, "entropy": 0.2665818503830168, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 21825.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 98000, "num_env_steps_trained": 98000, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 98000}, "sampler_results": {"episode_reward_max": 9.416666666666666, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.168956043956044, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.416666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.124999999999998, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.25, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.25, 9.291666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2686905294686857, "mean_inference_ms": 1.2016356477318886, "mean_action_processing_ms": 0.10641971082926086, "mean_env_wait_ms": 36.193325717082246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007443768637520927, "StateBufferConnector_ms": 0.0051168295053335335, "ViewRequirementAgentConnector_ms": 0.11049823446588201}}, "episode_reward_max": 9.416666666666666, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.168956043956044, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.416666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.124999999999998, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.25, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.25, 9.291666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2686905294686857, "mean_inference_ms": 1.2016356477318886, "mean_action_processing_ms": 0.10641971082926086, "mean_env_wait_ms": 36.193325717082246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007443768637520927, "StateBufferConnector_ms": 0.0051168295053335335, "ViewRequirementAgentConnector_ms": 0.11049823446588201}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 98000, "num_env_steps_sampled": 98000, "num_env_steps_trained": 98000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 25.08163475903312, "num_env_steps_trained_throughput_per_sec": 25.08163475903312, "timesteps_total": 98000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 98000, "timers": {"training_iteration_time_ms": 80926.952, "sample_time_ms": 77712.941, "load_time_ms": 12.236, "load_throughput": 163455.305, "learn_time_ms": 3199.199, "learn_throughput": 625.156, "synch_weights_time_ms": 2.155}, "counters": {"num_env_steps_sampled": 98000, "num_env_steps_trained": 98000, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 98000}, "done": false, "episodes_total": 9048, "training_iteration": 49, "trial_id": "13850_00003", "date": "2023-12-28_18-53-29", "timestamp": 1703760809, "time_this_iter_s": 79.74670839309692, "time_total_s": 3959.6161415576935, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3959.6161415576935, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 55.880701754385974, "ram_util_percent": 92.44385964912277}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.793967723846435e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5063817519611784, "policy_loss": 0.031944829088946185, "vf_loss": 3.474436928431193, "vf_explained_var": 0.35486200862460665, "kl": 0.004015384060472381, "entropy": 0.2698272432552444, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 22275.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 9.333333333333334, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.165285451197052, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.125, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.333333333333334, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2682916340811874, "mean_inference_ms": 1.2015526946132822, "mean_action_processing_ms": 0.1064152304224333, "mean_env_wait_ms": 36.19037970911413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007470141458247906, "StateBufferConnector_ms": 0.005085955667232281, "ViewRequirementAgentConnector_ms": 0.11050767002843362}}, "episode_reward_max": 9.333333333333334, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.165285451197052, "episode_len_mean": 11.0, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.125, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.333333333333334, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2682916340811874, "mean_inference_ms": 1.2015526946132822, "mean_action_processing_ms": 0.1064152304224333, "mean_env_wait_ms": 36.19037970911413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007470141458247906, "StateBufferConnector_ms": 0.005085955667232281, "ViewRequirementAgentConnector_ms": 0.11050767002843362}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.843212207631165, "num_env_steps_trained_throughput_per_sec": 24.843212207631165, "timesteps_total": 100000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 80927.072, "sample_time_ms": 77706.067, "load_time_ms": 12.101, "load_throughput": 165277.462, "learn_time_ms": 3206.325, "learn_throughput": 623.767, "synch_weights_time_ms": 2.151}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 9229, "training_iteration": 50, "trial_id": "13850_00003", "date": "2023-12-28_18-54-50", "timestamp": 1703760890, "time_this_iter_s": 80.51288771629333, "time_total_s": 4040.129029273987, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4040.129029273987, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 55.93217391304347, "ram_util_percent": 92.36956521739128}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3969838619232175e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.191445134745704, "policy_loss": -0.004136020888884862, "vf_loss": 3.195581152704027, "vf_explained_var": 0.44216027246581185, "kl": 0.0028428170800494455, "entropy": 0.24610307859049904, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 22725.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 102000, "num_env_steps_trained": 102000, "num_agent_steps_sampled": 102000, "num_agent_steps_trained": 102000}, "sampler_results": {"episode_reward_max": 9.333333333333334, "episode_reward_min": 9.041666666666668, "episode_reward_mean": 9.158424908424909, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.333333333333334, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.208333333333332, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.333333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2678138611439418, "mean_inference_ms": 1.2012609279541056, "mean_action_processing_ms": 0.10639478119668694, "mean_env_wait_ms": 36.183818595233916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007418747786637191, "StateBufferConnector_ms": 0.00506573980981177, "ViewRequirementAgentConnector_ms": 0.10996257865821922}}, "episode_reward_max": 9.333333333333334, "episode_reward_min": 9.041666666666668, "episode_reward_mean": 9.158424908424909, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.333333333333334, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.208333333333332, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.333333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2678138611439418, "mean_inference_ms": 1.2012609279541056, "mean_action_processing_ms": 0.10639478119668694, "mean_env_wait_ms": 36.183818595233916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007418747786637191, "StateBufferConnector_ms": 0.00506573980981177, "ViewRequirementAgentConnector_ms": 0.10996257865821922}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102000, "num_agent_steps_trained": 102000, "num_env_steps_sampled": 102000, "num_env_steps_trained": 102000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.97792808549131, "num_env_steps_trained_throughput_per_sec": 24.97792808549131, "timesteps_total": 102000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 102000, "timers": {"training_iteration_time_ms": 80746.108, "sample_time_ms": 77522.996, "load_time_ms": 12.232, "load_throughput": 163503.094, "learn_time_ms": 3208.283, "learn_throughput": 623.386, "synch_weights_time_ms": 2.162}, "counters": {"num_env_steps_sampled": 102000, "num_env_steps_trained": 102000, "num_agent_steps_sampled": 102000, "num_agent_steps_trained": 102000}, "done": false, "episodes_total": 9411, "training_iteration": 51, "trial_id": "13850_00003", "date": "2023-12-28_18-56-10", "timestamp": 1703760970, "time_this_iter_s": 80.07786273956299, "time_total_s": 4120.20689201355, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4120.20689201355, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 55.76140350877194, "ram_util_percent": 92.46842105263157}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.984919309616087e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.468193924691942, "policy_loss": -0.029829440547360316, "vf_loss": 3.4980233844121296, "vf_explained_var": 0.34433963192833794, "kl": 0.0015245669393730843, "entropy": 0.24570054041014777, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 23175.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.157051282051281, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.25, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2674239714296205, "mean_inference_ms": 1.204566789775388, "mean_action_processing_ms": 0.10638622316910352, "mean_env_wait_ms": 36.18012623959274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007512674226865664, "StateBufferConnector_ms": 0.005110410543588491, "ViewRequirementAgentConnector_ms": 0.11078171677641817}}, "episode_reward_max": 9.25, "episode_reward_min": 9.083333333333332, "episode_reward_mean": 9.157051282051281, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.25, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2674239714296205, "mean_inference_ms": 1.204566789775388, "mean_action_processing_ms": 0.10638622316910352, "mean_env_wait_ms": 36.18012623959274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007512674226865664, "StateBufferConnector_ms": 0.005110410543588491, "ViewRequirementAgentConnector_ms": 0.11078171677641817}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.776560669374923, "num_env_steps_trained_throughput_per_sec": 24.776560669374923, "timesteps_total": 104000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 80670.468, "sample_time_ms": 77444.946, "load_time_ms": 12.603, "load_throughput": 158694.216, "learn_time_ms": 3210.36, "learn_throughput": 622.983, "synch_weights_time_ms": 2.134}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 9593, "training_iteration": 52, "trial_id": "13850_00003", "date": "2023-12-28_18-57-31", "timestamp": 1703761051, "time_this_iter_s": 80.72850513458252, "time_total_s": 4200.935397148132, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4200.935397148132, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 56.191228070175434, "ram_util_percent": 92.49298245614035}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.4924596548080437e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1562957837846546, "policy_loss": 0.015642252531316545, "vf_loss": 3.1406535482406617, "vf_explained_var": 0.39230867399109737, "kl": 0.00531790370582611, "entropy": 0.2727442502975464, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 106000, "num_env_steps_trained": 106000, "num_agent_steps_sampled": 106000, "num_agent_steps_trained": 106000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.041666666666666, "episode_reward_mean": 9.156135531135531, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.25, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.208333333333334, 9.124999999999998, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.266886248439979, "mean_inference_ms": 1.2042181000241834, "mean_action_processing_ms": 0.10636701868252496, "mean_env_wait_ms": 36.17433204483177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00730373047210358, "StateBufferConnector_ms": 0.005080935719249013, "ViewRequirementAgentConnector_ms": 0.10870747513823457}}, "episode_reward_max": 9.25, "episode_reward_min": 9.041666666666666, "episode_reward_mean": 9.156135531135531, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.25, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.208333333333334, 9.124999999999998, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.266886248439979, "mean_inference_ms": 1.2042181000241834, "mean_action_processing_ms": 0.10636701868252496, "mean_env_wait_ms": 36.17433204483177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00730373047210358, "StateBufferConnector_ms": 0.005080935719249013, "ViewRequirementAgentConnector_ms": 0.10870747513823457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106000, "num_agent_steps_trained": 106000, "num_env_steps_sampled": 106000, "num_env_steps_trained": 106000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.98755307619627, "num_env_steps_trained_throughput_per_sec": 24.98755307619627, "timesteps_total": 106000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 106000, "timers": {"training_iteration_time_ms": 80685.457, "sample_time_ms": 77458.936, "load_time_ms": 13.541, "load_throughput": 147695.601, "learn_time_ms": 3210.414, "learn_throughput": 622.973, "synch_weights_time_ms": 2.142}, "counters": {"num_env_steps_sampled": 106000, "num_env_steps_trained": 106000, "num_agent_steps_sampled": 106000, "num_agent_steps_trained": 106000}, "done": false, "episodes_total": 9775, "training_iteration": 53, "trial_id": "13850_00003", "date": "2023-12-28_18-58-51", "timestamp": 1703761131, "time_this_iter_s": 80.04747176170349, "time_total_s": 4280.982868909836, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4280.982868909836, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 55.964035087719296, "ram_util_percent": 92.55263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.4924596548080437e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.000458381440905, "policy_loss": -0.009163384698331356, "vf_loss": 4.009621762699551, "vf_explained_var": 0.2476983422703213, "kl": 0.002338347180827615, "entropy": 0.33269996215899783, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24075.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.041666666666666, "episode_reward_mean": 9.148809523809524, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.041666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.083333333333332, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.083333333333332, 9.124999999999998, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.041666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.083333333333332, 9.083333333333332, 9.125, 9.166666666666666, 9.124999999999998, 9.125, 9.249999999999998, 9.125, 9.208333333333334, 9.249999999999998, 9.125, 9.124999999999998, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2665852276407197, "mean_inference_ms": 1.2040218643927534, "mean_action_processing_ms": 0.1063619165195096, "mean_env_wait_ms": 36.17091713829739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073867839771312675, "StateBufferConnector_ms": 0.005122593470982143, "ViewRequirementAgentConnector_ms": 0.11039317309201419}}, "episode_reward_max": 9.25, "episode_reward_min": 9.041666666666666, "episode_reward_mean": 9.148809523809524, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.041666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.083333333333332, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.083333333333332, 9.124999999999998, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.041666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.083333333333332, 9.083333333333332, 9.125, 9.166666666666666, 9.124999999999998, 9.125, 9.249999999999998, 9.125, 9.208333333333334, 9.249999999999998, 9.125, 9.124999999999998, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2665852276407197, "mean_inference_ms": 1.2040218643927534, "mean_action_processing_ms": 0.1063619165195096, "mean_env_wait_ms": 36.17091713829739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073867839771312675, "StateBufferConnector_ms": 0.005122593470982143, "ViewRequirementAgentConnector_ms": 0.11039317309201419}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.903777980801493, "num_env_steps_trained_throughput_per_sec": 24.903777980801493, "timesteps_total": 108000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 80716.57, "sample_time_ms": 77493.757, "load_time_ms": 13.56, "load_throughput": 147491.749, "learn_time_ms": 3206.677, "learn_throughput": 623.699, "synch_weights_time_ms": 2.149}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 9957, "training_iteration": 54, "trial_id": "13850_00003", "date": "2023-12-28_19-00-11", "timestamp": 1703761211, "time_this_iter_s": 80.31655049324036, "time_total_s": 4361.299419403076, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4361.299419403076, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 55.79217391304346, "ram_util_percent": 92.60260869565217}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7462298274040218e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0536332331763374, "policy_loss": -0.005124235149059031, "vf_loss": 3.0587574632962546, "vf_explained_var": 0.46833252284261917, "kl": 0.004671879010695258, "entropy": 0.3582446787092421, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24525.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_agent_steps_sampled": 110000, "num_agent_steps_trained": 110000}, "sampler_results": {"episode_reward_max": 9.249999999999998, "episode_reward_min": 9.0, "episode_reward_mean": 9.145257826887661, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.125, 9.166666666666666, 9.083333333333332, 9.124999999999998, 9.083333333333334, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666668, 9.124999999999998, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.0, 9.166666666666666, 9.125, 9.125, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666668, 9.041666666666668, 9.125, 9.166666666666666, 9.083333333333334, 9.124999999999998, 9.124999999999998], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2661170298842455, "mean_inference_ms": 1.2037247640705266, "mean_action_processing_ms": 0.10634586367416078, "mean_env_wait_ms": 36.167103889143455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074135005803398005, "StateBufferConnector_ms": 0.0051844844501980104, "ViewRequirementAgentConnector_ms": 0.1100702180388224}}, "episode_reward_max": 9.249999999999998, "episode_reward_min": 9.0, "episode_reward_mean": 9.145257826887661, "episode_len_mean": 11.0, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.125, 9.166666666666666, 9.083333333333332, 9.124999999999998, 9.083333333333334, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666668, 9.124999999999998, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.0, 9.166666666666666, 9.125, 9.125, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666668, 9.041666666666668, 9.125, 9.166666666666666, 9.083333333333334, 9.124999999999998, 9.124999999999998], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2661170298842455, "mean_inference_ms": 1.2037247640705266, "mean_action_processing_ms": 0.10634586367416078, "mean_env_wait_ms": 36.167103889143455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074135005803398005, "StateBufferConnector_ms": 0.0051844844501980104, "ViewRequirementAgentConnector_ms": 0.1100702180388224}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110000, "num_agent_steps_trained": 110000, "num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.916566221242256, "num_env_steps_trained_throughput_per_sec": 24.916566221242256, "timesteps_total": 110000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 110000, "timers": {"training_iteration_time_ms": 80513.082, "sample_time_ms": 77293.837, "load_time_ms": 14.726, "load_throughput": 135813.152, "learn_time_ms": 3201.943, "learn_throughput": 624.621, "synch_weights_time_ms": 2.146}, "counters": {"num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_agent_steps_sampled": 110000, "num_agent_steps_trained": 110000}, "done": false, "episodes_total": 10138, "training_iteration": 55, "trial_id": "13850_00003", "date": "2023-12-28_19-01-31", "timestamp": 1703761291, "time_this_iter_s": 80.27525401115417, "time_total_s": 4441.57467341423, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4441.57467341423, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 55.954385964912284, "ram_util_percent": 92.29649122807017}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.731149137020109e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4509803205066256, "policy_loss": -0.006141952416963047, "vf_loss": 3.4571222739749485, "vf_explained_var": 0.424937935007943, "kl": 0.0017529866451792063, "entropy": 0.41553626477718353, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24975.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 9.0, "episode_reward_mean": 9.13392857142857, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.124999999999998, 9.125, 9.166666666666666, 9.041666666666668, 9.125, 9.208333333333334, 9.083333333333332, 9.000000000000002, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.25, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.0, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.041666666666664, 9.083333333333332, 9.124999999999998, 9.083333333333334, 9.041666666666668, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.125, 9.041666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.124999999999998, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.125, 9.083333333333332, 9.166666666666666, 9.124999999999998, 9.041666666666666, 9.083333333333334, 9.25, 9.166666666666666, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.0, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2660924933280069, "mean_inference_ms": 1.203642524900912, "mean_action_processing_ms": 0.10635516242069187, "mean_env_wait_ms": 36.17312297847781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074255597460400925, "StateBufferConnector_ms": 0.0051053015740363155, "ViewRequirementAgentConnector_ms": 0.11095922071855147}}, "episode_reward_max": 9.25, "episode_reward_min": 9.0, "episode_reward_mean": 9.13392857142857, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.124999999999998, 9.125, 9.166666666666666, 9.041666666666668, 9.125, 9.208333333333334, 9.083333333333332, 9.000000000000002, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.25, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.0, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.041666666666664, 9.083333333333332, 9.124999999999998, 9.083333333333334, 9.041666666666668, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.125, 9.041666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.124999999999998, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.125, 9.083333333333332, 9.166666666666666, 9.124999999999998, 9.041666666666666, 9.083333333333334, 9.25, 9.166666666666666, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.0, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2660924933280069, "mean_inference_ms": 1.203642524900912, "mean_action_processing_ms": 0.10635516242069187, "mean_env_wait_ms": 36.17312297847781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074255597460400925, "StateBufferConnector_ms": 0.0051053015740363155, "ViewRequirementAgentConnector_ms": 0.11095922071855147}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.553334754345812, "num_env_steps_trained_throughput_per_sec": 24.553334754345812, "timesteps_total": 112000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 80486.562, "sample_time_ms": 77263.036, "load_time_ms": 12.662, "load_throughput": 157958.811, "learn_time_ms": 3208.299, "learn_throughput": 623.383, "synch_weights_time_ms": 2.14}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 10320, "training_iteration": 56, "trial_id": "13850_00003", "date": "2023-12-28_19-02-53", "timestamp": 1703761373, "time_this_iter_s": 81.4627799987793, "time_total_s": 4523.03745341301, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4523.03745341301, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 55.81896551724138, "ram_util_percent": 92.27672413793098}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.3655745685100546e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.509523114098443, "policy_loss": 0.012539593759510251, "vf_loss": 3.496983519130283, "vf_explained_var": 0.25429736733436586, "kl": 0.02216664988091583, "entropy": 0.5021646102931765, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 25425.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 114000, "num_env_steps_trained": 114000, "num_agent_steps_sampled": 114000, "num_agent_steps_trained": 114000}, "sampler_results": {"episode_reward_max": 9.333333333333334, "episode_reward_min": 9.0, "episode_reward_mean": 9.127518315018316, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.041666666666666, 9.083333333333332, 9.041666666666666, 9.124999999999998, 9.125, 9.041666666666668, 9.333333333333334, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.125, 9.041666666666668, 9.25, 9.166666666666666, 9.083333333333334, 9.166666666666668, 9.083333333333332, 9.083333333333334, 9.125, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.125, 9.125, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.0, 9.208333333333334, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333334, 9.083333333333332, 9.0, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.125, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.0, 9.083333333333332, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.124999999999998, 9.041666666666666, 9.083333333333334, 9.083333333333332, 9.083333333333334, 9.208333333333334, 9.125, 9.125, 9.083333333333332, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.125, 9.124999999999998, 9.124999999999998, 9.125, 9.083333333333332, 9.249999999999998, 9.083333333333334, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.208333333333332, 9.083333333333332, 9.083333333333332, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2658789336031473, "mean_inference_ms": 1.2034605329929167, "mean_action_processing_ms": 0.10634856881127534, "mean_env_wait_ms": 36.17517965362633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073941199334113155, "StateBufferConnector_ms": 0.00509364264351981, "ViewRequirementAgentConnector_ms": 0.11001969431782817}}, "episode_reward_max": 9.333333333333334, "episode_reward_min": 9.0, "episode_reward_mean": 9.127518315018316, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.041666666666666, 9.083333333333332, 9.041666666666666, 9.124999999999998, 9.125, 9.041666666666668, 9.333333333333334, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.125, 9.041666666666668, 9.25, 9.166666666666666, 9.083333333333334, 9.166666666666668, 9.083333333333332, 9.083333333333334, 9.125, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.125, 9.125, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.0, 9.208333333333334, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333334, 9.083333333333332, 9.0, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.125, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.0, 9.083333333333332, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.124999999999998, 9.041666666666666, 9.083333333333334, 9.083333333333332, 9.083333333333334, 9.208333333333334, 9.125, 9.125, 9.083333333333332, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.125, 9.124999999999998, 9.124999999999998, 9.125, 9.083333333333332, 9.249999999999998, 9.083333333333334, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.208333333333332, 9.083333333333332, 9.083333333333332, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2658789336031473, "mean_inference_ms": 1.2034605329929167, "mean_action_processing_ms": 0.10634856881127534, "mean_env_wait_ms": 36.17517965362633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073941199334113155, "StateBufferConnector_ms": 0.00509364264351981, "ViewRequirementAgentConnector_ms": 0.11001969431782817}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114000, "num_agent_steps_trained": 114000, "num_env_steps_sampled": 114000, "num_env_steps_trained": 114000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.7123933945791, "num_env_steps_trained_throughput_per_sec": 24.7123933945791, "timesteps_total": 114000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 114000, "timers": {"training_iteration_time_ms": 80482.962, "sample_time_ms": 77257.4, "load_time_ms": 12.831, "load_throughput": 155867.325, "learn_time_ms": 3210.144, "learn_throughput": 623.025, "synch_weights_time_ms": 2.144}, "counters": {"num_env_steps_sampled": 114000, "num_env_steps_trained": 114000, "num_agent_steps_sampled": 114000, "num_agent_steps_trained": 114000}, "done": false, "episodes_total": 10502, "training_iteration": 57, "trial_id": "13850_00003", "date": "2023-12-28_19-04-14", "timestamp": 1703761454, "time_this_iter_s": 80.93884038925171, "time_total_s": 4603.976293802261, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4603.976293802261, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 55.88782608695652, "ram_util_percent": 92.34695652173913}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.548361852765085e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2201127886772154, "policy_loss": -0.004274809993803501, "vf_loss": 3.22438759220971, "vf_explained_var": 0.3630274862713284, "kl": 0.005884611736565527, "entropy": 0.5383569298850166, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 25875.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 9.166666666666668, "episode_reward_min": 8.916666666666668, "episode_reward_mean": 9.093177655677655, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.125, 9.125, 9.166666666666666, 9.041666666666666, 8.999999999999998, 9.125, 9.083333333333332, 9.041666666666668, 9.083333333333334, 9.124999999999998, 9.125, 9.041666666666666, 9.083333333333334, 9.124999999999998, 9.125, 9.041666666666668, 8.958333333333332, 8.916666666666668, 9.041666666666666, 9.041666666666666, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.041666666666668, 9.125, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.0, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.041666666666666, 9.041666666666668, 9.0, 9.125, 9.166666666666668, 9.125, 9.124999999999998, 9.041666666666664, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.083333333333332, 9.083333333333334, 9.083333333333332, 9.125, 8.999999999999998, 9.125, 9.125, 9.125, 9.125, 8.958333333333332, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.083333333333334, 9.166666666666666, 8.958333333333334, 9.125, 9.125, 9.083333333333334, 8.958333333333336, 9.0, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.083333333333332, 9.083333333333332, 9.083333333333332, 9.041666666666666, 9.0, 9.083333333333334, 9.041666666666668, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.125, 9.125, 9.041666666666666, 9.041666666666666, 9.125, 9.083333333333332, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 8.958333333333334, 9.041666666666666, 9.083333333333332, 9.083333333333334, 9.083333333333332, 9.041666666666664, 9.125, 9.166666666666666, 9.166666666666666, 9.0, 9.125000000000002, 9.166666666666668, 9.083333333333332, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.0, 9.0, 9.000000000000002, 9.041666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.125, 9.083333333333332, 8.958333333333332, 9.125, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.125, 8.958333333333332, 9.083333333333332, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.0, 9.041666666666668, 9.166666666666666, 9.083333333333334, 9.0, 9.124999999999998, 9.083333333333334, 9.083333333333332, 9.083333333333332, 9.083333333333332, 9.083333333333334, 9.041666666666666, 9.125, 9.125, 9.125, 9.125, 8.999999999999998, 9.041666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.124999999999998, 9.083333333333334, 9.041666666666668, 8.999999999999998, 9.166666666666666, 8.958333333333332, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.083333333333334, 9.124999999999998, 9.083333333333334, 9.125], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2658988883479483, "mean_inference_ms": 1.203383932117676, "mean_action_processing_ms": 0.10636095936915523, "mean_env_wait_ms": 36.18033813333315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00742529774760152, "StateBufferConnector_ms": 0.0051493173117166035, "ViewRequirementAgentConnector_ms": 0.11061508576948564}}, "episode_reward_max": 9.166666666666668, "episode_reward_min": 8.916666666666668, "episode_reward_mean": 9.093177655677655, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.125, 9.125, 9.166666666666666, 9.041666666666666, 8.999999999999998, 9.125, 9.083333333333332, 9.041666666666668, 9.083333333333334, 9.124999999999998, 9.125, 9.041666666666666, 9.083333333333334, 9.124999999999998, 9.125, 9.041666666666668, 8.958333333333332, 8.916666666666668, 9.041666666666666, 9.041666666666666, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.041666666666668, 9.125, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.0, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.041666666666666, 9.041666666666668, 9.0, 9.125, 9.166666666666668, 9.125, 9.124999999999998, 9.041666666666664, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.083333333333332, 9.083333333333334, 9.083333333333332, 9.125, 8.999999999999998, 9.125, 9.125, 9.125, 9.125, 8.958333333333332, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.083333333333334, 9.166666666666666, 8.958333333333334, 9.125, 9.125, 9.083333333333334, 8.958333333333336, 9.0, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.083333333333332, 9.083333333333332, 9.083333333333332, 9.041666666666666, 9.0, 9.083333333333334, 9.041666666666668, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.125, 9.125, 9.041666666666666, 9.041666666666666, 9.125, 9.083333333333332, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 8.958333333333334, 9.041666666666666, 9.083333333333332, 9.083333333333334, 9.083333333333332, 9.041666666666664, 9.125, 9.166666666666666, 9.166666666666666, 9.0, 9.125000000000002, 9.166666666666668, 9.083333333333332, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.0, 9.0, 9.000000000000002, 9.041666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.125, 9.083333333333332, 8.958333333333332, 9.125, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.125, 8.958333333333332, 9.083333333333332, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.0, 9.041666666666668, 9.166666666666666, 9.083333333333334, 9.0, 9.124999999999998, 9.083333333333334, 9.083333333333332, 9.083333333333332, 9.083333333333332, 9.083333333333334, 9.041666666666666, 9.125, 9.125, 9.125, 9.125, 8.999999999999998, 9.041666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.124999999999998, 9.083333333333334, 9.041666666666668, 8.999999999999998, 9.166666666666666, 8.958333333333332, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.083333333333334, 9.124999999999998, 9.083333333333334, 9.125], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2658988883479483, "mean_inference_ms": 1.203383932117676, "mean_action_processing_ms": 0.10636095936915523, "mean_env_wait_ms": 36.18033813333315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00742529774760152, "StateBufferConnector_ms": 0.0051493173117166035, "ViewRequirementAgentConnector_ms": 0.11061508576948564}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.587353186322698, "num_env_steps_trained_throughput_per_sec": 24.587353186322698, "timesteps_total": 116000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 80538.223, "sample_time_ms": 77314.685, "load_time_ms": 12.678, "load_throughput": 157756.811, "learn_time_ms": 3208.281, "learn_throughput": 623.387, "synch_weights_time_ms": 2.127}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 10684, "training_iteration": 58, "trial_id": "13850_00003", "date": "2023-12-28_19-05-35", "timestamp": 1703761535, "time_this_iter_s": 81.34994864463806, "time_total_s": 4685.326242446899, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4685.326242446899, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 55.973275862068974, "ram_util_percent": 92.3956896551724}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.548361852765085e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.368618188963996, "policy_loss": 0.009362863683038288, "vf_loss": 3.35925531996621, "vf_explained_var": 0.3856933919588725, "kl": 0.0038037807354032362, "entropy": 0.5921338930394915, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 26325.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 118000, "num_env_steps_trained": 118000, "num_agent_steps_sampled": 118000, "num_agent_steps_trained": 118000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 1.6666666666666667, "episode_reward_mean": 9.066849816849818, "episode_len_mean": 10.956043956043956, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.125, 9.083333333333334, 9.125, 9.166666666666666, 9.000000000000002, 9.124999999999998, 9.041666666666664, 9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.0, 9.125, 9.125, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.041666666666666, 9.125, 9.083333333333334, 9.124999999999998, 9.125, 9.125, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.25, 9.208333333333332, 9.083333333333334, 9.166666666666666, 8.999999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.041666666666666, 9.124999999999998, 9.041666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.0, 9.125, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.083333333333334, 9.041666666666666, 9.125, 9.083333333333332, 9.125, 9.125, 9.125, 9.124999999999998, 9.041666666666668, 9.125, 9.125, 9.125, 9.083333333333334, 9.125, 9.124999999999998, 9.041666666666666, 9.083333333333332, 9.25, 9.166666666666668, 9.124999999999998, 9.083333333333332, 9.124999999999998, 9.125, 9.208333333333334, 9.166666666666666, 9.041666666666664, 9.125, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.166666666666666, 9.0, 9.041666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 8.958333333333334, 9.166666666666666, 9.083333333333332, 9.124999999999998, 9.124999999999998, 9.083333333333334, 9.041666666666668, 9.166666666666666, 9.125, 9.166666666666666, 9.0, 9.125, 9.125, 9.041666666666668, 9.125, 9.0, 9.125, 9.124999999999998, 9.125, 9.041666666666668, 8.916666666666666, 9.041666666666668, 9.083333333333334, 9.124999999999998, 9.000000000000002, 1.6666666666666667, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.041666666666668, 9.0, 9.041666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.125, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.166666666666666, 9.0, 9.083333333333334, 9.166666666666666, 9.166666666666666, 8.958333333333332, 9.125, 9.041666666666664, 9.125, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.083333333333332, 9.208333333333332, 9.125, 9.0, 9.000000000000002, 9.041666666666668, 9.166666666666666, 9.083333333333332, 9.208333333333334, 9.166666666666666, 9.041666666666666, 9.041666666666666, 9.208333333333334, 9.083333333333334, 9.083333333333332, 9.124999999999998, 9.083333333333334, 9.083333333333334, 9.083333333333332, 9.041666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2655287031155493, "mean_inference_ms": 1.2031186874730644, "mean_action_processing_ms": 0.1063398587063314, "mean_env_wait_ms": 36.17383557444256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074454716273716515, "StateBufferConnector_ms": 0.005217829903403482, "ViewRequirementAgentConnector_ms": 0.11019706726074219}}, "episode_reward_max": 9.25, "episode_reward_min": 1.6666666666666667, "episode_reward_mean": 9.066849816849818, "episode_len_mean": 10.956043956043956, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.125, 9.083333333333334, 9.125, 9.166666666666666, 9.000000000000002, 9.124999999999998, 9.041666666666664, 9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.0, 9.125, 9.125, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.041666666666666, 9.125, 9.083333333333334, 9.124999999999998, 9.125, 9.125, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.25, 9.208333333333332, 9.083333333333334, 9.166666666666666, 8.999999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.041666666666666, 9.124999999999998, 9.041666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.0, 9.125, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.083333333333334, 9.041666666666666, 9.125, 9.083333333333332, 9.125, 9.125, 9.125, 9.124999999999998, 9.041666666666668, 9.125, 9.125, 9.125, 9.083333333333334, 9.125, 9.124999999999998, 9.041666666666666, 9.083333333333332, 9.25, 9.166666666666668, 9.124999999999998, 9.083333333333332, 9.124999999999998, 9.125, 9.208333333333334, 9.166666666666666, 9.041666666666664, 9.125, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.166666666666666, 9.0, 9.041666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 8.958333333333334, 9.166666666666666, 9.083333333333332, 9.124999999999998, 9.124999999999998, 9.083333333333334, 9.041666666666668, 9.166666666666666, 9.125, 9.166666666666666, 9.0, 9.125, 9.125, 9.041666666666668, 9.125, 9.0, 9.125, 9.124999999999998, 9.125, 9.041666666666668, 8.916666666666666, 9.041666666666668, 9.083333333333334, 9.124999999999998, 9.000000000000002, 1.6666666666666667, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.041666666666668, 9.0, 9.041666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.125, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.166666666666666, 9.0, 9.083333333333334, 9.166666666666666, 9.166666666666666, 8.958333333333332, 9.125, 9.041666666666664, 9.125, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.083333333333332, 9.208333333333332, 9.125, 9.0, 9.000000000000002, 9.041666666666668, 9.166666666666666, 9.083333333333332, 9.208333333333334, 9.166666666666666, 9.041666666666666, 9.041666666666666, 9.208333333333334, 9.083333333333334, 9.083333333333332, 9.124999999999998, 9.083333333333334, 9.083333333333334, 9.083333333333332, 9.041666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2655287031155493, "mean_inference_ms": 1.2031186874730644, "mean_action_processing_ms": 0.1063398587063314, "mean_env_wait_ms": 36.17383557444256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074454716273716515, "StateBufferConnector_ms": 0.005217829903403482, "ViewRequirementAgentConnector_ms": 0.11019706726074219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118000, "num_agent_steps_trained": 118000, "num_env_steps_sampled": 118000, "num_env_steps_trained": 118000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 25.02335478072369, "num_env_steps_trained_throughput_per_sec": 25.02335478072369, "timesteps_total": 118000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 118000, "timers": {"training_iteration_time_ms": 80556.795, "sample_time_ms": 77334.574, "load_time_ms": 11.979, "load_throughput": 166955.414, "learn_time_ms": 3207.661, "learn_throughput": 623.507, "synch_weights_time_ms": 2.129}, "counters": {"num_env_steps_sampled": 118000, "num_env_steps_trained": 118000, "num_agent_steps_sampled": 118000, "num_agent_steps_trained": 118000}, "done": false, "episodes_total": 10866, "training_iteration": 59, "trial_id": "13850_00003", "date": "2023-12-28_19-06-55", "timestamp": 1703761615, "time_this_iter_s": 79.93256187438965, "time_total_s": 4765.258804321289, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4765.258804321289, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 55.862280701754386, "ram_util_percent": 92.44298245614037}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.2741809263825425e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4021787492434186, "policy_loss": 0.013148618427415689, "vf_loss": 3.3890301296446057, "vf_explained_var": 0.36127583384513856, "kl": 0.007393939751657316, "entropy": 0.5262462999423345, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 26775.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 1.7500000000000002, "episode_reward_mean": 9.058287795992715, "episode_len_mean": 10.956284153005464, "episode_media": {}, "episodes_this_iter": 183, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.041666666666668, 9.083333333333332, 9.124999999999998, 9.083333333333332, 9.041666666666666, 9.208333333333332, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.083333333333334, 9.083333333333334, 9.083333333333332, 9.0, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.0, 9.166666666666666, 9.208333333333334, 9.041666666666668, 9.0, 9.166666666666666, 8.999999999999998, 8.916666666666666, 9.041666666666666, 9.166666666666666, 8.958333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.083333333333334, 9.125, 9.125, 9.0, 9.166666666666666, 9.0, 9.041666666666666, 9.124999999999998, 9.041666666666666, 9.041666666666668, 9.083333333333332, 9.208333333333334, 9.083333333333332, 9.083333333333334, 9.083333333333332, 9.125, 8.958333333333332, 9.041666666666666, 9.124999999999998, 9.25, 9.166666666666666, 9.083333333333332, 8.958333333333332, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.0, 9.208333333333334, 9.083333333333334, 9.124999999999998, 9.125, 9.124999999999998, 9.125, 1.7500000000000002, 9.041666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.041666666666666, 9.125, 9.041666666666666, 9.25, 9.041666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 8.958333333333332, 9.208333333333334, 9.166666666666666, 9.25, 9.083333333333332, 9.083333333333332, 8.958333333333332, 9.166666666666666, 9.125, 8.999999999999998, 9.041666666666666, 9.125, 9.166666666666666, 8.958333333333332, 9.041666666666668, 9.0, 9.083333333333334, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.041666666666664, 9.083333333333332, 9.041666666666666, 9.041666666666664, 9.041666666666668, 9.166666666666666, 9.041666666666668, 9.083333333333334, 9.083333333333334, 9.041666666666666, 9.083333333333334, 9.083333333333332, 9.041666666666668, 9.124999999999998, 8.999999999999998, 9.166666666666666, 9.0, 9.125, 9.124999999999998, 8.958333333333334, 9.0, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.041666666666666, 9.041666666666666, 9.041666666666666, 9.125, 9.0, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.125, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.0, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.0, 9.041666666666668, 9.125, 9.125, 9.125, 9.166666666666666, 8.916666666666668, 9.125, 9.041666666666668, 9.125, 9.125, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.125], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2655286073452237, "mean_inference_ms": 1.2030766108253774, "mean_action_processing_ms": 0.10634708592890127, "mean_env_wait_ms": 36.18036461780859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075874432839982495, "StateBufferConnector_ms": 0.005195049640259456, "ViewRequirementAgentConnector_ms": 0.11070895064723947}}, "episode_reward_max": 9.25, "episode_reward_min": 1.7500000000000002, "episode_reward_mean": 9.058287795992715, "episode_len_mean": 10.956284153005464, "episodes_this_iter": 183, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.041666666666668, 9.083333333333332, 9.124999999999998, 9.083333333333332, 9.041666666666666, 9.208333333333332, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.083333333333334, 9.083333333333334, 9.083333333333332, 9.0, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.0, 9.166666666666666, 9.208333333333334, 9.041666666666668, 9.0, 9.166666666666666, 8.999999999999998, 8.916666666666666, 9.041666666666666, 9.166666666666666, 8.958333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.083333333333334, 9.125, 9.125, 9.0, 9.166666666666666, 9.0, 9.041666666666666, 9.124999999999998, 9.041666666666666, 9.041666666666668, 9.083333333333332, 9.208333333333334, 9.083333333333332, 9.083333333333334, 9.083333333333332, 9.125, 8.958333333333332, 9.041666666666666, 9.124999999999998, 9.25, 9.166666666666666, 9.083333333333332, 8.958333333333332, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.0, 9.208333333333334, 9.083333333333334, 9.124999999999998, 9.125, 9.124999999999998, 9.125, 1.7500000000000002, 9.041666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.041666666666666, 9.125, 9.041666666666666, 9.25, 9.041666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 8.958333333333332, 9.208333333333334, 9.166666666666666, 9.25, 9.083333333333332, 9.083333333333332, 8.958333333333332, 9.166666666666666, 9.125, 8.999999999999998, 9.041666666666666, 9.125, 9.166666666666666, 8.958333333333332, 9.041666666666668, 9.0, 9.083333333333334, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.041666666666664, 9.083333333333332, 9.041666666666666, 9.041666666666664, 9.041666666666668, 9.166666666666666, 9.041666666666668, 9.083333333333334, 9.083333333333334, 9.041666666666666, 9.083333333333334, 9.083333333333332, 9.041666666666668, 9.124999999999998, 8.999999999999998, 9.166666666666666, 9.0, 9.125, 9.124999999999998, 8.958333333333334, 9.0, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.041666666666666, 9.041666666666666, 9.041666666666666, 9.125, 9.0, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.125, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.0, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.0, 9.041666666666668, 9.125, 9.125, 9.125, 9.166666666666666, 8.916666666666668, 9.125, 9.041666666666668, 9.125, 9.125, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.125], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2655286073452237, "mean_inference_ms": 1.2030766108253774, "mean_action_processing_ms": 0.10634708592890127, "mean_env_wait_ms": 36.18036461780859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075874432839982495, "StateBufferConnector_ms": 0.005195049640259456, "ViewRequirementAgentConnector_ms": 0.11070895064723947}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.521374423859623, "num_env_steps_trained_throughput_per_sec": 24.521374423859623, "timesteps_total": 120000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 80662.456, "sample_time_ms": 77442.636, "load_time_ms": 12.272, "load_throughput": 162976.416, "learn_time_ms": 3204.975, "learn_throughput": 624.03, "synch_weights_time_ms": 2.126}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 11049, "training_iteration": 60, "trial_id": "13850_00003", "date": "2023-12-28_19-08-17", "timestamp": 1703761697, "time_this_iter_s": 81.56861996650696, "time_total_s": 4846.827424287796, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4846.827424287796, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 56.116379310344826, "ram_util_percent": 92.42500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.2741809263825425e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7141634395387437, "policy_loss": -0.011628756622473398, "vf_loss": 3.7257921976513333, "vf_explained_var": 0.31424397375848556, "kl": 0.007915932772491531, "entropy": 0.5766213425662783, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 27225.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 122000, "num_env_steps_trained": 122000, "num_agent_steps_sampled": 122000, "num_agent_steps_trained": 122000}, "sampler_results": {"episode_reward_max": 9.208333333333332, "episode_reward_min": 1.6666666666666667, "episode_reward_mean": 9.051912568306012, "episode_len_mean": 10.956284153005464, "episode_media": {}, "episodes_this_iter": 183, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.083333333333334, 9.0, 9.041666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.041666666666666, 9.041666666666666, 8.958333333333332, 9.125, 9.124999999999998, 9.041666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.041666666666666, 9.124999999999998, 9.125, 9.125, 9.0, 9.041666666666666, 9.166666666666666, 8.958333333333334, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.041666666666668, 9.041666666666668, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.041666666666664, 9.166666666666666, 9.041666666666668, 9.083333333333332, 9.041666666666668, 9.125, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 8.999999999999998, 9.083333333333334, 9.0, 9.166666666666666, 9.166666666666666, 9.125, 9.0, 9.125, 9.083333333333334, 9.166666666666666, 8.958333333333334, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.124999999999998, 9.125, 9.166666666666666, 8.916666666666666, 9.041666666666668, 9.083333333333334, 9.166666666666666, 8.999999999999998, 9.083333333333332, 9.0, 9.125, 9.041666666666666, 9.083333333333332, 9.166666666666666, 8.958333333333336, 9.124999999999998, 9.125, 9.083333333333332, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.0, 9.125, 9.166666666666666, 9.125, 9.0, 9.041666666666668, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.125, 8.874999999999998, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 8.958333333333332, 8.958333333333332, 9.166666666666666, 9.041666666666666, 9.0, 9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 8.833333333333334, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.124999999999998, 8.958333333333334, 9.166666666666668, 9.083333333333332, 9.125, 8.958333333333332, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.125, 9.083333333333334, 9.0, 9.125, 9.0, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.041666666666664, 8.958333333333332, 9.0, 9.083333333333334, 9.166666666666666, 9.166666666666666, 8.916666666666666, 9.083333333333332, 9.083333333333334, 9.208333333333332, 9.166666666666666, 9.041666666666668, 9.041666666666668, 1.6666666666666667, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.0, 8.958333333333334, 9.124999999999998, 9.083333333333334, 8.999999999999998, 9.041666666666666, 9.166666666666666, 8.958333333333334, 9.041666666666668, 9.125, 9.041666666666666, 9.083333333333334, 9.0, 9.166666666666666, 9.083333333333334, 9.125, 9.125, 9.083333333333334, 9.083333333333332, 9.083333333333332], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2656538945002784, "mean_inference_ms": 1.203078459370733, "mean_action_processing_ms": 0.10637060120332803, "mean_env_wait_ms": 36.187131311405665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074837377162578975, "StateBufferConnector_ms": 0.005179936768578701, "ViewRequirementAgentConnector_ms": 0.11090997789726882}}, "episode_reward_max": 9.208333333333332, "episode_reward_min": 1.6666666666666667, "episode_reward_mean": 9.051912568306012, "episode_len_mean": 10.956284153005464, "episodes_this_iter": 183, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.083333333333334, 9.0, 9.041666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.041666666666666, 9.041666666666666, 8.958333333333332, 9.125, 9.124999999999998, 9.041666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.041666666666666, 9.124999999999998, 9.125, 9.125, 9.0, 9.041666666666666, 9.166666666666666, 8.958333333333334, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.041666666666668, 9.041666666666668, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.041666666666664, 9.166666666666666, 9.041666666666668, 9.083333333333332, 9.041666666666668, 9.125, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 8.999999999999998, 9.083333333333334, 9.0, 9.166666666666666, 9.166666666666666, 9.125, 9.0, 9.125, 9.083333333333334, 9.166666666666666, 8.958333333333334, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.124999999999998, 9.125, 9.166666666666666, 8.916666666666666, 9.041666666666668, 9.083333333333334, 9.166666666666666, 8.999999999999998, 9.083333333333332, 9.0, 9.125, 9.041666666666666, 9.083333333333332, 9.166666666666666, 8.958333333333336, 9.124999999999998, 9.125, 9.083333333333332, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.0, 9.125, 9.166666666666666, 9.125, 9.0, 9.041666666666668, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.125, 8.874999999999998, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 8.958333333333332, 8.958333333333332, 9.166666666666666, 9.041666666666666, 9.0, 9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 8.833333333333334, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.124999999999998, 8.958333333333334, 9.166666666666668, 9.083333333333332, 9.125, 8.958333333333332, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.125, 9.083333333333334, 9.0, 9.125, 9.0, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.041666666666664, 8.958333333333332, 9.0, 9.083333333333334, 9.166666666666666, 9.166666666666666, 8.916666666666666, 9.083333333333332, 9.083333333333334, 9.208333333333332, 9.166666666666666, 9.041666666666668, 9.041666666666668, 1.6666666666666667, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.0, 8.958333333333334, 9.124999999999998, 9.083333333333334, 8.999999999999998, 9.041666666666666, 9.166666666666666, 8.958333333333334, 9.041666666666668, 9.125, 9.041666666666666, 9.083333333333334, 9.0, 9.166666666666666, 9.083333333333334, 9.125, 9.125, 9.083333333333334, 9.083333333333332, 9.083333333333332], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2656538945002784, "mean_inference_ms": 1.203078459370733, "mean_action_processing_ms": 0.10637060120332803, "mean_env_wait_ms": 36.187131311405665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074837377162578975, "StateBufferConnector_ms": 0.005179936768578701, "ViewRequirementAgentConnector_ms": 0.11090997789726882}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122000, "num_agent_steps_trained": 122000, "num_env_steps_sampled": 122000, "num_env_steps_trained": 122000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.499536778237818, "num_env_steps_trained_throughput_per_sec": 24.499536778237818, "timesteps_total": 122000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 122000, "timers": {"training_iteration_time_ms": 80818.807, "sample_time_ms": 77599.62, "load_time_ms": 10.748, "load_throughput": 186076.919, "learn_time_ms": 3205.868, "learn_throughput": 623.856, "synch_weights_time_ms": 2.128}, "counters": {"num_env_steps_sampled": 122000, "num_env_steps_trained": 122000, "num_agent_steps_sampled": 122000, "num_agent_steps_trained": 122000}, "done": false, "episodes_total": 11232, "training_iteration": 61, "trial_id": "13850_00003", "date": "2023-12-28_19-09-38", "timestamp": 1703761778, "time_this_iter_s": 81.64165806770325, "time_total_s": 4928.469082355499, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4928.469082355499, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 55.774137931034474, "ram_util_percent": 92.46982758620689}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.2741809263825425e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2294964938693576, "policy_loss": 0.0062610807435380085, "vf_loss": 3.2232354142930775, "vf_explained_var": 0.33650989439752366, "kl": 0.004954008170840261, "entropy": 0.5941992709371778, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 27675.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 9.291666666666664, "episode_reward_min": 8.958333333333332, "episode_reward_mean": 9.09875690607735, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.124999999999998, 9.083333333333334, 8.999999999999998, 9.124999999999998, 9.166666666666666, 9.25, 9.083333333333332, 9.125, 9.166666666666666, 9.124999999999998, 9.125, 9.125, 9.083333333333334, 9.0, 9.291666666666664, 9.041666666666668, 9.041666666666668, 9.166666666666666, 8.999999999999998, 9.041666666666668, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.083333333333332, 9.083333333333334, 8.958333333333332, 9.166666666666666, 9.0, 8.958333333333332, 9.166666666666666, 9.125, 8.999999999999998, 9.25, 9.125, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.083333333333332, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.0, 9.0, 9.083333333333332, 8.999999999999998, 9.166666666666666, 9.041666666666668, 9.041666666666668, 9.124999999999998, 9.166666666666666, 9.125, 9.125, 9.083333333333332, 9.083333333333332, 9.125, 9.208333333333334, 9.083333333333334, 9.041666666666666, 9.000000000000002, 8.958333333333332, 9.166666666666666, 9.0, 9.25, 9.083333333333332, 9.041666666666664, 9.0, 9.000000000000002, 9.041666666666666, 9.083333333333332, 9.041666666666666, 9.041666666666668, 8.999999999999998, 9.125, 9.125, 8.999999999999998, 9.166666666666666, 9.166666666666666, 9.124999999999998, 8.958333333333334, 9.0, 9.041666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.0, 9.124999999999998, 9.083333333333334, 9.125, 9.083333333333332, 9.166666666666666, 9.083333333333332, 9.0, 9.083333333333334, 9.083333333333332, 9.125, 9.124999999999998, 9.125, 9.125, 9.041666666666668, 9.25, 9.125, 9.124999999999998, 9.125, 9.166666666666666, 9.041666666666666, 9.124999999999998, 9.166666666666666, 8.958333333333334, 9.083333333333332, 9.125, 9.125, 9.0, 9.124999999999998, 8.999999999999998, 9.166666666666668, 9.166666666666666, 8.999999999999998, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.041666666666666, 9.125, 8.958333333333332, 9.125, 9.083333333333334, 9.166666666666666, 9.125, 9.041666666666666, 9.125, 9.083333333333332, 9.125, 9.125, 9.041666666666666, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.208333333333334, 8.958333333333334, 9.041666666666666, 9.166666666666666, 9.125, 9.125, 9.250000000000002, 9.083333333333334, 9.166666666666666, 8.958333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.124999999999998, 9.125, 9.083333333333332, 9.041666666666668, 9.083333333333334, 9.083333333333332, 9.25, 9.041666666666666, 9.083333333333332, 9.083333333333332, 9.124999999999998, 9.083333333333332, 9.0], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2652053762713356, "mean_inference_ms": 1.2028758559938129, "mean_action_processing_ms": 0.10635935663508794, "mean_env_wait_ms": 36.18017834104505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007455783654313061, "StateBufferConnector_ms": 0.005053288370206212, "ViewRequirementAgentConnector_ms": 0.10984576209474005}}, "episode_reward_max": 9.291666666666664, "episode_reward_min": 8.958333333333332, "episode_reward_mean": 9.09875690607735, "episode_len_mean": 11.0, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.124999999999998, 9.083333333333334, 8.999999999999998, 9.124999999999998, 9.166666666666666, 9.25, 9.083333333333332, 9.125, 9.166666666666666, 9.124999999999998, 9.125, 9.125, 9.083333333333334, 9.0, 9.291666666666664, 9.041666666666668, 9.041666666666668, 9.166666666666666, 8.999999999999998, 9.041666666666668, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.083333333333332, 9.083333333333334, 8.958333333333332, 9.166666666666666, 9.0, 8.958333333333332, 9.166666666666666, 9.125, 8.999999999999998, 9.25, 9.125, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.083333333333332, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.0, 9.0, 9.083333333333332, 8.999999999999998, 9.166666666666666, 9.041666666666668, 9.041666666666668, 9.124999999999998, 9.166666666666666, 9.125, 9.125, 9.083333333333332, 9.083333333333332, 9.125, 9.208333333333334, 9.083333333333334, 9.041666666666666, 9.000000000000002, 8.958333333333332, 9.166666666666666, 9.0, 9.25, 9.083333333333332, 9.041666666666664, 9.0, 9.000000000000002, 9.041666666666666, 9.083333333333332, 9.041666666666666, 9.041666666666668, 8.999999999999998, 9.125, 9.125, 8.999999999999998, 9.166666666666666, 9.166666666666666, 9.124999999999998, 8.958333333333334, 9.0, 9.041666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.0, 9.124999999999998, 9.083333333333334, 9.125, 9.083333333333332, 9.166666666666666, 9.083333333333332, 9.0, 9.083333333333334, 9.083333333333332, 9.125, 9.124999999999998, 9.125, 9.125, 9.041666666666668, 9.25, 9.125, 9.124999999999998, 9.125, 9.166666666666666, 9.041666666666666, 9.124999999999998, 9.166666666666666, 8.958333333333334, 9.083333333333332, 9.125, 9.125, 9.0, 9.124999999999998, 8.999999999999998, 9.166666666666668, 9.166666666666666, 8.999999999999998, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.041666666666666, 9.125, 8.958333333333332, 9.125, 9.083333333333334, 9.166666666666666, 9.125, 9.041666666666666, 9.125, 9.083333333333332, 9.125, 9.125, 9.041666666666666, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.208333333333334, 8.958333333333334, 9.041666666666666, 9.166666666666666, 9.125, 9.125, 9.250000000000002, 9.083333333333334, 9.166666666666666, 8.958333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.124999999999998, 9.125, 9.083333333333332, 9.041666666666668, 9.083333333333334, 9.083333333333332, 9.25, 9.041666666666666, 9.083333333333332, 9.083333333333332, 9.124999999999998, 9.083333333333332, 9.0], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2652053762713356, "mean_inference_ms": 1.2028758559938129, "mean_action_processing_ms": 0.10635935663508794, "mean_env_wait_ms": 36.18017834104505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007455783654313061, "StateBufferConnector_ms": 0.005053288370206212, "ViewRequirementAgentConnector_ms": 0.10984576209474005}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 25.030613282740706, "num_env_steps_trained_throughput_per_sec": 25.030613282740706, "timesteps_total": 124000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 80736.877, "sample_time_ms": 77513.963, "load_time_ms": 10.783, "load_throughput": 185472.547, "learn_time_ms": 3209.564, "learn_throughput": 623.138, "synch_weights_time_ms": 2.122}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 11413, "training_iteration": 62, "trial_id": "13850_00003", "date": "2023-12-28_19-10-58", "timestamp": 1703761858, "time_this_iter_s": 79.90935349464417, "time_total_s": 5008.378435850143, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5008.378435850143, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 55.984210526315785, "ram_util_percent": 92.42894736842106}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6370904631912713e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6972582467397053, "policy_loss": 0.004742248902718226, "vf_loss": 3.6925159973568387, "vf_explained_var": 0.3023598371611701, "kl": 0.00850158623581053, "entropy": 0.5559462622139189, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 28125.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "sampler_results": {"episode_reward_max": 9.250000000000002, "episode_reward_min": 8.916666666666666, "episode_reward_mean": 9.089056776556776, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.083333333333332, 8.958333333333334, 9.041666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.125, 9.125, 9.041666666666668, 9.166666666666666, 9.0, 9.208333333333334, 8.916666666666666, 9.166666666666666, 9.124999999999998, 9.0, 9.166666666666666, 9.083333333333334, 9.125, 9.083333333333332, 9.125, 9.041666666666668, 9.125, 9.124999999999998, 9.0, 9.166666666666666, 8.958333333333332, 8.958333333333334, 9.25, 9.166666666666666, 9.0, 9.083333333333332, 8.958333333333334, 9.0, 9.208333333333332, 8.958333333333334, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.125, 9.083333333333334, 9.124999999999998, 9.083333333333334, 9.083333333333332, 9.083333333333332, 9.125, 9.166666666666664, 9.041666666666666, 9.0, 8.958333333333332, 9.166666666666666, 9.125, 9.041666666666668, 9.125, 9.125, 9.166666666666666, 9.125, 9.0, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.083333333333334, 8.958333333333332, 9.041666666666666, 9.0, 9.083333333333332, 9.166666666666666, 9.083333333333332, 9.125, 9.125, 9.0, 9.208333333333332, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.125, 9.166666666666666, 9.041666666666666, 9.083333333333332, 8.958333333333334, 9.0, 8.958333333333334, 9.125, 9.166666666666666, 9.083333333333334, 9.041666666666664, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.041666666666668, 9.083333333333332, 9.0, 8.916666666666666, 9.000000000000002, 9.000000000000002, 9.125, 9.125, 9.125, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.041666666666666, 8.916666666666666, 9.083333333333332, 9.041666666666666, 9.083333333333332, 9.125, 9.083333333333334, 9.166666666666666, 9.041666666666668, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.041666666666666, 9.041666666666666, 9.041666666666666, 8.958333333333332, 8.958333333333332, 9.041666666666668, 9.124999999999998, 9.041666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.041666666666666, 9.083333333333332, 9.083333333333334, 8.958333333333334, 9.083333333333334, 9.166666666666666, 9.125, 9.250000000000002, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.083333333333332, 9.125, 9.083333333333332, 8.916666666666668, 9.208333333333334, 9.125, 9.083333333333332, 9.125, 9.083333333333334, 9.083333333333332, 9.124999999999998, 9.125, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.125, 9.0, 9.041666666666666, 9.0, 9.083333333333332, 9.041666666666666, 9.125, 9.166666666666666, 9.125, 8.958333333333332, 9.041666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2652739457789455, "mean_inference_ms": 1.2029480015860385, "mean_action_processing_ms": 0.1063828786173826, "mean_env_wait_ms": 36.18782928490049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00747154047200968, "StateBufferConnector_ms": 0.005099930606045566, "ViewRequirementAgentConnector_ms": 0.11142583993765023}}, "episode_reward_max": 9.250000000000002, "episode_reward_min": 8.916666666666666, "episode_reward_mean": 9.089056776556776, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.083333333333332, 8.958333333333334, 9.041666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.125, 9.125, 9.041666666666668, 9.166666666666666, 9.0, 9.208333333333334, 8.916666666666666, 9.166666666666666, 9.124999999999998, 9.0, 9.166666666666666, 9.083333333333334, 9.125, 9.083333333333332, 9.125, 9.041666666666668, 9.125, 9.124999999999998, 9.0, 9.166666666666666, 8.958333333333332, 8.958333333333334, 9.25, 9.166666666666666, 9.0, 9.083333333333332, 8.958333333333334, 9.0, 9.208333333333332, 8.958333333333334, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.166666666666666, 9.125, 9.124999999999998, 9.125, 9.125, 9.083333333333334, 9.124999999999998, 9.083333333333334, 9.083333333333332, 9.083333333333332, 9.125, 9.166666666666664, 9.041666666666666, 9.0, 8.958333333333332, 9.166666666666666, 9.125, 9.041666666666668, 9.125, 9.125, 9.166666666666666, 9.125, 9.0, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.083333333333334, 8.958333333333332, 9.041666666666666, 9.0, 9.083333333333332, 9.166666666666666, 9.083333333333332, 9.125, 9.125, 9.0, 9.208333333333332, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.125, 9.166666666666666, 9.041666666666666, 9.083333333333332, 8.958333333333334, 9.0, 8.958333333333334, 9.125, 9.166666666666666, 9.083333333333334, 9.041666666666664, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.041666666666668, 9.083333333333332, 9.0, 8.916666666666666, 9.000000000000002, 9.000000000000002, 9.125, 9.125, 9.125, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.041666666666666, 8.916666666666666, 9.083333333333332, 9.041666666666666, 9.083333333333332, 9.125, 9.083333333333334, 9.166666666666666, 9.041666666666668, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.041666666666666, 9.041666666666666, 9.041666666666666, 8.958333333333332, 8.958333333333332, 9.041666666666668, 9.124999999999998, 9.041666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.041666666666666, 9.083333333333332, 9.083333333333334, 8.958333333333334, 9.083333333333334, 9.166666666666666, 9.125, 9.250000000000002, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.083333333333332, 9.125, 9.083333333333332, 8.916666666666668, 9.208333333333334, 9.125, 9.083333333333332, 9.125, 9.083333333333334, 9.083333333333332, 9.124999999999998, 9.125, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.125, 9.0, 9.041666666666666, 9.0, 9.083333333333332, 9.041666666666666, 9.125, 9.166666666666666, 9.125, 8.958333333333332, 9.041666666666666, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2652739457789455, "mean_inference_ms": 1.2029480015860385, "mean_action_processing_ms": 0.1063828786173826, "mean_env_wait_ms": 36.18782928490049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00747154047200968, "StateBufferConnector_ms": 0.005099930606045566, "ViewRequirementAgentConnector_ms": 0.11142583993765023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.4641194656537, "num_env_steps_trained_throughput_per_sec": 24.4641194656537, "timesteps_total": 126000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 126000, "timers": {"training_iteration_time_ms": 80908.13, "sample_time_ms": 77682.737, "load_time_ms": 11.158, "load_throughput": 179243.761, "learn_time_ms": 3211.66, "learn_throughput": 622.731, "synch_weights_time_ms": 2.126}, "counters": {"num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "done": false, "episodes_total": 11595, "training_iteration": 63, "trial_id": "13850_00003", "date": "2023-12-28_19-12-20", "timestamp": 1703761940, "time_this_iter_s": 81.75942254066467, "time_total_s": 5090.137858390808, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5090.137858390808, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 55.86120689655172, "ram_util_percent": 92.46120689655172}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6370904631912713e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1880204317304823, "policy_loss": -0.005130359613233142, "vf_loss": 3.1931507929166156, "vf_explained_var": 0.36901932266023424, "kl": 0.0047061661279789, "entropy": 0.5231872454616758, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 28575.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 9.249999999999998, "episode_reward_min": 8.875, "episode_reward_mean": 9.092490842490843, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.041666666666666, 9.041666666666666, 8.916666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.125, 9.0, 9.166666666666666, 8.916666666666666, 9.125, 9.124999999999998, 9.083333333333332, 9.125, 9.166666666666666, 9.208333333333332, 9.124999999999998, 9.083333333333332, 9.166666666666666, 9.125, 9.041666666666666, 9.125, 9.124999999999998, 9.125, 9.083333333333332, 9.166666666666668, 9.083333333333332, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.249999999999998, 9.041666666666664, 9.125, 9.041666666666666, 9.166666666666666, 9.083333333333332, 9.0, 9.041666666666664, 9.041666666666666, 9.083333333333332, 9.041666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.124999999999998, 9.125, 9.125, 9.166666666666668, 9.166666666666666, 9.125, 9.083333333333332, 9.125, 9.125, 9.125, 9.083333333333332, 9.166666666666666, 9.125, 9.125, 8.999999999999998, 9.125, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.083333333333332, 9.041666666666668, 9.166666666666666, 9.041666666666666, 8.958333333333334, 9.125, 9.083333333333332, 9.041666666666666, 9.125, 9.125, 9.083333333333334, 9.124999999999998, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.041666666666666, 8.999999999999998, 9.083333333333332, 9.125, 9.166666666666666, 9.041666666666664, 9.125, 9.083333333333334, 9.125, 9.125, 9.083333333333332, 9.041666666666668, 8.916666666666666, 9.124999999999998, 9.041666666666666, 9.041666666666668, 9.166666666666666, 9.0, 9.125, 9.083333333333332, 8.916666666666666, 9.083333333333334, 9.041666666666668, 9.041666666666666, 9.0, 9.166666666666666, 8.958333333333334, 9.166666666666666, 9.125, 9.208333333333332, 9.083333333333332, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.083333333333332, 9.083333333333332, 9.083333333333332, 9.083333333333334, 9.083333333333334, 9.125, 8.875, 8.958333333333334, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.125, 9.0, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.083333333333332, 9.0, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.000000000000002, 9.0, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.041666666666664, 8.999999999999998, 9.041666666666666, 9.083333333333332, 9.166666666666666, 9.041666666666664, 9.041666666666666, 9.0, 9.083333333333334, 9.125, 9.166666666666666, 8.875, 9.124999999999998, 9.083333333333332, 9.166666666666666, 9.041666666666664, 9.124999999999998, 8.958333333333332, 9.0, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.083333333333334, 9.083333333333332, 9.041666666666666, 9.083333333333334, 9.083333333333334], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2650156228615212, "mean_inference_ms": 1.2027511602193075, "mean_action_processing_ms": 0.10637038918258844, "mean_env_wait_ms": 36.18420644186099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007378662025535499, "StateBufferConnector_ms": 0.005073468763749678, "ViewRequirementAgentConnector_ms": 0.11103664125714983}}, "episode_reward_max": 9.249999999999998, "episode_reward_min": 8.875, "episode_reward_mean": 9.092490842490843, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.041666666666666, 9.041666666666666, 8.916666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.125, 9.0, 9.166666666666666, 8.916666666666666, 9.125, 9.124999999999998, 9.083333333333332, 9.125, 9.166666666666666, 9.208333333333332, 9.124999999999998, 9.083333333333332, 9.166666666666666, 9.125, 9.041666666666666, 9.125, 9.124999999999998, 9.125, 9.083333333333332, 9.166666666666668, 9.083333333333332, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.249999999999998, 9.041666666666664, 9.125, 9.041666666666666, 9.166666666666666, 9.083333333333332, 9.0, 9.041666666666664, 9.041666666666666, 9.083333333333332, 9.041666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.124999999999998, 9.125, 9.125, 9.166666666666668, 9.166666666666666, 9.125, 9.083333333333332, 9.125, 9.125, 9.125, 9.083333333333332, 9.166666666666666, 9.125, 9.125, 8.999999999999998, 9.125, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.083333333333332, 9.041666666666668, 9.166666666666666, 9.041666666666666, 8.958333333333334, 9.125, 9.083333333333332, 9.041666666666666, 9.125, 9.125, 9.083333333333334, 9.124999999999998, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.041666666666666, 8.999999999999998, 9.083333333333332, 9.125, 9.166666666666666, 9.041666666666664, 9.125, 9.083333333333334, 9.125, 9.125, 9.083333333333332, 9.041666666666668, 8.916666666666666, 9.124999999999998, 9.041666666666666, 9.041666666666668, 9.166666666666666, 9.0, 9.125, 9.083333333333332, 8.916666666666666, 9.083333333333334, 9.041666666666668, 9.041666666666666, 9.0, 9.166666666666666, 8.958333333333334, 9.166666666666666, 9.125, 9.208333333333332, 9.083333333333332, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.083333333333332, 9.083333333333332, 9.083333333333332, 9.083333333333334, 9.083333333333334, 9.125, 8.875, 8.958333333333334, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.125, 9.0, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.083333333333332, 9.0, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.000000000000002, 9.0, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.041666666666664, 8.999999999999998, 9.041666666666666, 9.083333333333332, 9.166666666666666, 9.041666666666664, 9.041666666666666, 9.0, 9.083333333333334, 9.125, 9.166666666666666, 8.875, 9.124999999999998, 9.083333333333332, 9.166666666666666, 9.041666666666664, 9.124999999999998, 8.958333333333332, 9.0, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.083333333333334, 9.083333333333332, 9.041666666666666, 9.083333333333334, 9.083333333333334], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2650156228615212, "mean_inference_ms": 1.2027511602193075, "mean_action_processing_ms": 0.10637038918258844, "mean_env_wait_ms": 36.18420644186099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007378662025535499, "StateBufferConnector_ms": 0.005073468763749678, "ViewRequirementAgentConnector_ms": 0.11103664125714983}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.927365901286482, "num_env_steps_trained_throughput_per_sec": 24.927365901286482, "timesteps_total": 128000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 80900.532, "sample_time_ms": 77674.928, "load_time_ms": 11.158, "load_throughput": 179250.655, "learn_time_ms": 3211.867, "learn_throughput": 622.691, "synch_weights_time_ms": 2.136}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 11777, "training_iteration": 64, "trial_id": "13850_00003", "date": "2023-12-28_19-13-40", "timestamp": 1703762020, "time_this_iter_s": 80.24039840698242, "time_total_s": 5170.3782567977905, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5170.3782567977905, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 55.75, "ram_util_percent": 92.48157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.185452315956356e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.537075989511278, "policy_loss": -0.01334206225971381, "vf_loss": 3.5504180431365966, "vf_explained_var": 0.36381055156389874, "kl": 0.003411608978183188, "entropy": 0.5306000559859806, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29025.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_agent_steps_sampled": 130000, "num_agent_steps_trained": 130000}, "sampler_results": {"episode_reward_max": 9.333333333333334, "episode_reward_min": 8.958333333333332, "episode_reward_mean": 9.105998168498168, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.25, 9.041666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.0, 9.083333333333332, 9.125, 9.041666666666666, 9.083333333333334, 9.124999999999998, 9.083333333333332, 9.124999999999998, 9.125, 9.083333333333334, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.0, 9.124999999999998, 9.124999999999998, 9.083333333333334, 9.083333333333332, 9.125, 9.041666666666666, 9.333333333333334, 9.041666666666664, 9.124999999999998, 8.958333333333332, 9.083333333333332, 9.125, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.041666666666668, 9.124999999999998, 9.166666666666666, 9.041666666666666, 9.083333333333332, 9.041666666666666, 9.041666666666668, 9.249999999999998, 9.041666666666666, 9.041666666666666, 9.041666666666666, 9.0, 8.999999999999998, 9.166666666666666, 9.125, 9.125, 9.083333333333332, 9.125, 9.166666666666666, 9.041666666666666, 9.125, 9.083333333333332, 9.25, 9.083333333333332, 9.041666666666668, 9.0, 9.166666666666666, 9.125, 9.000000000000002, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.083333333333332, 9.124999999999998, 9.208333333333332, 9.166666666666666, 9.208333333333332, 9.083333333333334, 9.0, 9.125, 9.25, 9.0, 9.041666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.125000000000002, 9.041666666666668, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.0, 9.125, 9.083333333333334, 9.083333333333334, 9.125, 9.0, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.125, 9.083333333333332, 9.125, 9.041666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.083333333333334, 9.0, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666668, 9.083333333333332, 9.083333333333332, 9.125, 9.166666666666666, 9.125, 9.166666666666668, 9.166666666666666, 9.041666666666666, 9.041666666666666, 9.125, 9.083333333333332, 9.125, 9.083333333333332, 9.083333333333332, 9.125, 8.999999999999998, 9.125, 9.0, 9.041666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666666, 9.083333333333334, 9.083333333333334, 9.125, 9.166666666666666, 9.041666666666666, 9.000000000000002, 9.166666666666666, 9.125, 9.208333333333334, 9.083333333333334, 9.083333333333332, 9.125, 9.0, 9.083333333333334, 9.166666666666668, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.041666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.264952664015809, "mean_inference_ms": 1.2026954660591638, "mean_action_processing_ms": 0.1063740232082678, "mean_env_wait_ms": 36.18860401555836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007431978707785135, "StateBufferConnector_ms": 0.005168050200074583, "ViewRequirementAgentConnector_ms": 0.11091140600351188}}, "episode_reward_max": 9.333333333333334, "episode_reward_min": 8.958333333333332, "episode_reward_mean": 9.105998168498168, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.25, 9.041666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.0, 9.083333333333332, 9.125, 9.041666666666666, 9.083333333333334, 9.124999999999998, 9.083333333333332, 9.124999999999998, 9.125, 9.083333333333334, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.0, 9.124999999999998, 9.124999999999998, 9.083333333333334, 9.083333333333332, 9.125, 9.041666666666666, 9.333333333333334, 9.041666666666664, 9.124999999999998, 8.958333333333332, 9.083333333333332, 9.125, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.041666666666668, 9.124999999999998, 9.166666666666666, 9.041666666666666, 9.083333333333332, 9.041666666666666, 9.041666666666668, 9.249999999999998, 9.041666666666666, 9.041666666666666, 9.041666666666666, 9.0, 8.999999999999998, 9.166666666666666, 9.125, 9.125, 9.083333333333332, 9.125, 9.166666666666666, 9.041666666666666, 9.125, 9.083333333333332, 9.25, 9.083333333333332, 9.041666666666668, 9.0, 9.166666666666666, 9.125, 9.000000000000002, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.083333333333332, 9.124999999999998, 9.208333333333332, 9.166666666666666, 9.208333333333332, 9.083333333333334, 9.0, 9.125, 9.25, 9.0, 9.041666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.125000000000002, 9.041666666666668, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.0, 9.125, 9.083333333333334, 9.083333333333334, 9.125, 9.0, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.125, 9.083333333333332, 9.125, 9.041666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.083333333333334, 9.0, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666668, 9.083333333333332, 9.083333333333332, 9.125, 9.166666666666666, 9.125, 9.166666666666668, 9.166666666666666, 9.041666666666666, 9.041666666666666, 9.125, 9.083333333333332, 9.125, 9.083333333333332, 9.083333333333332, 9.125, 8.999999999999998, 9.125, 9.0, 9.041666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666666, 9.083333333333334, 9.083333333333334, 9.125, 9.166666666666666, 9.041666666666666, 9.000000000000002, 9.166666666666666, 9.125, 9.208333333333334, 9.083333333333334, 9.083333333333332, 9.125, 9.0, 9.083333333333334, 9.166666666666668, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.041666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.264952664015809, "mean_inference_ms": 1.2026954660591638, "mean_action_processing_ms": 0.1063740232082678, "mean_env_wait_ms": 36.18860401555836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007431978707785135, "StateBufferConnector_ms": 0.005168050200074583, "ViewRequirementAgentConnector_ms": 0.11091140600351188}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 130000, "num_agent_steps_trained": 130000, "num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.587532345041474, "num_env_steps_trained_throughput_per_sec": 24.587532345041474, "timesteps_total": 130000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 130000, "timers": {"training_iteration_time_ms": 81007.948, "sample_time_ms": 77783.323, "load_time_ms": 9.981, "load_throughput": 200380.476, "learn_time_ms": 3212.079, "learn_throughput": 622.65, "synch_weights_time_ms": 2.122}, "counters": {"num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_agent_steps_sampled": 130000, "num_agent_steps_trained": 130000}, "done": false, "episodes_total": 11959, "training_iteration": 65, "trial_id": "13850_00003", "date": "2023-12-28_19-15-02", "timestamp": 1703762102, "time_this_iter_s": 81.3491997718811, "time_total_s": 5251.727456569672, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5251.727456569672, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 55.932758620689654, "ram_util_percent": 92.4853448275862}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.092726157978178e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6204579978519016, "policy_loss": -0.010082763189242946, "vf_loss": 3.630540747642517, "vf_explained_var": 0.36454455508126155, "kl": 0.0038649812216673555, "entropy": 0.5430746426184972, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29475.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 9.458333333333334, "episode_reward_min": 8.916666666666668, "episode_reward_mean": 9.109661172161173, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.958333333333334, 9.041666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 8.999999999999998, 9.125, 9.124999999999998, 9.166666666666666, 9.083333333333334, 9.166666666666666, 8.958333333333334, 9.125, 9.0, 8.999999999999998, 9.125, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 8.999999999999998, 9.125, 9.125, 9.166666666666666, 9.0, 9.124999999999998, 9.083333333333332, 9.083333333333332, 9.041666666666666, 9.25, 9.124999999999998, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.041666666666666, 9.041666666666666, 9.083333333333332, 9.0, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.083333333333332, 9.041666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.083333333333332, 9.083333333333334, 9.041666666666668, 9.083333333333332, 9.124999999999998, 9.083333333333332, 9.125, 9.083333333333332, 9.041666666666668, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.0, 9.125, 9.041666666666668, 9.166666666666666, 9.291666666666666, 9.166666666666666, 9.041666666666666, 9.125, 9.125, 9.125, 9.458333333333334, 9.083333333333334, 9.125, 9.208333333333332, 9.166666666666666, 9.083333333333332, 9.208333333333334, 8.999999999999998, 9.166666666666666, 9.166666666666668, 9.041666666666664, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.0, 8.958333333333332, 9.041666666666666, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 8.916666666666668, 9.166666666666666, 9.083333333333332, 9.125, 9.0, 9.125, 9.166666666666666, 8.958333333333336, 9.083333333333334, 9.124999999999998, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666668, 9.083333333333334, 9.124999999999998, 9.125, 9.125, 8.958333333333334, 9.041666666666666, 9.208333333333334, 9.125, 9.041666666666668, 9.041666666666664, 9.249999999999998, 9.083333333333332, 9.083333333333334, 9.208333333333334, 9.083333333333334, 9.083333333333334, 9.041666666666668, 9.125, 9.208333333333332, 9.041666666666668, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.0, 9.208333333333334, 9.124999999999998, 8.958333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.083333333333334, 8.958333333333334, 9.083333333333334, 9.125, 9.083333333333334, 9.125, 8.999999999999998, 9.166666666666666, 9.083333333333334, 9.041666666666668, 9.083333333333334, 9.124999999999998, 9.125, 9.0, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.125, 9.124999999999998, 9.124999999999998, 9.125, 9.125, 9.166666666666666, 9.125, 9.208333333333334, 9.083333333333332, 8.958333333333332], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2651471054706338, "mean_inference_ms": 1.2028947954711544, "mean_action_processing_ms": 0.10640377115162404, "mean_env_wait_ms": 36.19578880046038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693977146358281, "StateBufferConnector_ms": 0.005151937296102335, "ViewRequirementAgentConnector_ms": 0.11345973381629357}}, "episode_reward_max": 9.458333333333334, "episode_reward_min": 8.916666666666668, "episode_reward_mean": 9.109661172161173, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.958333333333334, 9.041666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 8.999999999999998, 9.125, 9.124999999999998, 9.166666666666666, 9.083333333333334, 9.166666666666666, 8.958333333333334, 9.125, 9.0, 8.999999999999998, 9.125, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 8.999999999999998, 9.125, 9.125, 9.166666666666666, 9.0, 9.124999999999998, 9.083333333333332, 9.083333333333332, 9.041666666666666, 9.25, 9.124999999999998, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.041666666666666, 9.041666666666666, 9.083333333333332, 9.0, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.083333333333332, 9.041666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.083333333333332, 9.083333333333334, 9.041666666666668, 9.083333333333332, 9.124999999999998, 9.083333333333332, 9.125, 9.083333333333332, 9.041666666666668, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.0, 9.125, 9.041666666666668, 9.166666666666666, 9.291666666666666, 9.166666666666666, 9.041666666666666, 9.125, 9.125, 9.125, 9.458333333333334, 9.083333333333334, 9.125, 9.208333333333332, 9.166666666666666, 9.083333333333332, 9.208333333333334, 8.999999999999998, 9.166666666666666, 9.166666666666668, 9.041666666666664, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.0, 8.958333333333332, 9.041666666666666, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 8.916666666666668, 9.166666666666666, 9.083333333333332, 9.125, 9.0, 9.125, 9.166666666666666, 8.958333333333336, 9.083333333333334, 9.124999999999998, 9.25, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666668, 9.083333333333334, 9.124999999999998, 9.125, 9.125, 8.958333333333334, 9.041666666666666, 9.208333333333334, 9.125, 9.041666666666668, 9.041666666666664, 9.249999999999998, 9.083333333333332, 9.083333333333334, 9.208333333333334, 9.083333333333334, 9.083333333333334, 9.041666666666668, 9.125, 9.208333333333332, 9.041666666666668, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.0, 9.208333333333334, 9.124999999999998, 8.958333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.083333333333334, 8.958333333333334, 9.083333333333334, 9.125, 9.083333333333334, 9.125, 8.999999999999998, 9.166666666666666, 9.083333333333334, 9.041666666666668, 9.083333333333334, 9.124999999999998, 9.125, 9.0, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.125, 9.124999999999998, 9.124999999999998, 9.125, 9.125, 9.166666666666666, 9.125, 9.208333333333334, 9.083333333333332, 8.958333333333332], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2651471054706338, "mean_inference_ms": 1.2028947954711544, "mean_action_processing_ms": 0.10640377115162404, "mean_env_wait_ms": 36.19578880046038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693977146358281, "StateBufferConnector_ms": 0.005151937296102335, "ViewRequirementAgentConnector_ms": 0.11345973381629357}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.452727829109204, "num_env_steps_trained_throughput_per_sec": 24.452727829109204, "timesteps_total": 132000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 81041.462, "sample_time_ms": 77821.33, "load_time_ms": 9.894, "load_throughput": 202134.645, "learn_time_ms": 3207.629, "learn_throughput": 623.514, "synch_weights_time_ms": 2.165}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 12141, "training_iteration": 66, "trial_id": "13850_00003", "date": "2023-12-28_19-16-24", "timestamp": 1703762184, "time_this_iter_s": 81.79810118675232, "time_total_s": 5333.525557756424, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5333.525557756424, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 56.02564102564103, "ram_util_percent": 92.53931623931624}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.046363078989089e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3791666825612388, "policy_loss": -0.008841772741741605, "vf_loss": 3.388008465766907, "vf_explained_var": 0.38381998777389525, "kl": 0.0067504751320243235, "entropy": 0.45329140649901495, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29925.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 134000, "num_env_steps_trained": 134000, "num_agent_steps_sampled": 134000, "num_agent_steps_trained": 134000}, "sampler_results": {"episode_reward_max": 9.291666666666668, "episode_reward_min": 8.875, "episode_reward_mean": 9.095073664825046, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 9.125, 9.083333333333334, 8.958333333333332, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 8.958333333333332, 9.083333333333334, 8.958333333333332, 9.041666666666666, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.291666666666666, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.041666666666666, 9.083333333333334, 9.083333333333334, 9.041666666666668, 9.124999999999998, 9.125, 9.041666666666666, 9.083333333333332, 9.208333333333332, 9.25, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.000000000000002, 9.125, 9.083333333333334, 9.124999999999998, 9.166666666666666, 8.875, 9.041666666666666, 9.083333333333332, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.041666666666666, 9.0, 9.083333333333334, 8.999999999999998, 8.916666666666666, 9.125, 9.124999999999998, 9.125, 9.125, 9.041666666666664, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.124999999999998, 9.083333333333332, 9.083333333333332, 9.083333333333332, 9.124999999999998, 9.166666666666666, 9.166666666666666, 8.999999999999998, 9.125, 9.083333333333332, 9.083333333333332, 9.125, 9.041666666666666, 9.166666666666666, 9.041666666666668, 9.0, 9.166666666666666, 9.125, 9.041666666666666, 9.166666666666666, 8.958333333333332, 9.166666666666666, 9.166666666666666, 9.0, 8.958333333333336, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.000000000000002, 9.000000000000002, 9.125, 9.124999999999998, 9.125, 9.166666666666666, 9.041666666666668, 9.125, 9.125, 9.125, 9.083333333333334, 9.166666666666666, 9.208333333333334, 9.125, 9.125, 9.125, 9.083333333333332, 9.083333333333334, 9.083333333333332, 9.124999999999998, 9.041666666666666, 8.958333333333332, 9.041666666666664, 9.0, 9.291666666666668, 9.166666666666666, 8.958333333333332, 9.041666666666666, 9.0, 9.125, 9.083333333333332, 9.0, 9.0, 9.041666666666668, 9.083333333333332, 9.041666666666666, 9.0, 9.083333333333332, 9.250000000000002, 9.0, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.249999999999998, 9.041666666666668, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.0, 9.083333333333332, 9.125, 9.125, 9.041666666666666, 9.041666666666666, 9.041666666666666, 9.0, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.125, 9.083333333333332, 9.125, 9.083333333333332, 9.124999999999998, 9.0, 9.166666666666666, 9.125, 8.999999999999998, 9.125, 9.0, 9.125, 9.166666666666668, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.124999999999998, 9.083333333333334, 8.916666666666666, 9.041666666666668, 9.124999999999998], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2647035005360379, "mean_inference_ms": 1.2026584925663542, "mean_action_processing_ms": 0.10638739774282673, "mean_env_wait_ms": 36.19204962171994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007396113148051731, "StateBufferConnector_ms": 0.0050684365119723325, "ViewRequirementAgentConnector_ms": 0.10931360128834762}}, "episode_reward_max": 9.291666666666668, "episode_reward_min": 8.875, "episode_reward_mean": 9.095073664825046, "episode_len_mean": 11.0, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.0, 9.125, 9.083333333333334, 8.958333333333332, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 8.958333333333332, 9.083333333333334, 8.958333333333332, 9.041666666666666, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.291666666666666, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.041666666666666, 9.083333333333334, 9.083333333333334, 9.041666666666668, 9.124999999999998, 9.125, 9.041666666666666, 9.083333333333332, 9.208333333333332, 9.25, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.000000000000002, 9.125, 9.083333333333334, 9.124999999999998, 9.166666666666666, 8.875, 9.041666666666666, 9.083333333333332, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.041666666666666, 9.0, 9.083333333333334, 8.999999999999998, 8.916666666666666, 9.125, 9.124999999999998, 9.125, 9.125, 9.041666666666664, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.124999999999998, 9.083333333333332, 9.083333333333332, 9.083333333333332, 9.124999999999998, 9.166666666666666, 9.166666666666666, 8.999999999999998, 9.125, 9.083333333333332, 9.083333333333332, 9.125, 9.041666666666666, 9.166666666666666, 9.041666666666668, 9.0, 9.166666666666666, 9.125, 9.041666666666666, 9.166666666666666, 8.958333333333332, 9.166666666666666, 9.166666666666666, 9.0, 8.958333333333336, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.000000000000002, 9.000000000000002, 9.125, 9.124999999999998, 9.125, 9.166666666666666, 9.041666666666668, 9.125, 9.125, 9.125, 9.083333333333334, 9.166666666666666, 9.208333333333334, 9.125, 9.125, 9.125, 9.083333333333332, 9.083333333333334, 9.083333333333332, 9.124999999999998, 9.041666666666666, 8.958333333333332, 9.041666666666664, 9.0, 9.291666666666668, 9.166666666666666, 8.958333333333332, 9.041666666666666, 9.0, 9.125, 9.083333333333332, 9.0, 9.0, 9.041666666666668, 9.083333333333332, 9.041666666666666, 9.0, 9.083333333333332, 9.250000000000002, 9.0, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.249999999999998, 9.041666666666668, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.0, 9.083333333333332, 9.125, 9.125, 9.041666666666666, 9.041666666666666, 9.041666666666666, 9.0, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.125, 9.083333333333332, 9.125, 9.083333333333332, 9.124999999999998, 9.0, 9.166666666666666, 9.125, 8.999999999999998, 9.125, 9.0, 9.125, 9.166666666666668, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.124999999999998, 9.083333333333334, 8.916666666666666, 9.041666666666668, 9.124999999999998], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2647035005360379, "mean_inference_ms": 1.2026584925663542, "mean_action_processing_ms": 0.10638739774282673, "mean_env_wait_ms": 36.19204962171994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007396113148051731, "StateBufferConnector_ms": 0.0050684365119723325, "ViewRequirementAgentConnector_ms": 0.10931360128834762}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134000, "num_agent_steps_trained": 134000, "num_env_steps_sampled": 134000, "num_env_steps_trained": 134000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.944506584282173, "num_env_steps_trained_throughput_per_sec": 24.944506584282173, "timesteps_total": 134000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 134000, "timers": {"training_iteration_time_ms": 80966.154, "sample_time_ms": 77747.212, "load_time_ms": 11.169, "load_throughput": 179069.283, "learn_time_ms": 3205.188, "learn_throughput": 623.988, "synch_weights_time_ms": 2.158}, "counters": {"num_env_steps_sampled": 134000, "num_env_steps_trained": 134000, "num_agent_steps_sampled": 134000, "num_agent_steps_trained": 134000}, "done": false, "episodes_total": 12322, "training_iteration": 67, "trial_id": "13850_00003", "date": "2023-12-28_19-17-44", "timestamp": 1703762264, "time_this_iter_s": 80.18498063087463, "time_total_s": 5413.710538387299, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5413.710538387299, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 56.08859649122807, "ram_util_percent": 92.48859649122808}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.046363078989089e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.971243817011515, "policy_loss": 0.005507148715356985, "vf_loss": 3.965736672083537, "vf_explained_var": 0.2881227523750729, "kl": 0.004256512626457189, "entropy": 0.47795734961827596, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 30375.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": 9.333333333333334, "episode_reward_min": 8.958333333333332, "episode_reward_mean": 9.096153846153847, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.125, 9.041666666666666, 9.083333333333334, 9.083333333333334, 9.000000000000002, 9.000000000000002, 9.166666666666666, 9.041666666666666, 8.958333333333334, 9.041666666666666, 9.25, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.041666666666666, 9.083333333333332, 9.166666666666666, 9.083333333333332, 9.125, 8.958333333333336, 9.166666666666666, 9.041666666666666, 9.291666666666666, 9.125, 9.083333333333334, 9.249999999999998, 9.041666666666666, 9.0, 9.083333333333332, 9.0, 9.125, 9.083333333333334, 9.125, 9.166666666666666, 9.0, 9.124999999999998, 9.125, 9.125, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.041666666666666, 9.124999999999998, 9.0, 9.166666666666666, 9.125, 9.041666666666666, 9.0, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.0, 9.125, 9.083333333333332, 8.958333333333332, 9.083333333333334, 9.125, 9.041666666666668, 9.083333333333336, 9.166666666666666, 8.958333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.124999999999998, 9.125, 9.041666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.041666666666666, 9.083333333333334, 9.125, 9.083333333333332, 9.125, 9.083333333333332, 9.125, 9.083333333333332, 9.083333333333334, 9.124999999999998, 9.124999999999998, 9.0, 9.083333333333334, 9.166666666666666, 9.125, 9.0, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.333333333333334, 9.125, 9.166666666666666, 9.041666666666664, 9.125, 9.083333333333334, 9.166666666666666, 8.999999999999998, 8.999999999999998, 9.083333333333332, 9.125, 9.208333333333332, 9.083333333333334, 9.166666666666666, 9.125, 9.125, 9.124999999999998, 9.124999999999998, 9.125, 9.041666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.0, 9.083333333333334, 9.0, 9.166666666666666, 9.083333333333334, 9.125, 9.124999999999998, 9.166666666666666, 9.000000000000002, 9.041666666666666, 9.083333333333334, 9.0, 9.333333333333334, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.125, 9.041666666666664, 9.166666666666666, 9.041666666666666, 9.041666666666666, 9.0, 9.166666666666666, 9.083333333333334, 9.041666666666666, 9.083333333333334, 9.125, 9.083333333333334, 8.999999999999998, 9.041666666666668, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.041666666666666, 9.083333333333332, 9.041666666666666, 9.125, 9.166666666666666, 9.125, 9.041666666666668, 9.041666666666666, 9.041666666666668, 9.083333333333334, 9.083333333333332, 8.958333333333334, 9.083333333333334, 9.0, 9.0, 9.208333333333332, 9.0, 9.0, 9.124999999999998, 9.0, 9.083333333333334, 9.041666666666668, 9.041666666666666, 9.041666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.264234774980521, "mean_inference_ms": 1.2024098892902482, "mean_action_processing_ms": 0.10637532232361692, "mean_env_wait_ms": 36.18484421295836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074391836648458965, "StateBufferConnector_ms": 0.005100847600580572, "ViewRequirementAgentConnector_ms": 0.10917632134406122}}, "episode_reward_max": 9.333333333333334, "episode_reward_min": 8.958333333333332, "episode_reward_mean": 9.096153846153847, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.125, 9.041666666666666, 9.083333333333334, 9.083333333333334, 9.000000000000002, 9.000000000000002, 9.166666666666666, 9.041666666666666, 8.958333333333334, 9.041666666666666, 9.25, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.041666666666666, 9.083333333333332, 9.166666666666666, 9.083333333333332, 9.125, 8.958333333333336, 9.166666666666666, 9.041666666666666, 9.291666666666666, 9.125, 9.083333333333334, 9.249999999999998, 9.041666666666666, 9.0, 9.083333333333332, 9.0, 9.125, 9.083333333333334, 9.125, 9.166666666666666, 9.0, 9.124999999999998, 9.125, 9.125, 9.083333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.041666666666666, 9.124999999999998, 9.0, 9.166666666666666, 9.125, 9.041666666666666, 9.0, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.0, 9.125, 9.083333333333332, 8.958333333333332, 9.083333333333334, 9.125, 9.041666666666668, 9.083333333333336, 9.166666666666666, 8.958333333333334, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.124999999999998, 9.125, 9.041666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.041666666666666, 9.083333333333334, 9.125, 9.083333333333332, 9.125, 9.083333333333332, 9.125, 9.083333333333332, 9.083333333333334, 9.124999999999998, 9.124999999999998, 9.0, 9.083333333333334, 9.166666666666666, 9.125, 9.0, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.333333333333334, 9.125, 9.166666666666666, 9.041666666666664, 9.125, 9.083333333333334, 9.166666666666666, 8.999999999999998, 8.999999999999998, 9.083333333333332, 9.125, 9.208333333333332, 9.083333333333334, 9.166666666666666, 9.125, 9.125, 9.124999999999998, 9.124999999999998, 9.125, 9.041666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.0, 9.083333333333334, 9.0, 9.166666666666666, 9.083333333333334, 9.125, 9.124999999999998, 9.166666666666666, 9.000000000000002, 9.041666666666666, 9.083333333333334, 9.0, 9.333333333333334, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.125, 9.041666666666664, 9.166666666666666, 9.041666666666666, 9.041666666666666, 9.0, 9.166666666666666, 9.083333333333334, 9.041666666666666, 9.083333333333334, 9.125, 9.083333333333334, 8.999999999999998, 9.041666666666668, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.041666666666666, 9.083333333333332, 9.041666666666666, 9.125, 9.166666666666666, 9.125, 9.041666666666668, 9.041666666666666, 9.041666666666668, 9.083333333333334, 9.083333333333332, 8.958333333333334, 9.083333333333334, 9.0, 9.0, 9.208333333333332, 9.0, 9.0, 9.124999999999998, 9.0, 9.083333333333334, 9.041666666666668, 9.041666666666666, 9.041666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.264234774980521, "mean_inference_ms": 1.2024098892902482, "mean_action_processing_ms": 0.10637532232361692, "mean_env_wait_ms": 36.18484421295836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074391836648458965, "StateBufferConnector_ms": 0.005100847600580572, "ViewRequirementAgentConnector_ms": 0.10917632134406122}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 25.097398703149718, "num_env_steps_trained_throughput_per_sec": 25.097398703149718, "timesteps_total": 136000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 80800.845, "sample_time_ms": 77582.862, "load_time_ms": 11.027, "load_throughput": 181376.877, "learn_time_ms": 3204.376, "learn_throughput": 624.147, "synch_weights_time_ms": 2.161}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 12504, "training_iteration": 68, "trial_id": "13850_00003", "date": "2023-12-28_19-19-03", "timestamp": 1703762343, "time_this_iter_s": 79.69660902023315, "time_total_s": 5493.407147407532, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5493.407147407532, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 56.13274336283187, "ram_util_percent": 92.51238938053098}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0231815394945445e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.774091977013482, "policy_loss": -0.0003836602552069558, "vf_loss": 3.774475632243686, "vf_explained_var": 0.24266580753856234, "kl": 0.0027181657001878793, "entropy": 0.4455048023992115, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 30825.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 138000, "num_env_steps_trained": 138000, "num_agent_steps_sampled": 138000, "num_agent_steps_trained": 138000}, "sampler_results": {"episode_reward_max": 9.333333333333334, "episode_reward_min": 8.875, "episode_reward_mean": 9.101877289377288, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.125, 9.083333333333334, 9.0, 9.083333333333334, 9.125, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666666, 9.166666666666666, 8.999999999999998, 9.041666666666666, 9.166666666666666, 9.125, 9.000000000000002, 9.166666666666666, 9.333333333333334, 9.166666666666666, 9.083333333333334, 9.041666666666666, 9.125, 9.125, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666666, 9.083333333333334, 8.999999999999998, 9.083333333333334, 9.083333333333334, 9.125, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.083333333333332, 8.916666666666666, 9.124999999999998, 9.041666666666666, 9.166666666666666, 8.958333333333334, 9.124999999999998, 9.125, 9.125, 9.083333333333334, 9.0, 9.083333333333334, 9.041666666666668, 9.041666666666668, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.124999999999998, 9.0, 9.166666666666666, 9.125, 9.0, 9.166666666666666, 9.083333333333334, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.125, 9.125, 9.041666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.208333333333332, 9.125, 9.083333333333332, 9.166666666666666, 8.999999999999998, 9.166666666666668, 9.041666666666666, 9.125, 9.166666666666666, 9.25, 9.041666666666666, 9.083333333333332, 9.125, 9.125, 9.083333333333332, 9.125, 9.041666666666668, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.125, 9.041666666666666, 9.166666666666666, 9.125, 9.041666666666666, 8.958333333333332, 8.999999999999998, 9.083333333333332, 9.124999999999998, 9.125, 9.124999999999998, 9.125, 8.958333333333332, 9.125, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666668, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.083333333333334, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.083333333333332, 9.083333333333332, 8.958333333333334, 9.0, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 8.875, 9.125, 9.125, 9.124999999999998, 9.0, 9.166666666666666, 9.125, 9.125, 9.000000000000002, 9.083333333333332, 9.083333333333334, 9.125, 9.083333333333334, 9.041666666666668, 9.0, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.083333333333334, 9.166666666666666, 9.041666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.0, 9.166666666666666, 9.041666666666666, 9.041666666666666, 9.166666666666666, 9.083333333333334, 9.125, 8.958333333333332, 9.083333333333332, 9.166666666666666, 9.0, 9.124999999999998, 9.125, 9.124999999999998], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2642729476827095, "mean_inference_ms": 1.202490268220518, "mean_action_processing_ms": 0.106388950300217, "mean_env_wait_ms": 36.18821554533431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007506517263559194, "StateBufferConnector_ms": 0.005207218966641269, "ViewRequirementAgentConnector_ms": 0.11147064167064624}}, "episode_reward_max": 9.333333333333334, "episode_reward_min": 8.875, "episode_reward_mean": 9.101877289377288, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.125, 9.083333333333334, 9.0, 9.083333333333334, 9.125, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666666, 9.166666666666666, 8.999999999999998, 9.041666666666666, 9.166666666666666, 9.125, 9.000000000000002, 9.166666666666666, 9.333333333333334, 9.166666666666666, 9.083333333333334, 9.041666666666666, 9.125, 9.125, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666666, 9.083333333333334, 8.999999999999998, 9.083333333333334, 9.083333333333334, 9.125, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.083333333333332, 8.916666666666666, 9.124999999999998, 9.041666666666666, 9.166666666666666, 8.958333333333334, 9.124999999999998, 9.125, 9.125, 9.083333333333334, 9.0, 9.083333333333334, 9.041666666666668, 9.041666666666668, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.124999999999998, 9.0, 9.166666666666666, 9.125, 9.0, 9.166666666666666, 9.083333333333334, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.125, 9.125, 9.041666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.208333333333332, 9.125, 9.083333333333332, 9.166666666666666, 8.999999999999998, 9.166666666666668, 9.041666666666666, 9.125, 9.166666666666666, 9.25, 9.041666666666666, 9.083333333333332, 9.125, 9.125, 9.083333333333332, 9.125, 9.041666666666668, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.125, 9.041666666666666, 9.166666666666666, 9.125, 9.041666666666666, 8.958333333333332, 8.999999999999998, 9.083333333333332, 9.124999999999998, 9.125, 9.124999999999998, 9.125, 8.958333333333332, 9.125, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666668, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.083333333333334, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.083333333333332, 9.083333333333332, 8.958333333333334, 9.0, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 8.875, 9.125, 9.125, 9.124999999999998, 9.0, 9.166666666666666, 9.125, 9.125, 9.000000000000002, 9.083333333333332, 9.083333333333334, 9.125, 9.083333333333334, 9.041666666666668, 9.0, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.083333333333334, 9.166666666666666, 9.041666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.0, 9.166666666666666, 9.041666666666666, 9.041666666666666, 9.166666666666666, 9.083333333333334, 9.125, 8.958333333333332, 9.083333333333332, 9.166666666666666, 9.0, 9.124999999999998, 9.125, 9.124999999999998], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2642729476827095, "mean_inference_ms": 1.202490268220518, "mean_action_processing_ms": 0.106388950300217, "mean_env_wait_ms": 36.18821554533431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007506517263559194, "StateBufferConnector_ms": 0.005207218966641269, "ViewRequirementAgentConnector_ms": 0.11147064167064624}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 138000, "num_agent_steps_trained": 138000, "num_env_steps_sampled": 138000, "num_env_steps_trained": 138000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.60219667849956, "num_env_steps_trained_throughput_per_sec": 24.60219667849956, "timesteps_total": 138000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 138000, "timers": {"training_iteration_time_ms": 80937.666, "sample_time_ms": 77716.227, "load_time_ms": 11.115, "load_throughput": 179931.962, "learn_time_ms": 3207.728, "learn_throughput": 623.494, "synch_weights_time_ms": 2.165}, "counters": {"num_env_steps_sampled": 138000, "num_env_steps_trained": 138000, "num_agent_steps_sampled": 138000, "num_agent_steps_trained": 138000}, "done": false, "episodes_total": 12686, "training_iteration": 69, "trial_id": "13850_00003", "date": "2023-12-28_19-20-25", "timestamp": 1703762425, "time_this_iter_s": 81.30116701126099, "time_total_s": 5574.708314418793, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5574.708314418793, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 56.01810344827586, "ram_util_percent": 92.54310344827587}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.115907697472723e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.0294717597961425, "policy_loss": -0.004290158417489793, "vf_loss": 4.033761904504564, "vf_explained_var": 0.26833244111802845, "kl": 0.003696751090590534, "entropy": 0.455713252292739, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 31275.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 8.916666666666666, "episode_reward_mean": 9.095924908424909, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.124999999999998, 9.083333333333334, 9.083333333333332, 9.125, 9.166666666666666, 9.041666666666666, 9.125, 9.166666666666666, 9.125000000000002, 9.166666666666666, 9.25, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 8.958333333333332, 9.083333333333332, 9.166666666666666, 9.041666666666664, 9.124999999999998, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.041666666666666, 9.041666666666666, 9.083333333333334, 9.125, 9.125, 9.083333333333334, 9.083333333333334, 9.041666666666668, 9.166666666666666, 9.125, 8.999999999999998, 9.166666666666666, 8.916666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.041666666666666, 9.083333333333332, 9.083333333333334, 8.999999999999998, 9.124999999999998, 9.166666666666666, 8.916666666666666, 9.041666666666668, 9.0, 8.958333333333334, 9.083333333333332, 9.124999999999998, 9.125, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 8.958333333333334, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.0, 9.0, 9.041666666666666, 9.166666666666666, 9.083333333333332, 8.958333333333334, 9.125, 9.166666666666666, 8.999999999999998, 9.125, 9.125, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.0, 9.083333333333334, 9.166666666666666, 9.0, 9.125, 9.124999999999998, 9.125, 9.0, 9.166666666666666, 9.124999999999998, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666668, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.166666666666666, 8.958333333333332, 9.041666666666666, 9.083333333333332, 9.083333333333332, 9.125, 9.125, 9.124999999999998, 8.958333333333334, 9.125, 9.041666666666666, 9.083333333333334, 9.125, 9.0, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.041666666666664, 9.0, 9.041666666666666, 9.041666666666666, 9.125, 9.083333333333334, 9.041666666666664, 9.041666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.125, 9.083333333333334, 9.0, 9.166666666666666, 9.0, 9.0, 9.083333333333332, 9.041666666666664, 9.125, 9.125, 9.166666666666666, 9.124999999999998, 9.041666666666666, 9.166666666666666, 9.041666666666666, 9.083333333333332, 9.041666666666668, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.125, 9.083333333333334, 9.041666666666668, 9.0, 8.958333333333332, 9.0, 9.083333333333334, 9.083333333333334, 9.083333333333332, 9.083333333333332, 9.124999999999998, 8.958333333333334, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2641897927074697, "mean_inference_ms": 1.2023908390441864, "mean_action_processing_ms": 0.10638607533396767, "mean_env_wait_ms": 36.188882849597775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007423987755408654, "StateBufferConnector_ms": 0.005132156413990062, "ViewRequirementAgentConnector_ms": 0.1101763693840949}}, "episode_reward_max": 9.25, "episode_reward_min": 8.916666666666666, "episode_reward_mean": 9.095924908424909, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.124999999999998, 9.083333333333334, 9.083333333333332, 9.125, 9.166666666666666, 9.041666666666666, 9.125, 9.166666666666666, 9.125000000000002, 9.166666666666666, 9.25, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 8.958333333333332, 9.083333333333332, 9.166666666666666, 9.041666666666664, 9.124999999999998, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.041666666666666, 9.041666666666666, 9.083333333333334, 9.125, 9.125, 9.083333333333334, 9.083333333333334, 9.041666666666668, 9.166666666666666, 9.125, 8.999999999999998, 9.166666666666666, 8.916666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.041666666666666, 9.083333333333332, 9.083333333333334, 8.999999999999998, 9.124999999999998, 9.166666666666666, 8.916666666666666, 9.041666666666668, 9.0, 8.958333333333334, 9.083333333333332, 9.124999999999998, 9.125, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 8.958333333333334, 9.166666666666666, 9.083333333333334, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.0, 9.0, 9.041666666666666, 9.166666666666666, 9.083333333333332, 8.958333333333334, 9.125, 9.166666666666666, 8.999999999999998, 9.125, 9.125, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.0, 9.083333333333334, 9.166666666666666, 9.0, 9.125, 9.124999999999998, 9.125, 9.0, 9.166666666666666, 9.124999999999998, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666668, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.166666666666666, 8.958333333333332, 9.041666666666666, 9.083333333333332, 9.083333333333332, 9.125, 9.125, 9.124999999999998, 8.958333333333334, 9.125, 9.041666666666666, 9.083333333333334, 9.125, 9.0, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.041666666666664, 9.0, 9.041666666666666, 9.041666666666666, 9.125, 9.083333333333334, 9.041666666666664, 9.041666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.125, 9.083333333333334, 9.0, 9.166666666666666, 9.0, 9.0, 9.083333333333332, 9.041666666666664, 9.125, 9.125, 9.166666666666666, 9.124999999999998, 9.041666666666666, 9.166666666666666, 9.041666666666666, 9.083333333333332, 9.041666666666668, 9.166666666666666, 9.125, 9.25, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.125, 9.083333333333334, 9.041666666666668, 9.0, 8.958333333333332, 9.0, 9.083333333333334, 9.083333333333334, 9.083333333333332, 9.083333333333332, 9.124999999999998, 8.958333333333334, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2641897927074697, "mean_inference_ms": 1.2023908390441864, "mean_action_processing_ms": 0.10638607533396767, "mean_env_wait_ms": 36.188882849597775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007423987755408654, "StateBufferConnector_ms": 0.005132156413990062, "ViewRequirementAgentConnector_ms": 0.1101763693840949}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.74737258254936, "num_env_steps_trained_throughput_per_sec": 24.74737258254936, "timesteps_total": 140000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 80863.182, "sample_time_ms": 77647.457, "load_time_ms": 10.443, "load_throughput": 191509.8, "learn_time_ms": 3202.633, "learn_throughput": 624.486, "synch_weights_time_ms": 2.203}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 12868, "training_iteration": 70, "trial_id": "13850_00003", "date": "2023-12-28_19-21-46", "timestamp": 1703762506, "time_this_iter_s": 80.82372808456421, "time_total_s": 5655.532042503357, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5655.532042503357, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 55.93217391304348, "ram_util_percent": 92.72260869565216}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.5579538487363614e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.428779479132758, "policy_loss": 0.013343357634213236, "vf_loss": 4.41543612798055, "vf_explained_var": 0.23009196480115254, "kl": 0.003978941046910371, "entropy": 0.5056242774592505, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 31725.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 142000, "num_env_steps_trained": 142000, "num_agent_steps_sampled": 142000, "num_agent_steps_trained": 142000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 1.6666666666666667, "episode_reward_mean": 9.06868131868132, "episode_len_mean": 10.956043956043956, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.125, 9.166666666666666, 9.125, 9.0, 9.083333333333332, 9.083333333333332, 9.041666666666666, 9.125, 9.125, 9.083333333333332, 9.25, 9.125, 9.041666666666668, 9.125, 9.166666666666666, 9.125, 9.249999999999998, 9.083333333333334, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.083333333333332, 1.6666666666666667, 9.083333333333332, 9.208333333333332, 9.083333333333334, 9.041666666666666, 9.124999999999998, 9.166666666666666, 9.041666666666668, 9.041666666666666, 9.166666666666666, 9.208333333333332, 8.999999999999998, 9.166666666666666, 9.125, 9.125, 9.041666666666668, 9.083333333333334, 9.166666666666666, 9.166666666666666, 8.999999999999998, 9.124999999999998, 9.083333333333332, 9.083333333333334, 8.999999999999998, 9.25, 9.041666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.041666666666664, 9.166666666666666, 9.041666666666666, 9.125, 9.124999999999998, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 8.999999999999998, 9.166666666666666, 9.125, 9.124999999999998, 8.958333333333332, 9.125, 9.124999999999998, 9.0, 9.124999999999998, 9.083333333333334, 9.083333333333334, 9.124999999999998, 9.041666666666666, 9.041666666666666, 9.041666666666664, 9.125, 9.125, 9.125, 9.041666666666668, 9.041666666666666, 9.166666666666666, 8.958333333333334, 9.125, 9.166666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.083333333333332, 9.125, 9.125, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.0, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.0, 9.166666666666666, 9.041666666666666, 9.125, 9.166666666666666, 9.125, 9.0, 9.125, 9.166666666666666, 9.041666666666666, 9.124999999999998, 9.0, 9.0, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.125, 9.041666666666666, 9.083333333333334, 9.166666666666666, 8.916666666666666, 9.083333333333332, 9.083333333333332, 9.0, 8.958333333333332, 9.041666666666668, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.083333333333332, 8.999999999999998, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.125, 9.0, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.125, 9.125, 9.125, 9.083333333333332, 9.125, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.125000000000002], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.264031239410045, "mean_inference_ms": 1.202234532569313, "mean_action_processing_ms": 0.10638442474583804, "mean_env_wait_ms": 36.188703757902374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007363597115317544, "StateBufferConnector_ms": 0.005069538787171081, "ViewRequirementAgentConnector_ms": 0.10994070178859837}}, "episode_reward_max": 9.25, "episode_reward_min": 1.6666666666666667, "episode_reward_mean": 9.06868131868132, "episode_len_mean": 10.956043956043956, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.125, 9.166666666666666, 9.125, 9.0, 9.083333333333332, 9.083333333333332, 9.041666666666666, 9.125, 9.125, 9.083333333333332, 9.25, 9.125, 9.041666666666668, 9.125, 9.166666666666666, 9.125, 9.249999999999998, 9.083333333333334, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.083333333333332, 1.6666666666666667, 9.083333333333332, 9.208333333333332, 9.083333333333334, 9.041666666666666, 9.124999999999998, 9.166666666666666, 9.041666666666668, 9.041666666666666, 9.166666666666666, 9.208333333333332, 8.999999999999998, 9.166666666666666, 9.125, 9.125, 9.041666666666668, 9.083333333333334, 9.166666666666666, 9.166666666666666, 8.999999999999998, 9.124999999999998, 9.083333333333332, 9.083333333333334, 8.999999999999998, 9.25, 9.041666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.041666666666664, 9.166666666666666, 9.041666666666666, 9.125, 9.124999999999998, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 8.999999999999998, 9.166666666666666, 9.125, 9.124999999999998, 8.958333333333332, 9.125, 9.124999999999998, 9.0, 9.124999999999998, 9.083333333333334, 9.083333333333334, 9.124999999999998, 9.041666666666666, 9.041666666666666, 9.041666666666664, 9.125, 9.125, 9.125, 9.041666666666668, 9.041666666666666, 9.166666666666666, 8.958333333333334, 9.125, 9.166666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.083333333333332, 9.125, 9.125, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.0, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.0, 9.166666666666666, 9.041666666666666, 9.125, 9.166666666666666, 9.125, 9.0, 9.125, 9.166666666666666, 9.041666666666666, 9.124999999999998, 9.0, 9.0, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.125, 9.041666666666666, 9.083333333333334, 9.166666666666666, 8.916666666666666, 9.083333333333332, 9.083333333333332, 9.0, 8.958333333333332, 9.041666666666668, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.083333333333332, 8.999999999999998, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.125, 9.0, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.125, 9.125, 9.125, 9.083333333333332, 9.125, 9.125, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.125000000000002], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 3, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.264031239410045, "mean_inference_ms": 1.202234532569313, "mean_action_processing_ms": 0.10638442474583804, "mean_env_wait_ms": 36.188703757902374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007363597115317544, "StateBufferConnector_ms": 0.005069538787171081, "ViewRequirementAgentConnector_ms": 0.10994070178859837}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142000, "num_agent_steps_trained": 142000, "num_env_steps_sampled": 142000, "num_env_steps_trained": 142000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.775047327159005, "num_env_steps_trained_throughput_per_sec": 24.775047327159005, "timesteps_total": 142000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 142000, "timers": {"training_iteration_time_ms": 80772.398, "sample_time_ms": 77557.29, "load_time_ms": 10.031, "load_throughput": 199377.478, "learn_time_ms": 3202.427, "learn_throughput": 624.526, "synch_weights_time_ms": 2.202}, "counters": {"num_env_steps_sampled": 142000, "num_env_steps_trained": 142000, "num_agent_steps_sampled": 142000, "num_agent_steps_trained": 142000}, "done": false, "episodes_total": 13050, "training_iteration": 71, "trial_id": "13850_00003", "date": "2023-12-28_19-23-06", "timestamp": 1703762586, "time_this_iter_s": 80.73391556739807, "time_total_s": 5736.265958070755, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5736.265958070755, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 55.82782608695651, "ram_util_percent": 92.59565217391305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2789769243681807e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.089984096421135, "policy_loss": -0.002292448232571284, "vf_loss": 4.092276525497437, "vf_explained_var": 0.19751048300001356, "kl": 0.005799097395791948, "entropy": 0.4236007325516807, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 32175.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 8.916666666666666, "episode_reward_mean": 9.103021978021978, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.083333333333332, 9.0, 9.083333333333334, 9.125, 9.041666666666666, 9.125, 9.125, 9.041666666666666, 9.125, 9.166666666666666, 9.083333333333332, 8.958333333333332, 9.083333333333332, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 8.958333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 8.958333333333332, 9.0, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.125, 9.166666666666666, 8.958333333333332, 9.166666666666666, 9.041666666666666, 9.125, 9.166666666666666, 9.125, 9.0, 9.208333333333334, 9.041666666666664, 9.166666666666666, 8.958333333333334, 9.125, 9.125, 9.125, 9.125, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.125, 8.999999999999998, 9.0, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.041666666666666, 9.0, 9.125, 9.041666666666668, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.041666666666666, 9.124999999999998, 9.041666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666666, 9.083333333333332, 9.166666666666666, 9.0, 9.125, 9.0, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.0, 9.166666666666666, 9.041666666666668, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.0, 9.125, 9.125, 8.958333333333334, 9.125, 9.166666666666666, 9.083333333333334, 9.0, 9.041666666666666, 9.125, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.0, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.124999999999998, 9.000000000000002, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.041666666666668, 9.124999999999998, 9.124999999999998, 9.166666666666666, 8.958333333333332, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 8.916666666666666, 8.958333333333334, 9.166666666666666, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.083333333333332, 9.041666666666668, 9.125, 9.125, 9.083333333333334, 9.041666666666666, 9.083333333333332, 9.0, 9.166666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.208333333333332, 9.083333333333332, 9.041666666666668, 9.0, 9.125, 9.25, 9.124999999999998, 9.125, 8.916666666666666, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.125, 9.125, 9.124999999999998], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.263979203977467, "mean_inference_ms": 1.202299134916612, "mean_action_processing_ms": 0.10639966482496964, "mean_env_wait_ms": 36.18996967915928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007559964945028116, "StateBufferConnector_ms": 0.005109231550614913, "ViewRequirementAgentConnector_ms": 0.11150286747859074}}, "episode_reward_max": 9.25, "episode_reward_min": 8.916666666666666, "episode_reward_mean": 9.103021978021978, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.083333333333332, 9.0, 9.083333333333334, 9.125, 9.041666666666666, 9.125, 9.125, 9.041666666666666, 9.125, 9.166666666666666, 9.083333333333332, 8.958333333333332, 9.083333333333332, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 8.958333333333334, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 8.958333333333332, 9.0, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.125, 9.166666666666666, 8.958333333333332, 9.166666666666666, 9.041666666666666, 9.125, 9.166666666666666, 9.125, 9.0, 9.208333333333334, 9.041666666666664, 9.166666666666666, 8.958333333333334, 9.125, 9.125, 9.125, 9.125, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.125, 8.999999999999998, 9.0, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.041666666666666, 9.0, 9.125, 9.041666666666668, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.041666666666666, 9.124999999999998, 9.041666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666666, 9.083333333333332, 9.166666666666666, 9.0, 9.125, 9.0, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.0, 9.166666666666666, 9.041666666666668, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.0, 9.125, 9.125, 8.958333333333334, 9.125, 9.166666666666666, 9.083333333333334, 9.0, 9.041666666666666, 9.125, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.249999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.0, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.124999999999998, 9.000000000000002, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.041666666666668, 9.124999999999998, 9.124999999999998, 9.166666666666666, 8.958333333333332, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 8.916666666666666, 8.958333333333334, 9.166666666666666, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.083333333333332, 9.041666666666668, 9.125, 9.125, 9.083333333333334, 9.041666666666666, 9.083333333333332, 9.0, 9.166666666666666, 9.083333333333332, 9.125, 9.166666666666666, 9.208333333333332, 9.083333333333332, 9.041666666666668, 9.0, 9.125, 9.25, 9.124999999999998, 9.125, 8.916666666666666, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.125, 9.125, 9.124999999999998], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.263979203977467, "mean_inference_ms": 1.202299134916612, "mean_action_processing_ms": 0.10639966482496964, "mean_env_wait_ms": 36.18996967915928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007559964945028116, "StateBufferConnector_ms": 0.005109231550614913, "ViewRequirementAgentConnector_ms": 0.11150286747859074}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.699289324751266, "num_env_steps_trained_throughput_per_sec": 24.699289324751266, "timesteps_total": 144000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 80879.582, "sample_time_ms": 77670.125, "load_time_ms": 10.534, "load_throughput": 189854.519, "learn_time_ms": 3196.283, "learn_throughput": 625.727, "synch_weights_time_ms": 2.197}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 13232, "training_iteration": 72, "trial_id": "13850_00003", "date": "2023-12-28_19-24-27", "timestamp": 1703762667, "time_this_iter_s": 80.98121166229248, "time_total_s": 5817.2471697330475, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5817.2471697330475, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 55.85478260869565, "ram_util_percent": 92.69739130434785}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2789769243681807e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.466832358042399, "policy_loss": 0.012061364125046464, "vf_loss": 4.454770982530382, "vf_explained_var": 0.266855352057351, "kl": 0.003949513975703249, "entropy": 0.41959312617778777, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 32625.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 146000, "num_env_steps_trained": 146000, "num_agent_steps_sampled": 146000, "num_agent_steps_trained": 146000}, "sampler_results": {"episode_reward_max": 9.333333333333332, "episode_reward_min": 8.916666666666666, "episode_reward_mean": 9.111721611721611, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.125, 9.166666666666666, 9.041666666666666, 9.125, 9.041666666666666, 9.041666666666666, 9.083333333333332, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.0, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.083333333333332, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666664, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.208333333333334, 9.125, 9.083333333333332, 9.125, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.124999999999998, 9.166666666666666, 9.0, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.0, 9.166666666666666, 9.166666666666666, 9.166666666666666, 8.916666666666668, 9.166666666666666, 9.0, 9.0, 8.958333333333332, 9.125, 9.083333333333334, 9.041666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.041666666666666, 9.125, 9.083333333333334, 9.166666666666666, 8.958333333333332, 9.124999999999998, 9.125, 9.0, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.083333333333334, 9.125, 9.083333333333332, 9.041666666666666, 9.125, 9.333333333333332, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.166666666666666, 9.0, 9.208333333333334, 9.041666666666666, 9.208333333333332, 9.041666666666668, 9.125, 9.083333333333334, 9.125, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.208333333333334, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.125, 9.166666666666666, 9.0, 9.125, 9.0, 9.083333333333334, 8.958333333333332, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.041666666666666, 9.125, 9.166666666666666, 8.916666666666666, 9.041666666666668, 9.166666666666666, 9.125, 9.041666666666668, 9.125, 9.125, 9.083333333333334, 9.166666666666666, 9.125, 9.25, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.083333333333334, 9.166666666666666, 9.0, 9.000000000000002, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.263918533294887, "mean_inference_ms": 1.2022997421587696, "mean_action_processing_ms": 0.10640637466240768, "mean_env_wait_ms": 36.19068766661532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075181761940757, "StateBufferConnector_ms": 0.005156129271119505, "ViewRequirementAgentConnector_ms": 0.11109912788474953}}, "episode_reward_max": 9.333333333333332, "episode_reward_min": 8.916666666666666, "episode_reward_mean": 9.111721611721611, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.125, 9.166666666666666, 9.041666666666666, 9.125, 9.041666666666666, 9.041666666666666, 9.083333333333332, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.0, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.125, 9.125, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.083333333333332, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666664, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.166666666666666, 9.208333333333334, 9.125, 9.083333333333332, 9.125, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.124999999999998, 9.166666666666666, 9.0, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.0, 9.166666666666666, 9.166666666666666, 9.166666666666666, 8.916666666666668, 9.166666666666666, 9.0, 9.0, 8.958333333333332, 9.125, 9.083333333333334, 9.041666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.041666666666666, 9.125, 9.083333333333334, 9.166666666666666, 8.958333333333332, 9.124999999999998, 9.125, 9.0, 9.166666666666666, 9.041666666666666, 9.083333333333334, 9.083333333333334, 9.125, 9.083333333333332, 9.041666666666666, 9.125, 9.333333333333332, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.083333333333334, 9.166666666666666, 9.0, 9.208333333333334, 9.041666666666666, 9.208333333333332, 9.041666666666668, 9.125, 9.083333333333334, 9.125, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.208333333333334, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.125, 9.166666666666666, 9.0, 9.125, 9.0, 9.083333333333334, 8.958333333333332, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.041666666666666, 9.125, 9.166666666666666, 8.916666666666666, 9.041666666666668, 9.166666666666666, 9.125, 9.041666666666668, 9.125, 9.125, 9.083333333333334, 9.166666666666666, 9.125, 9.25, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.083333333333334, 9.166666666666666, 9.0, 9.000000000000002, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.263918533294887, "mean_inference_ms": 1.2022997421587696, "mean_action_processing_ms": 0.10640637466240768, "mean_env_wait_ms": 36.19068766661532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075181761940757, "StateBufferConnector_ms": 0.005156129271119505, "ViewRequirementAgentConnector_ms": 0.11109912788474953}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 146000, "num_agent_steps_trained": 146000, "num_env_steps_sampled": 146000, "num_env_steps_trained": 146000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.712902578045913, "num_env_steps_trained_throughput_per_sec": 24.712902578045913, "timesteps_total": 146000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 146000, "timers": {"training_iteration_time_ms": 80797.282, "sample_time_ms": 77582.98, "load_time_ms": 10.761, "load_throughput": 185861.297, "learn_time_ms": 3200.899, "learn_throughput": 624.825, "synch_weights_time_ms": 2.204}, "counters": {"num_env_steps_sampled": 146000, "num_env_steps_trained": 146000, "num_agent_steps_sampled": 146000, "num_agent_steps_trained": 146000}, "done": false, "episodes_total": 13414, "training_iteration": 73, "trial_id": "13850_00003", "date": "2023-12-28_19-25-48", "timestamp": 1703762748, "time_this_iter_s": 80.93710517883301, "time_total_s": 5898.1842749118805, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5898.1842749118805, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 55.84521739130434, "ram_util_percent": 92.60521739130435}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.3948846218409034e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.566183019214206, "policy_loss": 0.0008994847536087036, "vf_loss": 4.565283539030287, "vf_explained_var": 0.2503721475601196, "kl": 0.003865137946380551, "entropy": 0.3689507438739141, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": 9.416666666666666, "episode_reward_min": 9.0, "episode_reward_mean": 9.13026556776557, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.083333333333332, 9.166666666666666, 9.125, 9.083333333333334, 9.083333333333332, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.0, 9.166666666666666, 9.166666666666666, 9.25, 9.125000000000002, 9.208333333333332, 9.0, 9.125, 9.166666666666666, 9.0, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.125, 9.125, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.041666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.0, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.000000000000002, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.166666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.041666666666668, 9.083333333333334, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.208333333333334, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.0, 9.124999999999998, 9.125, 9.125, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.25, 9.125, 9.25, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333332, 9.0, 9.124999999999998, 9.25, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.124999999999998, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.041666666666668, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.416666666666666, 9.166666666666666, 9.166666666666666, 9.000000000000002, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.041666666666668, 9.166666666666666, 9.041666666666668, 9.124999999999998, 9.125, 9.041666666666668, 9.166666666666666, 9.083333333333334, 9.125, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.124999999999998, 9.125], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.264090702371518, "mean_inference_ms": 1.202550606368654, "mean_action_processing_ms": 0.10642839864611923, "mean_env_wait_ms": 36.19753234538723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007736944890284276, "StateBufferConnector_ms": 0.005202895992404812, "ViewRequirementAgentConnector_ms": 0.11296246077988174}}, "episode_reward_max": 9.416666666666666, "episode_reward_min": 9.0, "episode_reward_mean": 9.13026556776557, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.083333333333332, 9.166666666666666, 9.125, 9.083333333333334, 9.083333333333332, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.0, 9.166666666666666, 9.166666666666666, 9.25, 9.125000000000002, 9.208333333333332, 9.0, 9.125, 9.166666666666666, 9.0, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.125, 9.125, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.041666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.0, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.000000000000002, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.208333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.166666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.041666666666668, 9.083333333333334, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.208333333333334, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.208333333333332, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.0, 9.124999999999998, 9.125, 9.125, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.25, 9.125, 9.25, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333332, 9.0, 9.124999999999998, 9.25, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.124999999999998, 9.124999999999998, 9.083333333333332, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.041666666666668, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.416666666666666, 9.166666666666666, 9.166666666666666, 9.000000000000002, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.041666666666668, 9.166666666666666, 9.041666666666668, 9.124999999999998, 9.125, 9.041666666666668, 9.166666666666666, 9.083333333333334, 9.125, 9.125, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.125, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.041666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.124999999999998, 9.125], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.264090702371518, "mean_inference_ms": 1.202550606368654, "mean_action_processing_ms": 0.10642839864611923, "mean_env_wait_ms": 36.19753234538723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007736944890284276, "StateBufferConnector_ms": 0.005202895992404812, "ViewRequirementAgentConnector_ms": 0.11296246077988174}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.40123653292194, "num_env_steps_trained_throughput_per_sec": 24.40123653292194, "timesteps_total": 148000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 80970.278, "sample_time_ms": 77743.417, "load_time_ms": 10.891, "load_throughput": 183634.911, "learn_time_ms": 3213.296, "learn_throughput": 622.414, "synch_weights_time_ms": 2.229}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 13596, "training_iteration": 74, "trial_id": "13850_00003", "date": "2023-12-28_19-27-10", "timestamp": 1703762830, "time_this_iter_s": 81.97066164016724, "time_total_s": 5980.154936552048, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5980.154936552048, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 56.0, "ram_util_percent": 92.59572649572652}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.1974423109204517e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.73217204729716, "policy_loss": 0.0027520094936092695, "vf_loss": 4.729420031971402, "vf_explained_var": 0.2580919685628679, "kl": 0.0027408079328432046, "entropy": 0.3657796359062195, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33525.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000}, "sampler_results": {"episode_reward_max": 9.333333333333334, "episode_reward_min": 8.958333333333332, "episode_reward_mean": 9.130952380952381, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.0, 9.041666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.0, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.250000000000002, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.333333333333334, 9.125, 9.125, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.25, 9.124999999999998, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.000000000000002, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333334, 9.291666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.083333333333332, 9.124999999999998, 9.083333333333332, 9.041666666666666, 9.125, 9.041666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.125, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.0, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.041666666666666, 9.208333333333334, 9.041666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 8.958333333333332, 8.999999999999998, 9.083333333333334, 9.041666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.041666666666664, 9.125, 9.0, 9.041666666666668, 9.291666666666666, 9.166666666666666, 9.125, 9.041666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 8.958333333333334, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.083333333333334, 9.166666666666666, 9.125, 9.041666666666668, 9.083333333333332, 9.041666666666666, 9.125, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.125, 9.124999999999998, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.125, 9.166666666666666, 9.0, 9.125, 9.083333333333334], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2641290948522586, "mean_inference_ms": 1.202717411418836, "mean_action_processing_ms": 0.10645350059136811, "mean_env_wait_ms": 36.20479712498125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007720569987873455, "StateBufferConnector_ms": 0.005249793712909405, "ViewRequirementAgentConnector_ms": 0.11195664877419943}}, "episode_reward_max": 9.333333333333334, "episode_reward_min": 8.958333333333332, "episode_reward_mean": 9.130952380952381, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.125, 9.166666666666666, 9.0, 9.041666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.0, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.250000000000002, 9.166666666666666, 9.041666666666666, 9.166666666666666, 9.333333333333334, 9.125, 9.125, 9.125, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.25, 9.124999999999998, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.000000000000002, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.083333333333334, 9.291666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.125, 9.166666666666666, 9.083333333333332, 9.124999999999998, 9.083333333333332, 9.041666666666666, 9.125, 9.041666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.125, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.124999999999998, 9.083333333333334, 9.0, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.041666666666666, 9.208333333333334, 9.041666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 8.958333333333332, 8.999999999999998, 9.083333333333334, 9.041666666666666, 9.125, 9.125, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.041666666666664, 9.125, 9.0, 9.041666666666668, 9.291666666666666, 9.166666666666666, 9.125, 9.041666666666666, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 8.958333333333334, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.125, 9.083333333333334, 9.166666666666666, 9.125, 9.041666666666668, 9.083333333333332, 9.041666666666666, 9.125, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.125, 9.124999999999998, 9.166666666666666, 9.125, 9.083333333333332, 9.166666666666666, 9.25, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.125, 9.083333333333334, 9.125, 9.166666666666666, 9.0, 9.125, 9.083333333333334], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2641290948522586, "mean_inference_ms": 1.202717411418836, "mean_action_processing_ms": 0.10645350059136811, "mean_env_wait_ms": 36.20479712498125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007720569987873455, "StateBufferConnector_ms": 0.005249793712909405, "ViewRequirementAgentConnector_ms": 0.11195664877419943}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000, "num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.406976728488072, "num_env_steps_trained_throughput_per_sec": 24.406976728488072, "timesteps_total": 150000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 150000, "timers": {"training_iteration_time_ms": 81030.452, "sample_time_ms": 77802.485, "load_time_ms": 11.105, "load_throughput": 180094.206, "learn_time_ms": 3214.187, "learn_throughput": 622.241, "synch_weights_time_ms": 2.23}, "counters": {"num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000}, "done": false, "episodes_total": 13778, "training_iteration": 75, "trial_id": "13850_00003", "date": "2023-12-28_19-28-32", "timestamp": 1703762912, "time_this_iter_s": 81.95092225074768, "time_total_s": 6062.105858802795, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6062.105858802795, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 55.928448275862074, "ram_util_percent": 92.61724137931036}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5987211554602259e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.882458963394165, "policy_loss": 0.004203903592295117, "vf_loss": 4.878255049387614, "vf_explained_var": 0.24108057141304015, "kl": 0.004860891787611399, "entropy": 0.42482103678915234, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33975.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": 9.25, "episode_reward_min": 8.958333333333334, "episode_reward_mean": 9.12591575091575, "episode_len_mean": 11.0, "episode_media": {}, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.124999999999998, 9.125, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.208333333333332, 9.125, 9.0, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.041666666666666, 9.208333333333332, 9.125, 9.125, 9.166666666666666, 9.124999999999998, 9.125, 9.041666666666668, 9.083333333333334, 9.166666666666666, 9.208333333333332, 9.124999999999998, 9.0, 9.125, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.125, 9.041666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.041666666666666, 9.041666666666668, 9.083333333333334, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.124999999999998, 9.25, 9.083333333333334, 9.166666666666666, 9.125, 9.125, 9.041666666666664, 9.083333333333334, 9.125, 9.166666666666666, 9.124999999999998, 9.125, 9.083333333333334, 9.125, 9.25, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.041666666666668, 9.125, 9.208333333333334, 9.166666666666666, 9.125, 9.125, 9.125, 9.125, 9.0, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.124999999999998, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666668, 9.166666666666666, 9.0, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666668, 9.0, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666668, 9.124999999999998, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.0, 9.083333333333332, 9.083333333333332, 9.041666666666666, 9.125, 9.124999999999998, 9.125, 9.083333333333332, 9.125, 9.083333333333334, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.000000000000002, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.041666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.083333333333332, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 8.958333333333334, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2642951202422694, "mean_inference_ms": 1.2029730008864572, "mean_action_processing_ms": 0.10649135135176786, "mean_env_wait_ms": 36.21476858893704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007556427966107379, "StateBufferConnector_ms": 0.005179185133713942, "ViewRequirementAgentConnector_ms": 0.11241108506590455}}, "episode_reward_max": 9.25, "episode_reward_min": 8.958333333333334, "episode_reward_mean": 9.12591575091575, "episode_len_mean": 11.0, "episodes_this_iter": 182, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.166666666666666, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.208333333333332, 9.166666666666666, 9.124999999999998, 9.125, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.208333333333332, 9.125, 9.0, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.041666666666666, 9.208333333333332, 9.125, 9.125, 9.166666666666666, 9.124999999999998, 9.125, 9.041666666666668, 9.083333333333334, 9.166666666666666, 9.208333333333332, 9.124999999999998, 9.0, 9.125, 9.124999999999998, 9.124999999999998, 9.166666666666666, 9.125, 9.041666666666666, 9.124999999999998, 9.125, 9.166666666666666, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.041666666666666, 9.041666666666668, 9.083333333333334, 9.166666666666666, 9.124999999999998, 9.083333333333332, 9.083333333333334, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.124999999999998, 9.25, 9.083333333333334, 9.166666666666666, 9.125, 9.125, 9.041666666666664, 9.083333333333334, 9.125, 9.166666666666666, 9.124999999999998, 9.125, 9.083333333333334, 9.125, 9.25, 9.166666666666666, 9.125, 9.124999999999998, 9.166666666666666, 9.041666666666668, 9.125, 9.208333333333334, 9.166666666666666, 9.125, 9.125, 9.125, 9.125, 9.0, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.124999999999998, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666668, 9.166666666666666, 9.0, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.041666666666666, 9.166666666666668, 9.0, 9.125, 9.166666666666666, 9.124999999999998, 9.166666666666666, 9.166666666666668, 9.124999999999998, 9.125, 9.166666666666666, 9.125, 9.083333333333334, 9.041666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.083333333333332, 9.166666666666666, 9.166666666666666, 9.25, 9.166666666666666, 9.208333333333334, 9.166666666666666, 9.166666666666666, 9.166666666666666, 9.0, 9.083333333333332, 9.083333333333332, 9.041666666666666, 9.125, 9.124999999999998, 9.125, 9.083333333333332, 9.125, 9.083333333333334, 9.166666666666666, 9.041666666666668, 9.166666666666666, 9.166666666666666, 9.125, 9.166666666666666, 9.125, 9.125, 9.166666666666666, 9.083333333333332, 9.166666666666666, 9.000000000000002, 9.166666666666666, 9.166666666666666, 9.083333333333332, 9.041666666666666, 9.083333333333332, 9.166666666666666, 9.125, 9.166666666666666, 9.083333333333332, 9.083333333333332, 9.083333333333332, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.125, 8.958333333333334, 9.124999999999998, 9.166666666666666, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.083333333333334, 9.166666666666666, 9.166666666666666], "episode_lengths": [11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2642951202422694, "mean_inference_ms": 1.2029730008864572, "mean_action_processing_ms": 0.10649135135176786, "mean_env_wait_ms": 36.21476858893704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007556427966107379, "StateBufferConnector_ms": 0.005179185133713942, "ViewRequirementAgentConnector_ms": 0.11241108506590455}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 24.207173686319987, "num_env_steps_trained_throughput_per_sec": 24.207173686319987, "timesteps_total": 152000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 81113.419, "sample_time_ms": 77863.631, "load_time_ms": 11.462, "load_throughput": 174482.404, "learn_time_ms": 3235.699, "learn_throughput": 618.104, "synch_weights_time_ms": 2.185}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 13960, "training_iteration": 76, "trial_id": "13850_00003", "date": "2023-12-28_19-29-55", "timestamp": 1703762995, "time_this_iter_s": 82.62715482711792, "time_total_s": 6144.733013629913, "pid": 390998, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "roundabout-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6144.733013629913, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 59.13474576271188, "ram_util_percent": 92.60762711864406}}
