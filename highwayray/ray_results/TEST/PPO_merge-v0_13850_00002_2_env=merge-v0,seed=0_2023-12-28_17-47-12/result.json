{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.095608189900716, "policy_loss": -0.03064645236151086, "vf_loss": 5.120175361633301, "vf_explained_var": 0.03794812877972921, "kl": 0.030396407598604357, "entropy": 1.5797831916809082, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 2000}, "sampler_results": {"episode_reward_max": 14.861111111111114, "episode_reward_min": 4.333333333333334, "episode_reward_mean": 7.449690033381021, "episode_len_mean": 8.583690987124463, "episode_media": {}, "episodes_this_iter": 233, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.111111111111111, 5.222222222222222, 7.027777777777779, 5.277777777777778, 7.055555555555556, 12.25, 10.222222222222225, 5.25, 5.194444444444445, 5.25, 6.750000000000001, 8.750000000000002, 6.027777777777779, 12.25, 10.305555555555557, 13.972222222222223, 12.805555555555559, 9.38888888888889, 5.972222222222221, 12.972222222222223, 5.25, 4.388888888888889, 5.25, 5.25, 9.499999999999998, 5.333333333333334, 4.444444444444445, 6.111111111111111, 9.500000000000002, 7.833333333333334, 4.388888888888889, 4.388888888888889, 5.166666666666667, 5.222222222222222, 6.888888888888889, 11.611111111111112, 9.250000000000002, 5.305555555555556, 8.333333333333334, 12.138888888888888, 7.9444444444444455, 5.333333333333334, 4.333333333333334, 13.916666666666668, 5.305555555555556, 6.972222222222223, 12.61111111111111, 5.972222222222221, 6.027777777777777, 8.583333333333334, 7.027777777777779, 6.138888888888888, 7.944444444444445, 5.333333333333334, 5.222222222222222, 5.972222222222222, 5.305555555555556, 6.277777777777778, 8.055555555555555, 6.0, 5.305555555555556, 7.0, 7.722222222222222, 7.583333333333333, 6.166666666666666, 9.444444444444445, 5.888888888888889, 9.305555555555557, 7.111111111111112, 5.305555555555555, 8.444444444444445, 7.833333333333334, 5.25, 7.027777777777779, 5.972222222222222, 13.38888888888889, 5.222222222222222, 13.444444444444448, 5.277777777777778, 5.333333333333334, 13.055555555555557, 5.944444444444444, 13.166666666666666, 8.416666666666666, 5.333333333333334, 13.361111111111114, 5.9444444444444455, 4.388888888888889, 7.61111111111111, 9.416666666666668, 5.194444444444445, 6.083333333333334, 12.361111111111112, 13.083333333333334, 4.388888888888889, 6.083333333333334, 8.500000000000002, 7.805555555555557, 7.277777777777779, 6.083333333333334, 5.25, 7.583333333333332, 4.972222222222222, 13.555555555555555, 7.75, 5.277777777777778, 7.916666666666667, 4.999999999999999, 13.02777777777778, 12.222222222222225, 5.083333333333334, 11.083333333333336, 5.361111111111112, 7.944444444444446, 6.055555555555555, 5.277777777777779, 6.166666666666668, 6.166666666666666, 5.166666666666667, 5.111111111111111, 8.694444444444445, 10.388888888888891, 7.722222222222221, 4.416666666666667, 4.388888888888889, 11.38888888888889, 5.333333333333334, 4.416666666666667, 5.305555555555555, 13.722222222222223, 4.444444444444445, 4.444444444444445, 7.111111111111111, 11.222222222222223, 9.472222222222223, 9.88888888888889, 5.083333333333333, 10.305555555555555, 5.305555555555555, 7.972222222222223, 5.194444444444445, 6.166666666666667, 4.416666666666667, 6.222222222222223, 8.583333333333334, 4.444444444444445, 6.111111111111111, 7.6944444444444455, 8.472222222222223, 6.083333333333334, 14.833333333333336, 4.361111111111112, 9.583333333333334, 7.8611111111111125, 14.861111111111114, 6.166666666666667, 5.250000000000001, 7.777777777777778, 12.083333333333334, 5.305555555555556, 10.111111111111112, 6.166666666666667, 6.138888888888889, 7.555555555555555, 13.13888888888889, 6.0, 5.361111111111112, 8.777777777777777, 5.194444444444445, 9.38888888888889, 6.888888888888889, 4.416666666666667, 8.972222222222221, 5.222222222222222, 8.305555555555555, 5.944444444444445, 8.055555555555555, 6.138888888888889, 4.416666666666667, 6.0, 5.75, 4.416666666666667, 6.250000000000001, 6.111111111111111, 5.194444444444445, 10.166666666666666, 14.722222222222223, 8.750000000000002, 11.944444444444445, 5.222222222222222, 7.88888888888889, 7.888888888888889, 4.416666666666667, 12.055555555555557, 5.972222222222223, 4.416666666666667, 4.444444444444445, 5.027777777777777, 6.083333333333333, 12.472222222222223, 7.888888888888889, 6.222222222222222, 8.111111111111112, 9.527777777777779, 4.416666666666667, 6.138888888888888, 5.333333333333334, 9.36111111111111, 7.916666666666668, 4.416666666666667, 4.388888888888889, 6.138888888888889, 7.9444444444444455, 10.277777777777777, 5.111111111111111, 5.222222222222222, 5.194444444444445, 6.055555555555555, 7.083333333333334, 6.944444444444445, 6.138888888888889, 9.500000000000002, 6.972222222222223, 6.611111111111111, 7.833333333333334, 12.888888888888891, 4.388888888888889, 7.083333333333334, 4.416666666666667, 12.694444444444445, 6.888888888888889, 13.055555555555554, 8.333333333333334], "episode_lengths": [7, 6, 8, 6, 8, 14, 12, 6, 6, 6, 8, 10, 7, 15, 12, 16, 15, 11, 7, 15, 6, 5, 6, 6, 11, 6, 5, 7, 11, 9, 5, 5, 6, 6, 8, 14, 11, 6, 10, 14, 9, 6, 5, 16, 6, 8, 15, 7, 7, 10, 8, 7, 9, 6, 6, 7, 6, 7, 9, 7, 6, 8, 9, 9, 7, 11, 7, 11, 8, 6, 10, 9, 6, 8, 7, 15, 6, 15, 6, 6, 15, 7, 15, 10, 6, 15, 7, 5, 9, 11, 6, 7, 14, 15, 5, 7, 10, 9, 8, 7, 6, 9, 6, 15, 9, 6, 9, 6, 15, 14, 6, 13, 6, 9, 7, 6, 7, 7, 6, 6, 10, 12, 9, 5, 5, 13, 6, 5, 6, 16, 5, 5, 8, 13, 11, 12, 6, 12, 6, 9, 6, 7, 5, 7, 10, 5, 7, 9, 10, 7, 17, 5, 11, 9, 17, 7, 6, 9, 14, 6, 12, 7, 7, 9, 15, 7, 6, 10, 6, 11, 8, 5, 11, 6, 10, 7, 9, 7, 5, 7, 7, 5, 7, 7, 6, 12, 17, 10, 14, 6, 9, 9, 5, 14, 7, 5, 5, 6, 7, 14, 9, 7, 9, 11, 5, 7, 6, 11, 9, 5, 5, 7, 9, 12, 6, 6, 6, 7, 8, 8, 7, 11, 8, 8, 9, 15, 5, 8, 5, 14, 8, 15, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3270770115354311, "mean_inference_ms": 1.243772416160084, "mean_action_processing_ms": 0.10570069064741315, "mean_env_wait_ms": 21.270450266047394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007593017790962187, "StateBufferConnector_ms": 0.007373324791249287, "ViewRequirementAgentConnector_ms": 0.11325580879342402}}, "episode_reward_max": 14.861111111111114, "episode_reward_min": 4.333333333333334, "episode_reward_mean": 7.449690033381021, "episode_len_mean": 8.583690987124463, "episodes_this_iter": 233, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.111111111111111, 5.222222222222222, 7.027777777777779, 5.277777777777778, 7.055555555555556, 12.25, 10.222222222222225, 5.25, 5.194444444444445, 5.25, 6.750000000000001, 8.750000000000002, 6.027777777777779, 12.25, 10.305555555555557, 13.972222222222223, 12.805555555555559, 9.38888888888889, 5.972222222222221, 12.972222222222223, 5.25, 4.388888888888889, 5.25, 5.25, 9.499999999999998, 5.333333333333334, 4.444444444444445, 6.111111111111111, 9.500000000000002, 7.833333333333334, 4.388888888888889, 4.388888888888889, 5.166666666666667, 5.222222222222222, 6.888888888888889, 11.611111111111112, 9.250000000000002, 5.305555555555556, 8.333333333333334, 12.138888888888888, 7.9444444444444455, 5.333333333333334, 4.333333333333334, 13.916666666666668, 5.305555555555556, 6.972222222222223, 12.61111111111111, 5.972222222222221, 6.027777777777777, 8.583333333333334, 7.027777777777779, 6.138888888888888, 7.944444444444445, 5.333333333333334, 5.222222222222222, 5.972222222222222, 5.305555555555556, 6.277777777777778, 8.055555555555555, 6.0, 5.305555555555556, 7.0, 7.722222222222222, 7.583333333333333, 6.166666666666666, 9.444444444444445, 5.888888888888889, 9.305555555555557, 7.111111111111112, 5.305555555555555, 8.444444444444445, 7.833333333333334, 5.25, 7.027777777777779, 5.972222222222222, 13.38888888888889, 5.222222222222222, 13.444444444444448, 5.277777777777778, 5.333333333333334, 13.055555555555557, 5.944444444444444, 13.166666666666666, 8.416666666666666, 5.333333333333334, 13.361111111111114, 5.9444444444444455, 4.388888888888889, 7.61111111111111, 9.416666666666668, 5.194444444444445, 6.083333333333334, 12.361111111111112, 13.083333333333334, 4.388888888888889, 6.083333333333334, 8.500000000000002, 7.805555555555557, 7.277777777777779, 6.083333333333334, 5.25, 7.583333333333332, 4.972222222222222, 13.555555555555555, 7.75, 5.277777777777778, 7.916666666666667, 4.999999999999999, 13.02777777777778, 12.222222222222225, 5.083333333333334, 11.083333333333336, 5.361111111111112, 7.944444444444446, 6.055555555555555, 5.277777777777779, 6.166666666666668, 6.166666666666666, 5.166666666666667, 5.111111111111111, 8.694444444444445, 10.388888888888891, 7.722222222222221, 4.416666666666667, 4.388888888888889, 11.38888888888889, 5.333333333333334, 4.416666666666667, 5.305555555555555, 13.722222222222223, 4.444444444444445, 4.444444444444445, 7.111111111111111, 11.222222222222223, 9.472222222222223, 9.88888888888889, 5.083333333333333, 10.305555555555555, 5.305555555555555, 7.972222222222223, 5.194444444444445, 6.166666666666667, 4.416666666666667, 6.222222222222223, 8.583333333333334, 4.444444444444445, 6.111111111111111, 7.6944444444444455, 8.472222222222223, 6.083333333333334, 14.833333333333336, 4.361111111111112, 9.583333333333334, 7.8611111111111125, 14.861111111111114, 6.166666666666667, 5.250000000000001, 7.777777777777778, 12.083333333333334, 5.305555555555556, 10.111111111111112, 6.166666666666667, 6.138888888888889, 7.555555555555555, 13.13888888888889, 6.0, 5.361111111111112, 8.777777777777777, 5.194444444444445, 9.38888888888889, 6.888888888888889, 4.416666666666667, 8.972222222222221, 5.222222222222222, 8.305555555555555, 5.944444444444445, 8.055555555555555, 6.138888888888889, 4.416666666666667, 6.0, 5.75, 4.416666666666667, 6.250000000000001, 6.111111111111111, 5.194444444444445, 10.166666666666666, 14.722222222222223, 8.750000000000002, 11.944444444444445, 5.222222222222222, 7.88888888888889, 7.888888888888889, 4.416666666666667, 12.055555555555557, 5.972222222222223, 4.416666666666667, 4.444444444444445, 5.027777777777777, 6.083333333333333, 12.472222222222223, 7.888888888888889, 6.222222222222222, 8.111111111111112, 9.527777777777779, 4.416666666666667, 6.138888888888888, 5.333333333333334, 9.36111111111111, 7.916666666666668, 4.416666666666667, 4.388888888888889, 6.138888888888889, 7.9444444444444455, 10.277777777777777, 5.111111111111111, 5.222222222222222, 5.194444444444445, 6.055555555555555, 7.083333333333334, 6.944444444444445, 6.138888888888889, 9.500000000000002, 6.972222222222223, 6.611111111111111, 7.833333333333334, 12.888888888888891, 4.388888888888889, 7.083333333333334, 4.416666666666667, 12.694444444444445, 6.888888888888889, 13.055555555555554, 8.333333333333334], "episode_lengths": [7, 6, 8, 6, 8, 14, 12, 6, 6, 6, 8, 10, 7, 15, 12, 16, 15, 11, 7, 15, 6, 5, 6, 6, 11, 6, 5, 7, 11, 9, 5, 5, 6, 6, 8, 14, 11, 6, 10, 14, 9, 6, 5, 16, 6, 8, 15, 7, 7, 10, 8, 7, 9, 6, 6, 7, 6, 7, 9, 7, 6, 8, 9, 9, 7, 11, 7, 11, 8, 6, 10, 9, 6, 8, 7, 15, 6, 15, 6, 6, 15, 7, 15, 10, 6, 15, 7, 5, 9, 11, 6, 7, 14, 15, 5, 7, 10, 9, 8, 7, 6, 9, 6, 15, 9, 6, 9, 6, 15, 14, 6, 13, 6, 9, 7, 6, 7, 7, 6, 6, 10, 12, 9, 5, 5, 13, 6, 5, 6, 16, 5, 5, 8, 13, 11, 12, 6, 12, 6, 9, 6, 7, 5, 7, 10, 5, 7, 9, 10, 7, 17, 5, 11, 9, 17, 7, 6, 9, 14, 6, 12, 7, 7, 9, 15, 7, 6, 10, 6, 11, 8, 5, 11, 6, 10, 7, 9, 7, 5, 7, 7, 5, 7, 7, 6, 12, 17, 10, 14, 6, 9, 9, 5, 14, 7, 5, 5, 6, 7, 14, 9, 7, 9, 11, 5, 7, 6, 11, 9, 5, 5, 7, 9, 12, 6, 6, 6, 7, 8, 8, 7, 11, 8, 8, 9, 15, 5, 8, 5, 14, 8, 15, 10]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3270770115354311, "mean_inference_ms": 1.243772416160084, "mean_action_processing_ms": 0.10570069064741315, "mean_env_wait_ms": 21.270450266047394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007593017790962187, "StateBufferConnector_ms": 0.007373324791249287, "ViewRequirementAgentConnector_ms": 0.11325580879342402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 2000, "num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.34345954523419, "num_env_steps_trained_throughput_per_sec": 38.34345954523419, "timesteps_total": 2000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 2000, "timers": {"training_iteration_time_ms": 52160.102, "sample_time_ms": 47964.375, "load_time_ms": 17.342, "load_throughput": 115324.764, "learn_time_ms": 4175.142, "learn_throughput": 479.026, "synch_weights_time_ms": 2.685}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 2000}, "done": false, "episodes_total": 233, "training_iteration": 1, "trial_id": "13850_00002", "date": "2023-12-28_17-48-21", "timestamp": 1703756901, "time_this_iter_s": 52.1679847240448, "time_total_s": 52.1679847240448, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 52.1679847240448, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 56.853333333333325, "ram_util_percent": 91.02133333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.528002318806118, "policy_loss": -0.044250279578069845, "vf_loss": 4.565712990760804, "vf_explained_var": 0.24244766738679674, "kl": 0.021798724429881986, "entropy": 1.5100947488678826, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 675.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 14.805555555555559, "episode_reward_min": 4.388888888888889, "episode_reward_mean": 8.610413176996092, "episode_len_mean": 10.040201005025125, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.8611111111111125, 13.750000000000002, 5.194444444444445, 12.638888888888893, 6.0, 13.305555555555554, 5.305555555555555, 5.25, 7.527777777777778, 7.611111111111111, 9.305555555555557, 5.888888888888888, 9.194444444444445, 5.999999999999999, 5.305555555555555, 5.027777777777778, 7.444444444444445, 12.638888888888888, 13.194444444444448, 13.055555555555557, 7.000000000000001, 6.055555555555555, 8.944444444444443, 10.5, 7.111111111111112, 11.972222222222223, 4.416666666666667, 7.777777777777778, 6.0, 9.305555555555557, 12.805555555555557, 7.111111111111111, 9.25, 6.777777777777778, 5.305555555555555, 5.027777777777778, 5.194444444444445, 5.194444444444445, 12.111111111111112, 9.583333333333334, 13.388888888888891, 6.888888888888889, 13.305555555555555, 5.972222222222223, 13.000000000000002, 6.111111111111112, 5.944444444444445, 12.61111111111111, 7.444444444444444, 9.416666666666668, 6.055555555555555, 9.277777777777779, 9.222222222222223, 5.361111111111112, 12.055555555555554, 13.694444444444446, 6.111111111111111, 13.027777777777779, 5.972222222222221, 12.333333333333332, 12.333333333333336, 4.999999999999999, 9.083333333333332, 5.222222222222221, 6.0, 10.000000000000002, 6.666666666666666, 8.36111111111111, 6.777777777777779, 9.805555555555554, 6.861111111111112, 5.166666666666666, 5.972222222222222, 12.305555555555555, 10.222222222222223, 8.416666666666668, 13.944444444444445, 11.38888888888889, 5.166666666666667, 10.333333333333334, 13.611111111111109, 7.694444444444446, 5.194444444444445, 5.222222222222222, 11.583333333333334, 7.888888888888889, 9.583333333333336, 5.166666666666667, 4.916666666666666, 7.361111111111112, 6.166666666666666, 9.86111111111111, 6.916666666666667, 10.222222222222221, 9.166666666666664, 10.666666666666668, 12.250000000000002, 5.277777777777778, 12.194444444444445, 5.277777777777779, 13.638888888888891, 8.555555555555557, 6.805555555555557, 4.388888888888889, 13.777777777777779, 5.888888888888889, 9.444444444444446, 6.083333333333334, 5.027777777777778, 6.861111111111112, 5.111111111111112, 11.027777777777779, 14.805555555555559, 13.666666666666668, 5.111111111111111, 6.861111111111112, 13.22222222222222, 5.277777777777779, 9.111111111111112, 12.305555555555557, 11.944444444444443, 7.5555555555555545, 6.861111111111112, 13.888888888888891, 6.75, 13.055555555555555, 6.25, 7.777777777777779, 5.222222222222221, 5.944444444444445, 5.888888888888889, 7.416666666666665, 9.305555555555555, 7.111111111111112, 7.138888888888889, 12.166666666666668, 5.027777777777778, 4.416666666666667, 13.472222222222225, 13.000000000000004, 7.666666666666668, 8.333333333333334, 10.638888888888888, 9.36111111111111, 11.75, 7.694444444444445, 7.777777777777779, 9.083333333333334, 8.277777777777779, 12.916666666666666, 4.972222222222222, 8.777777777777779, 14.138888888888888, 6.833333333333334, 7.055555555555556, 13.888888888888891, 13.055555555555557, 7.722222222222223, 13.138888888888888, 5.166666666666666, 9.777777777777779, 5.944444444444445, 5.333333333333334, 9.222222222222221, 14.36111111111111, 6.75, 5.194444444444445, 9.666666666666666, 5.25, 8.77777777777778, 7.611111111111111, 13.750000000000002, 8.777777777777779, 6.75, 7.138888888888889, 5.277777777777779, 12.388888888888891, 11.027777777777779, 6.0, 7.833333333333334, 14.472222222222223, 6.611111111111111, 4.388888888888889, 6.027777777777777, 10.416666666666668, 12.333333333333336, 6.611111111111111, 9.41666666666667, 9.86111111111111, 7.6944444444444455, 11.222222222222225, 6.861111111111112, 12.972222222222221, 6.055555555555555, 5.888888888888889, 14.36111111111111, 5.166666666666666, 4.388888888888889, 6.083333333333334], "episode_lengths": [8, 16, 6, 14, 7, 15, 6, 6, 9, 9, 11, 7, 11, 7, 6, 6, 9, 14, 15, 15, 8, 7, 11, 13, 8, 14, 5, 9, 7, 11, 15, 8, 11, 8, 6, 6, 6, 6, 14, 11, 15, 8, 15, 7, 15, 7, 7, 14, 9, 11, 7, 11, 11, 6, 14, 16, 7, 15, 7, 14, 14, 6, 11, 6, 7, 12, 8, 10, 8, 12, 8, 6, 7, 14, 12, 10, 16, 14, 6, 12, 15, 9, 6, 6, 14, 9, 11, 6, 6, 9, 7, 12, 8, 12, 11, 13, 14, 6, 14, 6, 16, 10, 8, 5, 16, 7, 11, 7, 6, 8, 6, 13, 17, 16, 6, 8, 15, 6, 11, 14, 14, 9, 8, 16, 8, 15, 7, 9, 6, 7, 7, 9, 11, 8, 8, 14, 6, 5, 16, 15, 9, 10, 13, 11, 14, 9, 9, 11, 10, 15, 6, 10, 17, 8, 8, 16, 15, 9, 16, 6, 11, 7, 6, 11, 17, 8, 6, 12, 6, 10, 9, 16, 10, 8, 8, 6, 14, 13, 7, 9, 17, 8, 5, 7, 12, 14, 8, 11, 12, 9, 13, 8, 15, 7, 7, 17, 6, 5, 7]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.243221971339746, "mean_inference_ms": 1.2286960169900152, "mean_action_processing_ms": 0.10460533222178464, "mean_env_wait_ms": 21.264774445979718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00748382740883372, "StateBufferConnector_ms": 0.006601558857826731, "ViewRequirementAgentConnector_ms": 0.11160038224416761}}, "episode_reward_max": 14.805555555555559, "episode_reward_min": 4.388888888888889, "episode_reward_mean": 8.610413176996092, "episode_len_mean": 10.040201005025125, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.8611111111111125, 13.750000000000002, 5.194444444444445, 12.638888888888893, 6.0, 13.305555555555554, 5.305555555555555, 5.25, 7.527777777777778, 7.611111111111111, 9.305555555555557, 5.888888888888888, 9.194444444444445, 5.999999999999999, 5.305555555555555, 5.027777777777778, 7.444444444444445, 12.638888888888888, 13.194444444444448, 13.055555555555557, 7.000000000000001, 6.055555555555555, 8.944444444444443, 10.5, 7.111111111111112, 11.972222222222223, 4.416666666666667, 7.777777777777778, 6.0, 9.305555555555557, 12.805555555555557, 7.111111111111111, 9.25, 6.777777777777778, 5.305555555555555, 5.027777777777778, 5.194444444444445, 5.194444444444445, 12.111111111111112, 9.583333333333334, 13.388888888888891, 6.888888888888889, 13.305555555555555, 5.972222222222223, 13.000000000000002, 6.111111111111112, 5.944444444444445, 12.61111111111111, 7.444444444444444, 9.416666666666668, 6.055555555555555, 9.277777777777779, 9.222222222222223, 5.361111111111112, 12.055555555555554, 13.694444444444446, 6.111111111111111, 13.027777777777779, 5.972222222222221, 12.333333333333332, 12.333333333333336, 4.999999999999999, 9.083333333333332, 5.222222222222221, 6.0, 10.000000000000002, 6.666666666666666, 8.36111111111111, 6.777777777777779, 9.805555555555554, 6.861111111111112, 5.166666666666666, 5.972222222222222, 12.305555555555555, 10.222222222222223, 8.416666666666668, 13.944444444444445, 11.38888888888889, 5.166666666666667, 10.333333333333334, 13.611111111111109, 7.694444444444446, 5.194444444444445, 5.222222222222222, 11.583333333333334, 7.888888888888889, 9.583333333333336, 5.166666666666667, 4.916666666666666, 7.361111111111112, 6.166666666666666, 9.86111111111111, 6.916666666666667, 10.222222222222221, 9.166666666666664, 10.666666666666668, 12.250000000000002, 5.277777777777778, 12.194444444444445, 5.277777777777779, 13.638888888888891, 8.555555555555557, 6.805555555555557, 4.388888888888889, 13.777777777777779, 5.888888888888889, 9.444444444444446, 6.083333333333334, 5.027777777777778, 6.861111111111112, 5.111111111111112, 11.027777777777779, 14.805555555555559, 13.666666666666668, 5.111111111111111, 6.861111111111112, 13.22222222222222, 5.277777777777779, 9.111111111111112, 12.305555555555557, 11.944444444444443, 7.5555555555555545, 6.861111111111112, 13.888888888888891, 6.75, 13.055555555555555, 6.25, 7.777777777777779, 5.222222222222221, 5.944444444444445, 5.888888888888889, 7.416666666666665, 9.305555555555555, 7.111111111111112, 7.138888888888889, 12.166666666666668, 5.027777777777778, 4.416666666666667, 13.472222222222225, 13.000000000000004, 7.666666666666668, 8.333333333333334, 10.638888888888888, 9.36111111111111, 11.75, 7.694444444444445, 7.777777777777779, 9.083333333333334, 8.277777777777779, 12.916666666666666, 4.972222222222222, 8.777777777777779, 14.138888888888888, 6.833333333333334, 7.055555555555556, 13.888888888888891, 13.055555555555557, 7.722222222222223, 13.138888888888888, 5.166666666666666, 9.777777777777779, 5.944444444444445, 5.333333333333334, 9.222222222222221, 14.36111111111111, 6.75, 5.194444444444445, 9.666666666666666, 5.25, 8.77777777777778, 7.611111111111111, 13.750000000000002, 8.777777777777779, 6.75, 7.138888888888889, 5.277777777777779, 12.388888888888891, 11.027777777777779, 6.0, 7.833333333333334, 14.472222222222223, 6.611111111111111, 4.388888888888889, 6.027777777777777, 10.416666666666668, 12.333333333333336, 6.611111111111111, 9.41666666666667, 9.86111111111111, 7.6944444444444455, 11.222222222222225, 6.861111111111112, 12.972222222222221, 6.055555555555555, 5.888888888888889, 14.36111111111111, 5.166666666666666, 4.388888888888889, 6.083333333333334], "episode_lengths": [8, 16, 6, 14, 7, 15, 6, 6, 9, 9, 11, 7, 11, 7, 6, 6, 9, 14, 15, 15, 8, 7, 11, 13, 8, 14, 5, 9, 7, 11, 15, 8, 11, 8, 6, 6, 6, 6, 14, 11, 15, 8, 15, 7, 15, 7, 7, 14, 9, 11, 7, 11, 11, 6, 14, 16, 7, 15, 7, 14, 14, 6, 11, 6, 7, 12, 8, 10, 8, 12, 8, 6, 7, 14, 12, 10, 16, 14, 6, 12, 15, 9, 6, 6, 14, 9, 11, 6, 6, 9, 7, 12, 8, 12, 11, 13, 14, 6, 14, 6, 16, 10, 8, 5, 16, 7, 11, 7, 6, 8, 6, 13, 17, 16, 6, 8, 15, 6, 11, 14, 14, 9, 8, 16, 8, 15, 7, 9, 6, 7, 7, 9, 11, 8, 8, 14, 6, 5, 16, 15, 9, 10, 13, 11, 14, 9, 9, 11, 10, 15, 6, 10, 17, 8, 8, 16, 15, 9, 16, 6, 11, 7, 6, 11, 17, 8, 6, 12, 6, 10, 9, 16, 10, 8, 8, 6, 14, 13, 7, 9, 17, 8, 5, 7, 12, 14, 8, 11, 12, 9, 13, 8, 15, 7, 7, 17, 6, 5, 7]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.243221971339746, "mean_inference_ms": 1.2286960169900152, "mean_action_processing_ms": 0.10460533222178464, "mean_env_wait_ms": 21.264774445979718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00748382740883372, "StateBufferConnector_ms": 0.006601558857826731, "ViewRequirementAgentConnector_ms": 0.11160038224416761}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.50504091677754, "num_env_steps_trained_throughput_per_sec": 39.50504091677754, "timesteps_total": 4000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 51393.264, "sample_time_ms": 47739.627, "load_time_ms": 14.153, "load_throughput": 141312.759, "learn_time_ms": 3636.578, "learn_throughput": 549.968, "synch_weights_time_ms": 2.421}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 432, "training_iteration": 2, "trial_id": "13850_00002", "date": "2023-12-28_17-49-12", "timestamp": 1703756952, "time_this_iter_s": 50.63413882255554, "time_total_s": 102.80212354660034, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 102.80212354660034, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 55.86805555555556, "ram_util_percent": 91.93055555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.023021543820699, "policy_loss": -0.038458969220519064, "vf_loss": 5.052789110607571, "vf_explained_var": 0.43764777766333685, "kl": 0.01931416860379413, "entropy": 1.4180668293105232, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1125.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 6000}, "sampler_results": {"episode_reward_max": 14.61111111111111, "episode_reward_min": 4.388888888888889, "episode_reward_mean": 10.584541062801934, "episode_len_mean": 12.360248447204969, "episode_media": {}, "episodes_this_iter": 161, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.027777777777779, 7.694444444444445, 10.833333333333334, 11.000000000000002, 10.722222222222221, 14.166666666666668, 10.75, 13.916666666666668, 6.972222222222222, 7.0, 12.944444444444446, 13.027777777777779, 7.055555555555556, 12.944444444444446, 6.777777777777778, 13.305555555555557, 12.305555555555555, 13.72222222222222, 14.61111111111111, 13.666666666666668, 13.805555555555555, 13.055555555555557, 6.027777777777778, 13.222222222222225, 7.555555555555557, 12.944444444444446, 13.388888888888888, 9.972222222222223, 13.88888888888889, 5.222222222222222, 4.999999999999999, 5.166666666666667, 7.722222222222223, 5.027777777777779, 6.166666666666666, 6.805555555555554, 13.944444444444448, 14.38888888888889, 11.000000000000002, 13.583333333333332, 13.666666666666668, 14.111111111111114, 7.527777777777779, 13.305555555555555, 13.916666666666668, 13.861111111111114, 7.277777777777779, 13.583333333333334, 8.972222222222221, 14.055555555555559, 13.86111111111111, 10.055555555555555, 8.472222222222223, 13.444444444444446, 13.472222222222223, 13.527777777777779, 6.861111111111111, 9.277777777777779, 7.888888888888889, 7.777777777777779, 13.277777777777779, 9.13888888888889, 5.916666666666666, 13.16666666666667, 13.66666666666667, 13.555555555555557, 7.611111111111112, 13.722222222222223, 5.138888888888888, 10.111111111111112, 12.055555555555559, 9.75, 11.277777777777779, 8.444444444444445, 10.694444444444443, 5.194444444444445, 12.916666666666668, 8.638888888888891, 13.222222222222225, 7.4722222222222205, 4.388888888888889, 6.944444444444445, 14.194444444444448, 13.25, 13.61111111111111, 5.055555555555555, 14.333333333333334, 7.638888888888889, 12.166666666666666, 9.305555555555555, 12.36111111111111, 12.305555555555557, 13.527777777777779, 9.777777777777779, 5.194444444444445, 13.194444444444446, 8.11111111111111, 5.944444444444444, 9.805555555555555, 6.888888888888889, 13.194444444444445, 13.500000000000002, 12.861111111111112, 5.083333333333334, 9.11111111111111, 13.555555555555559, 12.38888888888889, 10.25, 13.222222222222227, 13.138888888888893, 12.944444444444445, 13.555555555555555, 11.555555555555557, 6.805555555555556, 13.888888888888891, 10.388888888888891, 13.444444444444443, 12.833333333333334, 14.472222222222221, 13.166666666666668, 13.583333333333336, 4.416666666666667, 7.527777777777779, 5.277777777777778, 10.138888888888888, 7.666666666666667, 13.083333333333332, 13.63888888888889, 10.333333333333336, 11.861111111111114, 4.944444444444444, 10.944444444444445, 13.583333333333334, 4.388888888888889, 13.027777777777779, 12.055555555555555, 12.444444444444446, 14.527777777777779, 5.138888888888888, 8.66666666666667, 7.000000000000001, 13.77777777777778, 14.111111111111112, 5.166666666666667, 12.027777777777775, 12.083333333333336, 8.333333333333332, 7.000000000000001, 9.916666666666668, 13.083333333333334, 6.972222222222223, 14.388888888888891, 12.555555555555557, 13.472222222222223, 14.055555555555559, 7.555555555555555, 5.944444444444444, 13.527777777777779, 11.88888888888889, 6.805555555555556, 11.61111111111111], "episode_lengths": [8, 9, 13, 13, 13, 17, 13, 16, 8, 8, 15, 15, 8, 15, 8, 16, 14, 16, 17, 16, 16, 15, 7, 15, 9, 15, 16, 12, 16, 6, 6, 6, 9, 6, 7, 8, 16, 17, 13, 16, 16, 16, 9, 16, 16, 16, 8, 16, 11, 16, 16, 12, 10, 15, 16, 16, 8, 11, 9, 9, 15, 11, 7, 15, 16, 16, 9, 16, 6, 12, 14, 12, 13, 10, 13, 6, 15, 10, 15, 9, 5, 8, 17, 15, 16, 6, 17, 9, 14, 11, 15, 14, 15, 12, 6, 15, 10, 7, 12, 8, 15, 16, 15, 6, 11, 16, 14, 12, 15, 15, 15, 16, 14, 8, 16, 12, 16, 15, 17, 15, 16, 5, 9, 6, 12, 9, 15, 16, 12, 14, 6, 13, 16, 5, 15, 14, 14, 17, 6, 10, 8, 16, 16, 6, 14, 14, 10, 8, 12, 15, 8, 17, 14, 16, 16, 9, 7, 16, 14, 8, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1608183056170738, "mean_inference_ms": 1.2236763051978112, "mean_action_processing_ms": 0.10439948705092529, "mean_env_wait_ms": 21.454544628367703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007414521637910641, "StateBufferConnector_ms": 0.005802012378384608, "ViewRequirementAgentConnector_ms": 0.10964974113132643}}, "episode_reward_max": 14.61111111111111, "episode_reward_min": 4.388888888888889, "episode_reward_mean": 10.584541062801934, "episode_len_mean": 12.360248447204969, "episodes_this_iter": 161, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.027777777777779, 7.694444444444445, 10.833333333333334, 11.000000000000002, 10.722222222222221, 14.166666666666668, 10.75, 13.916666666666668, 6.972222222222222, 7.0, 12.944444444444446, 13.027777777777779, 7.055555555555556, 12.944444444444446, 6.777777777777778, 13.305555555555557, 12.305555555555555, 13.72222222222222, 14.61111111111111, 13.666666666666668, 13.805555555555555, 13.055555555555557, 6.027777777777778, 13.222222222222225, 7.555555555555557, 12.944444444444446, 13.388888888888888, 9.972222222222223, 13.88888888888889, 5.222222222222222, 4.999999999999999, 5.166666666666667, 7.722222222222223, 5.027777777777779, 6.166666666666666, 6.805555555555554, 13.944444444444448, 14.38888888888889, 11.000000000000002, 13.583333333333332, 13.666666666666668, 14.111111111111114, 7.527777777777779, 13.305555555555555, 13.916666666666668, 13.861111111111114, 7.277777777777779, 13.583333333333334, 8.972222222222221, 14.055555555555559, 13.86111111111111, 10.055555555555555, 8.472222222222223, 13.444444444444446, 13.472222222222223, 13.527777777777779, 6.861111111111111, 9.277777777777779, 7.888888888888889, 7.777777777777779, 13.277777777777779, 9.13888888888889, 5.916666666666666, 13.16666666666667, 13.66666666666667, 13.555555555555557, 7.611111111111112, 13.722222222222223, 5.138888888888888, 10.111111111111112, 12.055555555555559, 9.75, 11.277777777777779, 8.444444444444445, 10.694444444444443, 5.194444444444445, 12.916666666666668, 8.638888888888891, 13.222222222222225, 7.4722222222222205, 4.388888888888889, 6.944444444444445, 14.194444444444448, 13.25, 13.61111111111111, 5.055555555555555, 14.333333333333334, 7.638888888888889, 12.166666666666666, 9.305555555555555, 12.36111111111111, 12.305555555555557, 13.527777777777779, 9.777777777777779, 5.194444444444445, 13.194444444444446, 8.11111111111111, 5.944444444444444, 9.805555555555555, 6.888888888888889, 13.194444444444445, 13.500000000000002, 12.861111111111112, 5.083333333333334, 9.11111111111111, 13.555555555555559, 12.38888888888889, 10.25, 13.222222222222227, 13.138888888888893, 12.944444444444445, 13.555555555555555, 11.555555555555557, 6.805555555555556, 13.888888888888891, 10.388888888888891, 13.444444444444443, 12.833333333333334, 14.472222222222221, 13.166666666666668, 13.583333333333336, 4.416666666666667, 7.527777777777779, 5.277777777777778, 10.138888888888888, 7.666666666666667, 13.083333333333332, 13.63888888888889, 10.333333333333336, 11.861111111111114, 4.944444444444444, 10.944444444444445, 13.583333333333334, 4.388888888888889, 13.027777777777779, 12.055555555555555, 12.444444444444446, 14.527777777777779, 5.138888888888888, 8.66666666666667, 7.000000000000001, 13.77777777777778, 14.111111111111112, 5.166666666666667, 12.027777777777775, 12.083333333333336, 8.333333333333332, 7.000000000000001, 9.916666666666668, 13.083333333333334, 6.972222222222223, 14.388888888888891, 12.555555555555557, 13.472222222222223, 14.055555555555559, 7.555555555555555, 5.944444444444444, 13.527777777777779, 11.88888888888889, 6.805555555555556, 11.61111111111111], "episode_lengths": [8, 9, 13, 13, 13, 17, 13, 16, 8, 8, 15, 15, 8, 15, 8, 16, 14, 16, 17, 16, 16, 15, 7, 15, 9, 15, 16, 12, 16, 6, 6, 6, 9, 6, 7, 8, 16, 17, 13, 16, 16, 16, 9, 16, 16, 16, 8, 16, 11, 16, 16, 12, 10, 15, 16, 16, 8, 11, 9, 9, 15, 11, 7, 15, 16, 16, 9, 16, 6, 12, 14, 12, 13, 10, 13, 6, 15, 10, 15, 9, 5, 8, 17, 15, 16, 6, 17, 9, 14, 11, 15, 14, 15, 12, 6, 15, 10, 7, 12, 8, 15, 16, 15, 6, 11, 16, 14, 12, 15, 15, 15, 16, 14, 8, 16, 12, 16, 15, 17, 15, 16, 5, 9, 6, 12, 9, 15, 16, 12, 14, 6, 13, 16, 5, 15, 14, 14, 17, 6, 10, 8, 16, 16, 6, 14, 14, 10, 8, 12, 15, 8, 17, 14, 16, 16, 9, 7, 16, 14, 8, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1608183056170738, "mean_inference_ms": 1.2236763051978112, "mean_action_processing_ms": 0.10439948705092529, "mean_env_wait_ms": 21.454544628367703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007414521637910641, "StateBufferConnector_ms": 0.005802012378384608, "ViewRequirementAgentConnector_ms": 0.10964974113132643}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 6000, "num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.84351978501402, "num_env_steps_trained_throughput_per_sec": 38.84351978501402, "timesteps_total": 6000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 6000, "timers": {"training_iteration_time_ms": 51425.049, "sample_time_ms": 47938.949, "load_time_ms": 11.159, "load_throughput": 179225.889, "learn_time_ms": 3472.196, "learn_throughput": 576.004, "synch_weights_time_ms": 2.29}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 6000}, "done": false, "episodes_total": 593, "training_iteration": 3, "trial_id": "13850_00002", "date": "2023-12-28_17-50-03", "timestamp": 1703757003, "time_this_iter_s": 51.495198011398315, "time_total_s": 154.29732155799866, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 154.29732155799866, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 56.12328767123287, "ram_util_percent": 92.25205479452056}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3603967123561436, "policy_loss": -0.029938202814923393, "vf_loss": 3.3825884649488662, "vf_explained_var": 0.678706159989039, "kl": 0.017214311726067633, "entropy": 1.3219289167722066, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 14.944444444444448, "episode_reward_min": 5.083333333333333, "episode_reward_mean": 12.103624901497243, "episode_len_mean": 14.205673758865249, "episode_media": {}, "episodes_this_iter": 141, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.333333333333334, 13.805555555555555, 13.555555555555555, 13.555555555555555, 14.249999999999998, 10.083333333333332, 12.833333333333334, 13.972222222222227, 6.805555555555556, 12.222222222222223, 13.527777777777779, 13.555555555555559, 10.805555555555555, 13.416666666666668, 11.02777777777778, 9.055555555555555, 13.027777777777777, 6.972222222222223, 5.916666666666667, 10.250000000000002, 14.11111111111111, 14.555555555555555, 9.138888888888888, 5.277777777777778, 12.333333333333332, 14.472222222222225, 6.0, 13.111111111111112, 8.5, 13.361111111111112, 13.16666666666667, 13.027777777777779, 12.25, 14.194444444444446, 14.52777777777778, 12.833333333333332, 14.583333333333334, 13.694444444444446, 14.277777777777779, 13.63888888888889, 13.25, 8.083333333333332, 6.888888888888889, 13.527777777777779, 10.694444444444443, 9.722222222222223, 14.5, 11.222222222222221, 13.555555555555557, 13.583333333333334, 8.5, 14.166666666666668, 8.222222222222223, 14.472222222222225, 13.083333333333334, 13.972222222222225, 13.138888888888888, 12.277777777777779, 14.472222222222225, 12.972222222222223, 14.91666666666667, 12.916666666666666, 9.38888888888889, 13.63888888888889, 11.222222222222223, 14.13888888888889, 14.305555555555557, 14.222222222222225, 14.52777777777778, 14.55555555555556, 13.583333333333334, 12.222222222222225, 13.583333333333334, 14.194444444444443, 11.38888888888889, 14.638888888888891, 13.527777777777779, 14.444444444444446, 6.1944444444444455, 6.805555555555555, 14.388888888888891, 6.944444444444445, 14.333333333333332, 6.944444444444445, 14.61111111111111, 10.416666666666668, 6.805555555555555, 13.638888888888891, 13.916666666666668, 13.250000000000002, 7.944444444444445, 13.16666666666667, 13.722222222222223, 13.750000000000002, 14.222222222222225, 14.555555555555557, 13.805555555555559, 13.500000000000002, 13.388888888888891, 14.638888888888891, 8.277777777777779, 14.805555555555557, 14.361111111111112, 13.277777777777779, 12.805555555555557, 13.555555555555557, 8.611111111111112, 13.63888888888889, 10.583333333333332, 5.944444444444445, 12.805555555555557, 13.750000000000002, 9.916666666666666, 14.944444444444448, 8.36111111111111, 9.666666666666666, 14.361111111111114, 12.194444444444446, 13.111111111111112, 13.194444444444445, 12.805555555555555, 13.694444444444446, 7.444444444444444, 8.472222222222221, 13.138888888888891, 13.388888888888891, 14.444444444444445, 14.694444444444448, 6.0, 13.388888888888888, 5.083333333333333, 13.611111111111112, 14.222222222222223, 7.0, 14.444444444444446, 14.111111111111114, 7.305555555555555, 12.972222222222223, 12.305555555555555, 13.444444444444445, 13.777777777777779], "episode_lengths": [17, 16, 16, 16, 17, 12, 15, 16, 8, 14, 16, 16, 13, 16, 13, 11, 16, 8, 7, 12, 17, 17, 11, 6, 14, 17, 7, 15, 10, 16, 15, 15, 14, 17, 17, 15, 17, 16, 17, 16, 16, 10, 8, 16, 13, 12, 17, 14, 16, 15, 10, 17, 10, 17, 15, 16, 15, 15, 17, 15, 17, 15, 11, 16, 14, 17, 17, 17, 17, 17, 16, 14, 16, 17, 14, 17, 16, 17, 7, 8, 17, 8, 17, 8, 17, 12, 8, 16, 16, 15, 9, 15, 16, 16, 17, 17, 16, 16, 15, 17, 10, 17, 17, 16, 15, 16, 10, 16, 13, 7, 15, 16, 12, 17, 10, 11, 17, 14, 15, 15, 15, 16, 9, 10, 15, 16, 17, 17, 7, 16, 6, 16, 17, 8, 17, 16, 9, 15, 14, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0971353733752647, "mean_inference_ms": 1.2226735870624506, "mean_action_processing_ms": 0.10435030827178403, "mean_env_wait_ms": 21.564637433140152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007497165220003601, "StateBufferConnector_ms": 0.005384539881496565, "ViewRequirementAgentConnector_ms": 0.11065564257033328}}, "episode_reward_max": 14.944444444444448, "episode_reward_min": 5.083333333333333, "episode_reward_mean": 12.103624901497243, "episode_len_mean": 14.205673758865249, "episodes_this_iter": 141, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.333333333333334, 13.805555555555555, 13.555555555555555, 13.555555555555555, 14.249999999999998, 10.083333333333332, 12.833333333333334, 13.972222222222227, 6.805555555555556, 12.222222222222223, 13.527777777777779, 13.555555555555559, 10.805555555555555, 13.416666666666668, 11.02777777777778, 9.055555555555555, 13.027777777777777, 6.972222222222223, 5.916666666666667, 10.250000000000002, 14.11111111111111, 14.555555555555555, 9.138888888888888, 5.277777777777778, 12.333333333333332, 14.472222222222225, 6.0, 13.111111111111112, 8.5, 13.361111111111112, 13.16666666666667, 13.027777777777779, 12.25, 14.194444444444446, 14.52777777777778, 12.833333333333332, 14.583333333333334, 13.694444444444446, 14.277777777777779, 13.63888888888889, 13.25, 8.083333333333332, 6.888888888888889, 13.527777777777779, 10.694444444444443, 9.722222222222223, 14.5, 11.222222222222221, 13.555555555555557, 13.583333333333334, 8.5, 14.166666666666668, 8.222222222222223, 14.472222222222225, 13.083333333333334, 13.972222222222225, 13.138888888888888, 12.277777777777779, 14.472222222222225, 12.972222222222223, 14.91666666666667, 12.916666666666666, 9.38888888888889, 13.63888888888889, 11.222222222222223, 14.13888888888889, 14.305555555555557, 14.222222222222225, 14.52777777777778, 14.55555555555556, 13.583333333333334, 12.222222222222225, 13.583333333333334, 14.194444444444443, 11.38888888888889, 14.638888888888891, 13.527777777777779, 14.444444444444446, 6.1944444444444455, 6.805555555555555, 14.388888888888891, 6.944444444444445, 14.333333333333332, 6.944444444444445, 14.61111111111111, 10.416666666666668, 6.805555555555555, 13.638888888888891, 13.916666666666668, 13.250000000000002, 7.944444444444445, 13.16666666666667, 13.722222222222223, 13.750000000000002, 14.222222222222225, 14.555555555555557, 13.805555555555559, 13.500000000000002, 13.388888888888891, 14.638888888888891, 8.277777777777779, 14.805555555555557, 14.361111111111112, 13.277777777777779, 12.805555555555557, 13.555555555555557, 8.611111111111112, 13.63888888888889, 10.583333333333332, 5.944444444444445, 12.805555555555557, 13.750000000000002, 9.916666666666666, 14.944444444444448, 8.36111111111111, 9.666666666666666, 14.361111111111114, 12.194444444444446, 13.111111111111112, 13.194444444444445, 12.805555555555555, 13.694444444444446, 7.444444444444444, 8.472222222222221, 13.138888888888891, 13.388888888888891, 14.444444444444445, 14.694444444444448, 6.0, 13.388888888888888, 5.083333333333333, 13.611111111111112, 14.222222222222223, 7.0, 14.444444444444446, 14.111111111111114, 7.305555555555555, 12.972222222222223, 12.305555555555555, 13.444444444444445, 13.777777777777779], "episode_lengths": [17, 16, 16, 16, 17, 12, 15, 16, 8, 14, 16, 16, 13, 16, 13, 11, 16, 8, 7, 12, 17, 17, 11, 6, 14, 17, 7, 15, 10, 16, 15, 15, 14, 17, 17, 15, 17, 16, 17, 16, 16, 10, 8, 16, 13, 12, 17, 14, 16, 15, 10, 17, 10, 17, 15, 16, 15, 15, 17, 15, 17, 15, 11, 16, 14, 17, 17, 17, 17, 17, 16, 14, 16, 17, 14, 17, 16, 17, 7, 8, 17, 8, 17, 8, 17, 12, 8, 16, 16, 15, 9, 15, 16, 16, 17, 17, 16, 16, 15, 17, 10, 17, 17, 16, 15, 16, 10, 16, 13, 7, 15, 16, 12, 17, 10, 11, 17, 14, 15, 15, 15, 16, 9, 10, 15, 16, 17, 17, 7, 16, 6, 16, 17, 8, 17, 16, 9, 15, 14, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0971353733752647, "mean_inference_ms": 1.2226735870624506, "mean_action_processing_ms": 0.10435030827178403, "mean_env_wait_ms": 21.564637433140152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007497165220003601, "StateBufferConnector_ms": 0.005384539881496565, "ViewRequirementAgentConnector_ms": 0.11065564257033328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.88954637602958, "num_env_steps_trained_throughput_per_sec": 38.88954637602958, "timesteps_total": 8000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 51425.707, "sample_time_ms": 48027.228, "load_time_ms": 9.672, "load_throughput": 206772.568, "learn_time_ms": 3386.106, "learn_throughput": 590.649, "synch_weights_time_ms": 2.257}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 734, "training_iteration": 4, "trial_id": "13850_00002", "date": "2023-12-28_17-50-55", "timestamp": 1703757055, "time_this_iter_s": 51.433613300323486, "time_total_s": 205.73093485832214, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 205.73093485832214, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 56.0068493150685, "ram_util_percent": 92.17397260273974}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1154839984575906, "policy_loss": -0.02458145532343123, "vf_loss": 2.1313095548417835, "vf_explained_var": 0.8162238392564986, "kl": 0.019457552936719462, "entropy": 1.1809805960125392, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2025.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 10000}, "sampler_results": {"episode_reward_max": 14.944444444444446, "episode_reward_min": 5.861111111111111, "episode_reward_mean": 13.05619168787108, "episode_len_mean": 15.312977099236642, "episode_media": {}, "episodes_this_iter": 131, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.222222222222223, 13.5, 13.083333333333334, 12.194444444444448, 14.694444444444445, 11.694444444444445, 8.972222222222223, 13.416666666666668, 14.222222222222225, 14.38888888888889, 14.69444444444445, 13.194444444444446, 13.666666666666668, 12.972222222222223, 13.38888888888889, 12.805555555555557, 9.86111111111111, 6.75, 14.416666666666668, 10.083333333333332, 14.41666666666667, 12.916666666666668, 12.88888888888889, 13.444444444444443, 12.972222222222223, 14.305555555555557, 12.88888888888889, 13.750000000000002, 13.750000000000002, 14.277777777777779, 12.805555555555555, 13.722222222222225, 14.555555555555557, 6.833333333333334, 14.722222222222225, 14.055555555555559, 13.055555555555557, 14.944444444444446, 14.305555555555555, 14.333333333333332, 13.555555555555559, 13.611111111111114, 13.027777777777782, 14.277777777777779, 12.75, 14.444444444444448, 14.333333333333336, 13.694444444444446, 13.972222222222225, 14.25, 14.277777777777779, 14.166666666666666, 11.611111111111112, 11.027777777777779, 14.055555555555559, 14.277777777777779, 13.472222222222225, 13.805555555555557, 7.777777777777779, 12.916666666666668, 9.083333333333332, 13.722222222222223, 10.555555555555555, 14.305555555555557, 14.333333333333336, 13.833333333333334, 13.02777777777778, 13.472222222222225, 8.25, 13.500000000000002, 13.77777777777778, 14.805555555555559, 13.916666666666668, 6.861111111111112, 13.222222222222225, 14.472222222222221, 12.77777777777778, 11.472222222222221, 13.250000000000004, 14.472222222222225, 14.416666666666668, 13.583333333333334, 12.25, 13.611111111111114, 13.583333333333336, 14.055555555555557, 14.388888888888893, 13.416666666666668, 14.638888888888891, 13.63888888888889, 14.083333333333337, 13.666666666666668, 14.333333333333332, 14.222222222222223, 13.722222222222225, 9.944444444444445, 13.333333333333334, 12.833333333333334, 13.555555555555555, 13.444444444444446, 13.472222222222225, 13.833333333333337, 5.861111111111111, 12.972222222222223, 13.91666666666667, 13.416666666666666, 14.388888888888891, 13.750000000000002, 14.472222222222221, 14.611111111111116, 13.583333333333336, 11.916666666666666, 9.250000000000002, 14.750000000000004, 12.222222222222221, 10.61111111111111, 14.583333333333337, 13.666666666666666, 8.694444444444446, 12.833333333333334, 13.194444444444446, 14.611111111111114, 14.361111111111112, 13.083333333333334, 13.63888888888889, 14.388888888888893, 14.416666666666668, 12.833333333333334, 9.38888888888889, 12.805555555555557, 14.527777777777779], "episode_lengths": [17, 16, 16, 14, 17, 14, 11, 16, 17, 17, 17, 15, 16, 15, 16, 15, 12, 8, 17, 12, 17, 15, 15, 15, 15, 17, 15, 16, 16, 17, 15, 16, 17, 8, 17, 16, 15, 17, 17, 17, 16, 16, 15, 17, 15, 17, 17, 16, 16, 17, 17, 17, 14, 13, 16, 17, 16, 16, 9, 15, 11, 16, 13, 17, 17, 16, 15, 16, 10, 16, 16, 17, 16, 8, 15, 17, 15, 14, 15, 17, 17, 16, 14, 16, 16, 16, 17, 16, 17, 16, 16, 16, 17, 17, 16, 12, 16, 15, 16, 16, 16, 16, 7, 15, 16, 16, 17, 16, 17, 17, 16, 14, 11, 17, 14, 13, 17, 16, 10, 15, 15, 17, 17, 15, 16, 17, 17, 15, 11, 15, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0487071371903338, "mean_inference_ms": 1.220375213035642, "mean_action_processing_ms": 0.10416531798815964, "mean_env_wait_ms": 21.631227399263253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007355122165825531, "StateBufferConnector_ms": 0.0050151621112386685, "ViewRequirementAgentConnector_ms": 0.1093959080353948}}, "episode_reward_max": 14.944444444444446, "episode_reward_min": 5.861111111111111, "episode_reward_mean": 13.05619168787108, "episode_len_mean": 15.312977099236642, "episodes_this_iter": 131, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.222222222222223, 13.5, 13.083333333333334, 12.194444444444448, 14.694444444444445, 11.694444444444445, 8.972222222222223, 13.416666666666668, 14.222222222222225, 14.38888888888889, 14.69444444444445, 13.194444444444446, 13.666666666666668, 12.972222222222223, 13.38888888888889, 12.805555555555557, 9.86111111111111, 6.75, 14.416666666666668, 10.083333333333332, 14.41666666666667, 12.916666666666668, 12.88888888888889, 13.444444444444443, 12.972222222222223, 14.305555555555557, 12.88888888888889, 13.750000000000002, 13.750000000000002, 14.277777777777779, 12.805555555555555, 13.722222222222225, 14.555555555555557, 6.833333333333334, 14.722222222222225, 14.055555555555559, 13.055555555555557, 14.944444444444446, 14.305555555555555, 14.333333333333332, 13.555555555555559, 13.611111111111114, 13.027777777777782, 14.277777777777779, 12.75, 14.444444444444448, 14.333333333333336, 13.694444444444446, 13.972222222222225, 14.25, 14.277777777777779, 14.166666666666666, 11.611111111111112, 11.027777777777779, 14.055555555555559, 14.277777777777779, 13.472222222222225, 13.805555555555557, 7.777777777777779, 12.916666666666668, 9.083333333333332, 13.722222222222223, 10.555555555555555, 14.305555555555557, 14.333333333333336, 13.833333333333334, 13.02777777777778, 13.472222222222225, 8.25, 13.500000000000002, 13.77777777777778, 14.805555555555559, 13.916666666666668, 6.861111111111112, 13.222222222222225, 14.472222222222221, 12.77777777777778, 11.472222222222221, 13.250000000000004, 14.472222222222225, 14.416666666666668, 13.583333333333334, 12.25, 13.611111111111114, 13.583333333333336, 14.055555555555557, 14.388888888888893, 13.416666666666668, 14.638888888888891, 13.63888888888889, 14.083333333333337, 13.666666666666668, 14.333333333333332, 14.222222222222223, 13.722222222222225, 9.944444444444445, 13.333333333333334, 12.833333333333334, 13.555555555555555, 13.444444444444446, 13.472222222222225, 13.833333333333337, 5.861111111111111, 12.972222222222223, 13.91666666666667, 13.416666666666666, 14.388888888888891, 13.750000000000002, 14.472222222222221, 14.611111111111116, 13.583333333333336, 11.916666666666666, 9.250000000000002, 14.750000000000004, 12.222222222222221, 10.61111111111111, 14.583333333333337, 13.666666666666666, 8.694444444444446, 12.833333333333334, 13.194444444444446, 14.611111111111114, 14.361111111111112, 13.083333333333334, 13.63888888888889, 14.388888888888893, 14.416666666666668, 12.833333333333334, 9.38888888888889, 12.805555555555557, 14.527777777777779], "episode_lengths": [17, 16, 16, 14, 17, 14, 11, 16, 17, 17, 17, 15, 16, 15, 16, 15, 12, 8, 17, 12, 17, 15, 15, 15, 15, 17, 15, 16, 16, 17, 15, 16, 17, 8, 17, 16, 15, 17, 17, 17, 16, 16, 15, 17, 15, 17, 17, 16, 16, 17, 17, 17, 14, 13, 16, 17, 16, 16, 9, 15, 11, 16, 13, 17, 17, 16, 15, 16, 10, 16, 16, 17, 16, 8, 15, 17, 15, 14, 15, 17, 17, 16, 14, 16, 16, 16, 17, 16, 17, 16, 16, 16, 17, 17, 16, 12, 16, 15, 16, 16, 16, 16, 7, 15, 16, 16, 17, 16, 17, 17, 16, 14, 11, 17, 14, 13, 17, 16, 10, 15, 15, 17, 17, 15, 16, 17, 17, 15, 11, 15, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0487071371903338, "mean_inference_ms": 1.220375213035642, "mean_action_processing_ms": 0.10416531798815964, "mean_env_wait_ms": 21.631227399263253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007355122165825531, "StateBufferConnector_ms": 0.0050151621112386685, "ViewRequirementAgentConnector_ms": 0.1093959080353948}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 10000, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.99779599856105, "num_env_steps_trained_throughput_per_sec": 38.99779599856105, "timesteps_total": 10000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 10000, "timers": {"training_iteration_time_ms": 51397.551, "sample_time_ms": 48056.937, "load_time_ms": 9.029, "load_throughput": 221518.831, "learn_time_ms": 3328.932, "learn_throughput": 600.793, "synch_weights_time_ms": 2.217}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 10000}, "done": false, "episodes_total": 865, "training_iteration": 5, "trial_id": "13850_00002", "date": "2023-12-28_17-51-46", "timestamp": 1703757106, "time_this_iter_s": 51.2906608581543, "time_total_s": 257.02159571647644, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 257.02159571647644, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 56.07260273972602, "ram_util_percent": 92.22876712328768}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6748663997650146, "policy_loss": -0.023021661167343457, "vf_loss": 1.693511075311237, "vf_explained_var": 0.8573129279083676, "kl": 0.009726630607750926, "entropy": 1.0718246025509304, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2475.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 15.16666666666667, "episode_reward_min": 5.305555555555555, "episode_reward_mean": 13.692000000000002, "episode_len_mean": 16.008, "episode_media": {}, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.888888888888891, 11.416666666666666, 13.694444444444445, 13.66666666666667, 13.000000000000002, 13.000000000000002, 12.972222222222225, 14.527777777777779, 12.805555555555557, 14.944444444444446, 14.666666666666671, 14.91666666666667, 12.972222222222223, 14.194444444444448, 13.972222222222225, 13.61111111111111, 14.250000000000002, 14.61111111111111, 14.333333333333336, 14.611111111111114, 14.444444444444446, 14.722222222222225, 14.694444444444448, 12.916666666666666, 13.361111111111112, 14.944444444444448, 13.888888888888893, 13.472222222222225, 14.13888888888889, 13.500000000000002, 13.750000000000002, 14.41666666666667, 13.38888888888889, 14.277777777777779, 12.555555555555555, 14.222222222222223, 10.555555555555554, 14.416666666666668, 12.250000000000002, 13.916666666666671, 14.36111111111111, 14.444444444444448, 14.52777777777778, 14.583333333333334, 14.583333333333337, 13.66666666666667, 13.13888888888889, 14.916666666666671, 13.77777777777778, 14.750000000000004, 13.472222222222223, 13.91666666666667, 14.722222222222227, 15.16666666666667, 14.38888888888889, 13.52777777777778, 5.305555555555555, 14.666666666666666, 14.416666666666668, 14.416666666666668, 13.027777777777779, 15.000000000000002, 11.805555555555557, 13.777777777777779, 14.472222222222223, 12.722222222222223, 7.166666666666667, 13.77777777777778, 13.52777777777778, 13.000000000000004, 14.611111111111116, 14.27777777777778, 13.83333333333334, 11.694444444444445, 13.52777777777778, 9.722222222222223, 14.444444444444446, 14.91666666666667, 14.000000000000004, 13.305555555555557, 14.472222222222221, 13.527777777777779, 14.222222222222223, 14.222222222222225, 14.222222222222223, 13.472222222222223, 14.694444444444448, 13.694444444444445, 13.5, 13.722222222222223, 15.000000000000004, 14.444444444444446, 14.194444444444445, 13.555555555555555, 14.527777777777782, 14.305555555555555, 11.805555555555555, 14.500000000000004, 14.416666666666671, 14.694444444444446, 14.694444444444448, 14.222222222222221, 14.472222222222225, 14.333333333333336, 13.472222222222223, 14.638888888888893, 14.611111111111114, 14.500000000000004, 14.222222222222225, 14.722222222222227, 13.500000000000002, 14.16666666666667, 14.361111111111112, 13.444444444444445, 14.27777777777778, 9.555555555555557, 6.61111111111111, 13.444444444444445, 11.472222222222223, 15.138888888888893, 14.750000000000004, 12.16666666666667, 14.333333333333336, 14.083333333333336, 14.861111111111112], "episode_lengths": [17, 14, 16, 16, 15, 15, 15, 17, 15, 17, 17, 17, 15, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 15, 16, 17, 16, 16, 17, 16, 16, 17, 16, 17, 14, 17, 13, 17, 14, 16, 17, 17, 17, 17, 17, 16, 15, 17, 16, 17, 16, 16, 17, 17, 17, 16, 6, 17, 17, 17, 16, 17, 14, 16, 17, 15, 8, 16, 16, 15, 17, 17, 16, 14, 16, 12, 17, 17, 16, 16, 17, 16, 17, 17, 17, 16, 17, 16, 16, 16, 17, 17, 16, 16, 17, 17, 14, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 16, 16, 17, 16, 17, 11, 8, 16, 14, 17, 17, 14, 17, 16, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0148145270222437, "mean_inference_ms": 1.2226626034846217, "mean_action_processing_ms": 0.1043407393141534, "mean_env_wait_ms": 21.72273322449417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007469367980957031, "StateBufferConnector_ms": 0.005261421203613281, "ViewRequirementAgentConnector_ms": 0.11128177642822265}}, "episode_reward_max": 15.16666666666667, "episode_reward_min": 5.305555555555555, "episode_reward_mean": 13.692000000000002, "episode_len_mean": 16.008, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.888888888888891, 11.416666666666666, 13.694444444444445, 13.66666666666667, 13.000000000000002, 13.000000000000002, 12.972222222222225, 14.527777777777779, 12.805555555555557, 14.944444444444446, 14.666666666666671, 14.91666666666667, 12.972222222222223, 14.194444444444448, 13.972222222222225, 13.61111111111111, 14.250000000000002, 14.61111111111111, 14.333333333333336, 14.611111111111114, 14.444444444444446, 14.722222222222225, 14.694444444444448, 12.916666666666666, 13.361111111111112, 14.944444444444448, 13.888888888888893, 13.472222222222225, 14.13888888888889, 13.500000000000002, 13.750000000000002, 14.41666666666667, 13.38888888888889, 14.277777777777779, 12.555555555555555, 14.222222222222223, 10.555555555555554, 14.416666666666668, 12.250000000000002, 13.916666666666671, 14.36111111111111, 14.444444444444448, 14.52777777777778, 14.583333333333334, 14.583333333333337, 13.66666666666667, 13.13888888888889, 14.916666666666671, 13.77777777777778, 14.750000000000004, 13.472222222222223, 13.91666666666667, 14.722222222222227, 15.16666666666667, 14.38888888888889, 13.52777777777778, 5.305555555555555, 14.666666666666666, 14.416666666666668, 14.416666666666668, 13.027777777777779, 15.000000000000002, 11.805555555555557, 13.777777777777779, 14.472222222222223, 12.722222222222223, 7.166666666666667, 13.77777777777778, 13.52777777777778, 13.000000000000004, 14.611111111111116, 14.27777777777778, 13.83333333333334, 11.694444444444445, 13.52777777777778, 9.722222222222223, 14.444444444444446, 14.91666666666667, 14.000000000000004, 13.305555555555557, 14.472222222222221, 13.527777777777779, 14.222222222222223, 14.222222222222225, 14.222222222222223, 13.472222222222223, 14.694444444444448, 13.694444444444445, 13.5, 13.722222222222223, 15.000000000000004, 14.444444444444446, 14.194444444444445, 13.555555555555555, 14.527777777777782, 14.305555555555555, 11.805555555555555, 14.500000000000004, 14.416666666666671, 14.694444444444446, 14.694444444444448, 14.222222222222221, 14.472222222222225, 14.333333333333336, 13.472222222222223, 14.638888888888893, 14.611111111111114, 14.500000000000004, 14.222222222222225, 14.722222222222227, 13.500000000000002, 14.16666666666667, 14.361111111111112, 13.444444444444445, 14.27777777777778, 9.555555555555557, 6.61111111111111, 13.444444444444445, 11.472222222222223, 15.138888888888893, 14.750000000000004, 12.16666666666667, 14.333333333333336, 14.083333333333336, 14.861111111111112], "episode_lengths": [17, 14, 16, 16, 15, 15, 15, 17, 15, 17, 17, 17, 15, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 15, 16, 17, 16, 16, 17, 16, 16, 17, 16, 17, 14, 17, 13, 17, 14, 16, 17, 17, 17, 17, 17, 16, 15, 17, 16, 17, 16, 16, 17, 17, 17, 16, 6, 17, 17, 17, 16, 17, 14, 16, 17, 15, 8, 16, 16, 15, 17, 17, 16, 14, 16, 12, 17, 17, 16, 16, 17, 16, 17, 17, 17, 16, 17, 16, 16, 16, 17, 17, 16, 16, 17, 17, 14, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 16, 16, 17, 16, 17, 11, 8, 16, 14, 17, 17, 14, 17, 16, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0148145270222437, "mean_inference_ms": 1.2226626034846217, "mean_action_processing_ms": 0.1043407393141534, "mean_env_wait_ms": 21.72273322449417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007469367980957031, "StateBufferConnector_ms": 0.005261421203613281, "ViewRequirementAgentConnector_ms": 0.11128177642822265}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.49577280233797, "num_env_steps_trained_throughput_per_sec": 38.49577280233797, "timesteps_total": 12000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 51490.248, "sample_time_ms": 48176.233, "load_time_ms": 10.742, "load_throughput": 186191.461, "learn_time_ms": 3300.634, "learn_throughput": 605.944, "synch_weights_time_ms": 2.197}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 990, "training_iteration": 6, "trial_id": "13850_00002", "date": "2023-12-28_17-52-38", "timestamp": 1703757158, "time_this_iter_s": 51.95884561538696, "time_total_s": 308.9804413318634, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 308.9804413318634, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 55.981081081081086, "ram_util_percent": 92.29054054054053}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2246477304564583, "policy_loss": -0.005274196383025911, "vf_loss": 1.2264392750793034, "vf_explained_var": 0.9125953000121646, "kl": 0.007739222763322675, "entropy": 0.9721568973859152, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2925.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 8.444444444444446, "episode_reward_mean": 13.94877049180328, "episode_len_mean": 16.327868852459016, "episode_media": {}, "episodes_this_iter": 122, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.666666666666668, 15.222222222222227, 14.13888888888889, 14.194444444444446, 14.972222222222227, 14.361111111111112, 13.888888888888891, 15.194444444444448, 13.5, 14.638888888888891, 13.666666666666668, 14.000000000000004, 12.666666666666668, 14.361111111111112, 12.11111111111111, 13.444444444444446, 14.416666666666668, 14.777777777777779, 13.527777777777779, 9.88888888888889, 15.027777777777782, 14.027777777777779, 13.416666666666668, 13.694444444444445, 14.500000000000004, 14.722222222222227, 14.611111111111114, 13.833333333333337, 13.305555555555557, 14.583333333333337, 14.472222222222225, 14.055555555555557, 13.972222222222225, 14.77777777777778, 13.888888888888891, 14.250000000000002, 13.611111111111112, 14.277777777777779, 14.583333333333334, 14.52777777777778, 14.555555555555559, 14.527777777777779, 13.944444444444445, 14.52777777777778, 13.472222222222221, 13.388888888888891, 11.5, 14.777777777777782, 14.388888888888891, 13.166666666666668, 14.638888888888893, 14.722222222222227, 8.444444444444446, 14.500000000000005, 14.52777777777778, 13.888888888888893, 14.444444444444445, 14.27777777777778, 15.02777777777778, 9.833333333333332, 13.166666666666668, 14.305555555555557, 14.944444444444446, 14.91666666666667, 14.888888888888891, 14.472222222222225, 14.361111111111112, 13.416666666666668, 14.25, 13.36111111111111, 14.083333333333336, 13.194444444444445, 14.500000000000004, 13.722222222222223, 13.888888888888893, 14.305555555555557, 14.000000000000004, 13.916666666666671, 14.500000000000004, 14.361111111111114, 13.416666666666668, 14.555555555555559, 13.500000000000004, 13.750000000000002, 13.416666666666668, 14.527777777777779, 11.805555555555557, 14.500000000000004, 13.472222222222221, 14.583333333333337, 14.722222222222225, 14.750000000000004, 13.805555555555557, 14.055555555555559, 13.5, 14.222222222222223, 14.472222222222223, 14.222222222222225, 14.52777777777778, 14.27777777777778, 14.250000000000002, 12.88888888888889, 14.000000000000005, 13.63888888888889, 13.527777777777779, 12.111111111111114, 14.555555555555559, 13.91666666666667, 13.361111111111112, 13.833333333333337, 14.722222222222225, 14.333333333333334, 14.416666666666668, 13.416666666666668, 14.333333333333336, 14.388888888888891, 13.444444444444445, 14.388888888888891, 14.750000000000004, 13.916666666666671, 13.722222222222223, 13.861111111111114], "episode_lengths": [16, 17, 17, 16, 17, 17, 16, 17, 16, 17, 16, 16, 15, 17, 15, 16, 17, 17, 16, 12, 17, 17, 16, 16, 17, 17, 17, 16, 16, 17, 17, 16, 16, 17, 16, 17, 16, 17, 17, 17, 17, 17, 16, 17, 16, 16, 14, 17, 17, 16, 17, 17, 10, 17, 17, 16, 17, 17, 17, 12, 16, 17, 17, 17, 17, 17, 17, 16, 17, 15, 16, 15, 17, 16, 16, 17, 16, 16, 17, 17, 16, 17, 16, 16, 16, 17, 14, 17, 16, 17, 17, 17, 16, 16, 16, 17, 17, 17, 17, 17, 17, 16, 16, 16, 16, 14, 17, 16, 16, 16, 17, 17, 17, 16, 17, 17, 16, 17, 17, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9862916332152505, "mean_inference_ms": 1.2217371746962622, "mean_action_processing_ms": 0.1043125302712753, "mean_env_wait_ms": 21.750327204220746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075506382301205495, "StateBufferConnector_ms": 0.005064245130194992, "ViewRequirementAgentConnector_ms": 0.1097534523635614}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 8.444444444444446, "episode_reward_mean": 13.94877049180328, "episode_len_mean": 16.327868852459016, "episodes_this_iter": 122, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.666666666666668, 15.222222222222227, 14.13888888888889, 14.194444444444446, 14.972222222222227, 14.361111111111112, 13.888888888888891, 15.194444444444448, 13.5, 14.638888888888891, 13.666666666666668, 14.000000000000004, 12.666666666666668, 14.361111111111112, 12.11111111111111, 13.444444444444446, 14.416666666666668, 14.777777777777779, 13.527777777777779, 9.88888888888889, 15.027777777777782, 14.027777777777779, 13.416666666666668, 13.694444444444445, 14.500000000000004, 14.722222222222227, 14.611111111111114, 13.833333333333337, 13.305555555555557, 14.583333333333337, 14.472222222222225, 14.055555555555557, 13.972222222222225, 14.77777777777778, 13.888888888888891, 14.250000000000002, 13.611111111111112, 14.277777777777779, 14.583333333333334, 14.52777777777778, 14.555555555555559, 14.527777777777779, 13.944444444444445, 14.52777777777778, 13.472222222222221, 13.388888888888891, 11.5, 14.777777777777782, 14.388888888888891, 13.166666666666668, 14.638888888888893, 14.722222222222227, 8.444444444444446, 14.500000000000005, 14.52777777777778, 13.888888888888893, 14.444444444444445, 14.27777777777778, 15.02777777777778, 9.833333333333332, 13.166666666666668, 14.305555555555557, 14.944444444444446, 14.91666666666667, 14.888888888888891, 14.472222222222225, 14.361111111111112, 13.416666666666668, 14.25, 13.36111111111111, 14.083333333333336, 13.194444444444445, 14.500000000000004, 13.722222222222223, 13.888888888888893, 14.305555555555557, 14.000000000000004, 13.916666666666671, 14.500000000000004, 14.361111111111114, 13.416666666666668, 14.555555555555559, 13.500000000000004, 13.750000000000002, 13.416666666666668, 14.527777777777779, 11.805555555555557, 14.500000000000004, 13.472222222222221, 14.583333333333337, 14.722222222222225, 14.750000000000004, 13.805555555555557, 14.055555555555559, 13.5, 14.222222222222223, 14.472222222222223, 14.222222222222225, 14.52777777777778, 14.27777777777778, 14.250000000000002, 12.88888888888889, 14.000000000000005, 13.63888888888889, 13.527777777777779, 12.111111111111114, 14.555555555555559, 13.91666666666667, 13.361111111111112, 13.833333333333337, 14.722222222222225, 14.333333333333334, 14.416666666666668, 13.416666666666668, 14.333333333333336, 14.388888888888891, 13.444444444444445, 14.388888888888891, 14.750000000000004, 13.916666666666671, 13.722222222222223, 13.861111111111114], "episode_lengths": [16, 17, 17, 16, 17, 17, 16, 17, 16, 17, 16, 16, 15, 17, 15, 16, 17, 17, 16, 12, 17, 17, 16, 16, 17, 17, 17, 16, 16, 17, 17, 16, 16, 17, 16, 17, 16, 17, 17, 17, 17, 17, 16, 17, 16, 16, 14, 17, 17, 16, 17, 17, 10, 17, 17, 16, 17, 17, 17, 12, 16, 17, 17, 17, 17, 17, 17, 16, 17, 15, 16, 15, 17, 16, 16, 17, 16, 16, 17, 17, 16, 17, 16, 16, 16, 17, 14, 17, 16, 17, 17, 17, 16, 16, 16, 17, 17, 17, 17, 17, 17, 16, 16, 16, 16, 14, 17, 16, 16, 16, 17, 17, 17, 16, 17, 17, 16, 17, 17, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9862916332152505, "mean_inference_ms": 1.2217371746962622, "mean_action_processing_ms": 0.1043125302712753, "mean_env_wait_ms": 21.750327204220746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075506382301205495, "StateBufferConnector_ms": 0.005064245130194992, "ViewRequirementAgentConnector_ms": 0.1097534523635614}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000, "num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.98850276228254, "num_env_steps_trained_throughput_per_sec": 38.98850276228254, "timesteps_total": 14000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 14000, "timers": {"training_iteration_time_ms": 51462.662, "sample_time_ms": 48171.733, "load_time_ms": 11.951, "load_throughput": 167349.483, "learn_time_ms": 3276.305, "learn_throughput": 610.444, "synch_weights_time_ms": 2.213}, "counters": {"num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000}, "done": false, "episodes_total": 1112, "training_iteration": 7, "trial_id": "13850_00002", "date": "2023-12-28_17-53-29", "timestamp": 1703757209, "time_this_iter_s": 51.305255651474, "time_total_s": 360.2856969833374, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 360.2856969833374, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 55.768493150684925, "ram_util_percent": 92.00136986301371}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.810274825029903, "policy_loss": -0.025600637710756727, "vf_loss": 0.8340149590704176, "vf_explained_var": 0.9446221352948083, "kl": 0.004134456228089237, "entropy": 0.9358248020542993, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3375.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 15.194444444444448, "episode_reward_min": 11.111111111111112, "episode_reward_mean": 14.360879629629633, "episode_len_mean": 16.666666666666668, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.69444444444445, 14.66666666666667, 14.861111111111116, 14.611111111111112, 14.444444444444445, 14.944444444444446, 12.833333333333334, 14.472222222222225, 14.694444444444448, 13.944444444444445, 14.555555555555559, 13.444444444444445, 14.27777777777778, 13.888888888888893, 15.000000000000004, 14.027777777777782, 14.750000000000004, 14.500000000000002, 14.805555555555559, 14.722222222222227, 15.166666666666671, 14.972222222222227, 13.36111111111111, 14.694444444444448, 14.41666666666667, 14.52777777777778, 13.805555555555557, 14.888888888888891, 14.611111111111116, 14.27777777777778, 14.638888888888891, 14.638888888888893, 13.583333333333336, 14.388888888888891, 14.555555555555559, 13.666666666666668, 14.583333333333337, 13.527777777777779, 14.555555555555559, 14.972222222222227, 14.055555555555557, 14.694444444444446, 14.722222222222225, 14.666666666666671, 14.527777777777777, 14.750000000000002, 14.16666666666667, 15.055555555555559, 14.472222222222225, 14.277777777777779, 14.472222222222225, 14.444444444444448, 14.527777777777782, 14.888888888888893, 14.55555555555556, 14.36111111111111, 14.388888888888888, 14.722222222222227, 15.111111111111114, 14.416666666666666, 14.916666666666671, 14.333333333333336, 14.416666666666668, 14.333333333333336, 14.222222222222225, 14.611111111111114, 14.888888888888893, 14.500000000000004, 11.305555555555555, 14.500000000000004, 14.333333333333336, 14.000000000000004, 14.750000000000004, 14.472222222222225, 15.055555555555559, 14.416666666666668, 15.083333333333337, 12.694444444444446, 14.500000000000002, 15.000000000000004, 13.500000000000002, 12.833333333333336, 13.38888888888889, 14.444444444444448, 14.250000000000002, 13.527777777777779, 14.77777777777778, 14.80555555555556, 14.500000000000002, 14.138888888888891, 14.305555555555557, 13.52777777777778, 13.888888888888893, 14.666666666666671, 13.944444444444448, 14.722222222222225, 13.91666666666667, 13.36111111111111, 14.750000000000004, 15.111111111111114, 14.250000000000002, 13.91666666666667, 15.194444444444448, 14.611111111111116, 14.52777777777778, 14.305555555555559, 14.222222222222223, 14.80555555555556, 14.916666666666671, 14.750000000000004, 15.000000000000004, 14.555555555555559, 14.444444444444448, 14.69444444444445, 14.777777777777782, 13.527777777777779, 14.000000000000004, 11.111111111111112, 14.833333333333337, 14.91666666666667], "episode_lengths": [17, 17, 17, 17, 17, 17, 15, 17, 17, 16, 17, 16, 17, 16, 17, 16, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 16, 17, 17, 17, 17, 17, 16, 17, 17, 16, 17, 16, 17, 17, 16, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 14, 17, 17, 16, 17, 17, 17, 17, 17, 15, 17, 17, 16, 15, 16, 17, 17, 16, 17, 17, 17, 16, 17, 16, 16, 17, 16, 17, 16, 16, 17, 17, 17, 16, 17, 17, 17, 16, 16, 17, 17, 17, 17, 17, 17, 17, 17, 16, 16, 13, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9660674336477935, "mean_inference_ms": 1.2237249810310777, "mean_action_processing_ms": 0.10446779177074289, "mean_env_wait_ms": 21.815374637944917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007689992586771647, "StateBufferConnector_ms": 0.005044341087341309, "ViewRequirementAgentConnector_ms": 0.11281073093414307}}, "episode_reward_max": 15.194444444444448, "episode_reward_min": 11.111111111111112, "episode_reward_mean": 14.360879629629633, "episode_len_mean": 16.666666666666668, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.69444444444445, 14.66666666666667, 14.861111111111116, 14.611111111111112, 14.444444444444445, 14.944444444444446, 12.833333333333334, 14.472222222222225, 14.694444444444448, 13.944444444444445, 14.555555555555559, 13.444444444444445, 14.27777777777778, 13.888888888888893, 15.000000000000004, 14.027777777777782, 14.750000000000004, 14.500000000000002, 14.805555555555559, 14.722222222222227, 15.166666666666671, 14.972222222222227, 13.36111111111111, 14.694444444444448, 14.41666666666667, 14.52777777777778, 13.805555555555557, 14.888888888888891, 14.611111111111116, 14.27777777777778, 14.638888888888891, 14.638888888888893, 13.583333333333336, 14.388888888888891, 14.555555555555559, 13.666666666666668, 14.583333333333337, 13.527777777777779, 14.555555555555559, 14.972222222222227, 14.055555555555557, 14.694444444444446, 14.722222222222225, 14.666666666666671, 14.527777777777777, 14.750000000000002, 14.16666666666667, 15.055555555555559, 14.472222222222225, 14.277777777777779, 14.472222222222225, 14.444444444444448, 14.527777777777782, 14.888888888888893, 14.55555555555556, 14.36111111111111, 14.388888888888888, 14.722222222222227, 15.111111111111114, 14.416666666666666, 14.916666666666671, 14.333333333333336, 14.416666666666668, 14.333333333333336, 14.222222222222225, 14.611111111111114, 14.888888888888893, 14.500000000000004, 11.305555555555555, 14.500000000000004, 14.333333333333336, 14.000000000000004, 14.750000000000004, 14.472222222222225, 15.055555555555559, 14.416666666666668, 15.083333333333337, 12.694444444444446, 14.500000000000002, 15.000000000000004, 13.500000000000002, 12.833333333333336, 13.38888888888889, 14.444444444444448, 14.250000000000002, 13.527777777777779, 14.77777777777778, 14.80555555555556, 14.500000000000002, 14.138888888888891, 14.305555555555557, 13.52777777777778, 13.888888888888893, 14.666666666666671, 13.944444444444448, 14.722222222222225, 13.91666666666667, 13.36111111111111, 14.750000000000004, 15.111111111111114, 14.250000000000002, 13.91666666666667, 15.194444444444448, 14.611111111111116, 14.52777777777778, 14.305555555555559, 14.222222222222223, 14.80555555555556, 14.916666666666671, 14.750000000000004, 15.000000000000004, 14.555555555555559, 14.444444444444448, 14.69444444444445, 14.777777777777782, 13.527777777777779, 14.000000000000004, 11.111111111111112, 14.833333333333337, 14.91666666666667], "episode_lengths": [17, 17, 17, 17, 17, 17, 15, 17, 17, 16, 17, 16, 17, 16, 17, 16, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 16, 17, 17, 17, 17, 17, 16, 17, 17, 16, 17, 16, 17, 17, 16, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 14, 17, 17, 16, 17, 17, 17, 17, 17, 15, 17, 17, 16, 15, 16, 17, 17, 16, 17, 17, 17, 16, 17, 16, 16, 17, 16, 17, 16, 16, 17, 17, 17, 16, 17, 17, 17, 16, 16, 17, 17, 17, 17, 17, 17, 17, 17, 16, 16, 13, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9660674336477935, "mean_inference_ms": 1.2237249810310777, "mean_action_processing_ms": 0.10446779177074289, "mean_env_wait_ms": 21.815374637944917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007689992586771647, "StateBufferConnector_ms": 0.005044341087341309, "ViewRequirementAgentConnector_ms": 0.11281073093414307}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.440245827625894, "num_env_steps_trained_throughput_per_sec": 38.440245827625894, "timesteps_total": 16000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 51533.427, "sample_time_ms": 48265.224, "load_time_ms": 11.151, "load_throughput": 179355.858, "learn_time_ms": 3254.413, "learn_throughput": 614.55, "synch_weights_time_ms": 2.188}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 1232, "training_iteration": 8, "trial_id": "13850_00002", "date": "2023-12-28_17-54-21", "timestamp": 1703757261, "time_this_iter_s": 52.03409719467163, "time_total_s": 412.31979417800903, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 412.31979417800903, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 55.969333333333346, "ram_util_percent": 92.05066666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6548923209640715, "policy_loss": -0.02334504918091827, "vf_loss": 0.6760791136821112, "vf_explained_var": 0.9490839257505205, "kl": 0.009592255686649575, "entropy": 0.8359160266982184, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3825.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 7.777777777777778, "episode_reward_mean": 14.325694444444448, "episode_len_mean": 16.65, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.666666666666671, 14.694444444444448, 13.638888888888891, 14.444444444444448, 14.305555555555555, 13.416666666666664, 14.583333333333337, 15.000000000000004, 14.250000000000002, 14.500000000000004, 14.27777777777778, 15.166666666666671, 14.694444444444446, 14.611111111111116, 14.02777777777778, 14.972222222222225, 14.66666666666667, 13.416666666666668, 14.91666666666667, 13.666666666666668, 14.222222222222223, 14.472222222222225, 14.777777777777782, 14.305555555555555, 14.305555555555557, 9.75, 13.361111111111112, 14.916666666666671, 14.52777777777778, 14.861111111111114, 14.305555555555555, 14.472222222222225, 13.694444444444445, 14.805555555555557, 14.750000000000004, 14.861111111111114, 14.472222222222225, 14.805555555555559, 14.583333333333337, 14.222222222222221, 14.77777777777778, 14.722222222222225, 14.555555555555557, 14.888888888888893, 14.944444444444448, 15.222222222222227, 8.38888888888889, 14.777777777777782, 14.638888888888891, 14.861111111111116, 13.611111111111112, 13.444444444444445, 14.305555555555557, 15.111111111111114, 14.361111111111112, 14.02777777777778, 13.583333333333334, 14.333333333333336, 15.222222222222227, 14.944444444444448, 14.694444444444446, 14.555555555555557, 14.666666666666668, 14.25, 14.52777777777778, 14.638888888888893, 14.333333333333336, 13.805555555555557, 14.66666666666667, 14.833333333333336, 14.722222222222227, 14.888888888888891, 14.111111111111112, 13.388888888888891, 14.222222222222223, 13.333333333333334, 14.500000000000002, 14.38888888888889, 14.222222222222223, 14.69444444444445, 15.166666666666671, 14.80555555555556, 7.777777777777778, 13.777777777777782, 14.500000000000002, 14.555555555555557, 12.88888888888889, 14.888888888888893, 14.38888888888889, 13.861111111111112, 14.500000000000004, 14.444444444444448, 14.555555555555557, 14.583333333333337, 14.972222222222227, 14.666666666666671, 14.750000000000005, 14.611111111111116, 14.611111111111114, 15.138888888888893, 14.555555555555559, 14.944444444444448, 14.555555555555557, 14.305555555555557, 13.944444444444448, 14.500000000000002, 15.02777777777778, 14.583333333333337, 14.972222222222227, 14.61111111111111, 14.305555555555557, 14.77777777777778, 14.666666666666671, 14.444444444444445, 14.638888888888893, 14.388888888888891, 13.91666666666667, 14.888888888888893, 14.38888888888889, 14.66666666666667], "episode_lengths": [17, 17, 16, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 16, 17, 16, 17, 17, 17, 17, 17, 12, 16, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 10, 17, 17, 17, 16, 16, 17, 17, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 16, 16, 17, 16, 17, 17, 17, 17, 17, 17, 9, 16, 17, 17, 15, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9505416968022312, "mean_inference_ms": 1.2257947477259425, "mean_action_processing_ms": 0.1046313993679564, "mean_env_wait_ms": 21.876656501188954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00749369462331136, "StateBufferConnector_ms": 0.0050890445709228516, "ViewRequirementAgentConnector_ms": 0.11208852132161458}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 7.777777777777778, "episode_reward_mean": 14.325694444444448, "episode_len_mean": 16.65, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.666666666666671, 14.694444444444448, 13.638888888888891, 14.444444444444448, 14.305555555555555, 13.416666666666664, 14.583333333333337, 15.000000000000004, 14.250000000000002, 14.500000000000004, 14.27777777777778, 15.166666666666671, 14.694444444444446, 14.611111111111116, 14.02777777777778, 14.972222222222225, 14.66666666666667, 13.416666666666668, 14.91666666666667, 13.666666666666668, 14.222222222222223, 14.472222222222225, 14.777777777777782, 14.305555555555555, 14.305555555555557, 9.75, 13.361111111111112, 14.916666666666671, 14.52777777777778, 14.861111111111114, 14.305555555555555, 14.472222222222225, 13.694444444444445, 14.805555555555557, 14.750000000000004, 14.861111111111114, 14.472222222222225, 14.805555555555559, 14.583333333333337, 14.222222222222221, 14.77777777777778, 14.722222222222225, 14.555555555555557, 14.888888888888893, 14.944444444444448, 15.222222222222227, 8.38888888888889, 14.777777777777782, 14.638888888888891, 14.861111111111116, 13.611111111111112, 13.444444444444445, 14.305555555555557, 15.111111111111114, 14.361111111111112, 14.02777777777778, 13.583333333333334, 14.333333333333336, 15.222222222222227, 14.944444444444448, 14.694444444444446, 14.555555555555557, 14.666666666666668, 14.25, 14.52777777777778, 14.638888888888893, 14.333333333333336, 13.805555555555557, 14.66666666666667, 14.833333333333336, 14.722222222222227, 14.888888888888891, 14.111111111111112, 13.388888888888891, 14.222222222222223, 13.333333333333334, 14.500000000000002, 14.38888888888889, 14.222222222222223, 14.69444444444445, 15.166666666666671, 14.80555555555556, 7.777777777777778, 13.777777777777782, 14.500000000000002, 14.555555555555557, 12.88888888888889, 14.888888888888893, 14.38888888888889, 13.861111111111112, 14.500000000000004, 14.444444444444448, 14.555555555555557, 14.583333333333337, 14.972222222222227, 14.666666666666671, 14.750000000000005, 14.611111111111116, 14.611111111111114, 15.138888888888893, 14.555555555555559, 14.944444444444448, 14.555555555555557, 14.305555555555557, 13.944444444444448, 14.500000000000002, 15.02777777777778, 14.583333333333337, 14.972222222222227, 14.61111111111111, 14.305555555555557, 14.77777777777778, 14.666666666666671, 14.444444444444445, 14.638888888888893, 14.388888888888891, 13.91666666666667, 14.888888888888893, 14.38888888888889, 14.66666666666667], "episode_lengths": [17, 17, 16, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 16, 17, 16, 17, 17, 17, 17, 17, 12, 16, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 10, 17, 17, 17, 16, 16, 17, 17, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 16, 16, 17, 16, 17, 17, 17, 17, 17, 17, 9, 16, 17, 17, 15, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9505416968022312, "mean_inference_ms": 1.2257947477259425, "mean_action_processing_ms": 0.1046313993679564, "mean_env_wait_ms": 21.876656501188954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00749369462331136, "StateBufferConnector_ms": 0.0050890445709228516, "ViewRequirementAgentConnector_ms": 0.11208852132161458}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.235017730432205, "num_env_steps_trained_throughput_per_sec": 38.235017730432205, "timesteps_total": 18000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 51619.496, "sample_time_ms": 48360.897, "load_time_ms": 11.116, "load_throughput": 179927.674, "learn_time_ms": 3244.842, "learn_throughput": 616.363, "synch_weights_time_ms": 2.189}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "done": false, "episodes_total": 1352, "training_iteration": 9, "trial_id": "13850_00002", "date": "2023-12-28_17-55-14", "timestamp": 1703757314, "time_this_iter_s": 52.313233613967896, "time_total_s": 464.63302779197693, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 464.63302779197693, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 56.225675675675674, "ram_util_percent": 92.20135135135138}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.454875943130917, "policy_loss": 0.02188191495007939, "vf_loss": 0.4322236533959707, "vf_explained_var": 0.9716152358055115, "kl": 0.003423898421112123, "entropy": 0.7740378593073951, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 4275.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.111111111111112, "episode_reward_mean": 14.703154425612057, "episode_len_mean": 16.915254237288135, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.111111111111112, 14.750000000000004, 14.722222222222227, 15.083333333333337, 14.750000000000002, 14.916666666666671, 15.138888888888893, 14.805555555555559, 14.722222222222227, 14.666666666666671, 14.805555555555559, 14.361111111111112, 15.055555555555559, 15.000000000000004, 14.944444444444448, 14.861111111111116, 14.638888888888893, 14.638888888888893, 14.916666666666671, 15.000000000000002, 14.222222222222225, 14.861111111111116, 15.000000000000004, 14.805555555555559, 14.833333333333337, 14.555555555555559, 14.916666666666671, 14.638888888888893, 14.638888888888895, 15.111111111111112, 15.02777777777778, 15.000000000000004, 13.61111111111111, 14.833333333333337, 14.500000000000004, 14.36111111111111, 14.444444444444446, 14.861111111111114, 15.000000000000004, 14.333333333333334, 14.472222222222225, 14.722222222222227, 15.138888888888893, 14.555555555555559, 14.555555555555559, 14.444444444444446, 15.166666666666671, 14.722222222222227, 13.38888888888889, 14.305555555555557, 14.972222222222227, 14.52777777777778, 15.055555555555559, 15.027777777777782, 15.027777777777782, 14.444444444444446, 14.861111111111116, 14.194444444444445, 14.861111111111112, 15.166666666666671, 15.222222222222227, 14.000000000000004, 15.05555555555556, 14.916666666666671, 14.472222222222225, 14.611111111111112, 14.750000000000005, 13.500000000000002, 14.888888888888893, 14.41666666666667, 14.972222222222225, 14.77777777777778, 14.666666666666671, 14.944444444444446, 14.888888888888891, 15.055555555555559, 15.138888888888893, 14.52777777777778, 14.722222222222227, 15.166666666666671, 15.000000000000004, 13.583333333333334, 14.944444444444448, 14.638888888888891, 14.416666666666668, 14.41666666666667, 15.055555555555559, 14.194444444444448, 14.333333333333336, 15.138888888888893, 15.166666666666671, 13.833333333333337, 14.583333333333337, 14.555555555555559, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.805555555555559, 14.194444444444448, 14.472222222222225, 15.027777777777782, 15.000000000000004, 14.611111111111116, 14.833333333333336, 14.333333333333336, 14.583333333333337, 14.972222222222225, 14.250000000000002, 14.722222222222227, 14.722222222222227, 14.666666666666671, 15.166666666666671, 14.41666666666667, 14.555555555555559, 14.972222222222227, 14.91666666666667, 14.66666666666667, 15.000000000000004], "episode_lengths": [16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 16, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9362824910474141, "mean_inference_ms": 1.2247522356128597, "mean_action_processing_ms": 0.10458691514353122, "mean_env_wait_ms": 21.89309031633991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007371377136747716, "StateBufferConnector_ms": 0.004962339239605403, "ViewRequirementAgentConnector_ms": 0.10967982017387778}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.111111111111112, "episode_reward_mean": 14.703154425612057, "episode_len_mean": 16.915254237288135, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.111111111111112, 14.750000000000004, 14.722222222222227, 15.083333333333337, 14.750000000000002, 14.916666666666671, 15.138888888888893, 14.805555555555559, 14.722222222222227, 14.666666666666671, 14.805555555555559, 14.361111111111112, 15.055555555555559, 15.000000000000004, 14.944444444444448, 14.861111111111116, 14.638888888888893, 14.638888888888893, 14.916666666666671, 15.000000000000002, 14.222222222222225, 14.861111111111116, 15.000000000000004, 14.805555555555559, 14.833333333333337, 14.555555555555559, 14.916666666666671, 14.638888888888893, 14.638888888888895, 15.111111111111112, 15.02777777777778, 15.000000000000004, 13.61111111111111, 14.833333333333337, 14.500000000000004, 14.36111111111111, 14.444444444444446, 14.861111111111114, 15.000000000000004, 14.333333333333334, 14.472222222222225, 14.722222222222227, 15.138888888888893, 14.555555555555559, 14.555555555555559, 14.444444444444446, 15.166666666666671, 14.722222222222227, 13.38888888888889, 14.305555555555557, 14.972222222222227, 14.52777777777778, 15.055555555555559, 15.027777777777782, 15.027777777777782, 14.444444444444446, 14.861111111111116, 14.194444444444445, 14.861111111111112, 15.166666666666671, 15.222222222222227, 14.000000000000004, 15.05555555555556, 14.916666666666671, 14.472222222222225, 14.611111111111112, 14.750000000000005, 13.500000000000002, 14.888888888888893, 14.41666666666667, 14.972222222222225, 14.77777777777778, 14.666666666666671, 14.944444444444446, 14.888888888888891, 15.055555555555559, 15.138888888888893, 14.52777777777778, 14.722222222222227, 15.166666666666671, 15.000000000000004, 13.583333333333334, 14.944444444444448, 14.638888888888891, 14.416666666666668, 14.41666666666667, 15.055555555555559, 14.194444444444448, 14.333333333333336, 15.138888888888893, 15.166666666666671, 13.833333333333337, 14.583333333333337, 14.555555555555559, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.805555555555559, 14.194444444444448, 14.472222222222225, 15.027777777777782, 15.000000000000004, 14.611111111111116, 14.833333333333336, 14.333333333333336, 14.583333333333337, 14.972222222222225, 14.250000000000002, 14.722222222222227, 14.722222222222227, 14.666666666666671, 15.166666666666671, 14.41666666666667, 14.555555555555559, 14.972222222222227, 14.91666666666667, 14.66666666666667, 15.000000000000004], "episode_lengths": [16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 16, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9362824910474141, "mean_inference_ms": 1.2247522356128597, "mean_action_processing_ms": 0.10458691514353122, "mean_env_wait_ms": 21.89309031633991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007371377136747716, "StateBufferConnector_ms": 0.004962339239605403, "ViewRequirementAgentConnector_ms": 0.10967982017387778}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.84137842746732, "num_env_steps_trained_throughput_per_sec": 38.84137842746732, "timesteps_total": 20000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 51606.691, "sample_time_ms": 48362.765, "load_time_ms": 11.6, "load_throughput": 172419.202, "learn_time_ms": 3229.695, "learn_throughput": 619.253, "synch_weights_time_ms": 2.181}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 1470, "training_iteration": 10, "trial_id": "13850_00002", "date": "2023-12-28_17-56-05", "timestamp": 1703757365, "time_this_iter_s": 51.4972026348114, "time_total_s": 516.1302304267883, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 516.1302304267883, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 56.03424657534246, "ram_util_percent": 92.19863013698631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3701136261411011, "policy_loss": -0.0019817951031857067, "vf_loss": 0.3713706134756406, "vf_explained_var": 0.9749570816093021, "kl": 0.006442739979525805, "entropy": 0.6983210759692722, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 22000, "num_env_steps_trained": 22000, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 22000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 10.416666666666668, "episode_reward_mean": 14.678240740740744, "episode_len_mean": 16.8, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.500000000000002, 14.861111111111114, 14.861111111111116, 14.861111111111116, 14.472222222222225, 14.944444444444448, 14.944444444444446, 14.805555555555559, 14.944444444444448, 14.777777777777782, 14.833333333333337, 14.52777777777778, 14.861111111111116, 14.250000000000002, 15.02777777777778, 14.833333333333337, 14.444444444444446, 12.111111111111114, 14.972222222222227, 15.000000000000004, 14.722222222222227, 15.222222222222227, 15.166666666666671, 14.750000000000005, 14.777777777777779, 14.611111111111116, 14.972222222222227, 14.91666666666667, 14.666666666666668, 15.055555555555559, 13.638888888888891, 14.722222222222227, 15.000000000000002, 12.222222222222225, 14.611111111111116, 14.722222222222227, 14.888888888888893, 13.722222222222227, 14.611111111111114, 15.222222222222227, 14.861111111111116, 14.777777777777782, 14.611111111111114, 15.111111111111114, 15.138888888888893, 15.138888888888893, 14.750000000000005, 14.861111111111114, 14.916666666666671, 15.083333333333337, 14.500000000000004, 11.250000000000002, 14.861111111111116, 15.166666666666671, 14.611111111111116, 15.055555555555559, 15.111111111111114, 15.222222222222227, 14.888888888888893, 14.833333333333337, 15.000000000000004, 14.750000000000004, 14.333333333333336, 15.083333333333337, 14.888888888888893, 14.722222222222227, 15.138888888888893, 10.416666666666668, 15.138888888888893, 14.638888888888893, 15.166666666666671, 15.222222222222227, 13.444444444444446, 14.805555555555559, 15.138888888888893, 15.166666666666671, 13.000000000000002, 14.777777777777782, 15.166666666666671, 13.722222222222225, 15.111111111111114, 15.166666666666671, 15.138888888888893, 15.111111111111114, 14.80555555555556, 15.027777777777782, 15.027777777777782, 13.694444444444446, 15.027777777777782, 14.777777777777782, 14.69444444444445, 15.138888888888893, 14.972222222222227, 14.972222222222227, 12.944444444444446, 14.500000000000004, 14.916666666666671, 14.888888888888893, 14.277777777777779, 14.500000000000002, 14.944444444444448, 14.833333333333337, 14.555555555555559, 14.833333333333336, 14.694444444444448, 14.694444444444448, 15.166666666666671, 14.638888888888895, 14.666666666666671, 14.444444444444446, 14.361111111111112, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.000000000000004, 14.777777777777782, 15.222222222222227, 14.80555555555556, 15.222222222222227, 15.138888888888893], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 14, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 14, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 13, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 12, 17, 17, 17, 17, 16, 17, 17, 17, 15, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 15, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9247410010762672, "mean_inference_ms": 1.2236852590823513, "mean_action_processing_ms": 0.10446534200796381, "mean_env_wait_ms": 21.88451826222934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007312496503194173, "StateBufferConnector_ms": 0.00497738520304362, "ViewRequirementAgentConnector_ms": 0.1101134220759074}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 10.416666666666668, "episode_reward_mean": 14.678240740740744, "episode_len_mean": 16.8, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.500000000000002, 14.861111111111114, 14.861111111111116, 14.861111111111116, 14.472222222222225, 14.944444444444448, 14.944444444444446, 14.805555555555559, 14.944444444444448, 14.777777777777782, 14.833333333333337, 14.52777777777778, 14.861111111111116, 14.250000000000002, 15.02777777777778, 14.833333333333337, 14.444444444444446, 12.111111111111114, 14.972222222222227, 15.000000000000004, 14.722222222222227, 15.222222222222227, 15.166666666666671, 14.750000000000005, 14.777777777777779, 14.611111111111116, 14.972222222222227, 14.91666666666667, 14.666666666666668, 15.055555555555559, 13.638888888888891, 14.722222222222227, 15.000000000000002, 12.222222222222225, 14.611111111111116, 14.722222222222227, 14.888888888888893, 13.722222222222227, 14.611111111111114, 15.222222222222227, 14.861111111111116, 14.777777777777782, 14.611111111111114, 15.111111111111114, 15.138888888888893, 15.138888888888893, 14.750000000000005, 14.861111111111114, 14.916666666666671, 15.083333333333337, 14.500000000000004, 11.250000000000002, 14.861111111111116, 15.166666666666671, 14.611111111111116, 15.055555555555559, 15.111111111111114, 15.222222222222227, 14.888888888888893, 14.833333333333337, 15.000000000000004, 14.750000000000004, 14.333333333333336, 15.083333333333337, 14.888888888888893, 14.722222222222227, 15.138888888888893, 10.416666666666668, 15.138888888888893, 14.638888888888893, 15.166666666666671, 15.222222222222227, 13.444444444444446, 14.805555555555559, 15.138888888888893, 15.166666666666671, 13.000000000000002, 14.777777777777782, 15.166666666666671, 13.722222222222225, 15.111111111111114, 15.166666666666671, 15.138888888888893, 15.111111111111114, 14.80555555555556, 15.027777777777782, 15.027777777777782, 13.694444444444446, 15.027777777777782, 14.777777777777782, 14.69444444444445, 15.138888888888893, 14.972222222222227, 14.972222222222227, 12.944444444444446, 14.500000000000004, 14.916666666666671, 14.888888888888893, 14.277777777777779, 14.500000000000002, 14.944444444444448, 14.833333333333337, 14.555555555555559, 14.833333333333336, 14.694444444444448, 14.694444444444448, 15.166666666666671, 14.638888888888895, 14.666666666666671, 14.444444444444446, 14.361111111111112, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.000000000000004, 14.777777777777782, 15.222222222222227, 14.80555555555556, 15.222222222222227, 15.138888888888893], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 14, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 14, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 13, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 12, 17, 17, 17, 17, 16, 17, 17, 17, 15, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 15, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9247410010762672, "mean_inference_ms": 1.2236852590823513, "mean_action_processing_ms": 0.10446534200796381, "mean_env_wait_ms": 21.88451826222934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007312496503194173, "StateBufferConnector_ms": 0.00497738520304362, "ViewRequirementAgentConnector_ms": 0.1101134220759074}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 22000, "num_env_steps_sampled": 22000, "num_env_steps_trained": 22000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.21003434144336, "num_env_steps_trained_throughput_per_sec": 39.21003434144336, "timesteps_total": 22000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 22000, "timers": {"training_iteration_time_ms": 51491.414, "sample_time_ms": 48355.409, "load_time_ms": 10.393, "load_throughput": 192431.485, "learn_time_ms": 3123.058, "learn_throughput": 640.398, "synch_weights_time_ms": 2.11}, "counters": {"num_env_steps_sampled": 22000, "num_env_steps_trained": 22000, "num_agent_steps_sampled": 22000, "num_agent_steps_trained": 22000}, "done": false, "episodes_total": 1590, "training_iteration": 11, "trial_id": "13850_00002", "date": "2023-12-28_17-56-56", "timestamp": 1703757416, "time_this_iter_s": 51.01253581047058, "time_total_s": 567.1427662372589, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 567.1427662372589, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 55.81780821917808, "ram_util_percent": 92.25205479452055}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.21357874151784928, "policy_loss": -0.01626650417430533, "vf_loss": 0.22913182790080705, "vf_explained_var": 0.9859672035111321, "kl": 0.006341489557892651, "entropy": 0.5980274841520521, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 5175.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 11.111111111111112, "episode_reward_mean": 14.8641713747646, "episode_len_mean": 16.923728813559322, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.083333333333337, 14.972222222222227, 13.805555555555559, 14.861111111111114, 14.750000000000005, 15.138888888888893, 15.166666666666671, 14.666666666666671, 15.166666666666671, 14.638888888888895, 14.861111111111116, 14.777777777777782, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.083333333333337, 14.777777777777782, 13.638888888888891, 14.194444444444446, 14.888888888888893, 14.916666666666671, 15.166666666666671, 15.222222222222227, 14.611111111111116, 14.833333333333336, 15.166666666666671, 14.750000000000005, 14.638888888888895, 15.138888888888893, 14.666666666666671, 14.666666666666671, 15.138888888888893, 14.861111111111116, 15.138888888888893, 15.138888888888893, 14.750000000000005, 14.750000000000004, 14.972222222222227, 15.166666666666671, 15.166666666666671, 14.972222222222227, 14.861111111111116, 14.888888888888893, 15.138888888888893, 15.138888888888893, 14.527777777777782, 15.027777777777782, 14.250000000000002, 15.166666666666671, 14.916666666666671, 14.972222222222227, 14.41666666666667, 13.80555555555556, 15.027777777777782, 14.91666666666667, 15.166666666666671, 14.861111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.472222222222225, 15.166666666666671, 14.750000000000004, 14.888888888888893, 14.750000000000005, 15.166666666666671, 14.833333333333337, 14.916666666666671, 15.138888888888893, 15.222222222222227, 14.944444444444448, 14.888888888888893, 14.250000000000002, 14.944444444444446, 14.944444444444446, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.694444444444448, 14.888888888888891, 15.166666666666671, 15.138888888888893, 14.388888888888891, 15.083333333333337, 14.972222222222227, 15.083333333333337, 14.666666666666671, 14.805555555555559, 14.888888888888893, 14.833333333333337, 11.111111111111112, 14.861111111111116, 15.166666666666671, 14.888888888888893, 13.888888888888893, 15.166666666666671, 15.083333333333337, 14.80555555555556, 14.944444444444448, 14.91666666666667, 14.833333333333337, 14.833333333333337, 15.222222222222227, 14.722222222222227, 14.861111111111112, 14.861111111111116, 14.500000000000002, 14.52777777777778, 15.138888888888893, 15.138888888888893], "episode_lengths": [17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 13, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.913190253600146, "mean_inference_ms": 1.2216659581818672, "mean_action_processing_ms": 0.10430312674222679, "mean_env_wait_ms": 21.870851874336598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007351576271703688, "StateBufferConnector_ms": 0.004941326076701536, "ViewRequirementAgentConnector_ms": 0.10836831593917588}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 11.111111111111112, "episode_reward_mean": 14.8641713747646, "episode_len_mean": 16.923728813559322, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.083333333333337, 14.972222222222227, 13.805555555555559, 14.861111111111114, 14.750000000000005, 15.138888888888893, 15.166666666666671, 14.666666666666671, 15.166666666666671, 14.638888888888895, 14.861111111111116, 14.777777777777782, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.083333333333337, 14.777777777777782, 13.638888888888891, 14.194444444444446, 14.888888888888893, 14.916666666666671, 15.166666666666671, 15.222222222222227, 14.611111111111116, 14.833333333333336, 15.166666666666671, 14.750000000000005, 14.638888888888895, 15.138888888888893, 14.666666666666671, 14.666666666666671, 15.138888888888893, 14.861111111111116, 15.138888888888893, 15.138888888888893, 14.750000000000005, 14.750000000000004, 14.972222222222227, 15.166666666666671, 15.166666666666671, 14.972222222222227, 14.861111111111116, 14.888888888888893, 15.138888888888893, 15.138888888888893, 14.527777777777782, 15.027777777777782, 14.250000000000002, 15.166666666666671, 14.916666666666671, 14.972222222222227, 14.41666666666667, 13.80555555555556, 15.027777777777782, 14.91666666666667, 15.166666666666671, 14.861111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.472222222222225, 15.166666666666671, 14.750000000000004, 14.888888888888893, 14.750000000000005, 15.166666666666671, 14.833333333333337, 14.916666666666671, 15.138888888888893, 15.222222222222227, 14.944444444444448, 14.888888888888893, 14.250000000000002, 14.944444444444446, 14.944444444444446, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.694444444444448, 14.888888888888891, 15.166666666666671, 15.138888888888893, 14.388888888888891, 15.083333333333337, 14.972222222222227, 15.083333333333337, 14.666666666666671, 14.805555555555559, 14.888888888888893, 14.833333333333337, 11.111111111111112, 14.861111111111116, 15.166666666666671, 14.888888888888893, 13.888888888888893, 15.166666666666671, 15.083333333333337, 14.80555555555556, 14.944444444444448, 14.91666666666667, 14.833333333333337, 14.833333333333337, 15.222222222222227, 14.722222222222227, 14.861111111111112, 14.861111111111116, 14.500000000000002, 14.52777777777778, 15.138888888888893, 15.138888888888893], "episode_lengths": [17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 13, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.913190253600146, "mean_inference_ms": 1.2216659581818672, "mean_action_processing_ms": 0.10430312674222679, "mean_env_wait_ms": 21.870851874336598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007351576271703688, "StateBufferConnector_ms": 0.004941326076701536, "ViewRequirementAgentConnector_ms": 0.10836831593917588}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.389727364613755, "num_env_steps_trained_throughput_per_sec": 39.389727364613755, "timesteps_total": 24000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 51506.235, "sample_time_ms": 48369.762, "load_time_ms": 9.827, "load_throughput": 203516.1, "learn_time_ms": 3124.099, "learn_throughput": 640.185, "synch_weights_time_ms": 2.108}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 1708, "training_iteration": 12, "trial_id": "13850_00002", "date": "2023-12-28_17-57-47", "timestamp": 1703757467, "time_this_iter_s": 50.77959394454956, "time_total_s": 617.9223601818085, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 617.9223601818085, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 56.18194444444445, "ram_util_percent": 92.21805555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.18987987577824647, "policy_loss": -0.0034024164784285755, "vf_loss": 0.19301423652304545, "vf_explained_var": 0.9885246731175317, "kl": 0.002382720990048734, "entropy": 0.5326747371753057, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 5625.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 26000, "num_env_steps_trained": 26000, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 26000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 12.972222222222225, "episode_reward_mean": 14.965395480225995, "episode_len_mean": 16.949152542372882, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.166666666666671, 14.944444444444448, 14.361111111111114, 14.638888888888895, 15.138888888888893, 15.083333333333337, 15.166666666666671, 14.777777777777782, 14.861111111111116, 15.138888888888893, 15.166666666666671, 15.000000000000004, 14.805555555555559, 14.972222222222225, 15.166666666666671, 15.166666666666671, 14.861111111111116, 15.222222222222227, 13.861111111111116, 15.166666666666671, 15.027777777777782, 15.138888888888893, 15.138888888888893, 15.055555555555559, 15.138888888888893, 14.722222222222227, 14.916666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.166666666666671, 14.944444444444448, 15.166666666666671, 15.083333333333337, 15.166666666666671, 14.777777777777782, 15.138888888888893, 15.027777777777782, 15.000000000000004, 14.888888888888893, 14.861111111111116, 14.861111111111116, 14.777777777777782, 15.083333333333337, 15.16666666666667, 14.027777777777782, 15.111111111111114, 15.138888888888893, 15.166666666666671, 15.055555555555559, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.000000000000004, 14.80555555555556, 15.166666666666671, 15.166666666666671, 14.833333333333337, 13.80555555555556, 14.80555555555556, 14.777777777777782, 15.027777777777782, 15.166666666666671, 14.80555555555556, 12.972222222222225, 15.166666666666671, 15.083333333333337, 14.555555555555559, 15.111111111111114, 14.833333333333337, 15.166666666666671, 14.80555555555556, 14.750000000000005, 15.055555555555559, 15.166666666666671, 14.77777777777778, 15.166666666666671, 14.805555555555557, 15.222222222222227, 15.138888888888893, 14.888888888888893, 15.166666666666671, 15.055555555555559, 14.916666666666671, 14.888888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 14.861111111111114, 14.944444444444448, 15.111111111111114, 15.111111111111114, 15.138888888888893, 15.083333333333337, 14.888888888888893, 14.722222222222227, 15.166666666666671, 13.861111111111114, 15.138888888888893, 14.583333333333337, 15.138888888888893, 14.916666666666671, 15.166666666666671, 15.138888888888893, 14.777777777777782, 14.91666666666667, 15.055555555555559, 15.138888888888893, 14.777777777777782, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 15, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9044642760374837, "mean_inference_ms": 1.2205050434590687, "mean_action_processing_ms": 0.10426624624239778, "mean_env_wait_ms": 21.86544274995887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007293992123361361, "StateBufferConnector_ms": 0.005109633429575775, "ViewRequirementAgentConnector_ms": 0.1088544473809711}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 12.972222222222225, "episode_reward_mean": 14.965395480225995, "episode_len_mean": 16.949152542372882, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.166666666666671, 14.944444444444448, 14.361111111111114, 14.638888888888895, 15.138888888888893, 15.083333333333337, 15.166666666666671, 14.777777777777782, 14.861111111111116, 15.138888888888893, 15.166666666666671, 15.000000000000004, 14.805555555555559, 14.972222222222225, 15.166666666666671, 15.166666666666671, 14.861111111111116, 15.222222222222227, 13.861111111111116, 15.166666666666671, 15.027777777777782, 15.138888888888893, 15.138888888888893, 15.055555555555559, 15.138888888888893, 14.722222222222227, 14.916666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.166666666666671, 14.944444444444448, 15.166666666666671, 15.083333333333337, 15.166666666666671, 14.777777777777782, 15.138888888888893, 15.027777777777782, 15.000000000000004, 14.888888888888893, 14.861111111111116, 14.861111111111116, 14.777777777777782, 15.083333333333337, 15.16666666666667, 14.027777777777782, 15.111111111111114, 15.138888888888893, 15.166666666666671, 15.055555555555559, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.000000000000004, 14.80555555555556, 15.166666666666671, 15.166666666666671, 14.833333333333337, 13.80555555555556, 14.80555555555556, 14.777777777777782, 15.027777777777782, 15.166666666666671, 14.80555555555556, 12.972222222222225, 15.166666666666671, 15.083333333333337, 14.555555555555559, 15.111111111111114, 14.833333333333337, 15.166666666666671, 14.80555555555556, 14.750000000000005, 15.055555555555559, 15.166666666666671, 14.77777777777778, 15.166666666666671, 14.805555555555557, 15.222222222222227, 15.138888888888893, 14.888888888888893, 15.166666666666671, 15.055555555555559, 14.916666666666671, 14.888888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 14.861111111111114, 14.944444444444448, 15.111111111111114, 15.111111111111114, 15.138888888888893, 15.083333333333337, 14.888888888888893, 14.722222222222227, 15.166666666666671, 13.861111111111114, 15.138888888888893, 14.583333333333337, 15.138888888888893, 14.916666666666671, 15.166666666666671, 15.138888888888893, 14.777777777777782, 14.91666666666667, 15.055555555555559, 15.138888888888893, 14.777777777777782, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 15, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9044642760374837, "mean_inference_ms": 1.2205050434590687, "mean_action_processing_ms": 0.10426624624239778, "mean_env_wait_ms": 21.86544274995887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007293992123361361, "StateBufferConnector_ms": 0.005109633429575775, "ViewRequirementAgentConnector_ms": 0.1088544473809711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 26000, "num_env_steps_sampled": 26000, "num_env_steps_trained": 26000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.1835020937902, "num_env_steps_trained_throughput_per_sec": 39.1835020937902, "timesteps_total": 26000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 26000, "timers": {"training_iteration_time_ms": 51461.559, "sample_time_ms": 48322.854, "load_time_ms": 9.866, "load_throughput": 202725.234, "learn_time_ms": 3126.291, "learn_throughput": 639.736, "synch_weights_time_ms": 2.109}, "counters": {"num_env_steps_sampled": 26000, "num_env_steps_trained": 26000, "num_agent_steps_sampled": 26000, "num_agent_steps_trained": 26000}, "done": false, "episodes_total": 1826, "training_iteration": 13, "trial_id": "13850_00002", "date": "2023-12-28_17-58-38", "timestamp": 1703757518, "time_this_iter_s": 51.04699444770813, "time_total_s": 668.9693546295166, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 668.9693546295166, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 55.72876712328767, "ram_util_percent": 92.57808219178085}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.148310800354488, "policy_loss": -0.005072440612647268, "vf_loss": 0.15321627784106467, "vf_explained_var": 0.9908225997289022, "kl": 0.0029682515484059143, "entropy": 0.4648798861106237, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6075.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.000000000000004, "episode_reward_mean": 15.004001883239177, "episode_len_mean": 16.940677966101696, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.972222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.111111111111114, 15.138888888888893, 14.833333333333337, 15.166666666666671, 15.166666666666671, 14.944444444444448, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.638888888888893, 15.166666666666671, 14.861111111111116, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.555555555555559, 15.138888888888893, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 14.916666666666671, 14.69444444444445, 13.833333333333337, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 13.000000000000004, 15.16666666666667, 15.166666666666671, 15.000000000000004, 15.027777777777782, 15.083333333333337, 15.138888888888893, 15.166666666666671, 15.000000000000004, 15.166666666666671, 15.083333333333337, 15.166666666666671, 14.944444444444448, 15.166666666666671, 15.166666666666671, 14.80555555555556, 15.138888888888893, 13.805555555555559, 15.166666666666671, 15.111111111111114, 14.833333333333337, 14.861111111111116, 15.166666666666671, 15.166666666666671, 15.000000000000004, 14.500000000000004, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.027777777777782, 15.138888888888893, 14.777777777777782, 14.277777777777782, 14.861111111111116, 15.083333333333337, 15.166666666666671, 15.027777777777782, 14.916666666666671, 15.166666666666671, 15.166666666666671, 14.944444444444448, 15.055555555555559, 14.888888888888893, 15.027777777777782, 15.166666666666671, 13.888888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 13.750000000000002, 15.083333333333337, 15.138888888888893, 14.916666666666671, 14.888888888888893, 15.027777777777782, 14.972222222222227, 15.166666666666671, 15.027777777777782, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.027777777777782, 15.166666666666671, 15.222222222222227, 15.138888888888893, 14.861111111111116, 15.138888888888893, 15.000000000000004, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 15, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8963533250064808, "mean_inference_ms": 1.219584513492215, "mean_action_processing_ms": 0.10418983864906001, "mean_env_wait_ms": 21.848237913406987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007397643590377549, "StateBufferConnector_ms": 0.004993858983961202, "ViewRequirementAgentConnector_ms": 0.10777368383892512}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.000000000000004, "episode_reward_mean": 15.004001883239177, "episode_len_mean": 16.940677966101696, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.972222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.111111111111114, 15.138888888888893, 14.833333333333337, 15.166666666666671, 15.166666666666671, 14.944444444444448, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.638888888888893, 15.166666666666671, 14.861111111111116, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.555555555555559, 15.138888888888893, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 14.916666666666671, 14.69444444444445, 13.833333333333337, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 13.000000000000004, 15.16666666666667, 15.166666666666671, 15.000000000000004, 15.027777777777782, 15.083333333333337, 15.138888888888893, 15.166666666666671, 15.000000000000004, 15.166666666666671, 15.083333333333337, 15.166666666666671, 14.944444444444448, 15.166666666666671, 15.166666666666671, 14.80555555555556, 15.138888888888893, 13.805555555555559, 15.166666666666671, 15.111111111111114, 14.833333333333337, 14.861111111111116, 15.166666666666671, 15.166666666666671, 15.000000000000004, 14.500000000000004, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.027777777777782, 15.138888888888893, 14.777777777777782, 14.277777777777782, 14.861111111111116, 15.083333333333337, 15.166666666666671, 15.027777777777782, 14.916666666666671, 15.166666666666671, 15.166666666666671, 14.944444444444448, 15.055555555555559, 14.888888888888893, 15.027777777777782, 15.166666666666671, 13.888888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 13.750000000000002, 15.083333333333337, 15.138888888888893, 14.916666666666671, 14.888888888888893, 15.027777777777782, 14.972222222222227, 15.166666666666671, 15.027777777777782, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.027777777777782, 15.166666666666671, 15.222222222222227, 15.138888888888893, 14.861111111111116, 15.138888888888893, 15.000000000000004, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 15, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8963533250064808, "mean_inference_ms": 1.219584513492215, "mean_action_processing_ms": 0.10418983864906001, "mean_env_wait_ms": 21.848237913406987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007397643590377549, "StateBufferConnector_ms": 0.004993858983961202, "ViewRequirementAgentConnector_ms": 0.10777368383892512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.52065448319882, "num_env_steps_trained_throughput_per_sec": 39.52065448319882, "timesteps_total": 28000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 51379.434, "sample_time_ms": 48243.119, "load_time_ms": 11.292, "load_throughput": 177110.114, "learn_time_ms": 3122.47, "learn_throughput": 640.519, "synch_weights_time_ms": 2.112}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 1944, "training_iteration": 14, "trial_id": "13850_00002", "date": "2023-12-28_17-59-29", "timestamp": 1703757569, "time_this_iter_s": 50.611327171325684, "time_total_s": 719.5806818008423, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 719.5806818008423, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 55.82222222222222, "ram_util_percent": 92.68611111111113}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.11143207187039984, "policy_loss": -0.005226684966021114, "vf_loss": 0.11658693989117941, "vf_explained_var": 0.9929386446211073, "kl": 0.00255351671725416, "entropy": 0.4453320746289359, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6525.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.000000000000004, "episode_reward_mean": 15.099340866290024, "episode_len_mean": 16.983050847457626, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.80555555555556, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.138888888888893, 15.166666666666671, 13.000000000000004, 15.166666666666671, 15.138888888888893, 15.166666666666671, 14.888888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 14.777777777777782, 15.138888888888893, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 14.861111111111116, 15.027777777777782, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.750000000000005, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.000000000000004, 15.166666666666671, 14.583333333333337, 14.944444444444448, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.750000000000005, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.750000000000005, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.083333333333337, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 14.750000000000005, 15.166666666666671, 14.888888888888893, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.083333333333337], "episode_lengths": [17, 17, 17, 17, 17, 17, 15, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8891192417431504, "mean_inference_ms": 1.2184697975099443, "mean_action_processing_ms": 0.10408971640337411, "mean_env_wait_ms": 21.82653777492289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00739198620036497, "StateBufferConnector_ms": 0.004920514963440976, "ViewRequirementAgentConnector_ms": 0.10804382421202578}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.000000000000004, "episode_reward_mean": 15.099340866290024, "episode_len_mean": 16.983050847457626, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.80555555555556, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.138888888888893, 15.166666666666671, 13.000000000000004, 15.166666666666671, 15.138888888888893, 15.166666666666671, 14.888888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 14.777777777777782, 15.138888888888893, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 14.861111111111116, 15.027777777777782, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.750000000000005, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.000000000000004, 15.166666666666671, 14.583333333333337, 14.944444444444448, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.750000000000005, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.750000000000005, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.083333333333337, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 14.750000000000005, 15.166666666666671, 14.888888888888893, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.083333333333337], "episode_lengths": [17, 17, 17, 17, 17, 17, 15, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8891192417431504, "mean_inference_ms": 1.2184697975099443, "mean_action_processing_ms": 0.10408971640337411, "mean_env_wait_ms": 21.82653777492289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00739198620036497, "StateBufferConnector_ms": 0.004920514963440976, "ViewRequirementAgentConnector_ms": 0.10804382421202578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000, "num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.70815128337734, "num_env_steps_trained_throughput_per_sec": 39.70815128337734, "timesteps_total": 30000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 30000, "timers": {"training_iteration_time_ms": 51287.688, "sample_time_ms": 48152.9, "load_time_ms": 11.626, "load_throughput": 172023.55, "learn_time_ms": 3120.619, "learn_throughput": 640.898, "synch_weights_time_ms": 2.103}, "counters": {"num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000}, "done": false, "episodes_total": 2062, "training_iteration": 15, "trial_id": "13850_00002", "date": "2023-12-28_18-00-19", "timestamp": 1703757619, "time_this_iter_s": 50.372525691986084, "time_total_s": 769.9532074928284, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 769.9532074928284, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 55.962500000000006, "ram_util_percent": 92.70694444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07090772008633293, "policy_loss": -0.012643603045079443, "vf_loss": 0.08349012292093701, "vf_explained_var": 0.9948861673143174, "kl": 0.004352027026144706, "entropy": 0.44000562369823454, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.111111111111114, "episode_reward_mean": 15.096866096866105, "episode_len_mean": 16.99145299145299, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.138888888888893, 15.138888888888893, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.000000000000002, 15.166666666666671, 15.166666666666671, 14.833333333333337, 15.166666666666671, 15.027777777777782, 15.138888888888893, 15.000000000000004, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.972222222222225, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.138888888888893, 15.055555555555559, 15.222222222222227, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 14.888888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.694444444444448, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.888888888888893, 14.722222222222227, 15.166666666666671, 15.166666666666671, 14.833333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.80555555555556, 15.083333333333336, 14.111111111111114, 14.888888888888893, 14.861111111111116, 15.166666666666671, 15.138888888888893, 15.166666666666671, 14.80555555555556, 15.166666666666671, 15.166666666666671, 14.972222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.888888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.77777777777778, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.027777777777782, 14.916666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.861111111111116, 14.861111111111116, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.055555555555559, 15.166666666666671, 15.138888888888893, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8830722728850959, "mean_inference_ms": 1.217813351158723, "mean_action_processing_ms": 0.1040421025141571, "mean_env_wait_ms": 21.823911300909028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073469602144681494, "StateBufferConnector_ms": 0.004873316512148605, "ViewRequirementAgentConnector_ms": 0.10849349519126436}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.111111111111114, "episode_reward_mean": 15.096866096866105, "episode_len_mean": 16.99145299145299, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.138888888888893, 15.138888888888893, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.000000000000002, 15.166666666666671, 15.166666666666671, 14.833333333333337, 15.166666666666671, 15.027777777777782, 15.138888888888893, 15.000000000000004, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.972222222222225, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.138888888888893, 15.055555555555559, 15.222222222222227, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 14.888888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.694444444444448, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.888888888888893, 14.722222222222227, 15.166666666666671, 15.166666666666671, 14.833333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.80555555555556, 15.083333333333336, 14.111111111111114, 14.888888888888893, 14.861111111111116, 15.166666666666671, 15.138888888888893, 15.166666666666671, 14.80555555555556, 15.166666666666671, 15.166666666666671, 14.972222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.888888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.77777777777778, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.027777777777782, 14.916666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.861111111111116, 14.861111111111116, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.055555555555559, 15.166666666666671, 15.138888888888893, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8830722728850959, "mean_inference_ms": 1.217813351158723, "mean_action_processing_ms": 0.1040421025141571, "mean_env_wait_ms": 21.823911300909028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073469602144681494, "StateBufferConnector_ms": 0.004873316512148605, "ViewRequirementAgentConnector_ms": 0.10849349519126436}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.268499049446326, "num_env_steps_trained_throughput_per_sec": 39.268499049446326, "timesteps_total": 32000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 51185.453, "sample_time_ms": 48057.436, "load_time_ms": 10.235, "load_throughput": 195411.107, "learn_time_ms": 3115.254, "learn_throughput": 642.002, "synch_weights_time_ms": 2.099}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 2179, "training_iteration": 16, "trial_id": "13850_00002", "date": "2023-12-28_18-01-10", "timestamp": 1703757670, "time_this_iter_s": 50.93622803688049, "time_total_s": 820.8894355297089, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 820.8894355297089, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 55.979166666666664, "ram_util_percent": 92.83472222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07450044772807612, "policy_loss": -0.022165809433079428, "vf_loss": 0.09665143213338322, "vf_explained_var": 0.9943424479166667, "kl": 0.0021084484152286524, "entropy": 0.40175316168202296, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 7425.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 34000, "num_env_steps_trained": 34000, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 34000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.750000000000002, "episode_reward_mean": 15.098163841807917, "episode_len_mean": 16.97457627118644, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.833333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.916666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 14.80555555555556, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.138888888888893, 15.027777777777782, 14.333333333333336, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.888888888888893, 15.166666666666671, 15.138888888888893, 15.083333333333337, 15.166666666666671, 15.138888888888893, 15.138888888888893, 14.80555555555556, 14.972222222222227, 13.888888888888893, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 14.80555555555556, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 13.750000000000002, 15.027777777777782, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8788850846625347, "mean_inference_ms": 1.2190004947700837, "mean_action_processing_ms": 0.10411212950649512, "mean_env_wait_ms": 21.847384715268902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007630202729823225, "StateBufferConnector_ms": 0.005059121018749172, "ViewRequirementAgentConnector_ms": 0.1113131894903668}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.750000000000002, "episode_reward_mean": 15.098163841807917, "episode_len_mean": 16.97457627118644, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.833333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.916666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 14.80555555555556, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.138888888888893, 15.027777777777782, 14.333333333333336, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.888888888888893, 15.166666666666671, 15.138888888888893, 15.083333333333337, 15.166666666666671, 15.138888888888893, 15.138888888888893, 14.80555555555556, 14.972222222222227, 13.888888888888893, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 14.80555555555556, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 13.750000000000002, 15.027777777777782, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8788850846625347, "mean_inference_ms": 1.2190004947700837, "mean_action_processing_ms": 0.10411212950649512, "mean_env_wait_ms": 21.847384715268902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007630202729823225, "StateBufferConnector_ms": 0.005059121018749172, "ViewRequirementAgentConnector_ms": 0.1113131894903668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 34000, "num_env_steps_sampled": 34000, "num_env_steps_trained": 34000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.4920389430074, "num_env_steps_trained_throughput_per_sec": 38.4920389430074, "timesteps_total": 34000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 34000, "timers": {"training_iteration_time_ms": 51251.616, "sample_time_ms": 48122.857, "load_time_ms": 9.258, "load_throughput": 216038.651, "learn_time_ms": 3117.016, "learn_throughput": 641.639, "synch_weights_time_ms": 2.07}, "counters": {"num_env_steps_sampled": 34000, "num_env_steps_trained": 34000, "num_agent_steps_sampled": 34000, "num_agent_steps_trained": 34000}, "done": false, "episodes_total": 2297, "training_iteration": 17, "trial_id": "13850_00002", "date": "2023-12-28_18-02-02", "timestamp": 1703757722, "time_this_iter_s": 51.963666915893555, "time_total_s": 872.8531024456024, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 872.8531024456024, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 55.931081081081075, "ram_util_percent": 92.91621621621621}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05364896033373144, "policy_loss": -0.014040825027558539, "vf_loss": 0.06766437622408072, "vf_explained_var": 0.9957984564039443, "kl": 0.007227509551140471, "entropy": 0.38058582484722137, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 7875.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.750000000000005, "episode_reward_mean": 15.141713747645959, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.916666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.027777777777782, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.916666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.916666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.944444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 14.750000000000005, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 14.972222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8748837806877767, "mean_inference_ms": 1.218929558587582, "mean_action_processing_ms": 0.10408183236356705, "mean_env_wait_ms": 21.847180427999902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007727994757183528, "StateBufferConnector_ms": 0.0050219438843807935, "ViewRequirementAgentConnector_ms": 0.10988793130648339}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.750000000000005, "episode_reward_mean": 15.141713747645959, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.916666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.027777777777782, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.916666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.916666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.944444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 14.750000000000005, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 14.972222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8748837806877767, "mean_inference_ms": 1.218929558587582, "mean_action_processing_ms": 0.10408183236356705, "mean_env_wait_ms": 21.847180427999902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007727994757183528, "StateBufferConnector_ms": 0.0050219438843807935, "ViewRequirementAgentConnector_ms": 0.10988793130648339}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.123654116520306, "num_env_steps_trained_throughput_per_sec": 39.123654116520306, "timesteps_total": 36000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 51160.733, "sample_time_ms": 48029.537, "load_time_ms": 9.699, "load_throughput": 206217.24, "learn_time_ms": 3119.012, "learn_throughput": 641.229, "synch_weights_time_ms": 2.069}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 2415, "training_iteration": 18, "trial_id": "13850_00002", "date": "2023-12-28_18-02-53", "timestamp": 1703757773, "time_this_iter_s": 51.125282287597656, "time_total_s": 923.9783847332001, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 923.9783847332001, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 55.967123287671235, "ram_util_percent": 92.86986301369862}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.10474464648758941, "policy_loss": 0.012236747205671337, "vf_loss": 0.09248540232578914, "vf_explained_var": 0.994441311624315, "kl": 0.006399629525634545, "entropy": 0.33379982782734763, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 8325.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 38000, "num_env_steps_trained": 38000, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 38000}, "sampler_results": {"episode_reward_max": 15.166666666666671, "episode_reward_min": 13.000000000000004, "episode_reward_mean": 15.13817663817665, "episode_len_mean": 16.982905982905983, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 13.000000000000004, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 15, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8710800498753002, "mean_inference_ms": 1.2188077848185546, "mean_action_processing_ms": 0.10408574927935765, "mean_env_wait_ms": 21.85511269703284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074423276461087744, "StateBufferConnector_ms": 0.004943415649935731, "ViewRequirementAgentConnector_ms": 0.1089898948995476}}, "episode_reward_max": 15.166666666666671, "episode_reward_min": 13.000000000000004, "episode_reward_mean": 15.13817663817665, "episode_len_mean": 16.982905982905983, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 13.000000000000004, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 15, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8710800498753002, "mean_inference_ms": 1.2188077848185546, "mean_action_processing_ms": 0.10408574927935765, "mean_env_wait_ms": 21.85511269703284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074423276461087744, "StateBufferConnector_ms": 0.004943415649935731, "ViewRequirementAgentConnector_ms": 0.1089898948995476}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 38000, "num_env_steps_sampled": 38000, "num_env_steps_trained": 38000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.930257178595255, "num_env_steps_trained_throughput_per_sec": 38.930257178595255, "timesteps_total": 38000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 38000, "timers": {"training_iteration_time_ms": 51067.318, "sample_time_ms": 47945.326, "load_time_ms": 9.237, "load_throughput": 216531.615, "learn_time_ms": 3110.283, "learn_throughput": 643.028, "synch_weights_time_ms": 2.059}, "counters": {"num_env_steps_sampled": 38000, "num_env_steps_trained": 38000, "num_agent_steps_sampled": 38000, "num_agent_steps_trained": 38000}, "done": false, "episodes_total": 2532, "training_iteration": 19, "trial_id": "13850_00002", "date": "2023-12-28_18-03-45", "timestamp": 1703757825, "time_this_iter_s": 51.37860727310181, "time_total_s": 975.3569920063019, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 975.3569920063019, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 55.80958904109589, "ram_util_percent": 92.66849315068495}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05879181930258508, "policy_loss": -0.005162564106285572, "vf_loss": 0.06394842320846186, "vf_explained_var": 0.9960883814758724, "kl": 0.0016952182886894897, "entropy": 0.31496473020977445, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 8775.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.153483992467054, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.083333333333337, 14.916666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8676901617269744, "mean_inference_ms": 1.2186065899938654, "mean_action_processing_ms": 0.10406214911765882, "mean_env_wait_ms": 21.854460035269604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007359456207792638, "StateBufferConnector_ms": 0.0049186965166512185, "ViewRequirementAgentConnector_ms": 0.10902033013812566}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.153483992467054, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.083333333333337, 14.916666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8676901617269744, "mean_inference_ms": 1.2186065899938654, "mean_action_processing_ms": 0.10406214911765882, "mean_env_wait_ms": 21.854460035269604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007359456207792638, "StateBufferConnector_ms": 0.0049186965166512185, "ViewRequirementAgentConnector_ms": 0.10902033013812566}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.12374224921119, "num_env_steps_trained_throughput_per_sec": 39.12374224921119, "timesteps_total": 40000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 51030.156, "sample_time_ms": 47904.385, "load_time_ms": 8.773, "load_throughput": 227966.791, "learn_time_ms": 3114.527, "learn_throughput": 642.152, "synch_weights_time_ms": 2.062}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 2650, "training_iteration": 20, "trial_id": "13850_00002", "date": "2023-12-28_18-04-36", "timestamp": 1703757876, "time_this_iter_s": 51.1248197555542, "time_total_s": 1026.481811761856, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1026.481811761856, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 56.363013698630134, "ram_util_percent": 92.65890410958907}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0017578125000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.056714723259210585, "policy_loss": -0.009764591246429416, "vf_loss": 0.06646593545873959, "vf_explained_var": 0.9959085722764333, "kl": 0.007611034639050879, "entropy": 0.29421748611662124, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 9225.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.833333333333337, "episode_reward_mean": 15.14312617702449, "episode_len_mean": 16.991525423728813, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.694444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.69444444444445, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 13.833333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 14.944444444444448, 15.166666666666671, 15.083333333333337], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8647686407533774, "mean_inference_ms": 1.2186796409011318, "mean_action_processing_ms": 0.1040673057810641, "mean_env_wait_ms": 21.850831570907655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007577669822563559, "StateBufferConnector_ms": 0.005020327487234342, "ViewRequirementAgentConnector_ms": 0.11043225304555085}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.833333333333337, "episode_reward_mean": 15.14312617702449, "episode_len_mean": 16.991525423728813, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.694444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.69444444444445, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 13.833333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 14.944444444444448, 15.166666666666671, 15.083333333333337], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8647686407533774, "mean_inference_ms": 1.2186796409011318, "mean_action_processing_ms": 0.1040673057810641, "mean_env_wait_ms": 21.850831570907655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007577669822563559, "StateBufferConnector_ms": 0.005020327487234342, "ViewRequirementAgentConnector_ms": 0.11043225304555085}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000, "num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.208064228212756, "num_env_steps_trained_throughput_per_sec": 39.208064228212756, "timesteps_total": 42000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 42000, "timers": {"training_iteration_time_ms": 51030.413, "sample_time_ms": 47901.296, "load_time_ms": 9.273, "load_throughput": 215669.29, "learn_time_ms": 3117.368, "learn_throughput": 641.567, "synch_weights_time_ms": 2.069}, "counters": {"num_env_steps_sampled": 42000, "num_env_steps_trained": 42000, "num_agent_steps_sampled": 42000, "num_agent_steps_trained": 42000}, "done": false, "episodes_total": 2768, "training_iteration": 21, "trial_id": "13850_00002", "date": "2023-12-28_18-05-27", "timestamp": 1703757927, "time_this_iter_s": 51.014679193496704, "time_total_s": 1077.4964909553528, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1077.4964909553528, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 55.78611111111111, "ram_util_percent": 92.62777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0017578125000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07149114991434746, "policy_loss": 0.014124028612342146, "vf_loss": 0.05735362257394526, "vf_explained_var": 0.9964325228002336, "kl": 0.007679233727429727, "entropy": 0.2395883067117797, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 9675.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.833333333333337, "episode_reward_mean": 15.15811965811967, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 14.833333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8621206663079737, "mean_inference_ms": 1.2188201270204564, "mean_action_processing_ms": 0.10406493338689819, "mean_env_wait_ms": 21.854732771390783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00734003181131477, "StateBufferConnector_ms": 0.0049937484610793935, "ViewRequirementAgentConnector_ms": 0.10985594529371995}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.833333333333337, "episode_reward_mean": 15.15811965811967, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 14.833333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8621206663079737, "mean_inference_ms": 1.2188201270204564, "mean_action_processing_ms": 0.10406493338689819, "mean_env_wait_ms": 21.854732771390783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00734003181131477, "StateBufferConnector_ms": 0.0049937484610793935, "ViewRequirementAgentConnector_ms": 0.10985594529371995}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.94868912314343, "num_env_steps_trained_throughput_per_sec": 38.94868912314343, "timesteps_total": 44000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 51087.908, "sample_time_ms": 47953.499, "load_time_ms": 10.085, "load_throughput": 198306.151, "learn_time_ms": 3121.832, "learn_throughput": 640.649, "synch_weights_time_ms": 2.076}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 2885, "training_iteration": 22, "trial_id": "13850_00002", "date": "2023-12-28_18-06-18", "timestamp": 1703757978, "time_this_iter_s": 51.35516810417175, "time_total_s": 1128.8516590595245, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1128.8516590595245, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 56.16216216216216, "ram_util_percent": 92.59864864864866}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0017578125000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04668093793055353, "policy_loss": -0.007931323279109266, "vf_loss": 0.05460831739836269, "vf_explained_var": 0.996603960858451, "kl": 0.0022437581344641445, "entropy": 0.2340368401673105, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 10125.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 46000, "num_env_steps_trained": 46000, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 46000}, "sampler_results": {"episode_reward_max": 15.166666666666671, "episode_reward_min": 14.916666666666671, "episode_reward_mean": 15.15795668549907, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.055555555555559, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.916666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8600598555414968, "mean_inference_ms": 1.2194161435728037, "mean_action_processing_ms": 0.10409502046957878, "mean_env_wait_ms": 21.867532439445505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007487151582362288, "StateBufferConnector_ms": 0.005132262989626092, "ViewRequirementAgentConnector_ms": 0.1113325862561242}}, "episode_reward_max": 15.166666666666671, "episode_reward_min": 14.916666666666671, "episode_reward_mean": 15.15795668549907, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.055555555555559, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.916666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8600598555414968, "mean_inference_ms": 1.2194161435728037, "mean_action_processing_ms": 0.10409502046957878, "mean_env_wait_ms": 21.867532439445505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007487151582362288, "StateBufferConnector_ms": 0.005132262989626092, "ViewRequirementAgentConnector_ms": 0.1113325862561242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 46000, "num_env_steps_sampled": 46000, "num_env_steps_trained": 46000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.6467613046564, "num_env_steps_trained_throughput_per_sec": 38.6467613046564, "timesteps_total": 46000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 46000, "timers": {"training_iteration_time_ms": 51158.797, "sample_time_ms": 48031.189, "load_time_ms": 11.438, "load_throughput": 174853.007, "learn_time_ms": 3113.673, "learn_throughput": 642.328, "synch_weights_time_ms": 2.077}, "counters": {"num_env_steps_sampled": 46000, "num_env_steps_trained": 46000, "num_agent_steps_sampled": 46000, "num_agent_steps_trained": 46000}, "done": false, "episodes_total": 3003, "training_iteration": 23, "trial_id": "13850_00002", "date": "2023-12-28_18-07-10", "timestamp": 1703758030, "time_this_iter_s": 51.75595474243164, "time_total_s": 1180.6076138019562, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1180.6076138019562, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 56.04109589041096, "ram_util_percent": 92.64657534246578}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0008789062500000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04976007239634378, "policy_loss": -0.002345688177479638, "vf_loss": 0.05210312330060535, "vf_explained_var": 0.9967661906613244, "kl": 0.0030007904873864057, "entropy": 0.25022132340404724, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 10575.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 15.166666666666671, "episode_reward_min": 14.861111111111116, "episode_reward_mean": 15.159839924670447, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.861111111111116, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.916666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8571957928948454, "mean_inference_ms": 1.2186007589993983, "mean_action_processing_ms": 0.10404021354375365, "mean_env_wait_ms": 21.862393118327333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00736046645600917, "StateBufferConnector_ms": 0.004939305580268472, "ViewRequirementAgentConnector_ms": 0.10846812846296924}}, "episode_reward_max": 15.166666666666671, "episode_reward_min": 14.861111111111116, "episode_reward_mean": 15.159839924670447, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.861111111111116, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.916666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8571957928948454, "mean_inference_ms": 1.2186007589993983, "mean_action_processing_ms": 0.10404021354375365, "mean_env_wait_ms": 21.862393118327333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00736046645600917, "StateBufferConnector_ms": 0.004939305580268472, "ViewRequirementAgentConnector_ms": 0.10846812846296924}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.348608208370024, "num_env_steps_trained_throughput_per_sec": 39.348608208370024, "timesteps_total": 48000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 51180.923, "sample_time_ms": 48053.44, "load_time_ms": 10.036, "load_throughput": 199285.589, "learn_time_ms": 3114.959, "learn_throughput": 642.063, "synch_weights_time_ms": 2.068}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 3121, "training_iteration": 24, "trial_id": "13850_00002", "date": "2023-12-28_18-08-01", "timestamp": 1703758081, "time_this_iter_s": 50.83320665359497, "time_total_s": 1231.4408204555511, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1231.4408204555511, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 56.060273972602744, "ram_util_percent": 92.72328767123288}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0004394531250000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04630996772165721, "policy_loss": -0.002215289930916495, "vf_loss": 0.04852007351815701, "vf_explained_var": 0.9969909640153249, "kl": 0.0117951841138988, "entropy": 0.21460386703411738, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11025.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 50000}, "sampler_results": {"episode_reward_max": 15.166666666666671, "episode_reward_min": 14.972222222222227, "episode_reward_mean": 15.158594491927838, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8549916072143641, "mean_inference_ms": 1.2185354952416336, "mean_action_processing_ms": 0.10404412082351613, "mean_env_wait_ms": 21.86704682806978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007336771386301416, "StateBufferConnector_ms": 0.005160641466450487, "ViewRequirementAgentConnector_ms": 0.1095429444924379}}, "episode_reward_max": 15.166666666666671, "episode_reward_min": 14.972222222222227, "episode_reward_mean": 15.158594491927838, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8549916072143641, "mean_inference_ms": 1.2185354952416336, "mean_action_processing_ms": 0.10404412082351613, "mean_env_wait_ms": 21.86704682806978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007336771386301416, "StateBufferConnector_ms": 0.005160641466450487, "ViewRequirementAgentConnector_ms": 0.1095429444924379}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 50000, "num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.940172130752515, "num_env_steps_trained_throughput_per_sec": 38.940172130752515, "timesteps_total": 50000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 50000, "timers": {"training_iteration_time_ms": 51280.258, "sample_time_ms": 48150.634, "load_time_ms": 9.575, "load_throughput": 208881.762, "learn_time_ms": 3117.548, "learn_throughput": 641.53, "synch_weights_time_ms": 2.072}, "counters": {"num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled": 50000, "num_agent_steps_trained": 50000}, "done": false, "episodes_total": 3238, "training_iteration": 25, "trial_id": "13850_00002", "date": "2023-12-28_18-08-52", "timestamp": 1703758132, "time_this_iter_s": 51.3663592338562, "time_total_s": 1282.8071796894073, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1282.8071796894073, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 56.02465753424658, "ram_util_percent": 92.70000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0004394531250000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.043269192461993955, "policy_loss": -0.0031760171925028164, "vf_loss": 0.046442854404449466, "vf_explained_var": 0.9971498306592306, "kl": 0.005358932786919905, "entropy": 0.17968179119957817, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11475.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 15.166666666666671, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.15536723163843, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.055555555555559, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.916666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.852843985709132, "mean_inference_ms": 1.218052947134475, "mean_action_processing_ms": 0.10400686705837556, "mean_env_wait_ms": 21.859512006142303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00742067724971448, "StateBufferConnector_ms": 0.005108623181359242, "ViewRequirementAgentConnector_ms": 0.1084602485268803}}, "episode_reward_max": 15.166666666666671, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.15536723163843, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.055555555555559, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.916666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.852843985709132, "mean_inference_ms": 1.218052947134475, "mean_action_processing_ms": 0.10400686705837556, "mean_env_wait_ms": 21.859512006142303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00742067724971448, "StateBufferConnector_ms": 0.005108623181359242, "ViewRequirementAgentConnector_ms": 0.1084602485268803}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.389476746428194, "num_env_steps_trained_throughput_per_sec": 39.389476746428194, "timesteps_total": 52000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 51264.615, "sample_time_ms": 48128.873, "load_time_ms": 9.674, "load_throughput": 206732.566, "learn_time_ms": 3123.558, "learn_throughput": 640.295, "synch_weights_time_ms": 2.075}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 3356, "training_iteration": 26, "trial_id": "13850_00002", "date": "2023-12-28_18-09-43", "timestamp": 1703758183, "time_this_iter_s": 50.77982497215271, "time_total_s": 1333.58700466156, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1333.58700466156, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 55.97777777777778, "ram_util_percent": 92.65416666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0004394531250000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03888559360458101, "policy_loss": -0.0027175305121474795, "vf_loss": 0.041601591954628626, "vf_explained_var": 0.9974229547712538, "kl": 0.003487202204296425, "entropy": 0.17926188674237992, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 11925.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "sampler_results": {"episode_reward_max": 15.166666666666671, "episode_reward_min": 15.138888888888893, "episode_reward_mean": 15.164548022598883, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8510468467553745, "mean_inference_ms": 1.2182216000039061, "mean_action_processing_ms": 0.10401013493482715, "mean_env_wait_ms": 21.861205341458273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007505538099903172, "StateBufferConnector_ms": 0.005034470962265791, "ViewRequirementAgentConnector_ms": 0.10985257261890476}}, "episode_reward_max": 15.166666666666671, "episode_reward_min": 15.138888888888893, "episode_reward_mean": 15.164548022598883, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8510468467553745, "mean_inference_ms": 1.2182216000039061, "mean_action_processing_ms": 0.10401013493482715, "mean_env_wait_ms": 21.861205341458273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007505538099903172, "StateBufferConnector_ms": 0.005034470962265791, "ViewRequirementAgentConnector_ms": 0.10985257261890476}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.04641689933047, "num_env_steps_trained_throughput_per_sec": 39.04641689933047, "timesteps_total": 54000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 51190.845, "sample_time_ms": 48060.5, "load_time_ms": 9.25, "load_throughput": 216219.627, "learn_time_ms": 3118.577, "learn_throughput": 641.318, "synch_weights_time_ms": 2.085}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "done": false, "episodes_total": 3474, "training_iteration": 27, "trial_id": "13850_00002", "date": "2023-12-28_18-10-34", "timestamp": 1703758234, "time_this_iter_s": 51.22675681114197, "time_total_s": 1384.813761472702, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1384.813761472702, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 56.0958904109589, "ram_util_percent": 92.72465753424659}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00021972656250000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04947272355461286, "policy_loss": 0.008942747838381265, "vf_loss": 0.04052953282992045, "vf_explained_var": 0.9975284769799975, "kl": 0.002016028678190726, "entropy": 0.17482785787847308, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 12375.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.156695156695163, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.194444444444448, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.055555555555559, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.111111111111114, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8495568620317978, "mean_inference_ms": 1.2186229515283447, "mean_action_processing_ms": 0.10405126034099096, "mean_env_wait_ms": 21.86930732419156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007499792636969151, "StateBufferConnector_ms": 0.004988450270432692, "ViewRequirementAgentConnector_ms": 0.11128910586365268}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.156695156695163, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.194444444444448, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.055555555555559, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.111111111111114, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8495568620317978, "mean_inference_ms": 1.2186229515283447, "mean_action_processing_ms": 0.10405126034099096, "mean_env_wait_ms": 21.86930732419156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007499792636969151, "StateBufferConnector_ms": 0.004988450270432692, "ViewRequirementAgentConnector_ms": 0.11128910586365268}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.76134288374773, "num_env_steps_trained_throughput_per_sec": 38.76134288374773, "timesteps_total": 56000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 51238.628, "sample_time_ms": 48112.507, "load_time_ms": 10.014, "load_throughput": 199718.3, "learn_time_ms": 3113.584, "learn_throughput": 642.347, "synch_weights_time_ms": 2.087}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 3591, "training_iteration": 28, "trial_id": "13850_00002", "date": "2023-12-28_18-11-26", "timestamp": 1703758286, "time_this_iter_s": 51.602718114852905, "time_total_s": 1436.416479587555, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1436.416479587555, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 55.87534246575342, "ram_util_percent": 92.72465753424657}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00010986328125000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.031895003610301904, "policy_loss": -0.004223428987380531, "vf_loss": 0.036118254537383716, "vf_explained_var": 0.9977635806136661, "kl": 0.0016195421756882667, "entropy": 0.13554233393735357, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 12825.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 58000, "num_env_steps_trained": 58000, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 58000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.944444444444448, "episode_reward_mean": 15.157250470809803, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.972222222222227, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.944444444444448, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.194444444444448, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.972222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8477065417727971, "mean_inference_ms": 1.218350475688336, "mean_action_processing_ms": 0.10402467205155275, "mean_env_wait_ms": 21.863218957034785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007381681668556342, "StateBufferConnector_ms": 0.004950014211363711, "ViewRequirementAgentConnector_ms": 0.1091288307965812}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.944444444444448, "episode_reward_mean": 15.157250470809803, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.972222222222227, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.944444444444448, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.194444444444448, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.972222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8477065417727971, "mean_inference_ms": 1.218350475688336, "mean_action_processing_ms": 0.10402467205155275, "mean_env_wait_ms": 21.863218957034785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007381681668556342, "StateBufferConnector_ms": 0.004950014211363711, "ViewRequirementAgentConnector_ms": 0.1091288307965812}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 58000, "num_env_steps_sampled": 58000, "num_env_steps_trained": 58000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.38791614199227, "num_env_steps_trained_throughput_per_sec": 39.38791614199227, "timesteps_total": 58000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 58000, "timers": {"training_iteration_time_ms": 51178.935, "sample_time_ms": 48048.799, "load_time_ms": 11.202, "load_throughput": 178547.122, "learn_time_ms": 3116.408, "learn_throughput": 641.764, "synch_weights_time_ms": 2.088}, "counters": {"num_env_steps_sampled": 58000, "num_env_steps_trained": 58000, "num_agent_steps_sampled": 58000, "num_agent_steps_trained": 58000}, "done": false, "episodes_total": 3709, "training_iteration": 29, "trial_id": "13850_00002", "date": "2023-12-28_18-12-17", "timestamp": 1703758337, "time_this_iter_s": 50.78187012672424, "time_total_s": 1487.1983497142792, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1487.1983497142792, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 55.66438356164384, "ram_util_percent": 92.77123287671232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.4931640625000015e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04405584567979935, "policy_loss": -0.0009471116421951187, "vf_loss": 0.04500289225329956, "vf_explained_var": 0.9973294764094882, "kl": 0.0011782707691947644, "entropy": 0.12316955172353321, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 13275.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.152542372881367, "episode_len_mean": 16.991525423728813, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 13.888888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.861111111111116, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8467334490716762, "mean_inference_ms": 1.2189525260231668, "mean_action_processing_ms": 0.1040798563060855, "mean_env_wait_ms": 21.874668196804066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007817098649881653, "StateBufferConnector_ms": 0.005149033110020525, "ViewRequirementAgentConnector_ms": 0.11169243667085292}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.152542372881367, "episode_len_mean": 16.991525423728813, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 13.888888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.861111111111116, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8467334490716762, "mean_inference_ms": 1.2189525260231668, "mean_action_processing_ms": 0.1040798563060855, "mean_env_wait_ms": 21.874668196804066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007817098649881653, "StateBufferConnector_ms": 0.005149033110020525, "ViewRequirementAgentConnector_ms": 0.11169243667085292}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.534585402828526, "num_env_steps_trained_throughput_per_sec": 38.534585402828526, "timesteps_total": 60000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 51257.092, "sample_time_ms": 48129.558, "load_time_ms": 10.638, "load_throughput": 188001.918, "learn_time_ms": 3114.373, "learn_throughput": 642.184, "synch_weights_time_ms": 2.082}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 3827, "training_iteration": 30, "trial_id": "13850_00002", "date": "2023-12-28_18-13-08", "timestamp": 1703758388, "time_this_iter_s": 51.90652132034302, "time_total_s": 1539.1048710346222, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1539.1048710346222, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 56.06621621621621, "ram_util_percent": 92.83243243243243}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7465820312500007e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.035332030613596244, "policy_loss": 0.002928257832924525, "vf_loss": 0.03240375303973754, "vf_explained_var": 0.998012312385771, "kl": 0.0007317469375758832, "entropy": 0.12473413361443414, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 13725.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 62000, "num_env_steps_trained": 62000, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 62000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.888888888888893, "episode_reward_mean": 15.14292497625832, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.083333333333337, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.944444444444448, 15.055555555555559, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 14.888888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.000000000000004, 15.166666666666671, 15.083333333333337, 15.083333333333337, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.083333333333337, 15.138888888888893, 15.138888888888893, 15.166666666666671, 14.888888888888893, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.027777777777782, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.138888888888893, 15.166666666666671, 14.916666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.083333333333337, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8457017132156182, "mean_inference_ms": 1.2197740189373616, "mean_action_processing_ms": 0.10413874430213517, "mean_env_wait_ms": 21.888084879683046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007493475563505776, "StateBufferConnector_ms": 0.0050687382363865515, "ViewRequirementAgentConnector_ms": 0.11229331676776592}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.888888888888893, "episode_reward_mean": 15.14292497625832, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.083333333333337, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.944444444444448, 15.055555555555559, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 14.888888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.000000000000004, 15.166666666666671, 15.083333333333337, 15.083333333333337, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.083333333333337, 15.138888888888893, 15.138888888888893, 15.166666666666671, 14.888888888888893, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.027777777777782, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.138888888888893, 15.166666666666671, 14.916666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.083333333333337, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8457017132156182, "mean_inference_ms": 1.2197740189373616, "mean_action_processing_ms": 0.10413874430213517, "mean_env_wait_ms": 21.888084879683046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007493475563505776, "StateBufferConnector_ms": 0.0050687382363865515, "ViewRequirementAgentConnector_ms": 0.11229331676776592}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 62000, "num_env_steps_sampled": 62000, "num_env_steps_trained": 62000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.39837169014337, "num_env_steps_trained_throughput_per_sec": 38.39837169014337, "timesteps_total": 62000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 62000, "timers": {"training_iteration_time_ms": 51364.655, "sample_time_ms": 48239.491, "load_time_ms": 11.452, "load_throughput": 174638.237, "learn_time_ms": 3111.189, "learn_throughput": 642.841, "synch_weights_time_ms": 2.078}, "counters": {"num_env_steps_sampled": 62000, "num_env_steps_trained": 62000, "num_agent_steps_sampled": 62000, "num_agent_steps_trained": 62000}, "done": false, "episodes_total": 3944, "training_iteration": 31, "trial_id": "13850_00002", "date": "2023-12-28_18-14-01", "timestamp": 1703758441, "time_this_iter_s": 52.09051871299744, "time_total_s": 1591.1953897476196, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1591.1953897476196, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 56.1554054054054, "ram_util_percent": 92.83783783783782}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3732910156250004e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03277003461288081, "policy_loss": 0.004276248721612824, "vf_loss": 0.028493776097893716, "vf_explained_var": 0.9982353447543251, "kl": 0.00067349896087636, "entropy": 0.10351695123645994, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 15.027777777777782, "episode_reward_mean": 15.157015065913383, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.222222222222227, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.055555555555559, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8443630802801061, "mean_inference_ms": 1.2196509443713923, "mean_action_processing_ms": 0.10413493672914186, "mean_env_wait_ms": 21.887864871475177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007362082853155621, "StateBufferConnector_ms": 0.0051106436777923064, "ViewRequirementAgentConnector_ms": 0.10894840046510858}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 15.027777777777782, "episode_reward_mean": 15.157015065913383, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.222222222222227, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.055555555555559, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8443630802801061, "mean_inference_ms": 1.2196509443713923, "mean_action_processing_ms": 0.10413493672914186, "mean_env_wait_ms": 21.887864871475177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007362082853155621, "StateBufferConnector_ms": 0.0051106436777923064, "ViewRequirementAgentConnector_ms": 0.10894840046510858}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.075648951367675, "num_env_steps_trained_throughput_per_sec": 39.075648951367675, "timesteps_total": 64000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 51347.971, "sample_time_ms": 48226.44, "load_time_ms": 11.884, "load_throughput": 168289.482, "learn_time_ms": 3107.122, "learn_throughput": 643.682, "synch_weights_time_ms": 2.081}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 4062, "training_iteration": 32, "trial_id": "13850_00002", "date": "2023-12-28_18-14-52", "timestamp": 1703758492, "time_this_iter_s": 51.18782830238342, "time_total_s": 1642.383218050003, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1642.383218050003, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 55.83013698630137, "ram_util_percent": 92.83013698630137}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.866455078125002e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.031192948023154813, "policy_loss": -0.003014023299846384, "vf_loss": 0.03420696190247933, "vf_explained_var": 0.9980379051632351, "kl": 0.0013004674610862773, "entropy": 0.08013536201583014, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 14625.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 66000, "num_env_steps_trained": 66000, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 66000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.157956685499068, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8432042358322606, "mean_inference_ms": 1.21951935495424, "mean_action_processing_ms": 0.1041189587240326, "mean_env_wait_ms": 21.890363943067296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007467148667674953, "StateBufferConnector_ms": 0.005069021451271186, "ViewRequirementAgentConnector_ms": 0.10954303256535934}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.157956685499068, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8432042358322606, "mean_inference_ms": 1.21951935495424, "mean_action_processing_ms": 0.1041189587240326, "mean_env_wait_ms": 21.890363943067296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007467148667674953, "StateBufferConnector_ms": 0.005069021451271186, "ViewRequirementAgentConnector_ms": 0.10954303256535934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 66000, "num_env_steps_sampled": 66000, "num_env_steps_trained": 66000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.92731682524818, "num_env_steps_trained_throughput_per_sec": 38.92731682524818, "timesteps_total": 66000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 66000, "timers": {"training_iteration_time_ms": 51310.673, "sample_time_ms": 48185.21, "load_time_ms": 11.031, "load_throughput": 181306.706, "learn_time_ms": 3111.86, "learn_throughput": 642.702, "synch_weights_time_ms": 2.122}, "counters": {"num_env_steps_sampled": 66000, "num_env_steps_trained": 66000, "num_agent_steps_sampled": 66000, "num_agent_steps_trained": 66000}, "done": false, "episodes_total": 4180, "training_iteration": 33, "trial_id": "13850_00002", "date": "2023-12-28_18-15-43", "timestamp": 1703758543, "time_this_iter_s": 51.3833749294281, "time_total_s": 1693.7665929794312, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1693.7665929794312, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 55.92191780821918, "ram_util_percent": 92.87534246575342}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.433227539062501e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.026217746963989663, "policy_loss": -0.010527780279517174, "vf_loss": 0.03674552364067899, "vf_explained_var": 0.9978676858213212, "kl": 0.0009142405558886206, "entropy": 0.05947159942653444, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15075.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.149810066476743, "episode_len_mean": 16.99145299145299, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.055555555555559, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 13.888888888888893, 15.166666666666671, 15.138888888888893, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.841857966225865, "mean_inference_ms": 1.2191674198866385, "mean_action_processing_ms": 0.10409710472155062, "mean_env_wait_ms": 21.88819159574523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007366318987984942, "StateBufferConnector_ms": 0.004938932565542368, "ViewRequirementAgentConnector_ms": 0.10879263918623965}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.149810066476743, "episode_len_mean": 16.99145299145299, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.055555555555559, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 13.888888888888893, 15.166666666666671, 15.138888888888893, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.841857966225865, "mean_inference_ms": 1.2191674198866385, "mean_action_processing_ms": 0.10409710472155062, "mean_env_wait_ms": 21.88819159574523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007366318987984942, "StateBufferConnector_ms": 0.004938932565542368, "ViewRequirementAgentConnector_ms": 0.10879263918623965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.1842880300924, "num_env_steps_trained_throughput_per_sec": 39.1842880300924, "timesteps_total": 68000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 51331.984, "sample_time_ms": 48203.107, "load_time_ms": 11.047, "load_throughput": 181049.615, "learn_time_ms": 3115.262, "learn_throughput": 642.001, "synch_weights_time_ms": 2.12}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 4297, "training_iteration": 34, "trial_id": "13850_00002", "date": "2023-12-28_18-16-34", "timestamp": 1703758594, "time_this_iter_s": 51.045475244522095, "time_total_s": 1744.8120682239532, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1744.8120682239532, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 55.99444444444444, "ram_util_percent": 92.84583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7166137695312505e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.010904256086505484, "policy_loss": -0.01241854819158713, "vf_loss": 0.023322785654001765, "vf_explained_var": 0.9985684470335643, "kl": 0.011340585894785827, "entropy": 0.1003680190609561, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15525.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.888888888888893, "episode_reward_mean": 15.160310734463287, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.888888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8407208128020831, "mean_inference_ms": 1.219223394415855, "mean_action_processing_ms": 0.10410358346504302, "mean_env_wait_ms": 21.891926236173834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075821149147163, "StateBufferConnector_ms": 0.005019923387947729, "ViewRequirementAgentConnector_ms": 0.11035082703929837}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.888888888888893, "episode_reward_mean": 15.160310734463287, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.888888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8407208128020831, "mean_inference_ms": 1.219223394415855, "mean_action_processing_ms": 0.10410358346504302, "mean_env_wait_ms": 21.891926236173834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075821149147163, "StateBufferConnector_ms": 0.005019923387947729, "ViewRequirementAgentConnector_ms": 0.11035082703929837}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000, "num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.81322318974746, "num_env_steps_trained_throughput_per_sec": 38.81322318974746, "timesteps_total": 70000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 70000, "timers": {"training_iteration_time_ms": 51348.783, "sample_time_ms": 48212.055, "load_time_ms": 11.656, "load_throughput": 171588.634, "learn_time_ms": 3122.474, "learn_throughput": 640.518, "synch_weights_time_ms": 2.156}, "counters": {"num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled": 70000, "num_agent_steps_trained": 70000}, "done": false, "episodes_total": 4415, "training_iteration": 35, "trial_id": "13850_00002", "date": "2023-12-28_18-17-26", "timestamp": 1703758646, "time_this_iter_s": 51.53417468070984, "time_total_s": 1796.346242904663, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1796.346242904663, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 56.33513513513514, "ram_util_percent": 92.71081081081081}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7166137695312505e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.042453852338081154, "policy_loss": 0.014015430209951269, "vf_loss": 0.028438418035705883, "vf_explained_var": 0.9982832992076873, "kl": 0.0027803331937640845, "entropy": 0.11154446547230085, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 15975.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.694444444444448, "episode_reward_mean": 15.145480225988708, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.138888888888893, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.138888888888893, 14.694444444444448, 15.166666666666671, 15.055555555555559, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.111111111111114, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.027777777777782, 15.138888888888893, 15.138888888888893, 15.222222222222227, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.138888888888893, 14.694444444444448, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.194444444444448, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.138888888888893, 15.138888888888893, 15.222222222222227, 14.694444444444448, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.111111111111114, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.111111111111114, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.839747928387274, "mean_inference_ms": 1.2194839521036611, "mean_action_processing_ms": 0.10410443727951013, "mean_env_wait_ms": 21.89529454535415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075014971070370435, "StateBufferConnector_ms": 0.00500355736683991, "ViewRequirementAgentConnector_ms": 0.11109234923023288}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.694444444444448, "episode_reward_mean": 15.145480225988708, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.138888888888893, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.138888888888893, 14.694444444444448, 15.166666666666671, 15.055555555555559, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.111111111111114, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.027777777777782, 15.138888888888893, 15.138888888888893, 15.222222222222227, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.138888888888893, 14.694444444444448, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.194444444444448, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.138888888888893, 15.138888888888893, 15.222222222222227, 14.694444444444448, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.111111111111114, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.111111111111114, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.839747928387274, "mean_inference_ms": 1.2194839521036611, "mean_action_processing_ms": 0.10410443727951013, "mean_env_wait_ms": 21.89529454535415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075014971070370435, "StateBufferConnector_ms": 0.00500355736683991, "ViewRequirementAgentConnector_ms": 0.11109234923023288}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.86298393816356, "num_env_steps_trained_throughput_per_sec": 38.86298393816356, "timesteps_total": 72000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 51417.57, "sample_time_ms": 48286.535, "load_time_ms": 12.539, "load_throughput": 159498.343, "learn_time_ms": 3115.879, "learn_throughput": 641.873, "synch_weights_time_ms": 2.178}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 4533, "training_iteration": 36, "trial_id": "13850_00002", "date": "2023-12-28_18-18-17", "timestamp": 1703758697, "time_this_iter_s": 51.467657804489136, "time_total_s": 1847.8139007091522, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1847.8139007091522, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 56.179452054794524, "ram_util_percent": 92.4917808219178}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.583068847656252e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.019035663419506615, "policy_loss": -0.014307409185502265, "vf_loss": 0.03334307319588131, "vf_explained_var": 0.9981032676166959, "kl": 0.001575123829327249, "entropy": 0.09027527158459027, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 16425.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 74000, "num_env_steps_trained": 74000, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 74000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.146723646723656, "episode_len_mean": 16.99145299145299, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 14.694444444444448, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.194444444444448, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 13.888888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.138888888888893, 14.777777777777782, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8384588384909882, "mean_inference_ms": 1.2194104788166484, "mean_action_processing_ms": 0.10408651000594689, "mean_env_wait_ms": 21.892508703834846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007396885472485143, "StateBufferConnector_ms": 0.00503593020968967, "ViewRequirementAgentConnector_ms": 0.10826893341846955}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.146723646723656, "episode_len_mean": 16.99145299145299, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 14.694444444444448, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.194444444444448, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 13.888888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.138888888888893, 14.777777777777782, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8384588384909882, "mean_inference_ms": 1.2194104788166484, "mean_action_processing_ms": 0.10408651000594689, "mean_env_wait_ms": 21.892508703834846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007396885472485143, "StateBufferConnector_ms": 0.00503593020968967, "ViewRequirementAgentConnector_ms": 0.10826893341846955}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 74000, "num_env_steps_sampled": 74000, "num_env_steps_trained": 74000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.23408604156044, "num_env_steps_trained_throughput_per_sec": 39.23408604156044, "timesteps_total": 74000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 74000, "timers": {"training_iteration_time_ms": 51393.069, "sample_time_ms": 48260.131, "load_time_ms": 14.115, "load_throughput": 141694.912, "learn_time_ms": 3116.191, "learn_throughput": 641.809, "synch_weights_time_ms": 2.191}, "counters": {"num_env_steps_sampled": 74000, "num_env_steps_trained": 74000, "num_agent_steps_sampled": 74000, "num_agent_steps_trained": 74000}, "done": false, "episodes_total": 4650, "training_iteration": 37, "trial_id": "13850_00002", "date": "2023-12-28_18-19-08", "timestamp": 1703758748, "time_this_iter_s": 50.980833292007446, "time_total_s": 1898.7947340011597, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1898.7947340011597, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 55.98219178082192, "ram_util_percent": 92.43972602739724}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.291534423828126e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.02140471682482813, "policy_loss": 0.002409714034034146, "vf_loss": 0.018995002400543956, "vf_explained_var": 0.9988288848929935, "kl": 0.00025005667128601415, "entropy": 0.0946342299381892, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 16875.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 15.083333333333337, "episode_reward_mean": 15.164783427495301, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8373686979354079, "mean_inference_ms": 1.2191187100834526, "mean_action_processing_ms": 0.10408554087688908, "mean_env_wait_ms": 21.889715567634088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007410978866835772, "StateBufferConnector_ms": 0.0049298092470330705, "ViewRequirementAgentConnector_ms": 0.1086936158648992}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 15.083333333333337, "episode_reward_mean": 15.164783427495301, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8373686979354079, "mean_inference_ms": 1.2191187100834526, "mean_action_processing_ms": 0.10408554087688908, "mean_env_wait_ms": 21.889715567634088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007410978866835772, "StateBufferConnector_ms": 0.0049298092470330705, "ViewRequirementAgentConnector_ms": 0.1086936158648992}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.248116548613396, "num_env_steps_trained_throughput_per_sec": 39.248116548613396, "timesteps_total": 76000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 51329.075, "sample_time_ms": 48192.864, "load_time_ms": 12.882, "load_throughput": 155259.775, "learn_time_ms": 3120.689, "learn_throughput": 640.884, "synch_weights_time_ms": 2.199}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 4768, "training_iteration": 38, "trial_id": "13850_00002", "date": "2023-12-28_18-19-59", "timestamp": 1703758799, "time_this_iter_s": 50.962894916534424, "time_total_s": 1949.757628917694, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1949.757628917694, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 55.89861111111111, "ram_util_percent": 92.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.145767211914063e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03902708489292612, "policy_loss": 0.010052347588870261, "vf_loss": 0.0289747381168935, "vf_explained_var": 0.9983525976869795, "kl": 0.0014047047344520535, "entropy": 0.0833207909266154, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 17325.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 78000, "num_env_steps_trained": 78000, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 78000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.694444444444448, "episode_reward_mean": 15.144774011299445, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.138888888888893, 14.750000000000004, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.083333333333337, 14.694444444444448, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.138888888888893, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 14.777777777777782, 14.694444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 14.722222222222227, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8368963700141894, "mean_inference_ms": 1.2196757191549588, "mean_action_processing_ms": 0.10413417213887818, "mean_env_wait_ms": 21.898540719542943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007503113504183494, "StateBufferConnector_ms": 0.005067607103768042, "ViewRequirementAgentConnector_ms": 0.11164798574932551}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.694444444444448, "episode_reward_mean": 15.144774011299445, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.138888888888893, 14.750000000000004, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.083333333333337, 14.694444444444448, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.138888888888893, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 14.777777777777782, 14.694444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 14.722222222222227, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8368963700141894, "mean_inference_ms": 1.2196757191549588, "mean_action_processing_ms": 0.10413417213887818, "mean_env_wait_ms": 21.898540719542943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007503113504183494, "StateBufferConnector_ms": 0.005067607103768042, "ViewRequirementAgentConnector_ms": 0.11164798574932551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 78000, "num_env_steps_sampled": 78000, "num_env_steps_trained": 78000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.46724954021602, "num_env_steps_trained_throughput_per_sec": 38.46724954021602, "timesteps_total": 78000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 78000, "timers": {"training_iteration_time_ms": 51450.604, "sample_time_ms": 48312.472, "load_time_ms": 11.594, "load_throughput": 172499.686, "learn_time_ms": 3123.89, "learn_throughput": 640.227, "synch_weights_time_ms": 2.208}, "counters": {"num_env_steps_sampled": 78000, "num_env_steps_trained": 78000, "num_agent_steps_sampled": 78000, "num_agent_steps_trained": 78000}, "done": false, "episodes_total": 4886, "training_iteration": 39, "trial_id": "13850_00002", "date": "2023-12-28_18-20-51", "timestamp": 1703758851, "time_this_iter_s": 51.99713325500488, "time_total_s": 2001.754762172699, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2001.754762172699, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 56.039189189189194, "ram_util_percent": 92.41486486486485}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0728836059570315e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.02206958882096741, "policy_loss": -0.0014625789845983186, "vf_loss": 0.023532165636618932, "vf_explained_var": 0.9986439373758104, "kl": 0.0007289621299065155, "entropy": 0.06608462705380387, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 17775.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.694444444444448, "episode_reward_mean": 15.155508072174747, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 14.722222222222227, 15.138888888888893, 14.694444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8358267494694035, "mean_inference_ms": 1.2194225173332038, "mean_action_processing_ms": 0.10409775788294583, "mean_env_wait_ms": 21.893504434784575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007499792636969151, "StateBufferConnector_ms": 0.004960940434382512, "ViewRequirementAgentConnector_ms": 0.1088058846628564}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.694444444444448, "episode_reward_mean": 15.155508072174747, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 14.722222222222227, 15.138888888888893, 14.694444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8358267494694035, "mean_inference_ms": 1.2194225173332038, "mean_action_processing_ms": 0.10409775788294583, "mean_env_wait_ms": 21.893504434784575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007499792636969151, "StateBufferConnector_ms": 0.004960940434382512, "ViewRequirementAgentConnector_ms": 0.1088058846628564}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.38807426824065, "num_env_steps_trained_throughput_per_sec": 39.38807426824065, "timesteps_total": 80000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 51338.14, "sample_time_ms": 48199.584, "load_time_ms": 12.001, "load_throughput": 166659.541, "learn_time_ms": 3123.922, "learn_throughput": 640.221, "synch_weights_time_ms": 2.196}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 5003, "training_iteration": 40, "trial_id": "13850_00002", "date": "2023-12-28_18-21-42", "timestamp": 1703758902, "time_this_iter_s": 50.78181982040405, "time_total_s": 2052.536581993103, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2052.536581993103, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 55.9375, "ram_util_percent": 92.40138888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.364418029785158e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.011968340902692743, "policy_loss": -0.003428391781118181, "vf_loss": 0.015396731406864192, "vf_explained_var": 0.9990551157792409, "kl": 0.0001999555506469935, "entropy": 0.06168107088241312, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 18225.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 82000, "num_env_steps_trained": 82000, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 82000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 15.083333333333337, "episode_reward_mean": 15.169491525423739, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8351011634799033, "mean_inference_ms": 1.2194039253177829, "mean_action_processing_ms": 0.10411372509056882, "mean_env_wait_ms": 21.89694643762045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007388551356428761, "StateBufferConnector_ms": 0.004968198679261289, "ViewRequirementAgentConnector_ms": 0.10952464604781846}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 15.083333333333337, "episode_reward_mean": 15.169491525423739, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8351011634799033, "mean_inference_ms": 1.2194039253177829, "mean_action_processing_ms": 0.10411372509056882, "mean_env_wait_ms": 21.89694643762045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007388551356428761, "StateBufferConnector_ms": 0.004968198679261289, "ViewRequirementAgentConnector_ms": 0.10952464604781846}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 82000, "num_env_steps_sampled": 82000, "num_env_steps_trained": 82000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.836399146357444, "num_env_steps_trained_throughput_per_sec": 38.836399146357444, "timesteps_total": 82000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 82000, "timers": {"training_iteration_time_ms": 51279.394, "sample_time_ms": 48140.751, "load_time_ms": 10.731, "load_throughput": 186376.236, "learn_time_ms": 3125.275, "learn_throughput": 639.944, "synch_weights_time_ms": 2.207}, "counters": {"num_env_steps_sampled": 82000, "num_env_steps_trained": 82000, "num_agent_steps_sampled": 82000, "num_agent_steps_trained": 82000}, "done": false, "episodes_total": 5121, "training_iteration": 41, "trial_id": "13850_00002", "date": "2023-12-28_18-22-34", "timestamp": 1703758954, "time_this_iter_s": 51.504448890686035, "time_total_s": 2104.041030883789, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2104.041030883789, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 55.96216216216217, "ram_util_percent": 92.22162162162162}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.682209014892579e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.011045567389681108, "policy_loss": -0.005169092280169328, "vf_loss": 0.016214661068386503, "vf_explained_var": 0.99901876144939, "kl": 0.0008263310991884029, "entropy": 0.04871991041633818, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 18675.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.916666666666671, "episode_reward_mean": 15.163370998116768, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.916666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8343815841844651, "mean_inference_ms": 1.2194677369412732, "mean_action_processing_ms": 0.10410727302928292, "mean_env_wait_ms": 21.89718169985275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007573426780054125, "StateBufferConnector_ms": 0.005156508946822861, "ViewRequirementAgentConnector_ms": 0.11003381114895061}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.916666666666671, "episode_reward_mean": 15.163370998116768, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.916666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8343815841844651, "mean_inference_ms": 1.2194677369412732, "mean_action_processing_ms": 0.10410727302928292, "mean_env_wait_ms": 21.89718169985275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007573426780054125, "StateBufferConnector_ms": 0.005156508946822861, "ViewRequirementAgentConnector_ms": 0.11003381114895061}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.01953671909986, "num_env_steps_trained_throughput_per_sec": 39.01953671909986, "timesteps_total": 84000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 51286.754, "sample_time_ms": 48147.659, "load_time_ms": 10.463, "load_throughput": 191148.036, "learn_time_ms": 3126.006, "learn_throughput": 639.794, "synch_weights_time_ms": 2.195}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 5239, "training_iteration": 42, "trial_id": "13850_00002", "date": "2023-12-28_18-23-25", "timestamp": 1703759005, "time_this_iter_s": 51.26122760772705, "time_total_s": 2155.302258491516, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2155.302258491516, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 55.91917808219178, "ram_util_percent": 92.28356164383561}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3411045074462894e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.004076269885732068, "policy_loss": -0.015923931743535732, "vf_loss": 0.020000202395021916, "vf_explained_var": 0.9988333116637336, "kl": 0.0003521871238950336, "entropy": 0.05559196922514174, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19125.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 86000, "num_env_steps_trained": 86000, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 86000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 15.027777777777782, "episode_reward_mean": 15.166429249762594, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8335595513439166, "mean_inference_ms": 1.219445090727967, "mean_action_processing_ms": 0.10411440858319644, "mean_env_wait_ms": 21.89707714181101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076004582592564774, "StateBufferConnector_ms": 0.0050703684488932295, "ViewRequirementAgentConnector_ms": 0.1105092529557709}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 15.027777777777782, "episode_reward_mean": 15.166429249762594, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.027777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8335595513439166, "mean_inference_ms": 1.219445090727967, "mean_action_processing_ms": 0.10411440858319644, "mean_env_wait_ms": 21.89707714181101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076004582592564774, "StateBufferConnector_ms": 0.0050703684488932295, "ViewRequirementAgentConnector_ms": 0.1105092529557709}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 86000, "num_env_steps_sampled": 86000, "num_env_steps_trained": 86000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.05380858373551, "num_env_steps_trained_throughput_per_sec": 39.05380858373551, "timesteps_total": 86000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 86000, "timers": {"training_iteration_time_ms": 51270.113, "sample_time_ms": 48131.561, "load_time_ms": 9.922, "load_throughput": 201563.954, "learn_time_ms": 3125.951, "learn_throughput": 639.805, "synch_weights_time_ms": 2.25}, "counters": {"num_env_steps_sampled": 86000, "num_env_steps_trained": 86000, "num_agent_steps_sampled": 86000, "num_agent_steps_trained": 86000}, "done": false, "episodes_total": 5356, "training_iteration": 43, "trial_id": "13850_00002", "date": "2023-12-28_18-24-16", "timestamp": 1703759056, "time_this_iter_s": 51.21861290931702, "time_total_s": 2206.520871400833, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2206.520871400833, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 55.73972602739726, "ram_util_percent": 92.31095890410957}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.705522537231447e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.006132654008559055, "policy_loss": -0.006668615235636632, "vf_loss": 0.012801269236952066, "vf_explained_var": 0.9992169404029846, "kl": 0.0005720622288955547, "entropy": 0.04048038848572307, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 19575.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 15.083333333333337, "episode_reward_mean": 15.16454802259888, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8327655362220799, "mean_inference_ms": 1.2192978530963383, "mean_action_processing_ms": 0.1040940376790041, "mean_env_wait_ms": 21.893165529880314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007380671420339811, "StateBufferConnector_ms": 0.004952034707796775, "ViewRequirementAgentConnector_ms": 0.10979337207341598}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 15.083333333333337, "episode_reward_mean": 15.16454802259888, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8327655362220799, "mean_inference_ms": 1.2192978530963383, "mean_action_processing_ms": 0.1040940376790041, "mean_env_wait_ms": 21.893165529880314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007380671420339811, "StateBufferConnector_ms": 0.004952034707796775, "ViewRequirementAgentConnector_ms": 0.10979337207341598}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.34137481911103, "num_env_steps_trained_throughput_per_sec": 39.34137481911103, "timesteps_total": 88000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 51249.738, "sample_time_ms": 48114.235, "load_time_ms": 10.385, "load_throughput": 192594.069, "learn_time_ms": 3122.454, "learn_throughput": 640.522, "synch_weights_time_ms": 2.236}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 5474, "training_iteration": 44, "trial_id": "13850_00002", "date": "2023-12-28_18-25-07", "timestamp": 1703759107, "time_this_iter_s": 50.848150968551636, "time_total_s": 2257.3690223693848, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2257.3690223693848, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 56.19583333333333, "ram_util_percent": 92.36805555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3527612686157236e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.00021938380579942734, "policy_loss": -0.01080299413866467, "vf_loss": 0.010583611132784023, "vf_explained_var": 0.9993575286865234, "kl": 0.013386649774939436, "entropy": 0.083647814715902, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20025.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 15.138888888888893, "episode_reward_mean": 15.165018832391725, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8320867034472659, "mean_inference_ms": 1.2190929194389235, "mean_action_processing_ms": 0.10409045328827803, "mean_env_wait_ms": 21.89291548850005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007384712413205939, "StateBufferConnector_ms": 0.0049469834667141156, "ViewRequirementAgentConnector_ms": 0.10911771806619935}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 15.138888888888893, "episode_reward_mean": 15.165018832391725, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8320867034472659, "mean_inference_ms": 1.2190929194389235, "mean_action_processing_ms": 0.10409045328827803, "mean_env_wait_ms": 21.89291548850005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007384712413205939, "StateBufferConnector_ms": 0.0049469834667141156, "ViewRequirementAgentConnector_ms": 0.10911771806619935}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.09179728157599, "num_env_steps_trained_throughput_per_sec": 39.09179728157599, "timesteps_total": 90000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 51213.017, "sample_time_ms": 48084.596, "load_time_ms": 10.273, "load_throughput": 194677.8, "learn_time_ms": 3115.511, "learn_throughput": 641.949, "synch_weights_time_ms": 2.207}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "episodes_total": 5592, "training_iteration": 45, "trial_id": "13850_00002", "date": "2023-12-28_18-25-58", "timestamp": 1703759158, "time_this_iter_s": 51.16725158691406, "time_total_s": 2308.536273956299, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2308.536273956299, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 55.97123287671233, "ram_util_percent": 92.32876712328766}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3527612686157236e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09342500826136933, "policy_loss": 0.005463487957086828, "vf_loss": 0.08796152028772566, "vf_explained_var": 0.9952952370378706, "kl": 0.005116654951439774, "entropy": 0.10790301834543546, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20475.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.075498575498578, "episode_len_mean": 16.965811965811966, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.138888888888893, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 13.944444444444448, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.222222222222227, 14.777777777777782, 14.722222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 13.888888888888893, 15.111111111111114, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 14.722222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 13.888888888888893, 15.222222222222227, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.138888888888893, 14.833333333333337, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.722222222222227, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.722222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.722222222222227, 13.888888888888893, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 14.833333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.027777777777782, 15.083333333333337, 15.222222222222227, 14.833333333333337, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8312797322483011, "mean_inference_ms": 1.2187565258394866, "mean_action_processing_ms": 0.10406272444854248, "mean_env_wait_ms": 21.887167906149845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007507128593249199, "StateBufferConnector_ms": 0.005016775212736212, "ViewRequirementAgentConnector_ms": 0.10901271787464109}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.075498575498578, "episode_len_mean": 16.965811965811966, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.138888888888893, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 13.944444444444448, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.222222222222227, 14.777777777777782, 14.722222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 13.888888888888893, 15.111111111111114, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 14.722222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 13.888888888888893, 15.222222222222227, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.138888888888893, 14.833333333333337, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.722222222222227, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.722222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.722222222222227, 13.888888888888893, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 14.833333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.027777777777782, 15.083333333333337, 15.222222222222227, 14.833333333333337, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8312797322483011, "mean_inference_ms": 1.2187565258394866, "mean_action_processing_ms": 0.10406272444854248, "mean_env_wait_ms": 21.887167906149845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007507128593249199, "StateBufferConnector_ms": 0.005016775212736212, "ViewRequirementAgentConnector_ms": 0.10901271787464109}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.50682925044681, "num_env_steps_trained_throughput_per_sec": 39.50682925044681, "timesteps_total": 92000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 51129.148, "sample_time_ms": 48000.263, "load_time_ms": 9.684, "load_throughput": 206532.534, "learn_time_ms": 3116.556, "learn_throughput": 641.734, "synch_weights_time_ms": 2.214}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 5709, "training_iteration": 46, "trial_id": "13850_00002", "date": "2023-12-28_18-26-49", "timestamp": 1703759209, "time_this_iter_s": 50.629244327545166, "time_total_s": 2359.165518283844, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2359.165518283844, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 55.84027777777778, "ram_util_percent": 92.32499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3527612686157236e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0641443316390117, "policy_loss": 0.0050263862063487375, "vf_loss": 0.059117945989386904, "vf_explained_var": 0.9968864497873519, "kl": 0.002285631736422312, "entropy": 0.0837405814561579, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 94000, "num_env_steps_trained": 94000, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 94000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.122881355932211, "episode_len_mean": 16.97457627118644, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.222222222222227, 13.888888888888893, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 14.750000000000004, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 13.888888888888893, 14.722222222222227, 15.166666666666671, 15.222222222222227, 13.888888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8303887998726396, "mean_inference_ms": 1.2183625312996968, "mean_action_processing_ms": 0.10402742263450306, "mean_env_wait_ms": 21.883044511355926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007359658257435944, "StateBufferConnector_ms": 0.005016286494368214, "ViewRequirementAgentConnector_ms": 0.10852126751915883}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.122881355932211, "episode_len_mean": 16.97457627118644, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.222222222222227, 13.888888888888893, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 14.750000000000004, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 13.888888888888893, 14.722222222222227, 15.166666666666671, 15.222222222222227, 13.888888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8303887998726396, "mean_inference_ms": 1.2183625312996968, "mean_action_processing_ms": 0.10402742263450306, "mean_env_wait_ms": 21.883044511355926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007359658257435944, "StateBufferConnector_ms": 0.005016286494368214, "ViewRequirementAgentConnector_ms": 0.10852126751915883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 94000, "num_env_steps_sampled": 94000, "num_env_steps_trained": 94000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.45350805743986, "num_env_steps_trained_throughput_per_sec": 39.45350805743986, "timesteps_total": 94000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 94000, "timers": {"training_iteration_time_ms": 51100.797, "sample_time_ms": 47976.433, "load_time_ms": 8.115, "load_throughput": 246458.459, "learn_time_ms": 3113.632, "learn_throughput": 642.337, "synch_weights_time_ms": 2.187}, "counters": {"num_env_steps_sampled": 94000, "num_env_steps_trained": 94000, "num_agent_steps_sampled": 94000, "num_agent_steps_trained": 94000}, "done": false, "episodes_total": 5827, "training_iteration": 47, "trial_id": "13850_00002", "date": "2023-12-28_18-27-39", "timestamp": 1703759259, "time_this_iter_s": 50.69750094413757, "time_total_s": 2409.8630192279816, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2409.8630192279816, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 56.233333333333334, "ram_util_percent": 92.34444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6763806343078618e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03249412537448936, "policy_loss": 0.0032367816526028847, "vf_loss": 0.029257343500438664, "vf_explained_var": 0.9984183829360538, "kl": 0.0010317960830562199, "entropy": 0.07137725486523576, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 21375.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.147128060263663, "episode_len_mean": 16.991525423728813, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 13.888888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.083333333333337, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8294746898884333, "mean_inference_ms": 1.2179942587062926, "mean_action_processing_ms": 0.10399046001930429, "mean_env_wait_ms": 21.874608929555293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00743643712189238, "StateBufferConnector_ms": 0.004905967389122914, "ViewRequirementAgentConnector_ms": 0.10783510693049027}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.147128060263663, "episode_len_mean": 16.991525423728813, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 13.888888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.083333333333337, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8294746898884333, "mean_inference_ms": 1.2179942587062926, "mean_action_processing_ms": 0.10399046001930429, "mean_env_wait_ms": 21.874608929555293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00743643712189238, "StateBufferConnector_ms": 0.004905967389122914, "ViewRequirementAgentConnector_ms": 0.10783510693049027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.687364768825724, "num_env_steps_trained_throughput_per_sec": 39.687364768825724, "timesteps_total": 96000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 51044.398, "sample_time_ms": 47910.883, "load_time_ms": 9.616, "load_throughput": 207981.157, "learn_time_ms": 3121.28, "learn_throughput": 640.763, "synch_weights_time_ms": 2.188}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 5945, "training_iteration": 48, "trial_id": "13850_00002", "date": "2023-12-28_18-28-30", "timestamp": 1703759310, "time_this_iter_s": 50.39916968345642, "time_total_s": 2460.262188911438, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2460.262188911438, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 55.87083333333333, "ram_util_percent": 92.37083333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.381903171539309e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.013359809931781557, "policy_loss": -0.0012459860866268475, "vf_loss": 0.014605793253415161, "vf_explained_var": 0.999129814306895, "kl": 0.0011238880888424403, "entropy": 0.05220019360383352, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 21825.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 98000, "num_env_steps_trained": 98000, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 98000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.166902071563097, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8291702348552603, "mean_inference_ms": 1.2185770928062358, "mean_action_processing_ms": 0.10402441922490051, "mean_env_wait_ms": 21.882693872961607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007472199908757614, "StateBufferConnector_ms": 0.005037905806202, "ViewRequirementAgentConnector_ms": 0.11264227204403635}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.166902071563097, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8291702348552603, "mean_inference_ms": 1.2185770928062358, "mean_action_processing_ms": 0.10402441922490051, "mean_env_wait_ms": 21.882693872961607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007472199908757614, "StateBufferConnector_ms": 0.005037905806202, "ViewRequirementAgentConnector_ms": 0.11264227204403635}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 98000, "num_env_steps_sampled": 98000, "num_env_steps_trained": 98000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.434558788697956, "num_env_steps_trained_throughput_per_sec": 38.434558788697956, "timesteps_total": 98000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 98000, "timers": {"training_iteration_time_ms": 51048.82, "sample_time_ms": 47918.409, "load_time_ms": 9.944, "load_throughput": 201127.556, "learn_time_ms": 3117.855, "learn_throughput": 641.467, "synch_weights_time_ms": 2.177}, "counters": {"num_env_steps_sampled": 98000, "num_env_steps_trained": 98000, "num_agent_steps_sampled": 98000, "num_agent_steps_trained": 98000}, "done": false, "episodes_total": 6063, "training_iteration": 49, "trial_id": "13850_00002", "date": "2023-12-28_18-29-22", "timestamp": 1703759362, "time_this_iter_s": 52.04167866706848, "time_total_s": 2512.3038675785065, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2512.3038675785065, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 55.87567567567568, "ram_util_percent": 92.40540540540538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.1909515857696545e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.01706656115750472, "policy_loss": -0.006076725547512372, "vf_loss": 0.02314328552120262, "vf_explained_var": 0.9987349073092143, "kl": 0.0005372629036030416, "entropy": 0.04209143868750996, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 22275.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.149335232668577, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8284786822999693, "mean_inference_ms": 1.2183506867095024, "mean_action_processing_ms": 0.10401399787347954, "mean_env_wait_ms": 21.87983672693561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007348386650411491, "StateBufferConnector_ms": 0.004950344053089109, "ViewRequirementAgentConnector_ms": 0.1086477540497087}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.149335232668577, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8284786822999693, "mean_inference_ms": 1.2183506867095024, "mean_action_processing_ms": 0.10401399787347954, "mean_env_wait_ms": 21.87983672693561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007348386650411491, "StateBufferConnector_ms": 0.004950344053089109, "ViewRequirementAgentConnector_ms": 0.1086477540497087}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.33350815813627, "num_env_steps_trained_throughput_per_sec": 39.33350815813627, "timesteps_total": 100000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 51055.864, "sample_time_ms": 47926.975, "load_time_ms": 10.204, "load_throughput": 195995.056, "learn_time_ms": 3116.035, "learn_throughput": 641.841, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 6180, "training_iteration": 50, "trial_id": "13850_00002", "date": "2023-12-28_18-30-13", "timestamp": 1703759413, "time_this_iter_s": 50.85206627845764, "time_total_s": 2563.155933856964, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2563.155933856964, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 55.900000000000006, "ram_util_percent": 92.40416666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0954757928848272e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.006584870302031049, "policy_loss": -0.0038562536425888537, "vf_loss": 0.010441125011485483, "vf_explained_var": 0.9993828153610229, "kl": 0.005533694933664177, "entropy": 0.0644816778600216, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 22725.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 102000, "num_env_steps_trained": 102000, "num_agent_steps_sampled": 102000, "num_agent_steps_trained": 102000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 15.166666666666671, "episode_reward_mean": 15.172316384180803, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8277917702751229, "mean_inference_ms": 1.2180021728455195, "mean_action_processing_ms": 0.10398444675375212, "mean_env_wait_ms": 21.87634228250574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007438053519038831, "StateBufferConnector_ms": 0.0050318443169028075, "ViewRequirementAgentConnector_ms": 0.10857622502213818}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 15.166666666666671, "episode_reward_mean": 15.172316384180803, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8277917702751229, "mean_inference_ms": 1.2180021728455195, "mean_action_processing_ms": 0.10398444675375212, "mean_env_wait_ms": 21.87634228250574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007438053519038831, "StateBufferConnector_ms": 0.0050318443169028075, "ViewRequirementAgentConnector_ms": 0.10857622502213818}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102000, "num_agent_steps_trained": 102000, "num_env_steps_sampled": 102000, "num_env_steps_trained": 102000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.3740108073075, "num_env_steps_trained_throughput_per_sec": 39.3740108073075, "timesteps_total": 102000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 102000, "timers": {"training_iteration_time_ms": 50985.549, "sample_time_ms": 47853.66, "load_time_ms": 11.266, "load_throughput": 177521.649, "learn_time_ms": 3117.985, "learn_throughput": 641.44, "synch_weights_time_ms": 2.188}, "counters": {"num_env_steps_sampled": 102000, "num_env_steps_trained": 102000, "num_agent_steps_sampled": 102000, "num_agent_steps_trained": 102000}, "done": false, "episodes_total": 6298, "training_iteration": 51, "trial_id": "13850_00002", "date": "2023-12-28_18-31-04", "timestamp": 1703759464, "time_this_iter_s": 50.7996609210968, "time_total_s": 2613.955594778061, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2613.955594778061, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 55.76027397260274, "ram_util_percent": 92.37397260273971}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0954757928848272e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04798239333762063, "policy_loss": -0.008780249721474117, "vf_loss": 0.056762643955234025, "vf_explained_var": 0.9969557423061794, "kl": 0.002863484684008957, "entropy": 0.0966326358086533, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 23175.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.10899246704332, "episode_len_mean": 16.97457627118644, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.722222222222227, 15.194444444444448, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.194444444444448, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.027777777777782, 15.166666666666671, 13.944444444444448, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.833333333333337, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.027777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.833333333333337, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 14.722222222222227, 15.166666666666671, 15.166666666666671, 13.888888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.722222222222227, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.083333333333337, 13.944444444444448, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.222222222222227, 14.722222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8275426168503486, "mean_inference_ms": 1.2183491745205657, "mean_action_processing_ms": 0.10401509296224566, "mean_env_wait_ms": 21.882668835462457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007669400360624669, "StateBufferConnector_ms": 0.005327644994703389, "ViewRequirementAgentConnector_ms": 0.11107739755662821}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.10899246704332, "episode_len_mean": 16.97457627118644, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.722222222222227, 15.194444444444448, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.194444444444448, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.027777777777782, 15.166666666666671, 13.944444444444448, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.833333333333337, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.027777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.833333333333337, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 14.722222222222227, 15.166666666666671, 15.166666666666671, 13.888888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.722222222222227, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.083333333333337, 13.944444444444448, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.222222222222227, 14.722222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8275426168503486, "mean_inference_ms": 1.2183491745205657, "mean_action_processing_ms": 0.10401509296224566, "mean_env_wait_ms": 21.882668835462457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007669400360624669, "StateBufferConnector_ms": 0.005327644994703389, "ViewRequirementAgentConnector_ms": 0.11107739755662821}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.50564916985028, "num_env_steps_trained_throughput_per_sec": 38.50564916985028, "timesteps_total": 104000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 51053.948, "sample_time_ms": 47918.699, "load_time_ms": 10.69, "load_throughput": 187082.435, "learn_time_ms": 3121.836, "learn_throughput": 640.649, "synch_weights_time_ms": 2.259}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 6416, "training_iteration": 52, "trial_id": "13850_00002", "date": "2023-12-28_18-31-56", "timestamp": 1703759516, "time_this_iter_s": 51.94603681564331, "time_total_s": 2665.901631593704, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2665.901631593704, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 55.99324324324324, "ram_util_percent": 92.47702702702702}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0477378964424136e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.012886916862593757, "policy_loss": -0.01787765011191368, "vf_loss": 0.030764567373941343, "vf_explained_var": 0.9982543138662974, "kl": 0.002012979462809034, "entropy": 0.07727689996361732, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 106000, "num_env_steps_trained": 106000, "num_agent_steps_sampled": 106000, "num_agent_steps_trained": 106000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.944444444444448, "episode_reward_mean": 15.141500474833816, "episode_len_mean": 16.99145299145299, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 13.944444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.833333333333337, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.083333333333337, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.222222222222227, 14.694444444444448, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.694444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.166666666666671, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8268576296044666, "mean_inference_ms": 1.218161046869909, "mean_action_processing_ms": 0.10399657331942733, "mean_env_wait_ms": 21.879399086279463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073347336206680686, "StateBufferConnector_ms": 0.004916720920138889, "ViewRequirementAgentConnector_ms": 0.10898724580422425}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.944444444444448, "episode_reward_mean": 15.141500474833816, "episode_len_mean": 16.99145299145299, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 13.944444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.833333333333337, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.083333333333337, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.222222222222227, 14.694444444444448, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.694444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.166666666666671, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.972222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8268576296044666, "mean_inference_ms": 1.218161046869909, "mean_action_processing_ms": 0.10399657331942733, "mean_env_wait_ms": 21.879399086279463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073347336206680686, "StateBufferConnector_ms": 0.004916720920138889, "ViewRequirementAgentConnector_ms": 0.10898724580422425}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106000, "num_agent_steps_trained": 106000, "num_env_steps_sampled": 106000, "num_env_steps_trained": 106000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.3850539989675, "num_env_steps_trained_throughput_per_sec": 39.3850539989675, "timesteps_total": 106000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 106000, "timers": {"training_iteration_time_ms": 51010.877, "sample_time_ms": 47878.156, "load_time_ms": 12.238, "load_throughput": 163421.233, "learn_time_ms": 3117.819, "learn_throughput": 641.474, "synch_weights_time_ms": 2.209}, "counters": {"num_env_steps_sampled": 106000, "num_env_steps_trained": 106000, "num_agent_steps_sampled": 106000, "num_agent_steps_trained": 106000}, "done": false, "episodes_total": 6533, "training_iteration": 53, "trial_id": "13850_00002", "date": "2023-12-28_18-32-46", "timestamp": 1703759566, "time_this_iter_s": 50.7856228351593, "time_total_s": 2716.6872544288635, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2716.6872544288635, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 56.06944444444444, "ram_util_percent": 92.44027777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.238689482212068e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.04130229186680582, "policy_loss": -0.0558088194910023, "vf_loss": 0.014506526900869277, "vf_explained_var": 0.9991175173388587, "kl": 0.0010364685273346543, "entropy": 0.06052383925351831, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24075.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.833333333333337, "episode_reward_mean": 15.152071563088521, "episode_len_mean": 16.991525423728813, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.083333333333337, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 14.750000000000004, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.138888888888893, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 13.833333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8263314986990333, "mean_inference_ms": 1.2180638910879686, "mean_action_processing_ms": 0.10399256552494557, "mean_env_wait_ms": 21.87677377277006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007657883530956203, "StateBufferConnector_ms": 0.005051241082660222, "ViewRequirementAgentConnector_ms": 0.1104839777542373}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.833333333333337, "episode_reward_mean": 15.152071563088521, "episode_len_mean": 16.991525423728813, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.083333333333337, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 14.750000000000004, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.138888888888893, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 13.833333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8263314986990333, "mean_inference_ms": 1.2180638910879686, "mean_action_processing_ms": 0.10399256552494557, "mean_env_wait_ms": 21.87677377277006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007657883530956203, "StateBufferConnector_ms": 0.005051241082660222, "ViewRequirementAgentConnector_ms": 0.1104839777542373}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.31590576679181, "num_env_steps_trained_throughput_per_sec": 39.31590576679181, "timesteps_total": 108000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 51014.171, "sample_time_ms": 47880.677, "load_time_ms": 11.78, "load_throughput": 169778.604, "learn_time_ms": 3119.033, "learn_throughput": 641.224, "synch_weights_time_ms": 2.222}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 6651, "training_iteration": 54, "trial_id": "13850_00002", "date": "2023-12-28_18-33-37", "timestamp": 1703759617, "time_this_iter_s": 50.87518572807312, "time_total_s": 2767.5624401569366, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2767.5624401569366, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 55.65972222222222, "ram_util_percent": 92.43333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.619344741106034e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.00441938161643015, "policy_loss": -0.007372637867099709, "vf_loss": 0.01179201838043001, "vf_explained_var": 0.9992852397759755, "kl": 0.00977272710923574, "entropy": 0.10497277667952909, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24525.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_agent_steps_sampled": 110000, "num_agent_steps_trained": 110000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.165960451977412, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8256218023542317, "mean_inference_ms": 1.2177401573605693, "mean_action_processing_ms": 0.1039706423402243, "mean_env_wait_ms": 21.87010334868441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007318036030914824, "StateBufferConnector_ms": 0.0049423363249180684, "ViewRequirementAgentConnector_ms": 0.108157376111564}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.165960451977412, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8256218023542317, "mean_inference_ms": 1.2177401573605693, "mean_action_processing_ms": 0.1039706423402243, "mean_env_wait_ms": 21.87010334868441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007318036030914824, "StateBufferConnector_ms": 0.0049423363249180684, "ViewRequirementAgentConnector_ms": 0.108157376111564}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110000, "num_agent_steps_trained": 110000, "num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.70536081167362, "num_env_steps_trained_throughput_per_sec": 39.70536081167362, "timesteps_total": 110000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 110000, "timers": {"training_iteration_time_ms": 50935.111, "sample_time_ms": 47801.092, "load_time_ms": 12.827, "load_throughput": 155921.502, "learn_time_ms": 3118.499, "learn_throughput": 641.334, "synch_weights_time_ms": 2.234}, "counters": {"num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_agent_steps_sampled": 110000, "num_agent_steps_trained": 110000}, "done": false, "episodes_total": 6769, "training_iteration": 55, "trial_id": "13850_00002", "date": "2023-12-28_18-34-28", "timestamp": 1703759668, "time_this_iter_s": 50.37592840194702, "time_total_s": 2817.9383685588837, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2817.9383685588837, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 55.93333333333333, "ram_util_percent": 92.32916666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.619344741106034e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.017978521208796235, "policy_loss": -0.0006468390218085713, "vf_loss": 0.01862536209842397, "vf_explained_var": 0.9990130947695838, "kl": 0.0015849257891980843, "entropy": 0.13585973800884352, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 24975.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.694444444444448, "episode_reward_mean": 15.152896486229826, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.16666666666667, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.194444444444448, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.222222222222227, 15.083333333333337, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.194444444444448, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.111111111111114, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.138888888888893, 15.222222222222227, 15.194444444444448, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.138888888888893, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.694444444444448, 15.138888888888893, 14.694444444444448, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.222222222222227, 14.694444444444448, 15.138888888888893, 15.166666666666671, 14.972222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8250728045059866, "mean_inference_ms": 1.2176379388066767, "mean_action_processing_ms": 0.10396255116261714, "mean_env_wait_ms": 21.868785902142122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007357149042634882, "StateBufferConnector_ms": 0.005021054520566239, "ViewRequirementAgentConnector_ms": 0.1081193614209819}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.694444444444448, "episode_reward_mean": 15.152896486229826, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.16666666666667, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.194444444444448, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.222222222222227, 15.083333333333337, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.194444444444448, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.111111111111114, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.138888888888893, 15.222222222222227, 15.194444444444448, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.138888888888893, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.694444444444448, 15.138888888888893, 14.694444444444448, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.222222222222227, 14.694444444444448, 15.138888888888893, 15.166666666666671, 14.972222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8250728045059866, "mean_inference_ms": 1.2176379388066767, "mean_action_processing_ms": 0.10396255116261714, "mean_env_wait_ms": 21.868785902142122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007357149042634882, "StateBufferConnector_ms": 0.005021054520566239, "ViewRequirementAgentConnector_ms": 0.1081193614209819}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.193180970497664, "num_env_steps_trained_throughput_per_sec": 39.193180970497664, "timesteps_total": 112000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 50975.624, "sample_time_ms": 47836.61, "load_time_ms": 12.51, "load_throughput": 159875.28, "learn_time_ms": 3123.843, "learn_throughput": 640.237, "synch_weights_time_ms": 2.205}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 6886, "training_iteration": 56, "trial_id": "13850_00002", "date": "2023-12-28_18-35-19", "timestamp": 1703759719, "time_this_iter_s": 51.0344717502594, "time_total_s": 2868.972840309143, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2868.972840309143, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 55.92054794520547, "ram_util_percent": 92.39726027397258}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.309672370553017e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010349617836376031, "policy_loss": -0.021914781510002083, "vf_loss": 0.01156516349563996, "vf_explained_var": 0.9992876501878103, "kl": 0.00142576028121366, "entropy": 0.1154654805527793, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 25425.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 114000, "num_env_steps_trained": 114000, "num_agent_steps_sampled": 114000, "num_agent_steps_trained": 114000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.150188323917142, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.222222222222227, 14.750000000000004, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.16666666666667, 15.138888888888893, 15.111111111111114, 15.138888888888893, 15.194444444444448, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.111111111111114, 15.111111111111114, 15.166666666666671, 15.222222222222227, 15.111111111111114, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.138888888888893, 15.194444444444448, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.111111111111114, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.138888888888893, 15.16666666666667, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.194444444444448, 14.722222222222227, 15.222222222222227, 15.138888888888893, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 14.722222222222227, 15.138888888888893, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8247550929354253, "mean_inference_ms": 1.2176884300762045, "mean_action_processing_ms": 0.10397315632873355, "mean_env_wait_ms": 21.871134653033796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075811046664997685, "StateBufferConnector_ms": 0.004993050785387977, "ViewRequirementAgentConnector_ms": 0.11016090037459034}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.150188323917142, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.222222222222227, 14.750000000000004, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.16666666666667, 15.138888888888893, 15.111111111111114, 15.138888888888893, 15.194444444444448, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.111111111111114, 15.111111111111114, 15.166666666666671, 15.222222222222227, 15.111111111111114, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.138888888888893, 15.194444444444448, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.111111111111114, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.138888888888893, 15.16666666666667, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.194444444444448, 14.722222222222227, 15.222222222222227, 15.138888888888893, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 14.722222222222227, 15.138888888888893, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8247550929354253, "mean_inference_ms": 1.2176884300762045, "mean_action_processing_ms": 0.10397315632873355, "mean_env_wait_ms": 21.871134653033796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075811046664997685, "StateBufferConnector_ms": 0.004993050785387977, "ViewRequirementAgentConnector_ms": 0.11016090037459034}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114000, "num_agent_steps_trained": 114000, "num_env_steps_sampled": 114000, "num_env_steps_trained": 114000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.89325947852602, "num_env_steps_trained_throughput_per_sec": 38.89325947852602, "timesteps_total": 114000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 114000, "timers": {"training_iteration_time_ms": 51048.645, "sample_time_ms": 47906.55, "load_time_ms": 12.52, "load_throughput": 159738.587, "learn_time_ms": 3126.893, "learn_throughput": 639.613, "synch_weights_time_ms": 2.22}, "counters": {"num_env_steps_sampled": 114000, "num_env_steps_trained": 114000, "num_agent_steps_sampled": 114000, "num_agent_steps_trained": 114000}, "done": false, "episodes_total": 7004, "training_iteration": 57, "trial_id": "13850_00002", "date": "2023-12-28_18-36-10", "timestamp": 1703759770, "time_this_iter_s": 51.42782163619995, "time_total_s": 2920.400661945343, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2920.400661945343, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 56.00958904109589, "ram_util_percent": 92.3821917808219}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.548361852765085e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.004750645247598489, "policy_loss": -0.004047261228164037, "vf_loss": 0.008797905329200956, "vf_explained_var": 0.9994953530364566, "kl": 0.0018166686492630962, "entropy": 0.09641624867916107, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 25875.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.154661016949158, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.083333333333336, 15.111111111111114, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.138888888888893, 15.111111111111114, 15.166666666666671, 15.194444444444448, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.138888888888893, 14.777777777777782, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.824436261867016, "mean_inference_ms": 1.2176924915714762, "mean_action_processing_ms": 0.10397760187002823, "mean_env_wait_ms": 21.872051865818932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007449368299063989, "StateBufferConnector_ms": 0.004979311409643141, "ViewRequirementAgentConnector_ms": 0.1092769331851248}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.154661016949158, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.083333333333336, 15.111111111111114, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.138888888888893, 15.111111111111114, 15.166666666666671, 15.194444444444448, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.138888888888893, 14.777777777777782, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.824436261867016, "mean_inference_ms": 1.2176924915714762, "mean_action_processing_ms": 0.10397760187002823, "mean_env_wait_ms": 21.872051865818932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007449368299063989, "StateBufferConnector_ms": 0.004979311409643141, "ViewRequirementAgentConnector_ms": 0.1092769331851248}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.02287259350808, "num_env_steps_trained_throughput_per_sec": 39.02287259350808, "timesteps_total": 116000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 51134.458, "sample_time_ms": 48003.501, "load_time_ms": 12.51, "load_throughput": 159868.577, "learn_time_ms": 3115.773, "learn_throughput": 641.895, "synch_weights_time_ms": 2.216}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 7122, "training_iteration": 58, "trial_id": "13850_00002", "date": "2023-12-28_18-37-02", "timestamp": 1703759822, "time_this_iter_s": 51.25716829299927, "time_total_s": 2971.6578302383423, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2971.6578302383423, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 56.082191780821915, "ram_util_percent": 92.3917808219178}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.2741809263825425e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.00849405955730213, "policy_loss": 0.0006408879057400756, "vf_loss": 0.007853170815441344, "vf_explained_var": 0.9995364016956754, "kl": 0.0017784980354732325, "entropy": 0.09294176002343496, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 26325.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 118000, "num_env_steps_trained": 118000, "num_agent_steps_sampled": 118000, "num_agent_steps_trained": 118000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.160968660968669, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.111111111111114, 15.222222222222227, 15.138888888888893, 15.111111111111114, 15.222222222222227, 15.194444444444448, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.16666666666667, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.111111111111114, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.055555555555559, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.111111111111114, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8239600033300655, "mean_inference_ms": 1.2175277821459072, "mean_action_processing_ms": 0.10396965665262278, "mean_env_wait_ms": 21.870787671597903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007419708447578626, "StateBufferConnector_ms": 0.0049970088860927485, "ViewRequirementAgentConnector_ms": 0.11017954247629541}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.160968660968669, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.111111111111114, 15.222222222222227, 15.138888888888893, 15.111111111111114, 15.222222222222227, 15.194444444444448, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.16666666666667, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.111111111111114, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.055555555555559, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.111111111111114, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8239600033300655, "mean_inference_ms": 1.2175277821459072, "mean_action_processing_ms": 0.10396965665262278, "mean_env_wait_ms": 21.870787671597903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007419708447578626, "StateBufferConnector_ms": 0.0049970088860927485, "ViewRequirementAgentConnector_ms": 0.11017954247629541}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118000, "num_agent_steps_trained": 118000, "num_env_steps_sampled": 118000, "num_env_steps_trained": 118000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.20231977540924, "num_env_steps_trained_throughput_per_sec": 39.20231977540924, "timesteps_total": 118000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 118000, "timers": {"training_iteration_time_ms": 51032.547, "sample_time_ms": 47897.006, "load_time_ms": 12.69, "load_throughput": 157608.019, "learn_time_ms": 3120.182, "learn_throughput": 640.988, "synch_weights_time_ms": 2.207}, "counters": {"num_env_steps_sampled": 118000, "num_env_steps_trained": 118000, "num_agent_steps_sampled": 118000, "num_agent_steps_trained": 118000}, "done": false, "episodes_total": 7239, "training_iteration": 59, "trial_id": "13850_00002", "date": "2023-12-28_18-37-53", "timestamp": 1703759873, "time_this_iter_s": 51.02218842506409, "time_total_s": 3022.6800186634064, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3022.6800186634064, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 56.230136986301375, "ram_util_percent": 92.2904109589041}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6370904631912713e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.013922303292072481, "policy_loss": -0.0005258362409141328, "vf_loss": 0.014448139582657152, "vf_explained_var": 0.9991990983486175, "kl": 0.00300607889604939, "entropy": 0.07836912188265059, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 26775.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.166431261770253, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 14.722222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.166666666666671, 15.194444444444448, 15.222222222222227, 15.166666666666671, 15.111111111111114, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8233563991247853, "mean_inference_ms": 1.2171639419484328, "mean_action_processing_ms": 0.10394262678032064, "mean_env_wait_ms": 21.86448033992976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007394006696798034, "StateBufferConnector_ms": 0.004929607197389764, "ViewRequirementAgentConnector_ms": 0.10743646298424672}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.166431261770253, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 14.722222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.166666666666671, 15.194444444444448, 15.222222222222227, 15.166666666666671, 15.111111111111114, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8233563991247853, "mean_inference_ms": 1.2171639419484328, "mean_action_processing_ms": 0.10394262678032064, "mean_env_wait_ms": 21.86448033992976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007394006696798034, "StateBufferConnector_ms": 0.004929607197389764, "ViewRequirementAgentConnector_ms": 0.10743646298424672}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.74453827480763, "num_env_steps_trained_throughput_per_sec": 39.74453827480763, "timesteps_total": 120000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 50979.962, "sample_time_ms": 47843.238, "load_time_ms": 11.98, "load_throughput": 166939.134, "learn_time_ms": 3122.086, "learn_throughput": 640.597, "synch_weights_time_ms": 2.211}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 7357, "training_iteration": 60, "trial_id": "13850_00002", "date": "2023-12-28_18-38-43", "timestamp": 1703759923, "time_this_iter_s": 50.326902866363525, "time_total_s": 3073.00692152977, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3073.00692152977, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 55.90845070422535, "ram_util_percent": 92.35492957746474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.185452315956356e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.017468862065838444, "policy_loss": 0.005181245195368926, "vf_loss": 0.012287615679411425, "vf_explained_var": 0.9993256370226542, "kl": 0.0012015743362643791, "entropy": 0.05541581331027878, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 27225.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 122000, "num_env_steps_trained": 122000, "num_agent_steps_sampled": 122000, "num_agent_steps_trained": 122000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.158192090395486, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.138888888888893, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8230957392517633, "mean_inference_ms": 1.2173027723775778, "mean_action_processing_ms": 0.10394575756083413, "mean_env_wait_ms": 21.866834245450477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074758368023371295, "StateBufferConnector_ms": 0.005114280571371822, "ViewRequirementAgentConnector_ms": 0.11026758258625613}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.158192090395486, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.111111111111114, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.027777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.138888888888893, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8230957392517633, "mean_inference_ms": 1.2173027723775778, "mean_action_processing_ms": 0.10394575756083413, "mean_env_wait_ms": 21.866834245450477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074758368023371295, "StateBufferConnector_ms": 0.005114280571371822, "ViewRequirementAgentConnector_ms": 0.11026758258625613}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122000, "num_agent_steps_trained": 122000, "num_env_steps_sampled": 122000, "num_env_steps_trained": 122000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.81651974828932, "num_env_steps_trained_throughput_per_sec": 38.81651974828932, "timesteps_total": 122000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 122000, "timers": {"training_iteration_time_ms": 51052.914, "sample_time_ms": 47912.839, "load_time_ms": 11.883, "load_throughput": 168307.715, "learn_time_ms": 3125.485, "learn_throughput": 639.901, "synch_weights_time_ms": 2.259}, "counters": {"num_env_steps_sampled": 122000, "num_env_steps_trained": 122000, "num_agent_steps_sampled": 122000, "num_agent_steps_trained": 122000}, "done": false, "episodes_total": 7475, "training_iteration": 61, "trial_id": "13850_00002", "date": "2023-12-28_18-39-34", "timestamp": 1703759974, "time_this_iter_s": 51.53004574775696, "time_total_s": 3124.536967277527, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3124.536967277527, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 56.10405405405405, "ram_util_percent": 92.38378378378376}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.092726157978178e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0264853500864572, "policy_loss": -0.00012483441995249855, "vf_loss": 0.026610184668873747, "vf_explained_var": 0.9985029803382026, "kl": 0.0003113058928169105, "entropy": 0.054432060205274156, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 27675.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.153608736942079, "episode_len_mean": 16.99145299145299, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.833333333333337, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 13.888888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 14.722222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8224875470076681, "mean_inference_ms": 1.216988132041904, "mean_action_processing_ms": 0.10391713369267697, "mean_env_wait_ms": 21.86009312661225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007636730487530048, "StateBufferConnector_ms": 0.004953196924975795, "ViewRequirementAgentConnector_ms": 0.10789642986069378}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.153608736942079, "episode_len_mean": 16.99145299145299, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.833333333333337, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 13.888888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 14.722222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8224875470076681, "mean_inference_ms": 1.216988132041904, "mean_action_processing_ms": 0.10391713369267697, "mean_env_wait_ms": 21.86009312661225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007636730487530048, "StateBufferConnector_ms": 0.004953196924975795, "ViewRequirementAgentConnector_ms": 0.10789642986069378}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.83559482090084, "num_env_steps_trained_throughput_per_sec": 39.83559482090084, "timesteps_total": 124000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 50879.513, "sample_time_ms": 47746.948, "load_time_ms": 12.653, "load_throughput": 158070.429, "learn_time_ms": 3117.312, "learn_throughput": 641.578, "synch_weights_time_ms": 2.17}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 7592, "training_iteration": 62, "trial_id": "13850_00002", "date": "2023-12-28_18-40-25", "timestamp": 1703760025, "time_this_iter_s": 50.21689462661743, "time_total_s": 3174.7538619041443, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3174.7538619041443, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 55.935211267605624, "ram_util_percent": 92.43098591549295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.046363078989089e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0035358390874332853, "policy_loss": -0.0025946797016594145, "vf_loss": 0.006130521815373666, "vf_explained_var": 0.9996342069572872, "kl": 0.0005479443905873804, "entropy": 0.04404868359367053, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 28125.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.167137476459521, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.194444444444448, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8219500865093573, "mean_inference_ms": 1.2166772832673776, "mean_action_processing_ms": 0.10388413928489662, "mean_env_wait_ms": 21.852973633314463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007304498704813294, "StateBufferConnector_ms": 0.004931223594536216, "ViewRequirementAgentConnector_ms": 0.10846226902331337}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.167137476459521, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.083333333333337, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.194444444444448, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8219500865093573, "mean_inference_ms": 1.2166772832673776, "mean_action_processing_ms": 0.10388413928489662, "mean_env_wait_ms": 21.852973633314463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007304498704813294, "StateBufferConnector_ms": 0.004931223594536216, "ViewRequirementAgentConnector_ms": 0.10846226902331337}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.85107893180227, "num_env_steps_trained_throughput_per_sec": 39.85107893180227, "timesteps_total": 126000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 126000, "timers": {"training_iteration_time_ms": 50820.129, "sample_time_ms": 47684.313, "load_time_ms": 12.291, "load_throughput": 162726.026, "learn_time_ms": 3120.957, "learn_throughput": 640.829, "synch_weights_time_ms": 2.134}, "counters": {"num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "done": false, "episodes_total": 7710, "training_iteration": 63, "trial_id": "13850_00002", "date": "2023-12-28_18-41-15", "timestamp": 1703760075, "time_this_iter_s": 50.191726207733154, "time_total_s": 3224.9455881118774, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3224.9455881118774, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 56.205555555555556, "ram_util_percent": 92.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0231815394945445e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.007719709931148423, "policy_loss": 0.00010376638422409694, "vf_loss": 0.007615944326648282, "vf_explained_var": 0.9995542771286434, "kl": 0.00048184657566892894, "entropy": 0.051979408636689185, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 28575.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 15.138888888888893, "episode_reward_mean": 15.167843691148786, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8215075924013165, "mean_inference_ms": 1.2163298955981683, "mean_action_processing_ms": 0.1038503207642291, "mean_env_wait_ms": 21.84638717139307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007316217584125066, "StateBufferConnector_ms": 0.0049916364378848315, "ViewRequirementAgentConnector_ms": 0.10746818477824582}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 15.138888888888893, "episode_reward_mean": 15.167843691148786, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.138888888888893, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8215075924013165, "mean_inference_ms": 1.2163298955981683, "mean_action_processing_ms": 0.1038503207642291, "mean_env_wait_ms": 21.84638717139307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007316217584125066, "StateBufferConnector_ms": 0.0049916364378848315, "ViewRequirementAgentConnector_ms": 0.10746818477824582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.83069421325843, "num_env_steps_trained_throughput_per_sec": 39.83069421325843, "timesteps_total": 128000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 50754.382, "sample_time_ms": 47617.883, "load_time_ms": 12.236, "load_throughput": 163446.388, "learn_time_ms": 3121.707, "learn_throughput": 640.675, "synch_weights_time_ms": 2.125}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 7828, "training_iteration": 64, "trial_id": "13850_00002", "date": "2023-12-28_18-42-05", "timestamp": 1703760125, "time_this_iter_s": 50.21746778488159, "time_total_s": 3275.163055896759, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3275.163055896759, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 55.84788732394368, "ram_util_percent": 92.4070422535211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.115907697472723e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.018338626590039996, "policy_loss": -0.022776377132783333, "vf_loss": 0.0044377507486691075, "vf_explained_var": 0.9997322948773703, "kl": 0.0843281084714122, "entropy": 0.13476065929565165, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29025.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_agent_steps_sampled": 130000, "num_agent_steps_trained": 130000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 15.138888888888893, "episode_reward_mean": 15.170940170940181, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8211554487382761, "mean_inference_ms": 1.2164561268241618, "mean_action_processing_ms": 0.10385233881238774, "mean_env_wait_ms": 21.84813373507955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007473913013425647, "StateBufferConnector_ms": 0.0051054180177867925, "ViewRequirementAgentConnector_ms": 0.1095987792707916}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 15.138888888888893, "episode_reward_mean": 15.170940170940181, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8211554487382761, "mean_inference_ms": 1.2164561268241618, "mean_action_processing_ms": 0.10385233881238774, "mean_env_wait_ms": 21.84813373507955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007473913013425647, "StateBufferConnector_ms": 0.0051054180177867925, "ViewRequirementAgentConnector_ms": 0.1095987792707916}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 130000, "num_agent_steps_trained": 130000, "num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.96392999579222, "num_env_steps_trained_throughput_per_sec": 38.96392999579222, "timesteps_total": 130000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 130000, "timers": {"training_iteration_time_ms": 50850.232, "sample_time_ms": 47715.254, "load_time_ms": 10.933, "load_throughput": 182925.328, "learn_time_ms": 3121.484, "learn_throughput": 640.721, "synch_weights_time_ms": 2.121}, "counters": {"num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_agent_steps_sampled": 130000, "num_agent_steps_trained": 130000}, "done": false, "episodes_total": 7945, "training_iteration": 65, "trial_id": "13850_00002", "date": "2023-12-28_18-42-56", "timestamp": 1703760176, "time_this_iter_s": 51.334487438201904, "time_total_s": 3326.497543334961, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3326.497543334961, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 55.98356164383563, "ram_util_percent": 92.48219178082192}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.673861546209083e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.19100193204151258, "policy_loss": -0.015188464870055516, "vf_loss": 0.20619039650592538, "vf_explained_var": 0.9883357768588595, "kl": 0.010449257511104612, "entropy": 0.13185687311821515, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29475.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 14.759103641456587, "episode_len_mean": 16.80672268907563, "episode_media": {}, "episodes_this_iter": 119, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 14.722222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 13.888888888888893, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 14.777777777777782, 13.888888888888893, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 13.888888888888893, 15.222222222222227, 13.888888888888893, 15.222222222222227, 15.222222222222227, 15.222222222222227, 13.944444444444448, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 13.888888888888893, 14.000000000000004, 13.888888888888893, 13.888888888888893, 15.222222222222227, 14.777777777777782, 15.194444444444448, 15.222222222222227, 14.777777777777782, 14.833333333333337, 14.000000000000004, 15.222222222222227, 14.833333333333337, 14.722222222222227, 14.722222222222227, 14.777777777777782, 14.777777777777782, 15.166666666666671, 13.888888888888893, 15.222222222222227, 14.777777777777782, 14.833333333333337, 15.222222222222227, 15.138888888888893, 13.888888888888893, 13.888888888888893, 14.833333333333337, 14.777777777777782, 15.222222222222227, 14.722222222222227, 15.222222222222227, 13.888888888888893, 14.777777777777782, 15.222222222222227, 14.833333333333337, 14.777777777777782, 14.833333333333337, 14.777777777777782, 13.888888888888893, 15.222222222222227, 14.722222222222227, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 13.888888888888893, 14.722222222222227, 14.833333333333337, 14.722222222222227, 14.722222222222227, 15.222222222222227, 15.194444444444448, 14.722222222222227, 14.777777777777782, 15.194444444444448, 14.722222222222227, 15.222222222222227, 14.000000000000004, 14.777777777777782, 14.722222222222227, 14.722222222222227, 14.777777777777782, 13.944444444444448, 14.777777777777782, 13.888888888888893, 14.777777777777782, 14.833333333333337, 14.777777777777782, 14.833333333333337, 13.888888888888893, 15.222222222222227, 15.166666666666671, 14.000000000000004, 15.222222222222227, 15.222222222222227, 14.722222222222227, 13.888888888888893, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 13.944444444444448, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 16, 17, 16, 17, 17, 17, 16, 17, 17, 17, 17, 17, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 16, 16, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 16, 17, 16, 17, 17, 17, 17, 16, 17, 17, 16, 17, 17, 17, 16, 17, 17, 17, 17, 16, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8210443606708152, "mean_inference_ms": 1.2166299947896624, "mean_action_processing_ms": 0.10386976028689643, "mean_env_wait_ms": 21.854018467128157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007535629913586529, "StateBufferConnector_ms": 0.004954698706875329, "ViewRequirementAgentConnector_ms": 0.10999290883040228}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 14.759103641456587, "episode_len_mean": 16.80672268907563, "episodes_this_iter": 119, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 14.722222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 13.888888888888893, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 14.777777777777782, 13.888888888888893, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 13.888888888888893, 15.222222222222227, 13.888888888888893, 15.222222222222227, 15.222222222222227, 15.222222222222227, 13.944444444444448, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 13.888888888888893, 14.000000000000004, 13.888888888888893, 13.888888888888893, 15.222222222222227, 14.777777777777782, 15.194444444444448, 15.222222222222227, 14.777777777777782, 14.833333333333337, 14.000000000000004, 15.222222222222227, 14.833333333333337, 14.722222222222227, 14.722222222222227, 14.777777777777782, 14.777777777777782, 15.166666666666671, 13.888888888888893, 15.222222222222227, 14.777777777777782, 14.833333333333337, 15.222222222222227, 15.138888888888893, 13.888888888888893, 13.888888888888893, 14.833333333333337, 14.777777777777782, 15.222222222222227, 14.722222222222227, 15.222222222222227, 13.888888888888893, 14.777777777777782, 15.222222222222227, 14.833333333333337, 14.777777777777782, 14.833333333333337, 14.777777777777782, 13.888888888888893, 15.222222222222227, 14.722222222222227, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 13.888888888888893, 14.722222222222227, 14.833333333333337, 14.722222222222227, 14.722222222222227, 15.222222222222227, 15.194444444444448, 14.722222222222227, 14.777777777777782, 15.194444444444448, 14.722222222222227, 15.222222222222227, 14.000000000000004, 14.777777777777782, 14.722222222222227, 14.722222222222227, 14.777777777777782, 13.944444444444448, 14.777777777777782, 13.888888888888893, 14.777777777777782, 14.833333333333337, 14.777777777777782, 14.833333333333337, 13.888888888888893, 15.222222222222227, 15.166666666666671, 14.000000000000004, 15.222222222222227, 15.222222222222227, 14.722222222222227, 13.888888888888893, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 13.944444444444448, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 16, 17, 16, 17, 17, 17, 16, 17, 17, 17, 17, 17, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 16, 16, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 16, 17, 16, 17, 17, 17, 17, 16, 17, 17, 16, 17, 17, 17, 16, 17, 17, 17, 17, 16, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8210443606708152, "mean_inference_ms": 1.2166299947896624, "mean_action_processing_ms": 0.10386976028689643, "mean_env_wait_ms": 21.854018467128157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007535629913586529, "StateBufferConnector_ms": 0.004954698706875329, "ViewRequirementAgentConnector_ms": 0.10999290883040228}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.50148203668634, "num_env_steps_trained_throughput_per_sec": 38.50148203668634, "timesteps_total": 132000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 50941.908, "sample_time_ms": 47810.442, "load_time_ms": 12.65, "load_throughput": 158103.499, "learn_time_ms": 3116.233, "learn_throughput": 641.8, "synch_weights_time_ms": 2.133}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 8064, "training_iteration": 66, "trial_id": "13850_00002", "date": "2023-12-28_18-43-48", "timestamp": 1703760228, "time_this_iter_s": 51.951170921325684, "time_total_s": 3378.4487142562866, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3378.4487142562866, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 56.01486486486487, "ram_util_percent": 92.54189189189192}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.673861546209083e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.062107892152335906, "policy_loss": -0.010170751412709554, "vf_loss": 0.07227864132780168, "vf_explained_var": 0.9962572847472296, "kl": 0.0060098252793786755, "entropy": 0.11794995513227251, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 29925.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 134000, "num_env_steps_trained": 134000, "num_agent_steps_sampled": 134000, "num_agent_steps_trained": 134000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.029896421845578, "episode_len_mean": 16.983050847457626, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.777777777777782, 15.222222222222227, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.722222222222227, 15.166666666666671, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 15.194444444444448, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 13.888888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.166666666666671, 14.722222222222227, 14.777777777777782, 14.777777777777782, 15.166666666666671, 15.222222222222227, 14.833333333333337, 14.777777777777782, 15.222222222222227, 13.888888888888893, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.722222222222227, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.750000000000004, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.166666666666671, 14.833333333333337, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.138888888888893, 14.722222222222227, 14.833333333333337, 14.777777777777782, 15.222222222222227, 15.138888888888893, 14.777777777777782, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.194444444444448, 15.222222222222227, 15.138888888888893, 14.777777777777782, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8208280858663947, "mean_inference_ms": 1.2166271496101633, "mean_action_processing_ms": 0.10387944694422993, "mean_env_wait_ms": 21.856967403344598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007327532364150225, "StateBufferConnector_ms": 0.0049364768852621825, "ViewRequirementAgentConnector_ms": 0.10936118788638358}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.029896421845578, "episode_len_mean": 16.983050847457626, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.777777777777782, 15.222222222222227, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.722222222222227, 15.166666666666671, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 15.194444444444448, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 13.888888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.166666666666671, 14.722222222222227, 14.777777777777782, 14.777777777777782, 15.166666666666671, 15.222222222222227, 14.833333333333337, 14.777777777777782, 15.222222222222227, 13.888888888888893, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.722222222222227, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.750000000000004, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.166666666666671, 14.833333333333337, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.138888888888893, 14.722222222222227, 14.833333333333337, 14.777777777777782, 15.222222222222227, 15.138888888888893, 14.777777777777782, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.194444444444448, 15.222222222222227, 15.138888888888893, 14.777777777777782, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8208280858663947, "mean_inference_ms": 1.2166271496101633, "mean_action_processing_ms": 0.10387944694422993, "mean_env_wait_ms": 21.856967403344598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007327532364150225, "StateBufferConnector_ms": 0.0049364768852621825, "ViewRequirementAgentConnector_ms": 0.10936118788638358}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134000, "num_agent_steps_trained": 134000, "num_env_steps_sampled": 134000, "num_env_steps_trained": 134000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.80176960064416, "num_env_steps_trained_throughput_per_sec": 38.80176960064416, "timesteps_total": 134000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 134000, "timers": {"training_iteration_time_ms": 50954.033, "sample_time_ms": 47819.313, "load_time_ms": 13.908, "load_throughput": 143802.819, "learn_time_ms": 3118.229, "learn_throughput": 641.39, "synch_weights_time_ms": 2.131}, "counters": {"num_env_steps_sampled": 134000, "num_env_steps_trained": 134000, "num_agent_steps_sampled": 134000, "num_agent_steps_trained": 134000}, "done": false, "episodes_total": 8182, "training_iteration": 67, "trial_id": "13850_00002", "date": "2023-12-28_18-44-40", "timestamp": 1703760280, "time_this_iter_s": 51.54917287826538, "time_total_s": 3429.997887134552, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3429.997887134552, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 55.94657534246575, "ram_util_percent": 92.43835616438353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.673861546209083e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06576191384966175, "policy_loss": -0.03810045426090558, "vf_loss": 0.10386236800501744, "vf_explained_var": 0.9942108359601762, "kl": 0.005222278398470984, "entropy": 0.1070221336517069, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 30375.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.011770244821099, "episode_len_mean": 16.940677966101696, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 14.750000000000004, 14.777777777777782, 15.222222222222227, 15.222222222222227, 13.888888888888893, 14.694444444444448, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.833333333333337, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.722222222222227, 14.777777777777782, 15.138888888888893, 15.166666666666671, 14.777777777777782, 13.888888888888893, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 14.777777777777782, 14.777777777777782, 14.722222222222227, 15.222222222222227, 15.166666666666671, 15.194444444444448, 15.222222222222227, 13.888888888888893, 14.777777777777782, 14.777777777777782, 15.222222222222227, 14.833333333333337, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.722222222222227, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 13.888888888888893, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.833333333333337, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 13.888888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.694444444444448, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.750000000000004, 14.833333333333337, 14.777777777777782, 15.166666666666671, 14.777777777777782, 13.888888888888893, 15.194444444444448, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 13.888888888888893, 15.166666666666671, 15.138888888888893, 14.777777777777782], "episode_lengths": [17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8206814682000446, "mean_inference_ms": 1.216823073475003, "mean_action_processing_ms": 0.10389428670928355, "mean_env_wait_ms": 21.859977679407212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007497254064527608, "StateBufferConnector_ms": 0.005167419627561408, "ViewRequirementAgentConnector_ms": 0.11114286164105949}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.011770244821099, "episode_len_mean": 16.940677966101696, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 14.750000000000004, 14.777777777777782, 15.222222222222227, 15.222222222222227, 13.888888888888893, 14.694444444444448, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.833333333333337, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.722222222222227, 14.777777777777782, 15.138888888888893, 15.166666666666671, 14.777777777777782, 13.888888888888893, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 14.777777777777782, 14.777777777777782, 14.722222222222227, 15.222222222222227, 15.166666666666671, 15.194444444444448, 15.222222222222227, 13.888888888888893, 14.777777777777782, 14.777777777777782, 15.222222222222227, 14.833333333333337, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.722222222222227, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 13.888888888888893, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.833333333333337, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 13.888888888888893, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.694444444444448, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.750000000000004, 14.833333333333337, 14.777777777777782, 15.166666666666671, 14.777777777777782, 13.888888888888893, 15.194444444444448, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 13.888888888888893, 15.166666666666671, 15.138888888888893, 14.777777777777782], "episode_lengths": [17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8206814682000446, "mean_inference_ms": 1.216823073475003, "mean_action_processing_ms": 0.10389428670928355, "mean_env_wait_ms": 21.859977679407212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007497254064527608, "StateBufferConnector_ms": 0.005167419627561408, "ViewRequirementAgentConnector_ms": 0.11114286164105949}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.78452988914189, "num_env_steps_trained_throughput_per_sec": 38.78452988914189, "timesteps_total": 136000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 50985.528, "sample_time_ms": 47850.327, "load_time_ms": 12.426, "load_throughput": 160954.451, "learn_time_ms": 3120.206, "learn_throughput": 640.983, "synch_weights_time_ms": 2.118}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 8300, "training_iteration": 68, "trial_id": "13850_00002", "date": "2023-12-28_18-45-32", "timestamp": 1703760332, "time_this_iter_s": 51.572335720062256, "time_total_s": 3481.5702228546143, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3481.5702228546143, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 55.78243243243243, "ram_util_percent": 92.4027027027027}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.673861546209083e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03579637891716427, "policy_loss": -0.017316232774820594, "vf_loss": 0.05311261263055106, "vf_explained_var": 0.9970255008008745, "kl": 0.0027846312097828375, "entropy": 0.08980411536163754, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 30825.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 138000, "num_env_steps_trained": 138000, "num_agent_steps_sampled": 138000, "num_agent_steps_trained": 138000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.107815442561206, "episode_len_mean": 16.97457627118644, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.833333333333337, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.722222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.166666666666671, 14.000000000000004, 15.138888888888893, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.000000000000004, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.194444444444448, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.777777777777782, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 13.888888888888893, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.833333333333337, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 14.833333333333337, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8206027765939058, "mean_inference_ms": 1.2170823694770745, "mean_action_processing_ms": 0.10391826411124444, "mean_env_wait_ms": 21.864097803100503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007830635975983184, "StateBufferConnector_ms": 0.005142567521434719, "ViewRequirementAgentConnector_ms": 0.11150129770828505}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.107815442561206, "episode_len_mean": 16.97457627118644, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.833333333333337, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.722222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.166666666666671, 14.000000000000004, 15.138888888888893, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.000000000000004, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.194444444444448, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.777777777777782, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 13.888888888888893, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.833333333333337, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 14.833333333333337, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8206027765939058, "mean_inference_ms": 1.2170823694770745, "mean_action_processing_ms": 0.10391826411124444, "mean_env_wait_ms": 21.864097803100503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007830635975983184, "StateBufferConnector_ms": 0.005142567521434719, "ViewRequirementAgentConnector_ms": 0.11150129770828505}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 138000, "num_agent_steps_trained": 138000, "num_env_steps_sampled": 138000, "num_env_steps_trained": 138000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.623381061290914, "num_env_steps_trained_throughput_per_sec": 38.623381061290914, "timesteps_total": 138000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 138000, "timers": {"training_iteration_time_ms": 51062.0, "sample_time_ms": 47929.212, "load_time_ms": 12.117, "load_throughput": 165052.101, "learn_time_ms": 3118.099, "learn_throughput": 641.417, "synch_weights_time_ms": 2.128}, "counters": {"num_env_steps_sampled": 138000, "num_env_steps_trained": 138000, "num_agent_steps_sampled": 138000, "num_agent_steps_trained": 138000}, "done": false, "episodes_total": 8418, "training_iteration": 69, "trial_id": "13850_00002", "date": "2023-12-28_18-46-23", "timestamp": 1703760383, "time_this_iter_s": 51.787596464157104, "time_total_s": 3533.3578193187714, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3533.3578193187714, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 55.96351351351352, "ram_util_percent": 92.4135135135135}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.836930773104541e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.02644606153170268, "policy_loss": 0.006617336206965976, "vf_loss": 0.01982872485700581, "vf_explained_var": 0.9988186041514079, "kl": 0.0011882720378536703, "entropy": 0.07771804180410173, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 31275.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.694444444444448, "episode_reward_mean": 15.15371939736347, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.722222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.833333333333337, 14.694444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.833333333333337, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.694444444444448, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8203330368209947, "mean_inference_ms": 1.2171040757988292, "mean_action_processing_ms": 0.1039123588970345, "mean_env_wait_ms": 21.863743601207666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007536451695329052, "StateBufferConnector_ms": 0.004985372898942333, "ViewRequirementAgentConnector_ms": 0.1102324259483208}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.694444444444448, "episode_reward_mean": 15.15371939736347, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.722222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.833333333333337, 14.694444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.833333333333337, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.694444444444448, 15.194444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8203330368209947, "mean_inference_ms": 1.2171040757988292, "mean_action_processing_ms": 0.1039123588970345, "mean_env_wait_ms": 21.863743601207666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007536451695329052, "StateBufferConnector_ms": 0.004985372898942333, "ViewRequirementAgentConnector_ms": 0.1102324259483208}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.85540747845497, "num_env_steps_trained_throughput_per_sec": 38.85540747845497, "timesteps_total": 140000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 51177.15, "sample_time_ms": 48006.439, "load_time_ms": 13.548, "load_throughput": 147623.085, "learn_time_ms": 3154.609, "learn_throughput": 633.993, "synch_weights_time_ms": 2.108}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 8536, "training_iteration": 70, "trial_id": "13850_00002", "date": "2023-12-28_18-47-15", "timestamp": 1703760435, "time_this_iter_s": 51.479327917099, "time_total_s": 3584.8371472358704, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3584.8371472358704, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 56.220547945205475, "ram_util_percent": 92.43013698630136}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9184653865522706e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.012083122597800361, "policy_loss": -0.003980577430791325, "vf_loss": 0.01606369838842915, "vf_explained_var": 0.9990679444207086, "kl": 0.0014004876518152938, "entropy": 0.06290004058844513, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 31725.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 142000, "num_env_steps_trained": 142000, "num_agent_steps_sampled": 142000, "num_agent_steps_trained": 142000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.694444444444448, "episode_reward_mean": 15.165242165242173, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.194444444444448, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.833333333333337, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.694444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8198794163053885, "mean_inference_ms": 1.2169420866478302, "mean_action_processing_ms": 0.10389938860607613, "mean_env_wait_ms": 21.86098194692501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007542178162142762, "StateBufferConnector_ms": 0.004966442401592548, "ViewRequirementAgentConnector_ms": 0.10858030400724493}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.694444444444448, "episode_reward_mean": 15.165242165242173, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.194444444444448, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.833333333333337, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.694444444444448, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8198794163053885, "mean_inference_ms": 1.2169420866478302, "mean_action_processing_ms": 0.10389938860607613, "mean_env_wait_ms": 21.86098194692501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007542178162142762, "StateBufferConnector_ms": 0.004966442401592548, "ViewRequirementAgentConnector_ms": 0.10858030400724493}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142000, "num_agent_steps_trained": 142000, "num_env_steps_sampled": 142000, "num_env_steps_trained": 142000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.352321804240546, "num_env_steps_trained_throughput_per_sec": 39.352321804240546, "timesteps_total": 142000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 142000, "timers": {"training_iteration_time_ms": 51106.997, "sample_time_ms": 47930.073, "load_time_ms": 13.63, "load_throughput": 146738.13, "learn_time_ms": 3160.774, "learn_throughput": 632.756, "synch_weights_time_ms": 2.078}, "counters": {"num_env_steps_sampled": 142000, "num_env_steps_trained": 142000, "num_agent_steps_sampled": 142000, "num_agent_steps_trained": 142000}, "done": false, "episodes_total": 8653, "training_iteration": 71, "trial_id": "13850_00002", "date": "2023-12-28_18-48-06", "timestamp": 1703760486, "time_this_iter_s": 50.827897787094116, "time_total_s": 3635.6650450229645, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3635.6650450229645, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 56.06666666666667, "ram_util_percent": 92.50416666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.592326932761353e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.012583055504494242, "policy_loss": -3.53660931189855e-05, "vf_loss": 0.01261841863911185, "vf_explained_var": 0.9992715001106263, "kl": 0.0005859117524678344, "entropy": 0.05078701157536772, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 32175.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.160310734463287, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8193988687330603, "mean_inference_ms": 1.216680731824934, "mean_action_processing_ms": 0.10388508981193484, "mean_env_wait_ms": 21.8553319856419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007265705173298464, "StateBufferConnector_ms": 0.004885560375148967, "ViewRequirementAgentConnector_ms": 0.10731402090040304}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.160310734463287, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8193988687330603, "mean_inference_ms": 1.216680731824934, "mean_action_processing_ms": 0.10388508981193484, "mean_env_wait_ms": 21.8553319856419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007265705173298464, "StateBufferConnector_ms": 0.004885560375148967, "ViewRequirementAgentConnector_ms": 0.10731402090040304}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.82759396139502, "num_env_steps_trained_throughput_per_sec": 39.82759396139502, "timesteps_total": 144000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 51108.006, "sample_time_ms": 47931.248, "load_time_ms": 13.408, "load_throughput": 149162.1, "learn_time_ms": 3160.82, "learn_throughput": 632.747, "synch_weights_time_ms": 2.087}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 8771, "training_iteration": 72, "trial_id": "13850_00002", "date": "2023-12-28_18-48-56", "timestamp": 1703760536, "time_this_iter_s": 50.22132396697998, "time_total_s": 3685.8863689899445, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3685.8863689899445, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 55.65555555555555, "ram_util_percent": 92.52777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.7961634663806766e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.014233386938770612, "policy_loss": 0.003574418495926592, "vf_loss": 0.010658968209495976, "vf_explained_var": 0.9994047382142809, "kl": 0.0005937829672468058, "entropy": 0.04225576231049167, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 32625.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 146000, "num_env_steps_trained": 146000, "num_agent_steps_sampled": 146000, "num_agent_steps_trained": 146000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.162664783427505, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8189979054728744, "mean_inference_ms": 1.2164097044695088, "mean_action_processing_ms": 0.10385891408812703, "mean_env_wait_ms": 21.850016088338947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007409564519332627, "StateBufferConnector_ms": 0.0049166760202181544, "ViewRequirementAgentConnector_ms": 0.10823900416745978}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.162664783427505, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8189979054728744, "mean_inference_ms": 1.2164097044695088, "mean_action_processing_ms": 0.10385891408812703, "mean_env_wait_ms": 21.850016088338947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007409564519332627, "StateBufferConnector_ms": 0.0049166760202181544, "ViewRequirementAgentConnector_ms": 0.10823900416745978}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 146000, "num_agent_steps_trained": 146000, "num_env_steps_sampled": 146000, "num_env_steps_trained": 146000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.79559054214284, "num_env_steps_trained_throughput_per_sec": 39.79559054214284, "timesteps_total": 146000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 146000, "timers": {"training_iteration_time_ms": 51115.003, "sample_time_ms": 47942.611, "load_time_ms": 12.24, "load_throughput": 163400.224, "learn_time_ms": 3157.626, "learn_throughput": 633.387, "synch_weights_time_ms": 2.085}, "counters": {"num_env_steps_sampled": 146000, "num_env_steps_trained": 146000, "num_agent_steps_sampled": 146000, "num_agent_steps_trained": 146000}, "done": false, "episodes_total": 8889, "training_iteration": 73, "trial_id": "13850_00002", "date": "2023-12-28_18-49-46", "timestamp": 1703760586, "time_this_iter_s": 50.26183581352234, "time_total_s": 3736.148204803467, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3736.148204803467, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 55.86901408450704, "ram_util_percent": 92.50845070422534}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3980817331903383e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0027613050749318467, "policy_loss": -0.004874908523634076, "vf_loss": 0.00763621318878399, "vf_explained_var": 0.9995393443107605, "kl": 0.0008795854812907204, "entropy": 0.05027823374503189, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.166191832858509, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8186269328880648, "mean_inference_ms": 1.2163065582361376, "mean_action_processing_ms": 0.10384899285315483, "mean_env_wait_ms": 21.847405477697485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075429932683961, "StateBufferConnector_ms": 0.004950344053089109, "ViewRequirementAgentConnector_ms": 0.10811711987878522}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.166191832858509, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8186269328880648, "mean_inference_ms": 1.2163065582361376, "mean_action_processing_ms": 0.10384899285315483, "mean_env_wait_ms": 21.847405477697485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075429932683961, "StateBufferConnector_ms": 0.004950344053089109, "ViewRequirementAgentConnector_ms": 0.10811711987878522}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.425415002785336, "num_env_steps_trained_throughput_per_sec": 39.425415002785336, "timesteps_total": 148000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 51166.619, "sample_time_ms": 47990.652, "load_time_ms": 13.831, "load_throughput": 144599.261, "learn_time_ms": 3159.585, "learn_throughput": 632.995, "synch_weights_time_ms": 2.104}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 9006, "training_iteration": 74, "trial_id": "13850_00002", "date": "2023-12-28_18-50-37", "timestamp": 1703760637, "time_this_iter_s": 50.73349332809448, "time_total_s": 3786.8816981315613, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3786.8816981315613, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 56.183561643835624, "ram_util_percent": 92.46164383561643}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1990408665951691e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.009386419078542126, "policy_loss": 0.0019866951348053085, "vf_loss": 0.007399722595906092, "vf_explained_var": 0.9995841499169668, "kl": 6.819770018038993e-05, "entropy": 0.05248982826040851, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33525.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.172787193973644, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8185478254343378, "mean_inference_ms": 1.216452537899421, "mean_action_processing_ms": 0.10386031369888116, "mean_env_wait_ms": 21.85046694358047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007489576178081965, "StateBufferConnector_ms": 0.005113472372798597, "ViewRequirementAgentConnector_ms": 0.11044579037165238}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.172787193973644, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8185478254343378, "mean_inference_ms": 1.216452537899421, "mean_action_processing_ms": 0.10386031369888116, "mean_env_wait_ms": 21.85046694358047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007489576178081965, "StateBufferConnector_ms": 0.005113472372798597, "ViewRequirementAgentConnector_ms": 0.11044579037165238}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000, "num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.73755139545886, "num_env_steps_trained_throughput_per_sec": 38.73755139545886, "timesteps_total": 150000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 150000, "timers": {"training_iteration_time_ms": 51196.616, "sample_time_ms": 48017.579, "load_time_ms": 15.245, "load_throughput": 131187.609, "learn_time_ms": 3161.252, "learn_throughput": 632.661, "synch_weights_time_ms": 2.1}, "counters": {"num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000}, "done": false, "episodes_total": 9124, "training_iteration": 75, "trial_id": "13850_00002", "date": "2023-12-28_18-51-29", "timestamp": 1703760689, "time_this_iter_s": 51.634177446365356, "time_total_s": 3838.5158755779266, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3838.5158755779266, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 56.06849315068493, "ram_util_percent": 92.47397260273974}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.995204332975846e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.007798540045817693, "policy_loss": -0.0010797839032279121, "vf_loss": 0.008878321992233396, "vf_explained_var": 0.9995327174663544, "kl": 0.0011436252820612404, "entropy": 0.045814275352491274, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 33975.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.177350427350435, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.138888888888893, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8180714935997004, "mean_inference_ms": 1.2160961852621188, "mean_action_processing_ms": 0.10383938561309256, "mean_env_wait_ms": 21.84413558566999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073689680833082935, "StateBufferConnector_ms": 0.004977242559449285, "ViewRequirementAgentConnector_ms": 0.10719482715313251}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.177350427350435, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.138888888888893, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8180714935997004, "mean_inference_ms": 1.2160961852621188, "mean_action_processing_ms": 0.10383938561309256, "mean_env_wait_ms": 21.84413558566999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073689680833082935, "StateBufferConnector_ms": 0.004977242559449285, "ViewRequirementAgentConnector_ms": 0.10719482715313251}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.97180619457194, "num_env_steps_trained_throughput_per_sec": 39.97180619457194, "timesteps_total": 152000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 51005.538, "sample_time_ms": 47829.5, "load_time_ms": 13.883, "load_throughput": 144064.354, "learn_time_ms": 3159.628, "learn_throughput": 632.986, "synch_weights_time_ms": 2.098}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 9241, "training_iteration": 76, "trial_id": "13850_00002", "date": "2023-12-28_18-52-19", "timestamp": 1703760739, "time_this_iter_s": 50.040055990219116, "time_total_s": 3888.5559315681458, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3888.5559315681458, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 55.794366197183095, "ram_util_percent": 92.50281690140845}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.997602166487923e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.007828969839546415, "policy_loss": 0.00019816045959790548, "vf_loss": 0.007630809424962435, "vf_explained_var": 0.9995703004466163, "kl": 0.00018228979474036084, "entropy": 0.05085605168508159, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 34425.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 154000, "num_env_steps_trained": 154000, "num_agent_steps_sampled": 154000, "num_agent_steps_trained": 154000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.173728813559334, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8177225515796476, "mean_inference_ms": 1.2158158824019323, "mean_action_processing_ms": 0.10381188111090324, "mean_env_wait_ms": 21.8396393353496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007327936463436838, "StateBufferConnector_ms": 0.005034470962265791, "ViewRequirementAgentConnector_ms": 0.1077573178178173}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.173728813559334, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8177225515796476, "mean_inference_ms": 1.2158158824019323, "mean_action_processing_ms": 0.10381188111090324, "mean_env_wait_ms": 21.8396393353496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007327936463436838, "StateBufferConnector_ms": 0.005034470962265791, "ViewRequirementAgentConnector_ms": 0.1077573178178173}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 154000, "num_agent_steps_trained": 154000, "num_env_steps_sampled": 154000, "num_env_steps_trained": 154000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.753718258834674, "num_env_steps_trained_throughput_per_sec": 39.753718258834674, "timesteps_total": 154000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 154000, "timers": {"training_iteration_time_ms": 50882.11, "sample_time_ms": 47710.578, "load_time_ms": 12.986, "load_throughput": 154014.082, "learn_time_ms": 3156.034, "learn_throughput": 633.707, "synch_weights_time_ms": 2.092}, "counters": {"num_env_steps_sampled": 154000, "num_env_steps_trained": 154000, "num_agent_steps_sampled": 154000, "num_agent_steps_trained": 154000}, "done": false, "episodes_total": 9359, "training_iteration": 77, "trial_id": "13850_00002", "date": "2023-12-28_18-53-09", "timestamp": 1703760789, "time_this_iter_s": 50.3151638507843, "time_total_s": 3938.87109541893, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3938.87109541893, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 55.826388888888886, "ram_util_percent": 92.43194444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4988010832439614e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.01371159250744515, "policy_loss": 0.006910353476802508, "vf_loss": 0.006801239856932726, "vf_explained_var": 0.9996555072731442, "kl": 0.0008155264196305032, "entropy": 0.057406725817256504, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.182438794726934, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8173636163328158, "mean_inference_ms": 1.215590911709616, "mean_action_processing_ms": 0.10379064796898621, "mean_env_wait_ms": 21.83542418264885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007341271739895061, "StateBufferConnector_ms": 0.0048411094536215575, "ViewRequirementAgentConnector_ms": 0.10756577475596282}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.182438794726934, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8173636163328158, "mean_inference_ms": 1.215590911709616, "mean_action_processing_ms": 0.10379064796898621, "mean_env_wait_ms": 21.83542418264885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007341271739895061, "StateBufferConnector_ms": 0.0048411094536215575, "ViewRequirementAgentConnector_ms": 0.10756577475596282}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.6658910091338, "num_env_steps_trained_throughput_per_sec": 39.6658910091338, "timesteps_total": 156000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 50767.53, "sample_time_ms": 47589.161, "load_time_ms": 13.633, "load_throughput": 146701.177, "learn_time_ms": 3162.152, "learn_throughput": 632.481, "synch_weights_time_ms": 2.163}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 9477, "training_iteration": 78, "trial_id": "13850_00002", "date": "2023-12-28_18-53-59", "timestamp": 1703760839, "time_this_iter_s": 50.42633867263794, "time_total_s": 3989.297434091568, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3989.297434091568, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 55.861111111111114, "ram_util_percent": 92.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.494005416219807e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.023717724420130253, "policy_loss": 0.004300045564046336, "vf_loss": 0.019417679199638466, "vf_explained_var": 0.9989149228731791, "kl": 0.0005779489922664579, "entropy": 0.04535452253288693, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 35325.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 158000, "num_env_steps_trained": 158000, "num_agent_steps_sampled": 158000, "num_agent_steps_trained": 158000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.169753086419764, "episode_len_mean": 16.99145299145299, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 13.888888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8171655913834196, "mean_inference_ms": 1.2157394792747491, "mean_action_processing_ms": 0.10379853073163472, "mean_env_wait_ms": 21.837742326938656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076901199471237315, "StateBufferConnector_ms": 0.00503633776281634, "ViewRequirementAgentConnector_ms": 0.11052779662303436}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 15.169753086419764, "episode_len_mean": 16.99145299145299, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 13.888888888888893, 15.166666666666671, 15.166666666666671, 15.138888888888893, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8171655913834196, "mean_inference_ms": 1.2157394792747491, "mean_action_processing_ms": 0.10379853073163472, "mean_env_wait_ms": 21.837742326938656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076901199471237315, "StateBufferConnector_ms": 0.00503633776281634, "ViewRequirementAgentConnector_ms": 0.11052779662303436}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 158000, "num_agent_steps_trained": 158000, "num_env_steps_sampled": 158000, "num_env_steps_trained": 158000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.82057372936266, "num_env_steps_trained_throughput_per_sec": 38.82057372936266, "timesteps_total": 158000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 158000, "timers": {"training_iteration_time_ms": 50741.226, "sample_time_ms": 47559.671, "load_time_ms": 13.456, "load_throughput": 148631.671, "learn_time_ms": 3165.511, "learn_throughput": 631.809, "synch_weights_time_ms": 2.164}, "counters": {"num_env_steps_sampled": 158000, "num_env_steps_trained": 158000, "num_agent_steps_sampled": 158000, "num_agent_steps_trained": 158000}, "done": false, "episodes_total": 9594, "training_iteration": 79, "trial_id": "13850_00002", "date": "2023-12-28_18-54-51", "timestamp": 1703760891, "time_this_iter_s": 51.52403783798218, "time_total_s": 4040.82147192955, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4040.82147192955, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 55.98904109589041, "ram_util_percent": 92.3780821917808}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.7470027081099036e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0014208137285378244, "policy_loss": -0.005590534255736404, "vf_loss": 0.004169718625230922, "vf_explained_var": 0.9997544520431094, "kl": 0.000982531631471591, "entropy": 0.05582033670610852, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 35775.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 15.166666666666671, "episode_reward_mean": 15.181732580037673, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8168779175962251, "mean_inference_ms": 1.2155118909084996, "mean_action_processing_ms": 0.10378047185115784, "mean_env_wait_ms": 21.833887192665937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007466542518745034, "StateBufferConnector_ms": 0.004927384651313394, "ViewRequirementAgentConnector_ms": 0.10808928538176973}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 15.166666666666671, "episode_reward_mean": 15.181732580037673, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8168779175962251, "mean_inference_ms": 1.2155118909084996, "mean_action_processing_ms": 0.10378047185115784, "mean_env_wait_ms": 21.833887192665937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007466542518745034, "StateBufferConnector_ms": 0.004927384651313394, "ViewRequirementAgentConnector_ms": 0.10808928538176973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.66441363939892, "num_env_steps_trained_throughput_per_sec": 39.66441363939892, "timesteps_total": 160000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 50636.241, "sample_time_ms": 47491.641, "load_time_ms": 13.647, "load_throughput": 146553.295, "learn_time_ms": 3128.368, "learn_throughput": 639.311, "synch_weights_time_ms": 2.161}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 9712, "training_iteration": 80, "trial_id": "13850_00002", "date": "2023-12-28_18-55-41", "timestamp": 1703760941, "time_this_iter_s": 50.42830753326416, "time_total_s": 4091.2497794628143, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4091.2497794628143, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 55.75555555555556, "ram_util_percent": 92.45138888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8735013540549518e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0039818836189806465, "policy_loss": -0.001537470275329219, "vf_loss": 0.005519353790312178, "vf_explained_var": 0.999704521364636, "kl": 0.003572866979301452, "entropy": 0.06897108000185755, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 36225.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 15.166666666666671, "episode_reward_mean": 15.188323917137486, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8165258128591778, "mean_inference_ms": 1.21527612321538, "mean_action_processing_ms": 0.10376189931094017, "mean_env_wait_ms": 21.829830598027915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007356223413499736, "StateBufferConnector_ms": 0.005019923387947729, "ViewRequirementAgentConnector_ms": 0.10828507148613364}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 15.166666666666671, "episode_reward_mean": 15.188323917137486, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8165258128591778, "mean_inference_ms": 1.21527612321538, "mean_action_processing_ms": 0.10376189931094017, "mean_env_wait_ms": 21.829830598027915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007356223413499736, "StateBufferConnector_ms": 0.005019923387947729, "ViewRequirementAgentConnector_ms": 0.10828507148613364}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.700511921062855, "num_env_steps_trained_throughput_per_sec": 39.700511921062855, "timesteps_total": 162000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 162000, "timers": {"training_iteration_time_ms": 50591.662, "sample_time_ms": 47457.304, "load_time_ms": 12.558, "load_throughput": 159256.704, "learn_time_ms": 3119.239, "learn_throughput": 641.182, "synch_weights_time_ms": 2.138}, "counters": {"num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "done": false, "episodes_total": 9830, "training_iteration": 81, "trial_id": "13850_00002", "date": "2023-12-28_18-56-32", "timestamp": 1703760992, "time_this_iter_s": 50.38192391395569, "time_total_s": 4141.63170337677, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4141.63170337677, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 55.83888888888888, "ram_util_percent": 92.49444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.367506770274759e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.004894879659016927, "policy_loss": -0.016878265341122946, "vf_loss": 0.011983386803832319, "vf_explained_var": 0.9993120197455089, "kl": 0.00033852201532406115, "entropy": 0.07138781031800641, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 36675.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.176638176638182, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 14.833333333333337, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.722222222222227, 15.138888888888893, 15.194444444444448], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8164337359241092, "mean_inference_ms": 1.2155132740994958, "mean_action_processing_ms": 0.10377796353897287, "mean_env_wait_ms": 21.835336555737612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007545438587156116, "StateBufferConnector_ms": 0.0052765903309879136, "ViewRequirementAgentConnector_ms": 0.11170745914817876}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.176638176638182, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 14.833333333333337, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.722222222222227, 15.138888888888893, 15.194444444444448], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8164337359241092, "mean_inference_ms": 1.2155132740994958, "mean_action_processing_ms": 0.10377796353897287, "mean_env_wait_ms": 21.835336555737612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007545438587156116, "StateBufferConnector_ms": 0.0052765903309879136, "ViewRequirementAgentConnector_ms": 0.11170745914817876}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.465028824189346, "num_env_steps_trained_throughput_per_sec": 38.465028824189346, "timesteps_total": 164000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 50769.546, "sample_time_ms": 47635.461, "load_time_ms": 11.601, "load_throughput": 172399.713, "learn_time_ms": 3119.913, "learn_throughput": 641.044, "synch_weights_time_ms": 2.144}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 9947, "training_iteration": 82, "trial_id": "13850_00002", "date": "2023-12-28_18-57-24", "timestamp": 1703761044, "time_this_iter_s": 52.0002384185791, "time_total_s": 4193.631941795349, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4193.631941795349, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 56.32027027027027, "ram_util_percent": 92.49054054054054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.6837533851373795e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0189904894762569, "policy_loss": 0.0033124467068248323, "vf_loss": 0.015678043730763924, "vf_explained_var": 0.99915090613895, "kl": 0.002458237688883426, "entropy": 0.0652785558336311, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 37125.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 166000, "num_env_steps_trained": 166000, "num_agent_steps_sampled": 166000, "num_agent_steps_trained": 166000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.694444444444448, "episode_reward_mean": 15.167372881355938, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.694444444444448, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.194444444444448, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.816116707811051, "mean_inference_ms": 1.2153348010941913, "mean_action_processing_ms": 0.10376148021768157, "mean_env_wait_ms": 21.832546137419683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007335008200952562, "StateBufferConnector_ms": 0.005038916054418531, "ViewRequirementAgentConnector_ms": 0.10900436821630445}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.694444444444448, "episode_reward_mean": 15.167372881355938, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.694444444444448, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.194444444444448, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.194444444444448, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.816116707811051, "mean_inference_ms": 1.2153348010941913, "mean_action_processing_ms": 0.10376148021768157, "mean_env_wait_ms": 21.832546137419683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007335008200952562, "StateBufferConnector_ms": 0.005038916054418531, "ViewRequirementAgentConnector_ms": 0.10900436821630445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 166000, "num_agent_steps_trained": 166000, "num_env_steps_sampled": 166000, "num_env_steps_trained": 166000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.54660249581319, "num_env_steps_trained_throughput_per_sec": 39.54660249581319, "timesteps_total": 166000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 166000, "timers": {"training_iteration_time_ms": 50801.188, "sample_time_ms": 47663.587, "load_time_ms": 12.561, "load_throughput": 159218.315, "learn_time_ms": 3122.473, "learn_throughput": 640.518, "synch_weights_time_ms": 2.147}, "counters": {"num_env_steps_sampled": 166000, "num_env_steps_trained": 166000, "num_agent_steps_sampled": 166000, "num_agent_steps_trained": 166000}, "done": false, "episodes_total": 10065, "training_iteration": 83, "trial_id": "13850_00002", "date": "2023-12-28_18-58-14", "timestamp": 1703761094, "time_this_iter_s": 50.578195571899414, "time_total_s": 4244.2101373672485, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4244.2101373672485, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 56.09861111111111, "ram_util_percent": 92.52361111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3418766925686897e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.008582388990455204, "policy_loss": -0.022444750865300497, "vf_loss": 0.013862363596757254, "vf_explained_var": 0.9992606592178345, "kl": 0.0010334676060389065, "entropy": 0.05796378981735971, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 37575.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.170668549905844, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.722222222222227, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8159619365527311, "mean_inference_ms": 1.2152939633069553, "mean_action_processing_ms": 0.10376048626924893, "mean_env_wait_ms": 21.833228620463704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007427748987230204, "StateBufferConnector_ms": 0.004943548622777906, "ViewRequirementAgentConnector_ms": 0.10952080710459564}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.170668549905844, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.722222222222227, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.138888888888893, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8159619365527311, "mean_inference_ms": 1.2152939633069553, "mean_action_processing_ms": 0.10376048626924893, "mean_env_wait_ms": 21.833228620463704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007427748987230204, "StateBufferConnector_ms": 0.004943548622777906, "ViewRequirementAgentConnector_ms": 0.10952080710459564}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.08431163256257, "num_env_steps_trained_throughput_per_sec": 39.08431163256257, "timesteps_total": 168000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 50845.462, "sample_time_ms": 47713.035, "load_time_ms": 10.976, "load_throughput": 182211.313, "learn_time_ms": 3118.858, "learn_throughput": 641.26, "synch_weights_time_ms": 2.173}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 10183, "training_iteration": 84, "trial_id": "13850_00002", "date": "2023-12-28_18-59-06", "timestamp": 1703761146, "time_this_iter_s": 51.17636013031006, "time_total_s": 4295.386497497559, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4295.386497497559, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 55.801388888888894, "ram_util_percent": 92.58055555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1709383462843449e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.011465451246541407, "policy_loss": 0.004884896297007799, "vf_loss": 0.006580555977610251, "vf_explained_var": 0.9996702682971954, "kl": 0.0016699118847153353, "entropy": 0.06648615382611751, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 38025.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 170000, "num_env_steps_trained": 170000, "num_agent_steps_sampled": 170000, "num_agent_steps_trained": 170000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.183285849952526, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8156516452523426, "mean_inference_ms": 1.2152722215355989, "mean_action_processing_ms": 0.10375391570895745, "mean_env_wait_ms": 21.831827903743196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007433972807012052, "StateBufferConnector_ms": 0.005053454994136452, "ViewRequirementAgentConnector_ms": 0.10871235122028579}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.183285849952526, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8156516452523426, "mean_inference_ms": 1.2152722215355989, "mean_action_processing_ms": 0.10375391570895745, "mean_env_wait_ms": 21.831827903743196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007433972807012052, "StateBufferConnector_ms": 0.005053454994136452, "ViewRequirementAgentConnector_ms": 0.10871235122028579}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 170000, "num_agent_steps_trained": 170000, "num_env_steps_sampled": 170000, "num_env_steps_trained": 170000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.36577159419763, "num_env_steps_trained_throughput_per_sec": 39.36577159419763, "timesteps_total": 170000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 170000, "timers": {"training_iteration_time_ms": 50763.068, "sample_time_ms": 47632.718, "load_time_ms": 11.147, "load_throughput": 179428.173, "learn_time_ms": 3116.62, "learn_throughput": 641.721, "synch_weights_time_ms": 2.167}, "counters": {"num_env_steps_sampled": 170000, "num_env_steps_trained": 170000, "num_agent_steps_sampled": 170000, "num_agent_steps_trained": 170000}, "done": false, "episodes_total": 10300, "training_iteration": 85, "trial_id": "13850_00002", "date": "2023-12-28_18-59-56", "timestamp": 1703761196, "time_this_iter_s": 50.810503244400024, "time_total_s": 4346.197000741959, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4346.197000741959, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 55.76438356164384, "ram_util_percent": 92.6095890410959}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.854691731421724e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.006567055433988571, "policy_loss": -0.016184705081913206, "vf_loss": 0.022751759028890067, "vf_explained_var": 0.9987211161189609, "kl": 0.00115222484166931, "entropy": 0.05860656031303935, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 38475.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 13.944444444444448, "episode_reward_mean": 15.164312617702457, "episode_len_mean": 16.991525423728813, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 13.944444444444448, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.722222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8155407591949115, "mean_inference_ms": 1.2153868194211377, "mean_action_processing_ms": 0.10377155868194321, "mean_env_wait_ms": 21.83312523674893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007588176404015492, "StateBufferConnector_ms": 0.005086195670952231, "ViewRequirementAgentConnector_ms": 0.11103274458545749}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 13.944444444444448, "episode_reward_mean": 15.164312617702457, "episode_len_mean": 16.991525423728813, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 13.944444444444448, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.722222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8155407591949115, "mean_inference_ms": 1.2153868194211377, "mean_action_processing_ms": 0.10377155868194321, "mean_env_wait_ms": 21.83312523674893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007588176404015492, "StateBufferConnector_ms": 0.005086195670952231, "ViewRequirementAgentConnector_ms": 0.11103274458545749}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.98990954968719, "num_env_steps_trained_throughput_per_sec": 38.98990954968719, "timesteps_total": 172000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 50889.073, "sample_time_ms": 47760.069, "load_time_ms": 10.692, "load_throughput": 187058.656, "learn_time_ms": 3115.74, "learn_throughput": 641.902, "synch_weights_time_ms": 2.156}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 10418, "training_iteration": 86, "trial_id": "13850_00002", "date": "2023-12-28_19-00-48", "timestamp": 1703761248, "time_this_iter_s": 51.30008292198181, "time_total_s": 4397.49708366394, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4397.49708366394, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 55.80958904109589, "ram_util_percent": 92.38082191780819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.927345865710862e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.008186966909302606, "policy_loss": 0.0015504062051574388, "vf_loss": 0.006636561572344767, "vf_explained_var": 0.9996609889136421, "kl": 0.0017794685893156251, "entropy": 0.06767221392028862, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 38925.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 174000, "num_env_steps_trained": 174000, "num_agent_steps_sampled": 174000, "num_agent_steps_trained": 174000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.18785310734464, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8155512951296511, "mean_inference_ms": 1.215657508459378, "mean_action_processing_ms": 0.10379322460281831, "mean_env_wait_ms": 21.837591858432372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007618079751224841, "StateBufferConnector_ms": 0.005304813385009766, "ViewRequirementAgentConnector_ms": 0.11220746121164095}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.18785310734464, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8155512951296511, "mean_inference_ms": 1.215657508459378, "mean_action_processing_ms": 0.10379322460281831, "mean_env_wait_ms": 21.837591858432372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007618079751224841, "StateBufferConnector_ms": 0.005304813385009766, "ViewRequirementAgentConnector_ms": 0.11220746121164095}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174000, "num_agent_steps_trained": 174000, "num_env_steps_sampled": 174000, "num_env_steps_trained": 174000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.49437724549173, "num_env_steps_trained_throughput_per_sec": 38.49437724549173, "timesteps_total": 174000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 174000, "timers": {"training_iteration_time_ms": 51053.661, "sample_time_ms": 47919.74, "load_time_ms": 10.322, "load_throughput": 193756.45, "learn_time_ms": 3121.012, "learn_throughput": 640.818, "synch_weights_time_ms": 2.166}, "counters": {"num_env_steps_sampled": 174000, "num_env_steps_trained": 174000, "num_agent_steps_sampled": 174000, "num_agent_steps_trained": 174000}, "done": false, "episodes_total": 10536, "training_iteration": 87, "trial_id": "13850_00002", "date": "2023-12-28_19-01-40", "timestamp": 1703761300, "time_this_iter_s": 51.960782527923584, "time_total_s": 4449.457866191864, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4449.457866191864, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 56.0054054054054, "ram_util_percent": 92.29054054054055}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.463672932855431e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.007126683129204644, "policy_loss": -0.016994790732860567, "vf_loss": 0.009868105504040917, "vf_explained_var": 0.9994171011447907, "kl": 0.0005112865191275241, "entropy": 0.06885330066912704, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 39375.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.183285849952522, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8152154815988711, "mean_inference_ms": 1.2154703234379403, "mean_action_processing_ms": 0.10377822778789031, "mean_env_wait_ms": 21.83415153477799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007317005059657953, "StateBufferConnector_ms": 0.0050027146298661195, "ViewRequirementAgentConnector_ms": 0.10840179573776376}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.183285849952522, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8152154815988711, "mean_inference_ms": 1.2154703234379403, "mean_action_processing_ms": 0.10377822778789031, "mean_env_wait_ms": 21.83415153477799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007317005059657953, "StateBufferConnector_ms": 0.0050027146298661195, "ViewRequirementAgentConnector_ms": 0.10840179573776376}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.68462114866502, "num_env_steps_trained_throughput_per_sec": 39.68462114866502, "timesteps_total": 176000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 51051.282, "sample_time_ms": 47924.069, "load_time_ms": 9.676, "load_throughput": 206706.076, "learn_time_ms": 3114.959, "learn_throughput": 642.063, "synch_weights_time_ms": 2.148}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 10653, "training_iteration": 88, "trial_id": "13850_00002", "date": "2023-12-28_19-02-30", "timestamp": 1703761350, "time_this_iter_s": 50.4040162563324, "time_total_s": 4499.861882448196, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4499.861882448196, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 55.895833333333336, "ram_util_percent": 92.27083333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.318364664277155e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.01793783035957151, "policy_loss": 0.007825105169581043, "vf_loss": 0.010112725413507885, "vf_explained_var": 0.9994336638185713, "kl": 0.0011677161045584436, "entropy": 0.06356313785745038, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 39825.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 178000, "num_env_steps_trained": 178000, "num_agent_steps_sampled": 178000, "num_agent_steps_trained": 178000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.186440677966106, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8149493877198228, "mean_inference_ms": 1.2153073115719593, "mean_action_processing_ms": 0.10376191379111793, "mean_env_wait_ms": 21.830863754027124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074192629022113345, "StateBufferConnector_ms": 0.005060535366252317, "ViewRequirementAgentConnector_ms": 0.10875281641038798}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.186440677966106, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8149493877198228, "mean_inference_ms": 1.2153073115719593, "mean_action_processing_ms": 0.10376191379111793, "mean_env_wait_ms": 21.830863754027124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074192629022113345, "StateBufferConnector_ms": 0.005060535366252317, "ViewRequirementAgentConnector_ms": 0.10875281641038798}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 178000, "num_agent_steps_trained": 178000, "num_env_steps_sampled": 178000, "num_env_steps_trained": 178000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.66411750349556, "num_env_steps_trained_throughput_per_sec": 39.66411750349556, "timesteps_total": 178000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 178000, "timers": {"training_iteration_time_ms": 50941.715, "sample_time_ms": 47821.531, "load_time_ms": 10.032, "load_throughput": 199352.839, "learn_time_ms": 3107.583, "learn_throughput": 643.587, "synch_weights_time_ms": 2.145}, "counters": {"num_env_steps_sampled": 178000, "num_env_steps_trained": 178000, "num_agent_steps_sampled": 178000, "num_agent_steps_trained": 178000}, "done": false, "episodes_total": 10771, "training_iteration": 89, "trial_id": "13850_00002", "date": "2023-12-28_19-03-21", "timestamp": 1703761401, "time_this_iter_s": 50.428053855895996, "time_total_s": 4550.289936304092, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4550.289936304092, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 55.79154929577465, "ram_util_percent": 92.30985915492958}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.659182332138578e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.024841924835410385, "policy_loss": -0.033325372942619856, "vf_loss": 0.008483448683077262, "vf_explained_var": 0.9995175557666355, "kl": 0.0024562383883993686, "entropy": 0.06783650957875782, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 40275.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.185969868173263, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8146569239844285, "mean_inference_ms": 1.2151626523844745, "mean_action_processing_ms": 0.1037481411943918, "mean_env_wait_ms": 21.827617261592025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007347737328480866, "StateBufferConnector_ms": 0.004936274835618876, "ViewRequirementAgentConnector_ms": 0.10833800849267992}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.185969868173263, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8146569239844285, "mean_inference_ms": 1.2151626523844745, "mean_action_processing_ms": 0.1037481411943918, "mean_env_wait_ms": 21.827617261592025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007347737328480866, "StateBufferConnector_ms": 0.004936274835618876, "ViewRequirementAgentConnector_ms": 0.10833800849267992}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.67078603984451, "num_env_steps_trained_throughput_per_sec": 39.67078603984451, "timesteps_total": 180000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 50940.905, "sample_time_ms": 47823.244, "load_time_ms": 8.397, "load_throughput": 238188.22, "learn_time_ms": 3106.691, "learn_throughput": 643.772, "synch_weights_time_ms": 2.143}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 10889, "training_iteration": 90, "trial_id": "13850_00002", "date": "2023-12-28_19-04-11", "timestamp": 1703761451, "time_this_iter_s": 50.420247316360474, "time_total_s": 4600.710183620453, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4600.710183620453, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 55.88194444444444, "ram_util_percent": 92.35972222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.829591166069289e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.02319079958730274, "policy_loss": 0.007189439899391598, "vf_loss": 0.01600136103625927, "vf_explained_var": 0.9990815954738194, "kl": 0.0016256817717584188, "entropy": 0.06140590098996957, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 40725.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 182000, "num_env_steps_trained": 182000, "num_agent_steps_sampled": 182000, "num_agent_steps_trained": 182000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.177113010446348, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8143946707657078, "mean_inference_ms": 1.215128162906833, "mean_action_processing_ms": 0.10374126182494656, "mean_env_wait_ms": 21.826784728424236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007445995624248798, "StateBufferConnector_ms": 0.005070979778583233, "ViewRequirementAgentConnector_ms": 0.10981824662950304}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.177113010446348, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8143946707657078, "mean_inference_ms": 1.215128162906833, "mean_action_processing_ms": 0.10374126182494656, "mean_env_wait_ms": 21.826784728424236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007445995624248798, "StateBufferConnector_ms": 0.005070979778583233, "ViewRequirementAgentConnector_ms": 0.10981824662950304}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182000, "num_agent_steps_trained": 182000, "num_env_steps_sampled": 182000, "num_env_steps_trained": 182000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.24589876982803, "num_env_steps_trained_throughput_per_sec": 39.24589876982803, "timesteps_total": 182000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 182000, "timers": {"training_iteration_time_ms": 50999.267, "sample_time_ms": 47876.399, "load_time_ms": 8.44, "load_throughput": 236972.352, "learn_time_ms": 3111.811, "learn_throughput": 642.713, "synch_weights_time_ms": 2.184}, "counters": {"num_env_steps_sampled": 182000, "num_env_steps_trained": 182000, "num_agent_steps_sampled": 182000, "num_agent_steps_trained": 182000}, "done": false, "episodes_total": 11006, "training_iteration": 91, "trial_id": "13850_00002", "date": "2023-12-28_19-05-02", "timestamp": 1703761502, "time_this_iter_s": 50.96571183204651, "time_total_s": 4651.675895452499, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4651.675895452499, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 56.083561643835615, "ram_util_percent": 92.3958904109589}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.147955830346444e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011035456566347017, "policy_loss": -0.017237527916828792, "vf_loss": 0.006202070701660381, "vf_explained_var": 0.9996653595235613, "kl": 0.009193488610489176, "entropy": 0.06773613262507651, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 41175.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.833333333333337, "episode_reward_mean": 15.194444444444454, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.833333333333337, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8142687894846556, "mean_inference_ms": 1.2151337814843142, "mean_action_processing_ms": 0.10373481318310306, "mean_env_wait_ms": 21.82621677052935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007649195396294028, "StateBufferConnector_ms": 0.0052159115419549455, "ViewRequirementAgentConnector_ms": 0.11037567914542505}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.833333333333337, "episode_reward_mean": 15.194444444444454, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.833333333333337, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8142687894846556, "mean_inference_ms": 1.2151337814843142, "mean_action_processing_ms": 0.10373481318310306, "mean_env_wait_ms": 21.82621677052935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007649195396294028, "StateBufferConnector_ms": 0.0052159115419549455, "ViewRequirementAgentConnector_ms": 0.11037567914542505}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.24840632163277, "num_env_steps_trained_throughput_per_sec": 39.24840632163277, "timesteps_total": 184000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 50895.487, "sample_time_ms": 47769.514, "load_time_ms": 8.436, "load_throughput": 237070.13, "learn_time_ms": 3114.936, "learn_throughput": 642.068, "synch_weights_time_ms": 2.172}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 11124, "training_iteration": 92, "trial_id": "13850_00002", "date": "2023-12-28_19-05-53", "timestamp": 1703761553, "time_this_iter_s": 50.962549924850464, "time_total_s": 4702.63844537735, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4702.63844537735, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 55.826388888888886, "ram_util_percent": 92.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.147955830346444e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.02998255047533247, "policy_loss": 0.008131003553668657, "vf_loss": 0.02185154657603966, "vf_explained_var": 0.9988239014148712, "kl": 0.0025714343319068354, "entropy": 0.0630338510291444, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 41625.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 186000, "num_env_steps_trained": 186000, "num_agent_steps_sampled": 186000, "num_agent_steps_trained": 186000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.161016949152547, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.194444444444448, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.814077579220333, "mean_inference_ms": 1.2150587749405835, "mean_action_processing_ms": 0.10372586268532563, "mean_env_wait_ms": 21.82508607699559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073600623567225566, "StateBufferConnector_ms": 0.005074072692353847, "ViewRequirementAgentConnector_ms": 0.10901467274811308}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.161016949152547, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.138888888888893, 15.222222222222227, 15.194444444444448, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.814077579220333, "mean_inference_ms": 1.2150587749405835, "mean_action_processing_ms": 0.10372586268532563, "mean_env_wait_ms": 21.82508607699559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073600623567225566, "StateBufferConnector_ms": 0.005074072692353847, "ViewRequirementAgentConnector_ms": 0.10901467274811308}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 186000, "num_agent_steps_trained": 186000, "num_env_steps_sampled": 186000, "num_env_steps_trained": 186000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.34707354132987, "num_env_steps_trained_throughput_per_sec": 39.34707354132987, "timesteps_total": 186000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 186000, "timers": {"training_iteration_time_ms": 50921.132, "sample_time_ms": 47795.928, "load_time_ms": 8.736, "load_throughput": 228942.976, "learn_time_ms": 3113.881, "learn_throughput": 642.285, "synch_weights_time_ms": 2.159}, "counters": {"num_env_steps_sampled": 186000, "num_env_steps_trained": 186000, "num_agent_steps_sampled": 186000, "num_agent_steps_trained": 186000}, "done": false, "episodes_total": 11242, "training_iteration": 93, "trial_id": "13850_00002", "date": "2023-12-28_19-06-44", "timestamp": 1703761604, "time_this_iter_s": 50.834726095199585, "time_total_s": 4753.473171472549, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4753.473171472549, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 55.9109589041096, "ram_util_percent": 92.46164383561643}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.573977915173222e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.017971771789921653, "policy_loss": -0.03127896861897574, "vf_loss": 0.013307198473873239, "vf_explained_var": 0.9992284368144141, "kl": 0.001060677851602701, "entropy": 0.05859354400800334, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 42075.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.180911680911686, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8139255581368481, "mean_inference_ms": 1.2151091332928947, "mean_action_processing_ms": 0.1037321317904867, "mean_env_wait_ms": 21.827512550578216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007415836692875267, "StateBufferConnector_ms": 0.005010661915836171, "ViewRequirementAgentConnector_ms": 0.1104581050383739}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.180911680911686, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8139255581368481, "mean_inference_ms": 1.2151091332928947, "mean_action_processing_ms": 0.1037321317904867, "mean_env_wait_ms": 21.827512550578216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007415836692875267, "StateBufferConnector_ms": 0.005010661915836171, "ViewRequirementAgentConnector_ms": 0.1104581050383739}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.84144946653576, "num_env_steps_trained_throughput_per_sec": 38.84144946653576, "timesteps_total": 188000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 50953.128, "sample_time_ms": 47829.727, "load_time_ms": 9.399, "load_throughput": 212797.033, "learn_time_ms": 3111.432, "learn_throughput": 642.791, "synch_weights_time_ms": 2.139}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 11359, "training_iteration": 94, "trial_id": "13850_00002", "date": "2023-12-28_19-07-35", "timestamp": 1703761655, "time_this_iter_s": 51.49656558036804, "time_total_s": 4804.9697370529175, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4804.9697370529175, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 56.0, "ram_util_percent": 92.42876712328766}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.286988957586611e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.01860582302014033, "policy_loss": 0.012186756920483377, "vf_loss": 0.006419067250357734, "vf_explained_var": 0.9996597006585863, "kl": 0.0031523314317814547, "entropy": 0.060641178323162924, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 190000, "num_env_steps_trained": 190000, "num_agent_steps_sampled": 190000, "num_agent_steps_trained": 190000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.1906779661017, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8138907963283155, "mean_inference_ms": 1.215246327158613, "mean_action_processing_ms": 0.10374397712785544, "mean_env_wait_ms": 21.829645829237364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007580700567213155, "StateBufferConnector_ms": 0.0051419613725048, "ViewRequirementAgentConnector_ms": 0.11135561991546114}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.1906779661017, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8138907963283155, "mean_inference_ms": 1.215246327158613, "mean_action_processing_ms": 0.10374397712785544, "mean_env_wait_ms": 21.829645829237364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007580700567213155, "StateBufferConnector_ms": 0.0051419613725048, "ViewRequirementAgentConnector_ms": 0.11135561991546114}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190000, "num_agent_steps_trained": 190000, "num_env_steps_sampled": 190000, "num_env_steps_trained": 190000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.83342387559265, "num_env_steps_trained_throughput_per_sec": 38.83342387559265, "timesteps_total": 190000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 190000, "timers": {"training_iteration_time_ms": 51022.775, "sample_time_ms": 47900.431, "load_time_ms": 7.615, "load_throughput": 262644.666, "learn_time_ms": 3112.122, "learn_throughput": 642.648, "synch_weights_time_ms": 2.172}, "counters": {"num_env_steps_sampled": 190000, "num_env_steps_trained": 190000, "num_agent_steps_sampled": 190000, "num_agent_steps_trained": 190000}, "done": false, "episodes_total": 11477, "training_iteration": 95, "trial_id": "13850_00002", "date": "2023-12-28_19-08-27", "timestamp": 1703761707, "time_this_iter_s": 51.5068244934082, "time_total_s": 4856.476561546326, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4856.476561546326, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 56.07534246575342, "ram_util_percent": 92.43287671232878}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1434944787933055e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.022981431086858115, "policy_loss": 0.004803930280937089, "vf_loss": 0.01817749994030843, "vf_explained_var": 0.9990093289481269, "kl": 0.001534937229057248, "entropy": 0.056699641951256326, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 42975.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.172787193973639, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.833333333333337, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8136241888165602, "mean_inference_ms": 1.2151633243208233, "mean_action_processing_ms": 0.10373215242701045, "mean_env_wait_ms": 21.827686213017007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007487151582362288, "StateBufferConnector_ms": 0.004943750672421213, "ViewRequirementAgentConnector_ms": 0.10794744653216863}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.172787193973639, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.833333333333337, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8136241888165602, "mean_inference_ms": 1.2151633243208233, "mean_action_processing_ms": 0.10373215242701045, "mean_env_wait_ms": 21.827686213017007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007487151582362288, "StateBufferConnector_ms": 0.004943750672421213, "ViewRequirementAgentConnector_ms": 0.10794744653216863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.48051511880708, "num_env_steps_trained_throughput_per_sec": 39.48051511880708, "timesteps_total": 192000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 50959.033, "sample_time_ms": 47832.36, "load_time_ms": 8.123, "load_throughput": 246217.57, "learn_time_ms": 3115.936, "learn_throughput": 641.862, "synch_weights_time_ms": 2.181}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 11595, "training_iteration": 96, "trial_id": "13850_00002", "date": "2023-12-28_19-09-18", "timestamp": 1703761758, "time_this_iter_s": 50.66359615325928, "time_total_s": 4907.140157699585, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4907.140157699585, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 55.82777777777778, "ram_util_percent": 92.49166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.717472393966528e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.008782173465523456, "policy_loss": -0.0017340706971784433, "vf_loss": 0.010516244158045284, "vf_explained_var": 0.9994000601768493, "kl": 0.0007667028185852626, "entropy": 0.05384449263413747, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 43425.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 194000, "num_env_steps_trained": 194000, "num_agent_steps_sampled": 194000, "num_agent_steps_trained": 194000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.18708452041786, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8135645790970596, "mean_inference_ms": 1.2153146249744164, "mean_action_processing_ms": 0.1037472963975874, "mean_env_wait_ms": 21.83020746766108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007623485010913295, "StateBufferConnector_ms": 0.0050695533426398905, "ViewRequirementAgentConnector_ms": 0.11104437021108773}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.18708452041786, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8135645790970596, "mean_inference_ms": 1.2153146249744164, "mean_action_processing_ms": 0.1037472963975874, "mean_env_wait_ms": 21.83020746766108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007623485010913295, "StateBufferConnector_ms": 0.0050695533426398905, "ViewRequirementAgentConnector_ms": 0.11104437021108773}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 194000, "num_agent_steps_trained": 194000, "num_env_steps_sampled": 194000, "num_env_steps_trained": 194000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.74909990974673, "num_env_steps_trained_throughput_per_sec": 38.74909990974673, "timesteps_total": 194000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 194000, "timers": {"training_iteration_time_ms": 50924.879, "sample_time_ms": 47798.781, "load_time_ms": 9.363, "load_throughput": 213598.963, "learn_time_ms": 3114.124, "learn_throughput": 642.235, "synch_weights_time_ms": 2.178}, "counters": {"num_env_steps_sampled": 194000, "num_env_steps_trained": 194000, "num_agent_steps_sampled": 194000, "num_agent_steps_trained": 194000}, "done": false, "episodes_total": 11712, "training_iteration": 97, "trial_id": "13850_00002", "date": "2023-12-28_19-10-09", "timestamp": 1703761809, "time_this_iter_s": 51.61927247047424, "time_total_s": 4958.759430170059, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4958.759430170059, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 55.92567567567568, "ram_util_percent": 92.4081081081081}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.858736196983264e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0007152047577417559, "policy_loss": -0.00725533675816324, "vf_loss": 0.0079705441215386, "vf_explained_var": 0.9995757644706302, "kl": 0.00045571003690262913, "entropy": 0.05366922655867206, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 43875.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.194915254237296, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.813556099057683, "mean_inference_ms": 1.2154656331972595, "mean_action_processing_ms": 0.10375822418376536, "mean_env_wait_ms": 21.832420250825024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007538876291048728, "StateBufferConnector_ms": 0.005055686174812964, "ViewRequirementAgentConnector_ms": 0.11077977843203787}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.194915254237296, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.813556099057683, "mean_inference_ms": 1.2154656331972595, "mean_action_processing_ms": 0.10375822418376536, "mean_env_wait_ms": 21.832420250825024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007538876291048728, "StateBufferConnector_ms": 0.005055686174812964, "ViewRequirementAgentConnector_ms": 0.11077977843203787}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.74892521445627, "num_env_steps_trained_throughput_per_sec": 38.74892521445627, "timesteps_total": 196000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 51046.577, "sample_time_ms": 47913.28, "load_time_ms": 9.433, "load_throughput": 212025.215, "learn_time_ms": 3121.296, "learn_throughput": 640.759, "synch_weights_time_ms": 2.142}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 11830, "training_iteration": 98, "trial_id": "13850_00002", "date": "2023-12-28_19-11-01", "timestamp": 1703761861, "time_this_iter_s": 51.61913990974426, "time_total_s": 5010.3785700798035, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5010.3785700798035, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 55.93698630136986, "ram_util_percent": 92.44657534246575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.429368098491632e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.010330797986437877, "policy_loss": 0.00339792017514507, "vf_loss": 0.006932877590362397, "vf_explained_var": 0.999646888838874, "kl": 0.0009669461269616362, "entropy": 0.052434491308199035, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 44325.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.199192782526119, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8133408055177916, "mean_inference_ms": 1.2154039640935883, "mean_action_processing_ms": 0.10375568820623668, "mean_env_wait_ms": 21.83048148146086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007367745423928285, "StateBufferConnector_ms": 0.004963793306269198, "ViewRequirementAgentConnector_ms": 0.10890797672108707}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.199192782526119, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.138888888888893, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8133408055177916, "mean_inference_ms": 1.2154039640935883, "mean_action_processing_ms": 0.10375568820623668, "mean_env_wait_ms": 21.83048148146086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007367745423928285, "StateBufferConnector_ms": 0.004963793306269198, "ViewRequirementAgentConnector_ms": 0.10890797672108707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.49138091288369, "num_env_steps_trained_throughput_per_sec": 39.49138091288369, "timesteps_total": 198000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 198000, "timers": {"training_iteration_time_ms": 51068.632, "sample_time_ms": 47934.391, "load_time_ms": 9.411, "load_throughput": 212528.008, "learn_time_ms": 3122.278, "learn_throughput": 640.558, "synch_weights_time_ms": 2.127}, "counters": {"num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "done": false, "episodes_total": 11947, "training_iteration": 99, "trial_id": "13850_00002", "date": "2023-12-28_19-11-51", "timestamp": 1703761911, "time_this_iter_s": 50.64924907684326, "time_total_s": 5061.027819156647, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5061.027819156647, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 55.89861111111111, "ram_util_percent": 92.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.14684049245816e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.005344216184069713, "policy_loss": -0.009168713190075424, "vf_loss": 0.003824494055782755, "vf_explained_var": 0.9997712992297279, "kl": 0.028286061146757954, "entropy": 0.05930152954326735, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 44775.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 15.166666666666671, "episode_reward_mean": 15.208568738229761, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8130792971828601, "mean_inference_ms": 1.2152339767685778, "mean_action_processing_ms": 0.10373863087731074, "mean_env_wait_ms": 21.827080764279188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007406533774683031, "StateBufferConnector_ms": 0.005058312820175947, "ViewRequirementAgentConnector_ms": 0.10836669954202943}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 15.166666666666671, "episode_reward_mean": 15.208568738229761, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8130792971828601, "mean_inference_ms": 1.2152339767685778, "mean_action_processing_ms": 0.10373863087731074, "mean_env_wait_ms": 21.827080764279188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007406533774683031, "StateBufferConnector_ms": 0.005058312820175947, "ViewRequirementAgentConnector_ms": 0.10836669954202943}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.76467842642492, "num_env_steps_trained_throughput_per_sec": 39.76467842642492, "timesteps_total": 200000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 51056.729, "sample_time_ms": 47923.63, "load_time_ms": 9.974, "load_throughput": 200512.192, "learn_time_ms": 3120.58, "learn_throughput": 640.907, "synch_weights_time_ms": 2.127}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 12065, "training_iteration": 100, "trial_id": "13850_00002", "date": "2023-12-28_19-12-42", "timestamp": 1703761962, "time_this_iter_s": 50.30166268348694, "time_total_s": 5111.329481840134, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5111.329481840134, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 55.736111111111114, "ram_util_percent": 92.47083333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0720260738687236e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0277768870194753, "policy_loss": -0.005678949107726415, "vf_loss": 0.0334558366994477, "vf_explained_var": 0.9982247438695696, "kl": 0.007435370443845497, "entropy": 0.05885969343284766, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 45225.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 202000, "num_env_steps_trained": 202000, "num_agent_steps_sampled": 202000, "num_agent_steps_trained": 202000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.136064030131829, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 14.722222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8130402893853217, "mean_inference_ms": 1.2152333211686588, "mean_action_processing_ms": 0.10374444175979042, "mean_env_wait_ms": 21.828612621659996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074160301079184325, "StateBufferConnector_ms": 0.004975068367133706, "ViewRequirementAgentConnector_ms": 0.10962425652196851}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.136064030131829, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 14.722222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8130402893853217, "mean_inference_ms": 1.2152333211686588, "mean_action_processing_ms": 0.10374444175979042, "mean_env_wait_ms": 21.828612621659996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074160301079184325, "StateBufferConnector_ms": 0.004975068367133706, "ViewRequirementAgentConnector_ms": 0.10962425652196851}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 202000, "num_agent_steps_trained": 202000, "num_env_steps_sampled": 202000, "num_env_steps_trained": 202000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.91308309664663, "num_env_steps_trained_throughput_per_sec": 38.91308309664663, "timesteps_total": 202000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 202000, "timers": {"training_iteration_time_ms": 51100.314, "sample_time_ms": 47974.122, "load_time_ms": 10.44, "load_throughput": 191578.467, "learn_time_ms": 3113.218, "learn_throughput": 642.422, "synch_weights_time_ms": 2.111}, "counters": {"num_env_steps_sampled": 202000, "num_env_steps_trained": 202000, "num_agent_steps_sampled": 202000, "num_agent_steps_trained": 202000}, "done": false, "episodes_total": 12183, "training_iteration": 101, "trial_id": "13850_00002", "date": "2023-12-28_19-13-33", "timestamp": 1703762013, "time_this_iter_s": 51.4014573097229, "time_total_s": 5162.730939149857, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5162.730939149857, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 55.776712328767125, "ram_util_percent": 92.47534246575343}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0720260738687236e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.01213608572880427, "policy_loss": -0.0006822769178284539, "vf_loss": 0.012818361492827534, "vf_explained_var": 0.9993006250593397, "kl": 0.0019659583865795187, "entropy": 0.05240856937236256, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 45675.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.195156695156696, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.812843896227251, "mean_inference_ms": 1.2152174898320798, "mean_action_processing_ms": 0.10374298033808096, "mean_env_wait_ms": 21.82817468806761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007426636850732004, "StateBufferConnector_ms": 0.004987635164179354, "ViewRequirementAgentConnector_ms": 0.10915923322367872}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.195156695156696, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.812843896227251, "mean_inference_ms": 1.2152174898320798, "mean_action_processing_ms": 0.10374298033808096, "mean_env_wait_ms": 21.82817468806761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007426636850732004, "StateBufferConnector_ms": 0.004987635164179354, "ViewRequirementAgentConnector_ms": 0.10915923322367872}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.24739433828407, "num_env_steps_trained_throughput_per_sec": 39.24739433828407, "timesteps_total": 204000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 51100.445, "sample_time_ms": 47973.868, "load_time_ms": 11.334, "load_throughput": 176467.787, "learn_time_ms": 3112.67, "learn_throughput": 642.535, "synch_weights_time_ms": 2.147}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 12300, "training_iteration": 102, "trial_id": "13850_00002", "date": "2023-12-28_19-14-24", "timestamp": 1703762064, "time_this_iter_s": 50.96377635002136, "time_total_s": 5213.694715499878, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5213.694715499878, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 55.88767123287671, "ram_util_percent": 92.4972602739726}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.360130369343618e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.01663412360681428, "policy_loss": 0.00940899885363049, "vf_loss": 0.007225126869355639, "vf_explained_var": 0.9996059387260013, "kl": 0.00029472799668145595, "entropy": 0.05010491052435504, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 46125.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 206000, "num_env_steps_trained": 206000, "num_agent_steps_sampled": 206000, "num_agent_steps_trained": 206000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.209510357815445, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8127740389844716, "mean_inference_ms": 1.215263380374657, "mean_action_processing_ms": 0.10374822066643061, "mean_env_wait_ms": 21.82886440095014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007598278886180813, "StateBufferConnector_ms": 0.005013457799361924, "ViewRequirementAgentConnector_ms": 0.11106911352125265}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.209510357815445, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.722222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8127740389844716, "mean_inference_ms": 1.215263380374657, "mean_action_processing_ms": 0.10374822066643061, "mean_env_wait_ms": 21.82886440095014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007598278886180813, "StateBufferConnector_ms": 0.005013457799361924, "ViewRequirementAgentConnector_ms": 0.11106911352125265}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 206000, "num_agent_steps_trained": 206000, "num_env_steps_sampled": 206000, "num_env_steps_trained": 206000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.05109513856459, "num_env_steps_trained_throughput_per_sec": 39.05109513856459, "timesteps_total": 206000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 206000, "timers": {"training_iteration_time_ms": 51138.97, "sample_time_ms": 48014.024, "load_time_ms": 10.063, "load_throughput": 198740.266, "learn_time_ms": 3112.258, "learn_throughput": 642.62, "synch_weights_time_ms": 2.193}, "counters": {"num_env_steps_sampled": 206000, "num_env_steps_trained": 206000, "num_agent_steps_sampled": 206000, "num_agent_steps_trained": 206000}, "done": false, "episodes_total": 12418, "training_iteration": 103, "trial_id": "13850_00002", "date": "2023-12-28_19-15-15", "timestamp": 1703762115, "time_this_iter_s": 51.22075867652893, "time_total_s": 5264.915474176407, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5264.915474176407, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 55.99863013698629, "ram_util_percent": 92.47808219178081}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.680065184671809e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0067941609852843815, "policy_loss": -0.017398277587360806, "vf_loss": 0.010604118549575409, "vf_explained_var": 0.9993998861312866, "kl": 0.0007361422525032473, "entropy": 0.046541373456517855, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 46575.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.196798493408666, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.812745897926538, "mean_inference_ms": 1.2153798964473361, "mean_action_processing_ms": 0.1037560080287095, "mean_env_wait_ms": 21.83232778377287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007498668412030753, "StateBufferConnector_ms": 0.004976078615350239, "ViewRequirementAgentConnector_ms": 0.10955010430287507}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.196798493408666, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.812745897926538, "mean_inference_ms": 1.2153798964473361, "mean_action_processing_ms": 0.1037560080287095, "mean_env_wait_ms": 21.83232778377287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007498668412030753, "StateBufferConnector_ms": 0.004976078615350239, "ViewRequirementAgentConnector_ms": 0.10955010430287507}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.508617381743, "num_env_steps_trained_throughput_per_sec": 38.508617381743, "timesteps_total": 208000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 51183.474, "sample_time_ms": 48044.759, "load_time_ms": 9.549, "load_throughput": 209445.539, "learn_time_ms": 3126.565, "learn_throughput": 639.68, "synch_weights_time_ms": 2.175}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 12536, "training_iteration": 104, "trial_id": "13850_00002", "date": "2023-12-28_19-16-07", "timestamp": 1703762167, "time_this_iter_s": 51.94144558906555, "time_total_s": 5316.856919765472, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5316.856919765472, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 55.979729729729726, "ram_util_percent": 92.55270270270272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3400325923359045e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.019146444267696804, "policy_loss": 0.011856187652382586, "vf_loss": 0.007290259277344578, "vf_explained_var": 0.9996137478616502, "kl": 0.0006074870159009688, "entropy": 0.0449871503147814, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 47025.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 210000, "num_env_steps_trained": 210000, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.204178537511874, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8126153158509504, "mean_inference_ms": 1.2153258477550861, "mean_action_processing_ms": 0.10375220756496793, "mean_env_wait_ms": 21.83216483055265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007524449601132645, "StateBufferConnector_ms": 0.0049489176171457665, "ViewRequirementAgentConnector_ms": 0.10890023321168035}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.204178537511874, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8126153158509504, "mean_inference_ms": 1.2153258477550861, "mean_action_processing_ms": 0.10375220756496793, "mean_env_wait_ms": 21.83216483055265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007524449601132645, "StateBufferConnector_ms": 0.0049489176171457665, "ViewRequirementAgentConnector_ms": 0.10890023321168035}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000, "num_env_steps_sampled": 210000, "num_env_steps_trained": 210000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.17718664615814, "num_env_steps_trained_throughput_per_sec": 39.17718664615814, "timesteps_total": 210000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 210000, "timers": {"training_iteration_time_ms": 51138.284, "sample_time_ms": 47995.495, "load_time_ms": 11.543, "load_throughput": 173263.576, "learn_time_ms": 3128.665, "learn_throughput": 639.25, "synch_weights_time_ms": 2.157}, "counters": {"num_env_steps_sampled": 210000, "num_env_steps_trained": 210000, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000}, "done": false, "episodes_total": 12653, "training_iteration": 105, "trial_id": "13850_00002", "date": "2023-12-28_19-16-58", "timestamp": 1703762218, "time_this_iter_s": 51.05491805076599, "time_total_s": 5367.911837816238, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5367.911837816238, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 56.07361111111111, "ram_util_percent": 92.50833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.700162961679522e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012940989087025324, "policy_loss": -0.016073604027430216, "vf_loss": 0.0031326161759595078, "vf_explained_var": 0.9998114695813921, "kl": 0.020618145285679637, "entropy": 0.05060025698608822, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 47475.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 15.166666666666671, "episode_reward_mean": 15.211864406779663, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8124969490752992, "mean_inference_ms": 1.2153369745075322, "mean_action_processing_ms": 0.10375086073307477, "mean_env_wait_ms": 21.833206984111293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007545341879634534, "StateBufferConnector_ms": 0.005009618856139102, "ViewRequirementAgentConnector_ms": 0.11047973471172785}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 15.166666666666671, "episode_reward_mean": 15.211864406779663, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8124969490752992, "mean_inference_ms": 1.2153369745075322, "mean_action_processing_ms": 0.10375086073307477, "mean_env_wait_ms": 21.833206984111293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007545341879634534, "StateBufferConnector_ms": 0.005009618856139102, "ViewRequirementAgentConnector_ms": 0.11047973471172785}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.95335283562386, "num_env_steps_trained_throughput_per_sec": 38.95335283562386, "timesteps_total": 212000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 51206.84, "sample_time_ms": 48060.171, "load_time_ms": 11.031, "load_throughput": 181303.179, "learn_time_ms": 3133.077, "learn_throughput": 638.35, "synch_weights_time_ms": 2.139}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 12771, "training_iteration": 106, "trial_id": "13850_00002", "date": "2023-12-28_19-17-50", "timestamp": 1703762270, "time_this_iter_s": 51.34844493865967, "time_total_s": 5419.260282754898, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5419.260282754898, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 56.104109589041094, "ram_util_percent": 92.4849315068493}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.005024444251929e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.02591586410999298, "policy_loss": 0.003161447528335783, "vf_loss": 0.02275441552926269, "vf_explained_var": 0.9988180034690433, "kl": 0.006128075120032629, "entropy": 0.04913542063699828, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 47925.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 214000, "num_env_steps_trained": 214000, "num_agent_steps_sampled": 214000, "num_agent_steps_trained": 214000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.17184557438795, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8123824514195568, "mean_inference_ms": 1.2153195862237518, "mean_action_processing_ms": 0.10375007607183824, "mean_env_wait_ms": 21.833998230655496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007327128264863612, "StateBufferConnector_ms": 0.004986181097515559, "ViewRequirementAgentConnector_ms": 0.10922440027786513}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.17184557438795, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8123824514195568, "mean_inference_ms": 1.2153195862237518, "mean_action_processing_ms": 0.10375007607183824, "mean_env_wait_ms": 21.833998230655496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007327128264863612, "StateBufferConnector_ms": 0.004986181097515559, "ViewRequirementAgentConnector_ms": 0.10922440027786513}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 214000, "num_agent_steps_trained": 214000, "num_env_steps_sampled": 214000, "num_env_steps_trained": 214000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.03657947750143, "num_env_steps_trained_throughput_per_sec": 39.03657947750143, "timesteps_total": 214000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 214000, "timers": {"training_iteration_time_ms": 51168.83, "sample_time_ms": 48024.168, "load_time_ms": 10.894, "load_throughput": 183582.666, "learn_time_ms": 3131.207, "learn_throughput": 638.731, "synch_weights_time_ms": 2.141}, "counters": {"num_env_steps_sampled": 214000, "num_env_steps_trained": 214000, "num_agent_steps_sampled": 214000, "num_agent_steps_trained": 214000}, "done": false, "episodes_total": 12889, "training_iteration": 107, "trial_id": "13850_00002", "date": "2023-12-28_19-18-41", "timestamp": 1703762321, "time_this_iter_s": 51.23869490623474, "time_total_s": 5470.498977661133, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5470.498977661133, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 55.83287671232876, "ram_util_percent": 92.5068493150685}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.005024444251929e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.03541403421097332, "policy_loss": -0.04090558807262116, "vf_loss": 0.005491552497777674, "vf_explained_var": 0.999720837407642, "kl": 0.00038864559458327304, "entropy": 0.04280251149502066, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 48375.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.207977207977212, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8120924994207992, "mean_inference_ms": 1.215162441950495, "mean_action_processing_ms": 0.10373560576674427, "mean_env_wait_ms": 21.830608022205766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007388123080261752, "StateBufferConnector_ms": 0.0048991961356921075, "ViewRequirementAgentConnector_ms": 0.1080616926535582}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.207977207977212, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8120924994207992, "mean_inference_ms": 1.215162441950495, "mean_action_processing_ms": 0.10373560576674427, "mean_env_wait_ms": 21.830608022205766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007388123080261752, "StateBufferConnector_ms": 0.0048991961356921075, "ViewRequirementAgentConnector_ms": 0.1080616926535582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.77637038998525, "num_env_steps_trained_throughput_per_sec": 39.77637038998525, "timesteps_total": 216000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 51035.507, "sample_time_ms": 47894.973, "load_time_ms": 10.813, "load_throughput": 184969.108, "learn_time_ms": 3127.176, "learn_throughput": 639.555, "synch_weights_time_ms": 2.132}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 13006, "training_iteration": 108, "trial_id": "13850_00002", "date": "2023-12-28_19-19-31", "timestamp": 1703762371, "time_this_iter_s": 50.286112546920776, "time_total_s": 5520.785090208054, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5520.785090208054, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 56.23888888888889, "ram_util_percent": 92.5263888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.025122221259645e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.00823641452524397, "policy_loss": 9.95799485180113e-05, "vf_loss": 0.00813684145661278, "vf_explained_var": 0.9995659742090437, "kl": 0.00072176070670918, "entropy": 0.040070232210887805, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 48825.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 218000, "num_env_steps_trained": 218000, "num_agent_steps_sampled": 218000, "num_agent_steps_trained": 218000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.204802259887009, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8120791276586896, "mean_inference_ms": 1.2153478034722112, "mean_action_processing_ms": 0.10374689086205441, "mean_env_wait_ms": 21.833241777405473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007431183831166413, "StateBufferConnector_ms": 0.005110441628149, "ViewRequirementAgentConnector_ms": 0.11050559706607108}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.204802259887009, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8120791276586896, "mean_inference_ms": 1.2153478034722112, "mean_action_processing_ms": 0.10374689086205441, "mean_env_wait_ms": 21.833241777405473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007431183831166413, "StateBufferConnector_ms": 0.005110441628149, "ViewRequirementAgentConnector_ms": 0.11050559706607108}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 218000, "num_agent_steps_trained": 218000, "num_env_steps_sampled": 218000, "num_env_steps_trained": 218000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.617135533545515, "num_env_steps_trained_throughput_per_sec": 38.617135533545515, "timesteps_total": 218000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 218000, "timers": {"training_iteration_time_ms": 51150.158, "sample_time_ms": 48000.201, "load_time_ms": 11.572, "load_throughput": 172831.277, "learn_time_ms": 3135.815, "learn_throughput": 637.793, "synch_weights_time_ms": 2.154}, "counters": {"num_env_steps_sampled": 218000, "num_env_steps_trained": 218000, "num_agent_steps_sampled": 218000, "num_agent_steps_trained": 218000}, "done": false, "episodes_total": 13124, "training_iteration": 109, "trial_id": "13850_00002", "date": "2023-12-28_19-20-23", "timestamp": 1703762423, "time_this_iter_s": 51.79725170135498, "time_total_s": 5572.582341909409, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5572.582341909409, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 56.148648648648646, "ram_util_percent": 92.55000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.5125611106298224e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.010184284005728033, "policy_loss": 0.0040320209434462915, "vf_loss": 0.006152266360715859, "vf_explained_var": 0.9996742228666942, "kl": 0.0010554927287399693, "entropy": 0.03799076603104671, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 49275.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.213747645951035, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8120399920045395, "mean_inference_ms": 1.215442193709661, "mean_action_processing_ms": 0.10375549773508946, "mean_env_wait_ms": 21.83542198983344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007492606922731561, "StateBufferConnector_ms": 0.0049906261896683, "ViewRequirementAgentConnector_ms": 0.10963698564949682}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.213747645951035, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8120399920045395, "mean_inference_ms": 1.215442193709661, "mean_action_processing_ms": 0.10375549773508946, "mean_env_wait_ms": 21.83542198983344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007492606922731561, "StateBufferConnector_ms": 0.0049906261896683, "ViewRequirementAgentConnector_ms": 0.10963698564949682}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.748781843781, "num_env_steps_trained_throughput_per_sec": 38.748781843781, "timesteps_total": 220000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 51282.021, "sample_time_ms": 48126.808, "load_time_ms": 11.474, "load_throughput": 174300.045, "learn_time_ms": 3141.138, "learn_throughput": 636.712, "synch_weights_time_ms": 2.175}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 13242, "training_iteration": 110, "trial_id": "13850_00002", "date": "2023-12-28_19-21-15", "timestamp": 1703762475, "time_this_iter_s": 51.619866132736206, "time_total_s": 5624.202208042145, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5624.202208042145, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 56.04520547945205, "ram_util_percent": 92.70273972602742}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2562805553149112e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0014941344410181045, "policy_loss": -0.004640454898277919, "vf_loss": 0.006134588168416586, "vf_explained_var": 0.9996628186437819, "kl": 0.0005389411641815251, "entropy": 0.03587470471031136, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 49725.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 222000, "num_env_steps_trained": 222000, "num_agent_steps_sampled": 222000, "num_agent_steps_trained": 222000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.211301044634379, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8118808406161218, "mean_inference_ms": 1.2154006638399477, "mean_action_processing_ms": 0.10375918547573752, "mean_env_wait_ms": 21.834855195616296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073496093097915, "StateBufferConnector_ms": 0.005017794095552885, "ViewRequirementAgentConnector_ms": 0.10859884767450838}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.211301044634379, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8118808406161218, "mean_inference_ms": 1.2154006638399477, "mean_action_processing_ms": 0.10375918547573752, "mean_env_wait_ms": 21.834855195616296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073496093097915, "StateBufferConnector_ms": 0.005017794095552885, "ViewRequirementAgentConnector_ms": 0.10859884767450838}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222000, "num_agent_steps_trained": 222000, "num_env_steps_sampled": 222000, "num_env_steps_trained": 222000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.268808241350584, "num_env_steps_trained_throughput_per_sec": 39.268808241350584, "timesteps_total": 222000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 222000, "timers": {"training_iteration_time_ms": 51235.463, "sample_time_ms": 48081.127, "load_time_ms": 10.96, "load_throughput": 182481.243, "learn_time_ms": 3140.775, "learn_throughput": 636.786, "synch_weights_time_ms": 2.181}, "counters": {"num_env_steps_sampled": 222000, "num_env_steps_trained": 222000, "num_agent_steps_sampled": 222000, "num_agent_steps_trained": 222000}, "done": false, "episodes_total": 13359, "training_iteration": 111, "trial_id": "13850_00002", "date": "2023-12-28_19-22-06", "timestamp": 1703762526, "time_this_iter_s": 50.936150789260864, "time_total_s": 5675.138358831406, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5675.138358831406, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 55.67123287671233, "ram_util_percent": 92.67945205479454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.281402776574556e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.015307612700594796, "policy_loss": 0.006532843079831865, "vf_loss": 0.008774768787746629, "vf_explained_var": 0.9995129374663035, "kl": 0.0005365293905444745, "entropy": 0.03503094111051824, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 50175.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.202448210922789, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8116732618591522, "mean_inference_ms": 1.2152708628183593, "mean_action_processing_ms": 0.10375005947767685, "mean_env_wait_ms": 21.832357340046638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073659217963784425, "StateBufferConnector_ms": 0.004933850239899199, "ViewRequirementAgentConnector_ms": 0.10817798517518125}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.722222222222227, "episode_reward_mean": 15.202448210922789, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.722222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8116732618591522, "mean_inference_ms": 1.2152708628183593, "mean_action_processing_ms": 0.10375005947767685, "mean_env_wait_ms": 21.832357340046638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073659217963784425, "StateBufferConnector_ms": 0.004933850239899199, "ViewRequirementAgentConnector_ms": 0.10817798517518125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.65527184961511, "num_env_steps_trained_throughput_per_sec": 39.65527184961511, "timesteps_total": 224000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 51183.048, "sample_time_ms": 48031.532, "load_time_ms": 10.617, "load_throughput": 188375.97, "learn_time_ms": 3138.334, "learn_throughput": 637.281, "synch_weights_time_ms": 2.149}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 13477, "training_iteration": 112, "trial_id": "13850_00002", "date": "2023-12-28_19-22-56", "timestamp": 1703762576, "time_this_iter_s": 50.43962287902832, "time_total_s": 5725.577981710434, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5725.577981710434, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 55.93802816901409, "ram_util_percent": 92.59859154929583}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.140701388287278e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.013479210537754827, "policy_loss": 0.006667193203336663, "vf_loss": 0.006812013785044352, "vf_explained_var": 0.9996901211473677, "kl": 0.0005695669174938366, "entropy": 0.03286662380728457, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 50625.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 226000, "num_env_steps_trained": 226000, "num_agent_steps_sampled": 226000, "num_agent_steps_trained": 226000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.211864406779663, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8114682915519811, "mean_inference_ms": 1.215121683199072, "mean_action_processing_ms": 0.10374177016566113, "mean_env_wait_ms": 21.82937628184771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007351778321346994, "StateBufferConnector_ms": 0.004936678934905489, "ViewRequirementAgentConnector_ms": 0.10787147586628543}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.211864406779663, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8114682915519811, "mean_inference_ms": 1.215121683199072, "mean_action_processing_ms": 0.10374177016566113, "mean_env_wait_ms": 21.82937628184771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007351778321346994, "StateBufferConnector_ms": 0.004936678934905489, "ViewRequirementAgentConnector_ms": 0.10787147586628543}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226000, "num_agent_steps_trained": 226000, "num_env_steps_sampled": 226000, "num_env_steps_trained": 226000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.759002076257225, "num_env_steps_trained_throughput_per_sec": 39.759002076257225, "timesteps_total": 226000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 226000, "timers": {"training_iteration_time_ms": 51091.861, "sample_time_ms": 47942.636, "load_time_ms": 10.628, "load_throughput": 188177.782, "learn_time_ms": 3136.059, "learn_throughput": 637.743, "synch_weights_time_ms": 2.123}, "counters": {"num_env_steps_sampled": 226000, "num_env_steps_trained": 226000, "num_agent_steps_sampled": 226000, "num_agent_steps_trained": 226000}, "done": false, "episodes_total": 13595, "training_iteration": 113, "trial_id": "13850_00002", "date": "2023-12-28_19-23-47", "timestamp": 1703762627, "time_this_iter_s": 50.307780504226685, "time_total_s": 5775.885762214661, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5775.885762214661, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 55.87222222222223, "ram_util_percent": 92.6888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.570350694143639e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01495148272977935, "policy_loss": -0.01801800508879953, "vf_loss": 0.003066522606855465, "vf_explained_var": 0.9998149572478401, "kl": 0.09205639027536067, "entropy": 0.042672387605739964, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 51075.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 15.166666666666671, "episode_reward_mean": 15.219373219373223, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8112834255221468, "mean_inference_ms": 1.2149725159384874, "mean_action_processing_ms": 0.10373321741437834, "mean_env_wait_ms": 21.826830612606173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007342680906638121, "StateBufferConnector_ms": 0.004935468363965678, "ViewRequirementAgentConnector_ms": 0.10823184608394264}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 15.166666666666671, "episode_reward_mean": 15.219373219373223, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8112834255221468, "mean_inference_ms": 1.2149725159384874, "mean_action_processing_ms": 0.10373321741437834, "mean_env_wait_ms": 21.826830612606173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007342680906638121, "StateBufferConnector_ms": 0.004935468363965678, "ViewRequirementAgentConnector_ms": 0.10823184608394264}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.65488755737499, "num_env_steps_trained_throughput_per_sec": 39.65488755737499, "timesteps_total": 228000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 50941.733, "sample_time_ms": 47802.491, "load_time_ms": 10.474, "load_throughput": 190956.146, "learn_time_ms": 3126.239, "learn_throughput": 639.746, "synch_weights_time_ms": 2.116}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 13712, "training_iteration": 114, "trial_id": "13850_00002", "date": "2023-12-28_19-24-37", "timestamp": 1703762677, "time_this_iter_s": 50.440306186676025, "time_total_s": 5826.326068401337, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5826.326068401337, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 55.82777777777777, "ram_util_percent": 92.68333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.355526041215457e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.12732734072539542, "policy_loss": -0.02435515485703945, "vf_loss": 0.151682494332393, "vf_explained_var": 0.9917954415745205, "kl": 0.021201489949211054, "entropy": 0.05673792620499929, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 51525.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 230000, "num_env_steps_trained": 230000, "num_agent_steps_sampled": 230000, "num_agent_steps_trained": 230000}, "sampler_results": {"episode_reward_max": 14.833333333333337, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 14.539814814814816, "episode_len_mean": 16.75, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.888888888888893, 14.722222222222227, 14.722222222222227, 13.888888888888893, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.722222222222227, 13.888888888888893, 14.722222222222227, 14.777777777777782, 14.722222222222227, 13.888888888888893, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 13.888888888888893, 14.777777777777782, 14.777777777777782, 13.888888888888893, 13.888888888888893, 13.888888888888893, 14.777777777777782, 14.777777777777782, 14.777777777777782, 13.888888888888893, 13.888888888888893, 13.888888888888893, 14.833333333333337, 13.888888888888893, 14.722222222222227, 14.777777777777782, 14.777777777777782, 13.888888888888893, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 13.888888888888893, 14.777777777777782, 14.777777777777782, 14.777777777777782, 13.888888888888893, 14.722222222222227, 14.722222222222227, 13.888888888888893, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.722222222222227, 13.888888888888893, 14.722222222222227, 14.777777777777782, 13.888888888888893, 13.888888888888893, 14.777777777777782, 14.722222222222227, 13.888888888888893, 13.888888888888893, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.722222222222227, 13.888888888888893, 14.722222222222227, 14.777777777777782, 14.722222222222227, 14.777777777777782, 13.888888888888893, 14.777777777777782, 13.888888888888893, 14.722222222222227, 13.888888888888893, 14.777777777777782, 14.777777777777782, 13.888888888888893, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.722222222222227, 14.722222222222227, 14.777777777777782, 13.888888888888893, 14.722222222222227, 14.777777777777782, 13.888888888888893, 13.888888888888893, 13.888888888888893, 14.722222222222227, 14.777777777777782, 14.777777777777782], "episode_lengths": [16, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 16, 16, 16, 17, 17, 17, 16, 16, 16, 17, 16, 17, 17, 17, 16, 17, 17, 17, 17, 16, 17, 17, 17, 16, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 16, 16, 17, 17, 16, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 16, 17, 16, 17, 16, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 16, 16, 16, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8113065420375967, "mean_inference_ms": 1.2149915228265225, "mean_action_processing_ms": 0.10374249569481903, "mean_env_wait_ms": 21.828568147938466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007469852765401204, "StateBufferConnector_ms": 0.004926323890686035, "ViewRequirementAgentConnector_ms": 0.10914822419484456}}, "episode_reward_max": 14.833333333333337, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 14.539814814814816, "episode_len_mean": 16.75, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.888888888888893, 14.722222222222227, 14.722222222222227, 13.888888888888893, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.722222222222227, 13.888888888888893, 14.722222222222227, 14.777777777777782, 14.722222222222227, 13.888888888888893, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 13.888888888888893, 14.777777777777782, 14.777777777777782, 13.888888888888893, 13.888888888888893, 13.888888888888893, 14.777777777777782, 14.777777777777782, 14.777777777777782, 13.888888888888893, 13.888888888888893, 13.888888888888893, 14.833333333333337, 13.888888888888893, 14.722222222222227, 14.777777777777782, 14.777777777777782, 13.888888888888893, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 13.888888888888893, 14.777777777777782, 14.777777777777782, 14.777777777777782, 13.888888888888893, 14.722222222222227, 14.722222222222227, 13.888888888888893, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.722222222222227, 13.888888888888893, 14.722222222222227, 14.777777777777782, 13.888888888888893, 13.888888888888893, 14.777777777777782, 14.722222222222227, 13.888888888888893, 13.888888888888893, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.722222222222227, 13.888888888888893, 14.722222222222227, 14.777777777777782, 14.722222222222227, 14.777777777777782, 13.888888888888893, 14.777777777777782, 13.888888888888893, 14.722222222222227, 13.888888888888893, 14.777777777777782, 14.777777777777782, 13.888888888888893, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.722222222222227, 14.722222222222227, 14.777777777777782, 13.888888888888893, 14.722222222222227, 14.777777777777782, 13.888888888888893, 13.888888888888893, 13.888888888888893, 14.722222222222227, 14.777777777777782, 14.777777777777782], "episode_lengths": [16, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 16, 16, 16, 17, 17, 17, 16, 16, 16, 17, 16, 17, 17, 17, 16, 17, 17, 17, 17, 16, 17, 17, 17, 16, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 16, 16, 17, 17, 16, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 16, 17, 16, 17, 16, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 16, 16, 16, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8113065420375967, "mean_inference_ms": 1.2149915228265225, "mean_action_processing_ms": 0.10374249569481903, "mean_env_wait_ms": 21.828568147938466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007469852765401204, "StateBufferConnector_ms": 0.004926323890686035, "ViewRequirementAgentConnector_ms": 0.10914822419484456}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230000, "num_agent_steps_trained": 230000, "num_env_steps_sampled": 230000, "num_env_steps_trained": 230000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.81983105888117, "num_env_steps_trained_throughput_per_sec": 38.81983105888117, "timesteps_total": 230000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 230000, "timers": {"training_iteration_time_ms": 50988.727, "sample_time_ms": 47849.528, "load_time_ms": 9.513, "load_throughput": 210235.006, "learn_time_ms": 3127.159, "learn_throughput": 639.558, "synch_weights_time_ms": 2.113}, "counters": {"num_env_steps_sampled": 230000, "num_env_steps_trained": 230000, "num_agent_steps_sampled": 230000, "num_agent_steps_trained": 230000}, "done": false, "episodes_total": 13832, "training_iteration": 115, "trial_id": "13850_00002", "date": "2023-12-28_19-25-29", "timestamp": 1703762729, "time_this_iter_s": 51.52630424499512, "time_total_s": 5877.852372646332, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5877.852372646332, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 55.87397260273973, "ram_util_percent": 92.62465753424658}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.5332890618231855e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.013107457641098235, "policy_loss": -0.01827882968717151, "vf_loss": 0.031386291566822266, "vf_explained_var": 0.998193652232488, "kl": 0.09021791756874625, "entropy": 0.06467065529690849, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "sampler_results": {"episode_reward_max": 14.777777777777782, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 14.743589743589746, "episode_len_mean": 16.974358974358974, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 13.888888888888893, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 13.888888888888893, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.722222222222227, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 13.888888888888893, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8110496486170689, "mean_inference_ms": 1.2148159790578388, "mean_action_processing_ms": 0.10372802402760851, "mean_env_wait_ms": 21.825741317977062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007287661234537761, "StateBufferConnector_ms": 0.0049293550670656385, "ViewRequirementAgentConnector_ms": 0.10775826935075287}}, "episode_reward_max": 14.777777777777782, "episode_reward_min": 13.888888888888893, "episode_reward_mean": 14.743589743589746, "episode_len_mean": 16.974358974358974, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 13.888888888888893, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 13.888888888888893, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.722222222222227, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 13.888888888888893, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.722222222222227, 14.777777777777782, 14.777777777777782], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8110496486170689, "mean_inference_ms": 1.2148159790578388, "mean_action_processing_ms": 0.10372802402760851, "mean_env_wait_ms": 21.825741317977062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007287661234537761, "StateBufferConnector_ms": 0.0049293550670656385, "ViewRequirementAgentConnector_ms": 0.10775826935075287}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.777056935416496, "num_env_steps_trained_throughput_per_sec": 39.777056935416496, "timesteps_total": 232000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 50882.405, "sample_time_ms": 47752.73, "load_time_ms": 9.514, "load_throughput": 210221.835, "learn_time_ms": 3117.624, "learn_throughput": 641.514, "synch_weights_time_ms": 2.122}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "episodes_total": 13949, "training_iteration": 116, "trial_id": "13850_00002", "date": "2023-12-28_19-26-19", "timestamp": 1703762779, "time_this_iter_s": 50.29208707809448, "time_total_s": 5928.144459724426, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5928.144459724426, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 55.861111111111114, "ram_util_percent": 92.55833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.299933592734781e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03898173791252905, "policy_loss": -0.004418721728854709, "vf_loss": 0.043400459366126194, "vf_explained_var": 0.9978687618838417, "kl": 0.015753961760857516, "entropy": 0.053041278819243115, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 52425.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.078154425612054, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8109290698827419, "mean_inference_ms": 1.2147653427947938, "mean_action_processing_ms": 0.10371977342269305, "mean_env_wait_ms": 21.825177751616188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007499880709890592, "StateBufferConnector_ms": 0.005081548529156184, "ViewRequirementAgentConnector_ms": 0.10856854713569253}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.078154425612054, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8109290698827419, "mean_inference_ms": 1.2147653427947938, "mean_action_processing_ms": 0.10371977342269305, "mean_env_wait_ms": 21.825177751616188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007499880709890592, "StateBufferConnector_ms": 0.005081548529156184, "ViewRequirementAgentConnector_ms": 0.10856854713569253}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 39.20680272665886, "num_env_steps_trained_throughput_per_sec": 39.20680272665886, "timesteps_total": 234000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 234000, "timers": {"training_iteration_time_ms": 50860.161, "sample_time_ms": 47719.774, "load_time_ms": 9.688, "load_throughput": 206445.109, "learn_time_ms": 3128.139, "learn_throughput": 639.358, "synch_weights_time_ms": 2.135}, "counters": {"num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "done": false, "episodes_total": 14067, "training_iteration": 117, "trial_id": "13850_00002", "date": "2023-12-28_19-27-10", "timestamp": 1703762830, "time_this_iter_s": 51.01782536506653, "time_total_s": 5979.162285089493, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5979.162285089493, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 56.07777777777778, "ram_util_percent": 92.60555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.299933592734781e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.01777146385775672, "policy_loss": -0.0024727955791685316, "vf_loss": 0.020244259002825452, "vf_explained_var": 0.9989029896259308, "kl": 0.005407736722019371, "entropy": 0.038622011811369, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 52875.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.171374764595106, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8108639656386392, "mean_inference_ms": 1.2147889105000877, "mean_action_processing_ms": 0.10372625260086772, "mean_env_wait_ms": 21.826960230372116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007441286313331733, "StateBufferConnector_ms": 0.0049805237075029795, "ViewRequirementAgentConnector_ms": 0.10921510599427305}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.171374764595106, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8108639656386392, "mean_inference_ms": 1.2147889105000877, "mean_action_processing_ms": 0.10372625260086772, "mean_env_wait_ms": 21.826960230372116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007441286313331733, "StateBufferConnector_ms": 0.0049805237075029795, "ViewRequirementAgentConnector_ms": 0.10921510599427305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.84005624899313, "num_env_steps_trained_throughput_per_sec": 38.84005624899313, "timesteps_total": 236000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 50981.373, "sample_time_ms": 47842.186, "load_time_ms": 11.268, "load_throughput": 177487.845, "learn_time_ms": 3125.351, "learn_throughput": 639.928, "synch_weights_time_ms": 2.137}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "episodes_total": 14185, "training_iteration": 118, "trial_id": "13850_00002", "date": "2023-12-28_19-28-01", "timestamp": 1703762881, "time_this_iter_s": 51.4986047744751, "time_total_s": 6030.660889863968, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6030.660889863968, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 56.06849315068494, "ram_util_percent": 92.6178082191781}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.299933592734781e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.016054132945007748, "policy_loss": 0.0070362708138095005, "vf_loss": 0.009017859102330274, "vf_explained_var": 0.999534149699741, "kl": 0.0017300038744570835, "entropy": 0.031246787802212767, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 53325.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 238000, "num_env_steps_trained": 238000, "num_agent_steps_sampled": 238000, "num_agent_steps_trained": 238000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.204178537511874, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8105948944237974, "mean_inference_ms": 1.2145855874161886, "mean_action_processing_ms": 0.10370585500304189, "mean_env_wait_ms": 21.82269353725251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007272989321977665, "StateBufferConnector_ms": 0.004904494326338809, "ViewRequirementAgentConnector_ms": 0.10744119301820412}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.204178537511874, "episode_len_mean": 17.0, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8105948944237974, "mean_inference_ms": 1.2145855874161886, "mean_action_processing_ms": 0.10370585500304189, "mean_env_wait_ms": 21.82269353725251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007272989321977665, "StateBufferConnector_ms": 0.004904494326338809, "ViewRequirementAgentConnector_ms": 0.10744119301820412}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 238000, "num_agent_steps_trained": 238000, "num_env_steps_sampled": 238000, "num_env_steps_trained": 238000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 40.07050407209195, "num_env_steps_trained_throughput_per_sec": 40.07050407209195, "timesteps_total": 238000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 238000, "timers": {"training_iteration_time_ms": 50793.527, "sample_time_ms": 47665.793, "load_time_ms": 10.142, "load_throughput": 197198.054, "learn_time_ms": 3115.036, "learn_throughput": 642.047, "synch_weights_time_ms": 2.127}, "counters": {"num_env_steps_sampled": 238000, "num_env_steps_trained": 238000, "num_agent_steps_sampled": 238000, "num_agent_steps_trained": 238000}, "done": false, "episodes_total": 14302, "training_iteration": 119, "trial_id": "13850_00002", "date": "2023-12-28_19-28-51", "timestamp": 1703762931, "time_this_iter_s": 49.917508363723755, "time_total_s": 6080.578398227692, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6080.578398227692, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 55.73239436619719, "ram_util_percent": 92.60985915492961}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.6499667963673905e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.001480001455379857, "policy_loss": -0.0033136435680919223, "vf_loss": 0.004793644016608596, "vf_explained_var": 0.9997541161378225, "kl": 0.0008365835806113056, "entropy": 0.029176024848388302, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 53775.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.216572504708099, "episode_len_mean": 17.0, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8105767838106085, "mean_inference_ms": 1.2146844230535292, "mean_action_processing_ms": 0.10371574757955977, "mean_env_wait_ms": 21.823390713398684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007664349119542009, "StateBufferConnector_ms": 0.0050409365508515954, "ViewRequirementAgentConnector_ms": 0.11073249881550418}}, "episode_reward_max": 15.222222222222227, "episode_reward_min": 14.777777777777782, "episode_reward_mean": 15.216572504708099, "episode_len_mean": 17.0, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 14.777777777777782, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.166666666666671, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227, 15.222222222222227], "episode_lengths": [17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8105767838106085, "mean_inference_ms": 1.2146844230535292, "mean_action_processing_ms": 0.10371574757955977, "mean_env_wait_ms": 21.823390713398684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007664349119542009, "StateBufferConnector_ms": 0.0050409365508515954, "ViewRequirementAgentConnector_ms": 0.11073249881550418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 38.974988062451935, "num_env_steps_trained_throughput_per_sec": 38.974988062451935, "timesteps_total": 240000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 50763.571, "sample_time_ms": 47632.865, "load_time_ms": 11.203, "load_throughput": 178521.284, "learn_time_ms": 3116.947, "learn_throughput": 641.653, "synch_weights_time_ms": 2.13}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 14420, "training_iteration": 120, "trial_id": "13850_00002", "date": "2023-12-28_19-29-43", "timestamp": 1703762983, "time_this_iter_s": 51.3202919960022, "time_total_s": 6131.898690223694, "pid": 390997, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "merge-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6131.898690223694, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 60.2554054054054, "ram_util_percent": 92.63648648648649}}
