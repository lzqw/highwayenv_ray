{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.920595453050401, "policy_loss": -0.024150700138674843, "vf_loss": 6.941010975307888, "vf_explained_var": -0.0016467273235321045, "kl": 0.0186758064390512, "entropy": 1.5910885620117188, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 2000}, "sampler_results": {"episode_reward_max": 34.842147520737385, "episode_reward_min": 1.0877861133268076, "episode_reward_mean": 10.705795146566409, "episode_len_mean": 14.04225352112676, "episode_media": {}, "episodes_this_iter": 142, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0707941835607757, 7.835494730352856, 2.7779962648306116, 4.1156702046773095, 7.525902232323009, 3.597160683315191, 13.76992976176067, 4.66111567745266, 10.329396570931062, 7.174629417286612, 9.047236994343558, 8.025002612231006, 28.28414126572013, 28.77937078173382, 15.723123260940731, 4.984586384463212, 17.89043731979073, 21.238613730810997, 10.149681984960083, 10.007417150910108, 5.334531555204204, 4.269186980461662, 3.9950297255724436, 29.35157371078551, 4.881330053872486, 16.658933100973307, 18.058913757764795, 22.899035308444827, 2.890203476935584, 9.814894362313375, 9.508123696153834, 11.21914499322325, 21.387020786291288, 3.9064383104956026, 4.704637904249683, 1.0877861133268076, 9.462064588666568, 1.9288767524409185, 29.343123274637897, 16.35560863651017, 17.76239309959162, 6.7471894335782014, 21.79884004684128, 5.349085666630725, 11.867952431317041, 5.748016164036988, 10.404319437781723, 6.558989553183909, 2.422222222222222, 3.3090492901063198, 11.415424628742251, 17.114603622331213, 9.57843158745817, 2.6855933171709756, 4.726838120998127, 15.63810987196885, 27.483572108079102, 12.279376487001596, 13.080510325764017, 4.505875434767673, 11.50118466873928, 29.858042272369143, 2.7051592898915717, 9.505116341949725, 27.22208306692321, 4.624360894298636, 3.4398936708442798, 1.9498675727291594, 3.071376672754629, 2.4667691793404503, 6.438779968641407, 3.351731945086972, 9.554814916287864, 7.241975388522118, 1.6194962758014368, 13.640737635169195, 10.778860537137335, 7.110548235383183, 5.904376489490645, 12.815991553244682, 5.594744892459641, 9.287769880677178, 13.46140755814465, 5.708408459171861, 7.685503114532329, 7.5505193730824, 3.726977536536894, 3.405121969294129, 17.997101717706816, 16.526642889783556, 14.54656999573313, 8.909658912806426, 12.289527552381895, 17.95597085778642, 30.337812662473848, 1.9294396281688484, 30.322062481846586, 3.6892768160180665, 5.784841518366099, 7.383032320704783, 2.687786113326808, 23.040158014852114, 7.129893837742014, 33.65374660993724, 5.979541743188415, 6.198479761023242, 31.84668434292429, 9.234933338017436, 4.547579105264135, 5.152082847533422, 9.971123826775326, 3.951048399364308, 5.8362575668152505, 29.44320711036762, 11.4967467199087, 5.636719277922455, 7.084013477237793, 10.861212471615639, 4.176066317711901, 1.884432307996474, 13.403829649100683, 2.7066545302186964, 6.2392821962374985, 20.0353748219453, 8.92533480092427, 1.5768365664112174, 34.842147520737385, 2.5300857313387777, 9.326596551079543, 7.637690391627058, 2.4616388834985026, 4.505969710620062, 2.9349002571866993, 13.165872520343667, 6.504170191392204, 1.8892207039275584, 4.23995928062851, 30.176022056651572, 26.394734351115115, 8.975745733646148, 8.156281629039626, 28.368741682663565], "episode_lengths": [4, 10, 4, 6, 9, 5, 19, 7, 12, 10, 13, 12, 39, 40, 17, 7, 22, 25, 14, 12, 8, 6, 6, 40, 6, 18, 25, 31, 4, 13, 11, 15, 27, 5, 6, 2, 13, 3, 40, 21, 21, 9, 29, 7, 16, 7, 12, 8, 4, 5, 16, 22, 13, 4, 6, 20, 38, 14, 18, 6, 14, 40, 4, 13, 39, 7, 5, 3, 4, 4, 9, 5, 13, 10, 3, 18, 15, 9, 7, 16, 7, 13, 17, 8, 11, 10, 5, 6, 24, 21, 17, 11, 16, 24, 40, 3, 40, 5, 7, 11, 4, 29, 9, 40, 9, 8, 40, 11, 6, 7, 12, 5, 8, 40, 15, 7, 10, 14, 6, 3, 16, 4, 9, 26, 10, 3, 40, 4, 11, 9, 4, 6, 4, 17, 9, 3, 6, 40, 37, 10, 9, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4746911164702683, "mean_inference_ms": 1.2212238092532106, "mean_action_processing_ms": 0.1064700403551886, "mean_env_wait_ms": 315.14273352291747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007406422789667693, "StateBufferConnector_ms": 0.0066915028531786425, "ViewRequirementAgentConnector_ms": 0.11469394388333173}}, "episode_reward_max": 34.842147520737385, "episode_reward_min": 1.0877861133268076, "episode_reward_mean": 10.705795146566409, "episode_len_mean": 14.04225352112676, "episodes_this_iter": 142, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.0707941835607757, 7.835494730352856, 2.7779962648306116, 4.1156702046773095, 7.525902232323009, 3.597160683315191, 13.76992976176067, 4.66111567745266, 10.329396570931062, 7.174629417286612, 9.047236994343558, 8.025002612231006, 28.28414126572013, 28.77937078173382, 15.723123260940731, 4.984586384463212, 17.89043731979073, 21.238613730810997, 10.149681984960083, 10.007417150910108, 5.334531555204204, 4.269186980461662, 3.9950297255724436, 29.35157371078551, 4.881330053872486, 16.658933100973307, 18.058913757764795, 22.899035308444827, 2.890203476935584, 9.814894362313375, 9.508123696153834, 11.21914499322325, 21.387020786291288, 3.9064383104956026, 4.704637904249683, 1.0877861133268076, 9.462064588666568, 1.9288767524409185, 29.343123274637897, 16.35560863651017, 17.76239309959162, 6.7471894335782014, 21.79884004684128, 5.349085666630725, 11.867952431317041, 5.748016164036988, 10.404319437781723, 6.558989553183909, 2.422222222222222, 3.3090492901063198, 11.415424628742251, 17.114603622331213, 9.57843158745817, 2.6855933171709756, 4.726838120998127, 15.63810987196885, 27.483572108079102, 12.279376487001596, 13.080510325764017, 4.505875434767673, 11.50118466873928, 29.858042272369143, 2.7051592898915717, 9.505116341949725, 27.22208306692321, 4.624360894298636, 3.4398936708442798, 1.9498675727291594, 3.071376672754629, 2.4667691793404503, 6.438779968641407, 3.351731945086972, 9.554814916287864, 7.241975388522118, 1.6194962758014368, 13.640737635169195, 10.778860537137335, 7.110548235383183, 5.904376489490645, 12.815991553244682, 5.594744892459641, 9.287769880677178, 13.46140755814465, 5.708408459171861, 7.685503114532329, 7.5505193730824, 3.726977536536894, 3.405121969294129, 17.997101717706816, 16.526642889783556, 14.54656999573313, 8.909658912806426, 12.289527552381895, 17.95597085778642, 30.337812662473848, 1.9294396281688484, 30.322062481846586, 3.6892768160180665, 5.784841518366099, 7.383032320704783, 2.687786113326808, 23.040158014852114, 7.129893837742014, 33.65374660993724, 5.979541743188415, 6.198479761023242, 31.84668434292429, 9.234933338017436, 4.547579105264135, 5.152082847533422, 9.971123826775326, 3.951048399364308, 5.8362575668152505, 29.44320711036762, 11.4967467199087, 5.636719277922455, 7.084013477237793, 10.861212471615639, 4.176066317711901, 1.884432307996474, 13.403829649100683, 2.7066545302186964, 6.2392821962374985, 20.0353748219453, 8.92533480092427, 1.5768365664112174, 34.842147520737385, 2.5300857313387777, 9.326596551079543, 7.637690391627058, 2.4616388834985026, 4.505969710620062, 2.9349002571866993, 13.165872520343667, 6.504170191392204, 1.8892207039275584, 4.23995928062851, 30.176022056651572, 26.394734351115115, 8.975745733646148, 8.156281629039626, 28.368741682663565], "episode_lengths": [4, 10, 4, 6, 9, 5, 19, 7, 12, 10, 13, 12, 39, 40, 17, 7, 22, 25, 14, 12, 8, 6, 6, 40, 6, 18, 25, 31, 4, 13, 11, 15, 27, 5, 6, 2, 13, 3, 40, 21, 21, 9, 29, 7, 16, 7, 12, 8, 4, 5, 16, 22, 13, 4, 6, 20, 38, 14, 18, 6, 14, 40, 4, 13, 39, 7, 5, 3, 4, 4, 9, 5, 13, 10, 3, 18, 15, 9, 7, 16, 7, 13, 17, 8, 11, 10, 5, 6, 24, 21, 17, 11, 16, 24, 40, 3, 40, 5, 7, 11, 4, 29, 9, 40, 9, 8, 40, 11, 6, 7, 12, 5, 8, 40, 15, 7, 10, 14, 6, 3, 16, 4, 9, 26, 10, 3, 40, 4, 11, 9, 4, 6, 4, 17, 9, 3, 6, 40, 37, 10, 9, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4746911164702683, "mean_inference_ms": 1.2212238092532106, "mean_action_processing_ms": 0.1064700403551886, "mean_env_wait_ms": 315.14273352291747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007406422789667693, "StateBufferConnector_ms": 0.0066915028531786425, "ViewRequirementAgentConnector_ms": 0.11469394388333173}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 2000, "num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 3.1250813473236354, "num_env_steps_trained_throughput_per_sec": 3.1250813473236354, "timesteps_total": 2000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 2000, "timers": {"training_iteration_time_ms": 639983.305, "sample_time_ms": 636264.281, "load_time_ms": 16.046, "load_throughput": 124644.993, "learn_time_ms": 3699.905, "learn_throughput": 540.554, "synch_weights_time_ms": 2.444}, "counters": {"num_env_steps_sampled": 2000, "num_env_steps_trained": 2000, "num_agent_steps_sampled": 2000, "num_agent_steps_trained": 2000}, "done": false, "episodes_total": 142, "training_iteration": 1, "trial_id": "13850_00000", "date": "2023-12-28_17-58-09", "timestamp": 1703757489, "time_this_iter_s": 639.9896500110626, "time_total_s": 639.9896500110626, "pid": 390995, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 639.9896500110626, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 55.95137211855104, "ram_util_percent": 92.07639956092207}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.571882294548883, "policy_loss": -0.002968164376086659, "vf_loss": 7.569528682496813, "vf_explained_var": 0.0027768524487813313, "kl": 0.026608758678764086, "entropy": 1.522067649629381, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 675.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 32.145370715141304, "episode_reward_min": 1.1849092732318491, "episode_reward_mean": 13.37070378004156, "episode_len_mean": 18.091743119266056, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.239935827402377, 4.688055331784458, 4.4, 27.635260319952042, 4.598646061958809, 3.3097282106435357, 7.3307455098380245, 3.704493901481596, 10.160813983658851, 11.614333649013506, 3.86733205506838, 12.079915584128045, 29.551466604488418, 3.5100757377802903, 15.889567212751208, 26.839883127502425, 11.50663885536199, 10.792436194440215, 4.578576304425722, 5.780480717236776, 2.511111111111111, 28.216590804287968, 13.235448161517935, 7.143657671028245, 3.1122009181233854, 13.882953440764428, 12.546871268503624, 5.885782265387564, 31.25892613803005, 18.876906318851212, 10.32899045880187, 1.2387564616180482, 3.4751747514432396, 29.23741736238555, 30.39980521185242, 2.9326679449316204, 28.72577119457928, 9.180484603285727, 2.9047516238022855, 13.283105157260596, 13.15796203792147, 29.421787116308998, 11.731853296622713, 6.024724906872123, 9.996557329161119, 12.420934285635427, 12.690837966555938, 20.59200415463446, 5.891564980920808, 11.392762249824866, 24.332800824900882, 3.3813770484928014, 2.4, 1.5116739868390408, 19.816951179652815, 2.8609786838402704, 30.4201341721984, 29.065586786605017, 20.56922767089565, 1.2293537176762936, 5.640630905794833, 29.52045257718352, 6.799818820963472, 2.7497562821195674, 1.9894089804856738, 10.703776613632224, 28.091098200776518, 1.8622100857742518, 4.884392183185227, 10.971723418046276, 16.321430547929094, 29.464698635607167, 4.56131174565297, 20.243386614388015, 14.575924306557763, 29.662179689060967, 1.665179213024727, 10.52823411248336, 4.600148870713803, 20.37768079351242, 29.043504130653805, 14.92583392793852, 10.238497030308451, 31.151923082995282, 9.773548394590435, 12.20525911248793, 2.5516618503910706, 9.461863652482684, 1.8192543375519885, 27.17072475596751, 22.127831816048616, 30.643884330105692, 6.6709518052369745, 28.29414399642926, 29.5364313847796, 14.994051304365827, 3.536017033391193, 1.7516618503910704, 6.303699932369721, 1.1849092732318491, 30.236749448519703, 26.557277998987427, 2.642033312190006, 6.065956859095204, 5.687251806300873, 29.08504156435521, 15.954721477382035, 32.145370715141304, 3.0683827919068696], "episode_lengths": [25, 7, 6, 37, 7, 5, 11, 5, 14, 15, 6, 14, 40, 5, 21, 37, 16, 13, 7, 9, 4, 35, 16, 9, 5, 17, 17, 8, 40, 26, 15, 2, 5, 40, 40, 4, 36, 14, 4, 17, 19, 40, 16, 9, 14, 18, 19, 28, 9, 14, 32, 5, 4, 3, 28, 4, 40, 40, 29, 2, 8, 38, 8, 4, 3, 12, 40, 3, 7, 14, 22, 40, 6, 29, 20, 40, 3, 13, 6, 27, 40, 21, 13, 40, 12, 17, 4, 12, 3, 38, 31, 40, 9, 40, 40, 21, 6, 3, 8, 2, 40, 37, 4, 8, 7, 40, 21, 40, 5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3340319791039177, "mean_inference_ms": 1.2085434795170842, "mean_action_processing_ms": 0.10554184469095737, "mean_env_wait_ms": 315.2171954069399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007659142170477351, "StateBufferConnector_ms": 0.006331435037315439, "ViewRequirementAgentConnector_ms": 0.11200620493757615}}, "episode_reward_max": 32.145370715141304, "episode_reward_min": 1.1849092732318491, "episode_reward_mean": 13.37070378004156, "episode_len_mean": 18.091743119266056, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.239935827402377, 4.688055331784458, 4.4, 27.635260319952042, 4.598646061958809, 3.3097282106435357, 7.3307455098380245, 3.704493901481596, 10.160813983658851, 11.614333649013506, 3.86733205506838, 12.079915584128045, 29.551466604488418, 3.5100757377802903, 15.889567212751208, 26.839883127502425, 11.50663885536199, 10.792436194440215, 4.578576304425722, 5.780480717236776, 2.511111111111111, 28.216590804287968, 13.235448161517935, 7.143657671028245, 3.1122009181233854, 13.882953440764428, 12.546871268503624, 5.885782265387564, 31.25892613803005, 18.876906318851212, 10.32899045880187, 1.2387564616180482, 3.4751747514432396, 29.23741736238555, 30.39980521185242, 2.9326679449316204, 28.72577119457928, 9.180484603285727, 2.9047516238022855, 13.283105157260596, 13.15796203792147, 29.421787116308998, 11.731853296622713, 6.024724906872123, 9.996557329161119, 12.420934285635427, 12.690837966555938, 20.59200415463446, 5.891564980920808, 11.392762249824866, 24.332800824900882, 3.3813770484928014, 2.4, 1.5116739868390408, 19.816951179652815, 2.8609786838402704, 30.4201341721984, 29.065586786605017, 20.56922767089565, 1.2293537176762936, 5.640630905794833, 29.52045257718352, 6.799818820963472, 2.7497562821195674, 1.9894089804856738, 10.703776613632224, 28.091098200776518, 1.8622100857742518, 4.884392183185227, 10.971723418046276, 16.321430547929094, 29.464698635607167, 4.56131174565297, 20.243386614388015, 14.575924306557763, 29.662179689060967, 1.665179213024727, 10.52823411248336, 4.600148870713803, 20.37768079351242, 29.043504130653805, 14.92583392793852, 10.238497030308451, 31.151923082995282, 9.773548394590435, 12.20525911248793, 2.5516618503910706, 9.461863652482684, 1.8192543375519885, 27.17072475596751, 22.127831816048616, 30.643884330105692, 6.6709518052369745, 28.29414399642926, 29.5364313847796, 14.994051304365827, 3.536017033391193, 1.7516618503910704, 6.303699932369721, 1.1849092732318491, 30.236749448519703, 26.557277998987427, 2.642033312190006, 6.065956859095204, 5.687251806300873, 29.08504156435521, 15.954721477382035, 32.145370715141304, 3.0683827919068696], "episode_lengths": [25, 7, 6, 37, 7, 5, 11, 5, 14, 15, 6, 14, 40, 5, 21, 37, 16, 13, 7, 9, 4, 35, 16, 9, 5, 17, 17, 8, 40, 26, 15, 2, 5, 40, 40, 4, 36, 14, 4, 17, 19, 40, 16, 9, 14, 18, 19, 28, 9, 14, 32, 5, 4, 3, 28, 4, 40, 40, 29, 2, 8, 38, 8, 4, 3, 12, 40, 3, 7, 14, 22, 40, 6, 29, 20, 40, 3, 13, 6, 27, 40, 21, 13, 40, 12, 17, 4, 12, 3, 38, 31, 40, 9, 40, 40, 21, 6, 3, 8, 2, 40, 37, 4, 8, 7, 40, 21, 40, 5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3340319791039177, "mean_inference_ms": 1.2085434795170842, "mean_action_processing_ms": 0.10554184469095737, "mean_env_wait_ms": 315.2171954069399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007659142170477351, "StateBufferConnector_ms": 0.006331435037315439, "ViewRequirementAgentConnector_ms": 0.11200620493757615}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 3.131019505556221, "num_env_steps_trained_throughput_per_sec": 3.131019505556221, "timesteps_total": 4000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 639376.429, "sample_time_ms": 635944.252, "load_time_ms": 13.134, "load_throughput": 152276.503, "learn_time_ms": 3416.223, "learn_throughput": 585.442, "synch_weights_time_ms": 2.271}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 251, "training_iteration": 2, "trial_id": "13850_00000", "date": "2023-12-28_18-08-48", "timestamp": 1703758128, "time_this_iter_s": 638.7751793861389, "time_total_s": 1278.7648293972015, "pid": 390995, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1278.7648293972015, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 55.98976897689769, "ram_util_percent": 92.72134213421343}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.070671883689032, "policy_loss": -0.04561556466751628, "vf_loss": 8.108957088258531, "vf_explained_var": 0.0021781933307647703, "kl": 0.024434523696793508, "entropy": 1.4047274865044488, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1125.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 6000}, "sampler_results": {"episode_reward_max": 32.145370715141304, "episode_reward_min": 1.1849092732318491, "episode_reward_mean": 18.281189277438756, "episode_len_mean": 24.95, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.773548394590435, 12.20525911248793, 2.5516618503910706, 9.461863652482684, 1.8192543375519885, 27.17072475596751, 22.127831816048616, 30.643884330105692, 6.6709518052369745, 28.29414399642926, 29.5364313847796, 14.994051304365827, 3.536017033391193, 1.7516618503910704, 6.303699932369721, 1.1849092732318491, 30.236749448519703, 26.557277998987427, 2.642033312190006, 6.065956859095204, 5.687251806300873, 29.08504156435521, 15.954721477382035, 32.145370715141304, 3.0683827919068696, 31.768491404873448, 6.259676538323936, 9.774503603911938, 11.358043388511762, 29.95310564258001, 21.395167909295346, 6.630969044192588, 29.877899030232413, 28.536700185422077, 28.421223718118423, 25.66620086483747, 9.46690233515922, 28.06765286230026, 4.975816416487291, 20.483037173749395, 19.816065815476414, 31.215818121122613, 29.402241179703392, 21.35134364816153, 29.618742999772383, 27.348363895841985, 30.667928548835334, 14.555774943568228, 8.669223309629546, 18.70857649988311, 28.160814667943843, 4.175361355777463, 15.06081722537681, 7.44060889879726, 28.913797287903595, 3.47121394293265, 29.109636024168104, 20.954072139044975, 30.00449883403483, 4.528641101520905, 7.35800868266699, 5.879961245472573, 6.46664095098806, 30.190750657218135, 6.579880338106242, 15.285547758525613, 27.53859242585177, 4.578910632359021, 30.154191777052805, 3.0491172450599526, 29.73436512064353, 5.420172622504875, 14.442669552470155, 10.594212065205692, 30.549913929108065, 1.6232435593241463, 7.983036773326214, 27.913715503972643, 28.665242202905254, 5.1533853021243505, 5.065984162754994, 27.382242116233048, 29.692744500676614, 19.33504757757003, 28.157227848827127, 29.240350262596852, 26.863307486217682, 7.847617704438965, 31.160700279344262, 29.40245314223192, 30.99818773589443, 28.356086079219093, 28.647106972479698, 11.780972016393399, 26.905791756613624, 29.42397352405991, 30.025260191348035, 18.31857554410805, 24.99700066033218, 10.079128476459266], "episode_lengths": [12, 17, 4, 12, 3, 38, 31, 40, 9, 40, 40, 21, 6, 3, 8, 2, 40, 37, 4, 8, 7, 40, 21, 40, 5, 40, 9, 14, 16, 40, 29, 10, 40, 40, 40, 35, 14, 40, 7, 28, 25, 40, 40, 31, 40, 37, 40, 21, 12, 25, 40, 6, 19, 9, 40, 6, 40, 30, 40, 6, 11, 8, 9, 40, 9, 20, 40, 7, 40, 5, 40, 8, 19, 15, 40, 3, 12, 40, 40, 7, 8, 40, 40, 27, 40, 40, 36, 12, 40, 40, 40, 40, 40, 16, 36, 40, 40, 25, 33, 12]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2288635713119962, "mean_inference_ms": 1.2082276722191851, "mean_action_processing_ms": 0.10550647038088583, "mean_env_wait_ms": 315.5678828715744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007455110549926758, "StateBufferConnector_ms": 0.005750417709350586, "ViewRequirementAgentConnector_ms": 0.11278533935546875}}, "episode_reward_max": 32.145370715141304, "episode_reward_min": 1.1849092732318491, "episode_reward_mean": 18.281189277438756, "episode_len_mean": 24.95, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.773548394590435, 12.20525911248793, 2.5516618503910706, 9.461863652482684, 1.8192543375519885, 27.17072475596751, 22.127831816048616, 30.643884330105692, 6.6709518052369745, 28.29414399642926, 29.5364313847796, 14.994051304365827, 3.536017033391193, 1.7516618503910704, 6.303699932369721, 1.1849092732318491, 30.236749448519703, 26.557277998987427, 2.642033312190006, 6.065956859095204, 5.687251806300873, 29.08504156435521, 15.954721477382035, 32.145370715141304, 3.0683827919068696, 31.768491404873448, 6.259676538323936, 9.774503603911938, 11.358043388511762, 29.95310564258001, 21.395167909295346, 6.630969044192588, 29.877899030232413, 28.536700185422077, 28.421223718118423, 25.66620086483747, 9.46690233515922, 28.06765286230026, 4.975816416487291, 20.483037173749395, 19.816065815476414, 31.215818121122613, 29.402241179703392, 21.35134364816153, 29.618742999772383, 27.348363895841985, 30.667928548835334, 14.555774943568228, 8.669223309629546, 18.70857649988311, 28.160814667943843, 4.175361355777463, 15.06081722537681, 7.44060889879726, 28.913797287903595, 3.47121394293265, 29.109636024168104, 20.954072139044975, 30.00449883403483, 4.528641101520905, 7.35800868266699, 5.879961245472573, 6.46664095098806, 30.190750657218135, 6.579880338106242, 15.285547758525613, 27.53859242585177, 4.578910632359021, 30.154191777052805, 3.0491172450599526, 29.73436512064353, 5.420172622504875, 14.442669552470155, 10.594212065205692, 30.549913929108065, 1.6232435593241463, 7.983036773326214, 27.913715503972643, 28.665242202905254, 5.1533853021243505, 5.065984162754994, 27.382242116233048, 29.692744500676614, 19.33504757757003, 28.157227848827127, 29.240350262596852, 26.863307486217682, 7.847617704438965, 31.160700279344262, 29.40245314223192, 30.99818773589443, 28.356086079219093, 28.647106972479698, 11.780972016393399, 26.905791756613624, 29.42397352405991, 30.025260191348035, 18.31857554410805, 24.99700066033218, 10.079128476459266], "episode_lengths": [12, 17, 4, 12, 3, 38, 31, 40, 9, 40, 40, 21, 6, 3, 8, 2, 40, 37, 4, 8, 7, 40, 21, 40, 5, 40, 9, 14, 16, 40, 29, 10, 40, 40, 40, 35, 14, 40, 7, 28, 25, 40, 40, 31, 40, 37, 40, 21, 12, 25, 40, 6, 19, 9, 40, 6, 40, 30, 40, 6, 11, 8, 9, 40, 9, 20, 40, 7, 40, 5, 40, 8, 19, 15, 40, 3, 12, 40, 40, 7, 8, 40, 40, 27, 40, 40, 36, 12, 40, 40, 40, 40, 40, 16, 36, 40, 40, 25, 33, 12]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2288635713119962, "mean_inference_ms": 1.2082276722191851, "mean_action_processing_ms": 0.10550647038088583, "mean_env_wait_ms": 315.5678828715744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007455110549926758, "StateBufferConnector_ms": 0.005750417709350586, "ViewRequirementAgentConnector_ms": 0.11278533935546875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 6000, "num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 3.120773596052869, "num_env_steps_trained_throughput_per_sec": 3.120773596052869, "timesteps_total": 6000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 6000, "timers": {"training_iteration_time_ms": 639873.189, "sample_time_ms": 636544.526, "load_time_ms": 13.281, "load_throughput": 150586.253, "learn_time_ms": 3312.581, "learn_throughput": 603.759, "synch_weights_time_ms": 2.268}, "counters": {"num_env_steps_sampled": 6000, "num_env_steps_trained": 6000, "num_agent_steps_sampled": 6000, "num_agent_steps_trained": 6000}, "done": false, "episodes_total": 326, "training_iteration": 3, "trial_id": "13850_00000", "date": "2023-12-28_18-19-29", "timestamp": 1703758769, "time_this_iter_s": 640.872663974762, "time_total_s": 1919.6374933719635, "pid": 390995, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1919.6374933719635, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 55.99419496166484, "ram_util_percent": 92.71916757940855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.376276997460259, "policy_loss": -0.002416008785367012, "vf_loss": 8.376203375922309, "vf_explained_var": -0.0016608934932284885, "kl": 0.0055324288614873, "entropy": 1.339835961924659, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 31.28937874542847, "episode_reward_min": 1.6232435593241463, "episode_reward_mean": 22.182501941973825, "episode_len_mean": 30.53, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.190750657218135, 6.579880338106242, 15.285547758525613, 27.53859242585177, 4.578910632359021, 30.154191777052805, 3.0491172450599526, 29.73436512064353, 5.420172622504875, 14.442669552470155, 10.594212065205692, 30.549913929108065, 1.6232435593241463, 7.983036773326214, 27.913715503972643, 28.665242202905254, 5.1533853021243505, 5.065984162754994, 27.382242116233048, 29.692744500676614, 19.33504757757003, 28.157227848827127, 29.240350262596852, 26.863307486217682, 7.847617704438965, 31.160700279344262, 29.40245314223192, 30.99818773589443, 28.356086079219093, 28.647106972479698, 11.780972016393399, 26.905791756613624, 29.42397352405991, 30.025260191348035, 18.31857554410805, 24.99700066033218, 10.079128476459266, 27.094143917032092, 27.89411316828701, 23.685623745226128, 29.22519741236311, 27.737876624621144, 5.137789914225749, 1.7090530079356645, 29.314870593782274, 4.110153718058718, 27.768980112623044, 27.649683949812147, 29.40270284010697, 10.36248874632937, 30.73859166787948, 27.959989384588717, 2.815866425425783, 27.937364181705345, 27.379568002083264, 28.15931154333067, 28.692670010470408, 16.084324224878422, 28.294147433848586, 25.70395587361536, 4.288109793437866, 3.1157839117266195, 1.7540681019136157, 29.80512492519723, 29.69355307987783, 26.826199132013972, 30.00401885910909, 3.6016247816155817, 30.137789856773697, 28.27036388791302, 29.294148001393467, 23.00296295151614, 29.292600873026167, 29.22593803981552, 20.687207960562258, 29.84614390075119, 28.136239540014476, 28.123266188204113, 27.288170322419347, 16.776372714198157, 29.026114798282077, 28.694011254234653, 28.138592445820855, 4.424234636682319, 28.647170040334558, 29.804326456280258, 8.262084840743375, 29.045605860817478, 27.690667620972814, 19.337337476649523, 29.22429841466988, 9.793922741399653, 29.40308493738443, 25.27192188438503, 28.4711080264162, 29.047616899999387, 28.66725868213675, 31.28937874542847, 28.42476821247477, 28.421831399003178], "episode_lengths": [40, 9, 20, 40, 7, 40, 5, 40, 8, 19, 15, 40, 3, 12, 40, 40, 7, 8, 40, 40, 27, 40, 40, 36, 12, 40, 40, 40, 40, 40, 16, 36, 40, 40, 25, 33, 12, 40, 40, 33, 40, 40, 8, 3, 40, 6, 36, 40, 40, 14, 40, 36, 4, 40, 40, 40, 40, 23, 40, 36, 6, 5, 3, 40, 40, 37, 40, 5, 40, 40, 40, 32, 40, 40, 29, 40, 40, 38, 35, 24, 40, 40, 40, 7, 40, 40, 10, 40, 38, 27, 40, 14, 40, 34, 40, 40, 40, 40, 40, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1347119249793007, "mean_inference_ms": 1.2079162507259986, "mean_action_processing_ms": 0.10545924454140083, "mean_env_wait_ms": 315.84275212109213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007465362548828125, "StateBufferConnector_ms": 0.005414247512817383, "ViewRequirementAgentConnector_ms": 0.11246442794799805}}, "episode_reward_max": 31.28937874542847, "episode_reward_min": 1.6232435593241463, "episode_reward_mean": 22.182501941973825, "episode_len_mean": 30.53, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.190750657218135, 6.579880338106242, 15.285547758525613, 27.53859242585177, 4.578910632359021, 30.154191777052805, 3.0491172450599526, 29.73436512064353, 5.420172622504875, 14.442669552470155, 10.594212065205692, 30.549913929108065, 1.6232435593241463, 7.983036773326214, 27.913715503972643, 28.665242202905254, 5.1533853021243505, 5.065984162754994, 27.382242116233048, 29.692744500676614, 19.33504757757003, 28.157227848827127, 29.240350262596852, 26.863307486217682, 7.847617704438965, 31.160700279344262, 29.40245314223192, 30.99818773589443, 28.356086079219093, 28.647106972479698, 11.780972016393399, 26.905791756613624, 29.42397352405991, 30.025260191348035, 18.31857554410805, 24.99700066033218, 10.079128476459266, 27.094143917032092, 27.89411316828701, 23.685623745226128, 29.22519741236311, 27.737876624621144, 5.137789914225749, 1.7090530079356645, 29.314870593782274, 4.110153718058718, 27.768980112623044, 27.649683949812147, 29.40270284010697, 10.36248874632937, 30.73859166787948, 27.959989384588717, 2.815866425425783, 27.937364181705345, 27.379568002083264, 28.15931154333067, 28.692670010470408, 16.084324224878422, 28.294147433848586, 25.70395587361536, 4.288109793437866, 3.1157839117266195, 1.7540681019136157, 29.80512492519723, 29.69355307987783, 26.826199132013972, 30.00401885910909, 3.6016247816155817, 30.137789856773697, 28.27036388791302, 29.294148001393467, 23.00296295151614, 29.292600873026167, 29.22593803981552, 20.687207960562258, 29.84614390075119, 28.136239540014476, 28.123266188204113, 27.288170322419347, 16.776372714198157, 29.026114798282077, 28.694011254234653, 28.138592445820855, 4.424234636682319, 28.647170040334558, 29.804326456280258, 8.262084840743375, 29.045605860817478, 27.690667620972814, 19.337337476649523, 29.22429841466988, 9.793922741399653, 29.40308493738443, 25.27192188438503, 28.4711080264162, 29.047616899999387, 28.66725868213675, 31.28937874542847, 28.42476821247477, 28.421831399003178], "episode_lengths": [40, 9, 20, 40, 7, 40, 5, 40, 8, 19, 15, 40, 3, 12, 40, 40, 7, 8, 40, 40, 27, 40, 40, 36, 12, 40, 40, 40, 40, 40, 16, 36, 40, 40, 25, 33, 12, 40, 40, 33, 40, 40, 8, 3, 40, 6, 36, 40, 40, 14, 40, 36, 4, 40, 40, 40, 40, 23, 40, 36, 6, 5, 3, 40, 40, 37, 40, 5, 40, 40, 40, 32, 40, 40, 29, 40, 40, 38, 35, 24, 40, 40, 40, 7, 40, 40, 10, 40, 38, 27, 40, 14, 40, 34, 40, 40, 40, 40, 40, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1347119249793007, "mean_inference_ms": 1.2079162507259986, "mean_action_processing_ms": 0.10545924454140083, "mean_env_wait_ms": 315.84275212109213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007465362548828125, "StateBufferConnector_ms": 0.005414247512817383, "ViewRequirementAgentConnector_ms": 0.11246442794799805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 3.1208260593324257, "num_env_steps_trained_throughput_per_sec": 3.1208260593324257, "timesteps_total": 8000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 640118.878, "sample_time_ms": 636830.935, "load_time_ms": 12.365, "load_throughput": 161744.742, "learn_time_ms": 3272.797, "learn_throughput": 611.098, "synch_weights_time_ms": 2.265}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 389, "training_iteration": 4, "trial_id": "13850_00000", "date": "2023-12-28_18-30-10", "timestamp": 1703759410, "time_this_iter_s": 640.8606300354004, "time_total_s": 2560.498123407364, "pid": 390995, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2560.498123407364, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 55.96228070175439, "ram_util_percent": 92.3546052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.413020082049899, "policy_loss": 0.0016020228134261238, "vf_loss": 8.409638361401027, "vf_explained_var": 3.1844509972466364e-05, "kl": 0.003954850162803583, "entropy": 1.2840463214450413, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2025.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 10000}, "sampler_results": {"episode_reward_max": 31.28937874542847, "episode_reward_min": 1.2293537176762936, "episode_reward_mean": 23.45621486139532, "episode_len_mean": 32.52, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.69355307987783, 26.826199132013972, 30.00401885910909, 3.6016247816155817, 30.137789856773697, 28.27036388791302, 29.294148001393467, 23.00296295151614, 29.292600873026167, 29.22593803981552, 20.687207960562258, 29.84614390075119, 28.136239540014476, 28.123266188204113, 27.288170322419347, 16.776372714198157, 29.026114798282077, 28.694011254234653, 28.138592445820855, 4.424234636682319, 28.647170040334558, 29.804326456280258, 8.262084840743375, 29.045605860817478, 27.690667620972814, 19.337337476649523, 29.22429841466988, 9.793922741399653, 29.40308493738443, 25.27192188438503, 28.4711080264162, 29.047616899999387, 28.66725868213675, 31.28937874542847, 28.42476821247477, 28.421831399003178, 28.514478513988138, 15.711813143798091, 3.6496995519848037, 20.780844294683316, 26.84970287355228, 3.2233144467216404, 28.8030920749441, 10.192532127496506, 28.33129558994186, 28.44832522590163, 16.664044818855277, 28.758923088560028, 7.779814733797381, 28.758672303599745, 9.711069374864884, 3.6829785506383144, 29.403900427214612, 28.35467581075458, 29.816946497586073, 28.96081068150846, 28.78178537344806, 2.380366355307304, 16.938591878835247, 29.469732712590172, 10.304671998837328, 17.95931039478006, 29.337927054020746, 28.4033668520189, 30.290235746987197, 6.203739860483153, 28.071198530060975, 10.62045965787221, 28.112476517867538, 10.043094522961802, 27.203065676385346, 28.558257683587318, 28.889406676608367, 29.29403339073449, 29.443785023922118, 30.3369403798859, 28.6653373081961, 30.20069190318427, 29.959174113257745, 28.538592332197474, 27.71568158416961, 29.426671812949298, 15.243330072464545, 28.95891908701419, 1.622222222222222, 29.183021520847074, 28.78086222339222, 1.2293537176762936, 27.64969955198483, 8.581537924925021, 28.538588441427954, 28.848179404250974, 28.914181130751125, 28.29414800080981, 1.8609786838402704, 29.33639959932945, 28.67179240227157, 30.668539503850813, 28.243085408221123, 28.15918230939209], "episode_lengths": [40, 37, 40, 5, 40, 40, 40, 32, 40, 40, 29, 40, 40, 38, 35, 24, 40, 40, 40, 7, 40, 40, 10, 40, 38, 27, 40, 14, 40, 34, 40, 40, 40, 40, 40, 40, 40, 23, 6, 30, 40, 5, 40, 14, 40, 40, 24, 40, 12, 40, 14, 5, 40, 40, 40, 40, 40, 4, 24, 40, 14, 25, 40, 40, 40, 9, 40, 15, 40, 15, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 22, 40, 3, 40, 40, 2, 40, 13, 40, 40, 40, 40, 3, 40, 40, 40, 40, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0659895481533164, "mean_inference_ms": 1.2086729993961123, "mean_action_processing_ms": 0.10556511965084903, "mean_env_wait_ms": 316.2473249626328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007429838180541992, "StateBufferConnector_ms": 0.005168437957763672, "ViewRequirementAgentConnector_ms": 0.11253237724304199}}, "episode_reward_max": 31.28937874542847, "episode_reward_min": 1.2293537176762936, "episode_reward_mean": 23.45621486139532, "episode_len_mean": 32.52, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.69355307987783, 26.826199132013972, 30.00401885910909, 3.6016247816155817, 30.137789856773697, 28.27036388791302, 29.294148001393467, 23.00296295151614, 29.292600873026167, 29.22593803981552, 20.687207960562258, 29.84614390075119, 28.136239540014476, 28.123266188204113, 27.288170322419347, 16.776372714198157, 29.026114798282077, 28.694011254234653, 28.138592445820855, 4.424234636682319, 28.647170040334558, 29.804326456280258, 8.262084840743375, 29.045605860817478, 27.690667620972814, 19.337337476649523, 29.22429841466988, 9.793922741399653, 29.40308493738443, 25.27192188438503, 28.4711080264162, 29.047616899999387, 28.66725868213675, 31.28937874542847, 28.42476821247477, 28.421831399003178, 28.514478513988138, 15.711813143798091, 3.6496995519848037, 20.780844294683316, 26.84970287355228, 3.2233144467216404, 28.8030920749441, 10.192532127496506, 28.33129558994186, 28.44832522590163, 16.664044818855277, 28.758923088560028, 7.779814733797381, 28.758672303599745, 9.711069374864884, 3.6829785506383144, 29.403900427214612, 28.35467581075458, 29.816946497586073, 28.96081068150846, 28.78178537344806, 2.380366355307304, 16.938591878835247, 29.469732712590172, 10.304671998837328, 17.95931039478006, 29.337927054020746, 28.4033668520189, 30.290235746987197, 6.203739860483153, 28.071198530060975, 10.62045965787221, 28.112476517867538, 10.043094522961802, 27.203065676385346, 28.558257683587318, 28.889406676608367, 29.29403339073449, 29.443785023922118, 30.3369403798859, 28.6653373081961, 30.20069190318427, 29.959174113257745, 28.538592332197474, 27.71568158416961, 29.426671812949298, 15.243330072464545, 28.95891908701419, 1.622222222222222, 29.183021520847074, 28.78086222339222, 1.2293537176762936, 27.64969955198483, 8.581537924925021, 28.538588441427954, 28.848179404250974, 28.914181130751125, 28.29414800080981, 1.8609786838402704, 29.33639959932945, 28.67179240227157, 30.668539503850813, 28.243085408221123, 28.15918230939209], "episode_lengths": [40, 37, 40, 5, 40, 40, 40, 32, 40, 40, 29, 40, 40, 38, 35, 24, 40, 40, 40, 7, 40, 40, 10, 40, 38, 27, 40, 14, 40, 34, 40, 40, 40, 40, 40, 40, 40, 23, 6, 30, 40, 5, 40, 14, 40, 40, 24, 40, 12, 40, 14, 5, 40, 40, 40, 40, 40, 4, 24, 40, 14, 25, 40, 40, 40, 9, 40, 15, 40, 15, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 22, 40, 3, 40, 40, 2, 40, 13, 40, 40, 40, 40, 3, 40, 40, 40, 40, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0659895481533164, "mean_inference_ms": 1.2086729993961123, "mean_action_processing_ms": 0.10556511965084903, "mean_env_wait_ms": 316.2473249626328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007429838180541992, "StateBufferConnector_ms": 0.005168437957763672, "ViewRequirementAgentConnector_ms": 0.11253237724304199}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 10000, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 3.1034453045769155, "num_env_steps_trained_throughput_per_sec": 3.1034453045769155, "timesteps_total": 10000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 10000, "timers": {"training_iteration_time_ms": 640984.11, "sample_time_ms": 637686.056, "load_time_ms": 10.954, "load_throughput": 182579.345, "learn_time_ms": 3284.21, "learn_throughput": 608.974, "synch_weights_time_ms": 2.36}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 10000, "num_agent_steps_trained": 10000}, "done": false, "episodes_total": 453, "training_iteration": 5, "trial_id": "13850_00000", "date": "2023-12-28_18-40-54", "timestamp": 1703760054, "time_this_iter_s": 644.4504904747009, "time_total_s": 3204.948613882065, "pid": 390995, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3204.948613882065, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 55.9856052344602, "ram_util_percent": 92.39138495092693}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.317471255196466, "policy_loss": -0.01848058455520206, "vf_loss": 8.333929531309339, "vf_explained_var": -0.000899404419793023, "kl": 0.00898805368514324, "entropy": 1.2037649965286255, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2475.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 30.668539503850813, "episode_reward_min": 1.2293537176762936, "episode_reward_mean": 24.154474682065647, "episode_len_mean": 33.7, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.938591878835247, 29.469732712590172, 10.304671998837328, 17.95931039478006, 29.337927054020746, 28.4033668520189, 30.290235746987197, 6.203739860483153, 28.071198530060975, 10.62045965787221, 28.112476517867538, 10.043094522961802, 27.203065676385346, 28.558257683587318, 28.889406676608367, 29.29403339073449, 29.443785023922118, 30.3369403798859, 28.6653373081961, 30.20069190318427, 29.959174113257745, 28.538592332197474, 27.71568158416961, 29.426671812949298, 15.243330072464545, 28.95891908701419, 1.622222222222222, 29.183021520847074, 28.78086222339222, 1.2293537176762936, 27.64969955198483, 8.581537924925021, 28.538588441427954, 28.848179404250974, 28.914181130751125, 28.29414800080981, 1.8609786838402704, 29.33639959932945, 28.67179240227157, 30.668539503850813, 28.243085408221123, 28.15918230939209, 29.382679180734876, 22.80171892235541, 29.56081466806013, 3.403363531480558, 21.18302059406603, 29.136700869753252, 29.51483272763261, 27.626556193500505, 27.713611191207367, 27.915658387377125, 28.847142604999505, 28.160655670547143, 29.06834568794424, 8.372730219611585, 12.132632387858413, 29.09414800137932, 10.294148001293705, 10.219247670801618, 28.471327861726493, 29.20237715806429, 28.73656361453044, 27.7561896353747, 28.24970011943268, 29.71633238452065, 29.11610102927976, 27.627462625223444, 29.692256425109814, 28.95661298337903, 29.26797351083757, 28.027438468307924, 29.223943058017635, 29.66514206899477, 29.227481314743038, 27.847810646695137, 29.359286975606004, 28.204570581807133, 28.13843234595074, 27.937881056809, 28.11000274727895, 27.29345935863192, 29.138028886713226, 1.8399878635520297, 1.7105482353831813, 27.049570179465704, 27.579769985074595, 28.38073464637727, 2.5096236574691715, 27.716369421482415, 27.714478647528114, 28.91508348166497, 29.580826082814458, 4.890443515301741, 28.848313407126646, 27.713900359410186, 28.95763861398969, 29.159180601330515, 3.3553393358324626, 29.36081398805839], "episode_lengths": [24, 40, 14, 25, 40, 40, 40, 9, 40, 15, 40, 15, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 22, 40, 3, 40, 40, 2, 40, 13, 40, 40, 40, 40, 3, 40, 40, 40, 40, 40, 40, 31, 40, 6, 30, 40, 40, 40, 40, 40, 40, 40, 40, 12, 17, 40, 15, 14, 40, 40, 39, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 39, 40, 40, 3, 3, 40, 40, 40, 4, 40, 40, 40, 40, 7, 40, 40, 40, 40, 5, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0207147647961645, "mean_inference_ms": 1.209115659273835, "mean_action_processing_ms": 0.1056419782530515, "mean_env_wait_ms": 316.3927684445121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007508039474487305, "StateBufferConnector_ms": 0.005221843719482422, "ViewRequirementAgentConnector_ms": 0.11242532730102539}}, "episode_reward_max": 30.668539503850813, "episode_reward_min": 1.2293537176762936, "episode_reward_mean": 24.154474682065647, "episode_len_mean": 33.7, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.938591878835247, 29.469732712590172, 10.304671998837328, 17.95931039478006, 29.337927054020746, 28.4033668520189, 30.290235746987197, 6.203739860483153, 28.071198530060975, 10.62045965787221, 28.112476517867538, 10.043094522961802, 27.203065676385346, 28.558257683587318, 28.889406676608367, 29.29403339073449, 29.443785023922118, 30.3369403798859, 28.6653373081961, 30.20069190318427, 29.959174113257745, 28.538592332197474, 27.71568158416961, 29.426671812949298, 15.243330072464545, 28.95891908701419, 1.622222222222222, 29.183021520847074, 28.78086222339222, 1.2293537176762936, 27.64969955198483, 8.581537924925021, 28.538588441427954, 28.848179404250974, 28.914181130751125, 28.29414800080981, 1.8609786838402704, 29.33639959932945, 28.67179240227157, 30.668539503850813, 28.243085408221123, 28.15918230939209, 29.382679180734876, 22.80171892235541, 29.56081466806013, 3.403363531480558, 21.18302059406603, 29.136700869753252, 29.51483272763261, 27.626556193500505, 27.713611191207367, 27.915658387377125, 28.847142604999505, 28.160655670547143, 29.06834568794424, 8.372730219611585, 12.132632387858413, 29.09414800137932, 10.294148001293705, 10.219247670801618, 28.471327861726493, 29.20237715806429, 28.73656361453044, 27.7561896353747, 28.24970011943268, 29.71633238452065, 29.11610102927976, 27.627462625223444, 29.692256425109814, 28.95661298337903, 29.26797351083757, 28.027438468307924, 29.223943058017635, 29.66514206899477, 29.227481314743038, 27.847810646695137, 29.359286975606004, 28.204570581807133, 28.13843234595074, 27.937881056809, 28.11000274727895, 27.29345935863192, 29.138028886713226, 1.8399878635520297, 1.7105482353831813, 27.049570179465704, 27.579769985074595, 28.38073464637727, 2.5096236574691715, 27.716369421482415, 27.714478647528114, 28.91508348166497, 29.580826082814458, 4.890443515301741, 28.848313407126646, 27.713900359410186, 28.95763861398969, 29.159180601330515, 3.3553393358324626, 29.36081398805839], "episode_lengths": [24, 40, 14, 25, 40, 40, 40, 9, 40, 15, 40, 15, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 22, 40, 3, 40, 40, 2, 40, 13, 40, 40, 40, 40, 3, 40, 40, 40, 40, 40, 40, 31, 40, 6, 30, 40, 40, 40, 40, 40, 40, 40, 40, 12, 17, 40, 15, 14, 40, 40, 39, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 39, 40, 40, 3, 3, 40, 40, 40, 4, 40, 40, 40, 40, 7, 40, 40, 40, 40, 5, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0207147647961645, "mean_inference_ms": 1.209115659273835, "mean_action_processing_ms": 0.1056419782530515, "mean_env_wait_ms": 316.3927684445121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007508039474487305, "StateBufferConnector_ms": 0.005221843719482422, "ViewRequirementAgentConnector_ms": 0.11242532730102539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 3.1268554107742377, "num_env_steps_trained_throughput_per_sec": 3.1268554107742377, "timesteps_total": 12000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 640756.794, "sample_time_ms": 637481.812, "load_time_ms": 9.983, "load_throughput": 200348.092, "learn_time_ms": 3262.077, "learn_throughput": 613.106, "synch_weights_time_ms": 2.409}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 511, "training_iteration": 6, "trial_id": "13850_00000", "date": "2023-12-28_18-51-34", "timestamp": 1703760694, "time_this_iter_s": 639.626323223114, "time_total_s": 3844.574937105179, "pid": 390995, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3844.574937105179, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 55.96153846153846, "ram_util_percent": 92.46384615384616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.251707353591918, "policy_loss": -0.014514244919021924, "vf_loss": 8.26138742764791, "vf_explained_var": -4.757046699523926e-05, "kl": 0.021485112236982414, "entropy": 1.0396849285231695, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 2925.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000}, "sampler_results": {"episode_reward_max": 29.71633238452065, "episode_reward_min": 1.7105482353831813, "episode_reward_mean": 24.523407189810854, "episode_len_mean": 34.51, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.294148001293705, 10.219247670801618, 28.471327861726493, 29.20237715806429, 28.73656361453044, 27.7561896353747, 28.24970011943268, 29.71633238452065, 29.11610102927976, 27.627462625223444, 29.692256425109814, 28.95661298337903, 29.26797351083757, 28.027438468307924, 29.223943058017635, 29.66514206899477, 29.227481314743038, 27.847810646695137, 29.359286975606004, 28.204570581807133, 28.13843234595074, 27.937881056809, 28.11000274727895, 27.29345935863192, 29.138028886713226, 1.8399878635520297, 1.7105482353831813, 27.049570179465704, 27.579769985074595, 28.38073464637727, 2.5096236574691715, 27.716369421482415, 27.714478647528114, 28.91508348166497, 29.580826082814458, 4.890443515301741, 28.848313407126646, 27.713900359410186, 28.95763861398969, 29.159180601330515, 3.3553393358324626, 29.36081398805839, 28.782473326821616, 29.396088735798656, 10.183036890281839, 29.492645038874727, 28.070034143049877, 28.95858599835605, 28.936700869277953, 28.849566904689784, 29.269067639505973, 29.426682580820714, 28.27191780385308, 28.981784538869885, 29.29414800137642, 28.338592445834994, 28.181270820640126, 27.51637022361568, 28.824896507679735, 28.271921786793442, 29.622528624568, 18.42584898270026, 4.803060118439534, 9.938455320054764, 16.071925094840218, 27.936655425866423, 3.0924428373636568, 29.20523278167277, 29.403367535820898, 29.071925778587588, 3.889002595938198, 28.583036206326273, 29.56067740315238, 16.357547762752606, 27.560791231901685, 12.249703536962574, 26.871362901882765, 29.559307197448213, 2.3372270384978187, 28.803256311040396, 5.4142505541867045, 28.071925779154192, 27.1589191046111, 5.6478104901966315, 29.183036886866912, 27.760811327510755, 28.138231644113382, 29.248195278719102, 28.11336501852119, 27.603367536419828, 27.094014624493298, 27.605255121724962, 27.605147900393803, 27.449702873469562, 28.269904692339434, 28.07114699283848, 27.894147316994367, 28.894014624490875, 27.227347275838557, 28.73859244525424], "episode_lengths": [15, 14, 40, 40, 39, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 39, 40, 40, 3, 3, 40, 40, 40, 4, 40, 40, 40, 40, 7, 40, 40, 40, 40, 5, 40, 40, 40, 16, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 28, 7, 15, 24, 40, 5, 40, 40, 40, 6, 40, 40, 23, 40, 19, 40, 40, 4, 40, 7, 40, 40, 8, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9838384377469302, "mean_inference_ms": 1.2097375666388033, "mean_action_processing_ms": 0.10570384822771178, "mean_env_wait_ms": 316.59167461883504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007511138916015625, "StateBufferConnector_ms": 0.0052907466888427734, "ViewRequirementAgentConnector_ms": 0.11281418800354004}}, "episode_reward_max": 29.71633238452065, "episode_reward_min": 1.7105482353831813, "episode_reward_mean": 24.523407189810854, "episode_len_mean": 34.51, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.294148001293705, 10.219247670801618, 28.471327861726493, 29.20237715806429, 28.73656361453044, 27.7561896353747, 28.24970011943268, 29.71633238452065, 29.11610102927976, 27.627462625223444, 29.692256425109814, 28.95661298337903, 29.26797351083757, 28.027438468307924, 29.223943058017635, 29.66514206899477, 29.227481314743038, 27.847810646695137, 29.359286975606004, 28.204570581807133, 28.13843234595074, 27.937881056809, 28.11000274727895, 27.29345935863192, 29.138028886713226, 1.8399878635520297, 1.7105482353831813, 27.049570179465704, 27.579769985074595, 28.38073464637727, 2.5096236574691715, 27.716369421482415, 27.714478647528114, 28.91508348166497, 29.580826082814458, 4.890443515301741, 28.848313407126646, 27.713900359410186, 28.95763861398969, 29.159180601330515, 3.3553393358324626, 29.36081398805839, 28.782473326821616, 29.396088735798656, 10.183036890281839, 29.492645038874727, 28.070034143049877, 28.95858599835605, 28.936700869277953, 28.849566904689784, 29.269067639505973, 29.426682580820714, 28.27191780385308, 28.981784538869885, 29.29414800137642, 28.338592445834994, 28.181270820640126, 27.51637022361568, 28.824896507679735, 28.271921786793442, 29.622528624568, 18.42584898270026, 4.803060118439534, 9.938455320054764, 16.071925094840218, 27.936655425866423, 3.0924428373636568, 29.20523278167277, 29.403367535820898, 29.071925778587588, 3.889002595938198, 28.583036206326273, 29.56067740315238, 16.357547762752606, 27.560791231901685, 12.249703536962574, 26.871362901882765, 29.559307197448213, 2.3372270384978187, 28.803256311040396, 5.4142505541867045, 28.071925779154192, 27.1589191046111, 5.6478104901966315, 29.183036886866912, 27.760811327510755, 28.138231644113382, 29.248195278719102, 28.11336501852119, 27.603367536419828, 27.094014624493298, 27.605255121724962, 27.605147900393803, 27.449702873469562, 28.269904692339434, 28.07114699283848, 27.894147316994367, 28.894014624490875, 27.227347275838557, 28.73859244525424], "episode_lengths": [15, 14, 40, 40, 39, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 39, 40, 40, 3, 3, 40, 40, 40, 4, 40, 40, 40, 40, 7, 40, 40, 40, 40, 5, 40, 40, 40, 16, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 28, 7, 15, 24, 40, 5, 40, 40, 40, 6, 40, 40, 23, 40, 19, 40, 40, 4, 40, 7, 40, 40, 8, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9838384377469302, "mean_inference_ms": 1.2097375666388033, "mean_action_processing_ms": 0.10570384822771178, "mean_env_wait_ms": 316.59167461883504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007511138916015625, "StateBufferConnector_ms": 0.0052907466888427734, "ViewRequirementAgentConnector_ms": 0.11281418800354004}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000, "num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 3.0981911053824387, "num_env_steps_trained_throughput_per_sec": 3.0981911053824387, "timesteps_total": 14000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 14000, "timers": {"training_iteration_time_ms": 641439.816, "sample_time_ms": 638175.537, "load_time_ms": 9.877, "load_throughput": 202489.926, "learn_time_ms": 3251.541, "learn_throughput": 615.093, "synch_weights_time_ms": 2.364}, "counters": {"num_env_steps_sampled": 14000, "num_env_steps_trained": 14000, "num_agent_steps_sampled": 14000, "num_agent_steps_trained": 14000}, "done": false, "episodes_total": 569, "training_iteration": 7, "trial_id": "13850_00000", "date": "2023-12-28_19-02-19", "timestamp": 1703761339, "time_this_iter_s": 645.5425453186035, "time_total_s": 4490.117482423782, "pid": 390995, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4490.117482423782, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 55.91904243743199, "ram_util_percent": 92.44961915125134}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.070634909735785, "policy_loss": 0.0021743965273102123, "vf_loss": 8.067250661849975, "vf_explained_var": -0.00018186410268147786, "kl": 0.0035846367264898297, "entropy": 0.9759875131977929, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3375.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 30.2252924352958, "episode_reward_min": 1.7294396281688482, "episode_reward_mean": 24.862103111915967, "episode_len_mean": 35.24, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.29414800137642, 28.338592445834994, 28.181270820640126, 27.51637022361568, 28.824896507679735, 28.271921786793442, 29.622528624568, 18.42584898270026, 4.803060118439534, 9.938455320054764, 16.071925094840218, 27.936655425866423, 3.0924428373636568, 29.20523278167277, 29.403367535820898, 29.071925778587588, 3.889002595938198, 28.583036206326273, 29.56067740315238, 16.357547762752606, 27.560791231901685, 12.249703536962574, 26.871362901882765, 29.559307197448213, 2.3372270384978187, 28.803256311040396, 5.4142505541867045, 28.071925779154192, 27.1589191046111, 5.6478104901966315, 29.183036886866912, 27.760811327510755, 28.138231644113382, 29.248195278719102, 28.11336501852119, 27.603367536419828, 27.094014624493298, 27.605255121724962, 27.605147900393803, 27.449702873469562, 28.269904692339434, 28.07114699283848, 27.894147316994367, 28.894014624490875, 27.227347275838557, 28.73859244525424, 28.560814667493524, 28.18303689028235, 28.916366218726417, 28.60334031614889, 28.97707242034554, 27.62677302034664, 30.2252924352958, 27.494148001393377, 29.360814668060133, 27.716370223032026, 28.18303687361162, 1.7294396281688482, 28.716354809989262, 28.225589075245086, 28.958922487975585, 27.42597706146087, 29.360681529813903, 27.426895468707986, 26.959563152870373, 27.40376013737459, 28.82744263894485, 28.471902788880385, 28.15930638990582, 29.225293733400186, 27.781145157675695, 28.62748131474302, 28.004453261419442, 16.716370223128834, 28.159310276250896, 28.22488794884736, 27.005259112487526, 29.583036888230048, 27.115661925325508, 29.494147826392233, 28.84780799349998, 27.56081466464468, 27.426788689906125, 29.494147998561665, 28.582363796851084, 27.84903800949039, 29.404547726890872, 11.116370223615101, 27.09264372812753, 27.716346770883582, 13.53859244583788, 7.91637022351593, 28.60336747686634, 11.316370223131665, 28.694147981409206, 27.560811347497022, 28.337903806391346, 3.2918464946608275, 28.449569499069923, 29.000771558876124], "episode_lengths": [40, 40, 40, 40, 40, 40, 40, 28, 7, 15, 24, 40, 5, 40, 40, 40, 6, 40, 40, 23, 40, 19, 40, 40, 4, 40, 7, 40, 40, 8, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 3, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 25, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 17, 40, 40, 19, 12, 40, 17, 40, 40, 40, 5, 40, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9557781870149806, "mean_inference_ms": 1.2107847940061573, "mean_action_processing_ms": 0.10584300614284743, "mean_env_wait_ms": 316.8399751187845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007656574249267578, "StateBufferConnector_ms": 0.005295276641845703, "ViewRequirementAgentConnector_ms": 0.11340904235839844}}, "episode_reward_max": 30.2252924352958, "episode_reward_min": 1.7294396281688482, "episode_reward_mean": 24.862103111915967, "episode_len_mean": 35.24, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.29414800137642, 28.338592445834994, 28.181270820640126, 27.51637022361568, 28.824896507679735, 28.271921786793442, 29.622528624568, 18.42584898270026, 4.803060118439534, 9.938455320054764, 16.071925094840218, 27.936655425866423, 3.0924428373636568, 29.20523278167277, 29.403367535820898, 29.071925778587588, 3.889002595938198, 28.583036206326273, 29.56067740315238, 16.357547762752606, 27.560791231901685, 12.249703536962574, 26.871362901882765, 29.559307197448213, 2.3372270384978187, 28.803256311040396, 5.4142505541867045, 28.071925779154192, 27.1589191046111, 5.6478104901966315, 29.183036886866912, 27.760811327510755, 28.138231644113382, 29.248195278719102, 28.11336501852119, 27.603367536419828, 27.094014624493298, 27.605255121724962, 27.605147900393803, 27.449702873469562, 28.269904692339434, 28.07114699283848, 27.894147316994367, 28.894014624490875, 27.227347275838557, 28.73859244525424, 28.560814667493524, 28.18303689028235, 28.916366218726417, 28.60334031614889, 28.97707242034554, 27.62677302034664, 30.2252924352958, 27.494148001393377, 29.360814668060133, 27.716370223032026, 28.18303687361162, 1.7294396281688482, 28.716354809989262, 28.225589075245086, 28.958922487975585, 27.42597706146087, 29.360681529813903, 27.426895468707986, 26.959563152870373, 27.40376013737459, 28.82744263894485, 28.471902788880385, 28.15930638990582, 29.225293733400186, 27.781145157675695, 28.62748131474302, 28.004453261419442, 16.716370223128834, 28.159310276250896, 28.22488794884736, 27.005259112487526, 29.583036888230048, 27.115661925325508, 29.494147826392233, 28.84780799349998, 27.56081466464468, 27.426788689906125, 29.494147998561665, 28.582363796851084, 27.84903800949039, 29.404547726890872, 11.116370223615101, 27.09264372812753, 27.716346770883582, 13.53859244583788, 7.91637022351593, 28.60336747686634, 11.316370223131665, 28.694147981409206, 27.560811347497022, 28.337903806391346, 3.2918464946608275, 28.449569499069923, 29.000771558876124], "episode_lengths": [40, 40, 40, 40, 40, 40, 40, 28, 7, 15, 24, 40, 5, 40, 40, 40, 6, 40, 40, 23, 40, 19, 40, 40, 4, 40, 7, 40, 40, 8, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 3, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 25, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 17, 40, 40, 19, 12, 40, 17, 40, 40, 40, 5, 40, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9557781870149806, "mean_inference_ms": 1.2107847940061573, "mean_action_processing_ms": 0.10584300614284743, "mean_env_wait_ms": 316.8399751187845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007656574249267578, "StateBufferConnector_ms": 0.005295276641845703, "ViewRequirementAgentConnector_ms": 0.11340904235839844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 3.1081156470624958, "num_env_steps_trained_throughput_per_sec": 3.1081156470624958, "timesteps_total": 16000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 641694.423, "sample_time_ms": 638445.243, "load_time_ms": 9.778, "load_throughput": 204547.811, "learn_time_ms": 3236.579, "learn_throughput": 617.936, "synch_weights_time_ms": 2.331}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 623, "training_iteration": 8, "trial_id": "13850_00000", "date": "2023-12-28_19-13-03", "timestamp": 1703761983, "time_this_iter_s": 643.481241941452, "time_total_s": 5133.598724365234, "pid": 390995, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5133.598724365234, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 55.89934497816594, "ram_util_percent": 92.42183406113537}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.822437746259901, "policy_loss": -0.0008185810016261207, "vf_loss": 7.822258257336086, "vf_explained_var": -8.328530523512099e-05, "kl": 0.005914458698352974, "entropy": 0.8973548429542118, "entropy_coeff": 0.0}, "model": {}, "num_grad_updates_lifetime": 3825.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "sampler_results": {"episode_reward_max": 30.2252924352958, "episode_reward_min": 1.7294396281688482, "episode_reward_mean": 26.224348282044165, "episode_len_mean": 37.42, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.2252924352958, 27.494148001393377, 29.360814668060133, 27.716370223032026, 28.18303687361162, 1.7294396281688482, 28.716354809989262, 28.225589075245086, 28.958922487975585, 27.42597706146087, 29.360681529813903, 27.426895468707986, 26.959563152870373, 27.40376013737459, 28.82744263894485, 28.471902788880385, 28.15930638990582, 29.225293733400186, 27.781145157675695, 28.62748131474302, 28.004453261419442, 16.716370223128834, 28.159310276250896, 28.22488794884736, 27.005259112487526, 29.583036888230048, 27.115661925325508, 29.494147826392233, 28.84780799349998, 27.56081466464468, 27.426788689906125, 29.494147998561665, 28.582363796851084, 27.84903800949039, 29.404547726890872, 11.116370223615101, 27.09264372812753, 27.716346770883582, 13.53859244583788, 7.91637022351593, 28.60336747686634, 11.316370223131665, 28.694147981409206, 27.560811347497022, 28.337903806391346, 3.2918464946608275, 28.449569499069923, 29.000771558876124, 28.783036889698717, 28.42745846601082, 28.44819928368301, 27.402518655182643, 27.558789963285054, 28.516347233324826, 28.31434551835668, 28.983036890282264, 26.938569455547054, 27.758786683657938, 10.738592425851682, 7.849702872547743, 27.47192179176545, 27.15892307198905, 28.316370106732062, 27.36079142142768, 29.205258545436568, 27.071925095675, 26.916370223615697, 28.492123287071713, 27.00336753640287, 27.094147904423775, 27.89260727775215, 27.13667776793578, 28.7815326107692, 27.491843394959908, 29.22558975864214, 27.82558973865571, 27.91636953928186, 10.871925779170727, 27.913068220377493, 29.31637022361569, 29.360662088610397, 27.471921788391374, 27.20373541924096, 26.84970355694903, 27.671902788877464, 27.627366157190522, 29.134652743026017, 29.027457915638287, 28.360814668059632, 27.827477347238315, 27.116370223032042, 27.427481334726803, 27.183036889698712, 28.005236102251608, 27.203621462314857, 27.960658681572394, 28.400783428681365, 27.160126028614066, 26.982348247421108, 27.894148001393457], "episode_lengths": [40, 40, 40, 40, 40, 3, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 25, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 17, 40, 40, 19, 12, 40, 17, 40, 40, 40, 5, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 16, 12, 40, 39, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 17, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9300589255507897, "mean_inference_ms": 1.2104465971101006, "mean_action_processing_ms": 0.10587385913700126, "mean_env_wait_ms": 316.79070254474965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519721984863281, "StateBufferConnector_ms": 0.005018472671508789, "ViewRequirementAgentConnector_ms": 0.11208796501159668}}, "episode_reward_max": 30.2252924352958, "episode_reward_min": 1.7294396281688482, "episode_reward_mean": 26.224348282044165, "episode_len_mean": 37.42, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.2252924352958, 27.494148001393377, 29.360814668060133, 27.716370223032026, 28.18303687361162, 1.7294396281688482, 28.716354809989262, 28.225589075245086, 28.958922487975585, 27.42597706146087, 29.360681529813903, 27.426895468707986, 26.959563152870373, 27.40376013737459, 28.82744263894485, 28.471902788880385, 28.15930638990582, 29.225293733400186, 27.781145157675695, 28.62748131474302, 28.004453261419442, 16.716370223128834, 28.159310276250896, 28.22488794884736, 27.005259112487526, 29.583036888230048, 27.115661925325508, 29.494147826392233, 28.84780799349998, 27.56081466464468, 27.426788689906125, 29.494147998561665, 28.582363796851084, 27.84903800949039, 29.404547726890872, 11.116370223615101, 27.09264372812753, 27.716346770883582, 13.53859244583788, 7.91637022351593, 28.60336747686634, 11.316370223131665, 28.694147981409206, 27.560811347497022, 28.337903806391346, 3.2918464946608275, 28.449569499069923, 29.000771558876124, 28.783036889698717, 28.42745846601082, 28.44819928368301, 27.402518655182643, 27.558789963285054, 28.516347233324826, 28.31434551835668, 28.983036890282264, 26.938569455547054, 27.758786683657938, 10.738592425851682, 7.849702872547743, 27.47192179176545, 27.15892307198905, 28.316370106732062, 27.36079142142768, 29.205258545436568, 27.071925095675, 26.916370223615697, 28.492123287071713, 27.00336753640287, 27.094147904423775, 27.89260727775215, 27.13667776793578, 28.7815326107692, 27.491843394959908, 29.22558975864214, 27.82558973865571, 27.91636953928186, 10.871925779170727, 27.913068220377493, 29.31637022361569, 29.360662088610397, 27.471921788391374, 27.20373541924096, 26.84970355694903, 27.671902788877464, 27.627366157190522, 29.134652743026017, 29.027457915638287, 28.360814668059632, 27.827477347238315, 27.116370223032042, 27.427481334726803, 27.183036889698712, 28.005236102251608, 27.203621462314857, 27.960658681572394, 28.400783428681365, 27.160126028614066, 26.982348247421108, 27.894148001393457], "episode_lengths": [40, 40, 40, 40, 40, 3, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 25, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 17, 40, 40, 19, 12, 40, 17, 40, 40, 40, 5, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 16, 12, 40, 39, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 17, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9300589255507897, "mean_inference_ms": 1.2104465971101006, "mean_action_processing_ms": 0.10587385913700126, "mean_env_wait_ms": 316.79070254474965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007519721984863281, "StateBufferConnector_ms": 0.005018472671508789, "ViewRequirementAgentConnector_ms": 0.11208796501159668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 2000, "num_env_steps_trained_this_iter": 2000, "num_env_steps_sampled_throughput_per_sec": 3.1409166833617803, "num_env_steps_trained_throughput_per_sec": 3.1409166833617803, "timesteps_total": 18000, "num_steps_trained_this_iter": 2000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 641145.793, "sample_time_ms": 637908.051, "load_time_ms": 11.189, "load_throughput": 178748.51, "learn_time_ms": 3223.766, "learn_throughput": 620.393, "synch_weights_time_ms": 2.303}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "done": false, "episodes_total": 675, "training_iteration": 9, "trial_id": "13850_00000", "date": "2023-12-28_19-23-39", "timestamp": 1703762619, "time_this_iter_s": 636.7614693641663, "time_total_s": 5770.360193729401, "pid": 390995, "hostname": "lzqw-B365M-D2VX-SI", "node_ip": "172.26.25.128", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "highway-v0", "env_config": {"render_mode": "rgb_array"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f4aace36820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5770.360193729401, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 55.97781456953643, "ram_util_percent": 92.55717439293599}}
